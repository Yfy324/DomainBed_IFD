
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 36
	normlizetype: 0-1
	output_dir: train_output/7a6bf7f8c80024a0ff3cfc19b038b38a
	save_model_every_checkpoint: False
	seed: 1702098850
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	class_balanced: False
	data_augmentation: True
	lr: 1.5717124715347616e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.00019407120641339628
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3200000000  0.3095238095  0.3220000000  0.3095238095  0.3162650602  0.3253012048  0.3388554217  0.3192771084  0.3174603175  0.0000000000  1.1880071163  0.0194082260  0             0.3411629200
0.3460000000  0.3095238095  0.3160000000  0.3174603175  0.4759036145  0.5180722892  0.3674698795  0.3253012048  0.2904761905  1.8000000000  1.1457261682  0.0257153511  50            0.0408151054
0.3520000000  0.3333333333  0.3700000000  0.3809523810  0.5075301205  0.5240963855  0.4683734940  0.4036144578  0.3000000000  3.6000000000  1.1106623077  0.0257153511  100           0.0408948040
0.3660000000  0.3174603175  0.3900000000  0.3888888889  0.4593373494  0.4879518072  0.5015060241  0.4638554217  0.3380952381  5.4000000000  1.0911687899  0.0257153511  150           0.0402089834
0.3580000000  0.3253968254  0.3980000000  0.3650793651  0.4382530120  0.4518072289  0.5271084337  0.4819277108  0.3428571429  7.2000000000  1.0653569710  0.0257153511  200           0.0385349846
0.3640000000  0.3333333333  0.4220000000  0.4126984127  0.4322289157  0.4518072289  0.5783132530  0.5662650602  0.3539682540  9.0000000000  1.0499453366  0.0257153511  250           0.0398315859
0.3760000000  0.3174603175  0.4520000000  0.4523809524  0.4412650602  0.4397590361  0.5843373494  0.5662650602  0.3888888889  10.800000000  1.0402866125  0.0257153511  300           0.0395181990
0.3900000000  0.3333333333  0.4560000000  0.4682539683  0.4819277108  0.4698795181  0.6099397590  0.5722891566  0.4031746032  12.600000000  1.0332198346  0.0257153511  350           0.0405080938
0.4000000000  0.3571428571  0.4720000000  0.4761904762  0.5045180723  0.5000000000  0.6144578313  0.5662650602  0.4095238095  14.400000000  1.0230446255  0.0257153511  400           0.0399552727
0.4180000000  0.3809523810  0.4820000000  0.4841269841  0.5225903614  0.5240963855  0.6295180723  0.5783132530  0.4222222222  16.200000000  1.0039639056  0.0257153511  450           0.0392766047
0.4340000000  0.4126984127  0.4900000000  0.4920634921  0.5361445783  0.5301204819  0.6325301205  0.5903614458  0.4269841270  18.000000000  1.0009562659  0.0257153511  500           0.0383167887
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 21
	normlizetype: 0-1
	output_dir: train_output/133bb5e9805c3fd1efab130c90c0fc78
	save_model_every_checkpoint: False
	seed: 1292282122
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	lr: 6.91377517769638e-06
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.004281776758381881
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3220000000  0.2936507937  0.3020000000  0.3095238095  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2825396825  0.0000000000  1.1031295061  0.0167117119  0             0.3450601101
0.4300000000  0.4444444444  0.4260000000  0.4047619048  0.6084337349  0.6385542169  0.5692771084  0.5301204819  0.4634920635  1.1000000000  1.0826604843  0.0230188370  50            0.0407109165
0.4700000000  0.4682539683  0.4480000000  0.4444444444  0.7394578313  0.6566265060  0.6987951807  0.6746987952  0.4984126984  2.2000000000  1.0154014611  0.0230188370  100           0.0405278826
0.5040000000  0.4603174603  0.4580000000  0.4444444444  0.7605421687  0.7048192771  0.7259036145  0.7108433735  0.5031746032  3.3000000000  0.9840777016  0.0230188370  150           0.0400855970
0.5060000000  0.4682539683  0.4480000000  0.4365079365  0.8027108434  0.7891566265  0.7710843373  0.7710843373  0.5174603175  4.4000000000  0.9248131120  0.0230188370  200           0.0407062483
0.5080000000  0.4603174603  0.4600000000  0.4761904762  0.7876506024  0.7530120482  0.8087349398  0.8012048193  0.5253968254  5.5000000000  0.8701426744  0.0230188370  250           0.0412932968
0.5280000000  0.4603174603  0.5000000000  0.4761904762  0.7740963855  0.7469879518  0.8132530120  0.7951807229  0.5301587302  6.6000000000  0.8310962963  0.0230188370  300           0.0419494343
0.5760000000  0.5079365079  0.5180000000  0.5000000000  0.8087349398  0.8012048193  0.8162650602  0.7710843373  0.5698412698  7.7000000000  0.7972526515  0.0230188370  350           0.0409140635
0.5740000000  0.5158730159  0.5260000000  0.5000000000  0.7590361446  0.7590361446  0.8147590361  0.7771084337  0.5619047619  8.8000000000  0.7394753313  0.0230188370  400           0.0420943213
0.5700000000  0.4920634921  0.5240000000  0.4920634921  0.7530120482  0.7228915663  0.8313253012  0.8192771084  0.5603174603  9.9000000000  0.6911301202  0.0230188370  450           0.0429148674
0.6080000000  0.5476190476  0.5620000000  0.5079365079  0.8087349398  0.8132530120  0.8177710843  0.7771084337  0.6396825397  11.000000000  0.6623904151  0.0230188370  500           0.0430830240
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 24
	normlizetype: 0-1
	output_dir: train_output/10bdba2f51a4805e989b4744633bd104
	save_model_every_checkpoint: False
	seed: 42002986
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	class_balanced: False
	data_augmentation: True
	ib_lambda: 98.04652739496852
	ib_penalty_anneal_iters: 1
	irm_lambda: 17.385921430981032
	irm_penalty_anneal_iters: 719
	lr: 4.2550345485619685e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.5430730771167478e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0229608417  0.0089182276  0.3120000000  0.3174603175  0.3340000000  0.3253968254  0.3237951807  0.3433734940  0.4307228916  0.4337349398  0.3349206349  0.0000000000  1.1518198252  0.0604171753  1.1518198252  0             0.4048585892
0.0177574486  0.0020000469  0.4020000000  0.4365079365  0.3820000000  0.4523809524  0.2635542169  0.2108433735  0.3825301205  0.3493975904  0.3888888889  3.6000000000  2.8621384048  0.0665984154  2.8621384048  50            0.0187220240
0.0096457482  0.0002568145  0.3560000000  0.3333333333  0.3220000000  0.3730158730  0.4006024096  0.3975903614  0.3343373494  0.3132530120  0.3428571429  7.2000000000  2.0510528517  0.0665984154  2.0510528517  100           0.0220668411
0.0054623831  0.0001397127  0.3500000000  0.3015873016  0.3160000000  0.3412698413  0.3960843373  0.4036144578  0.3298192771  0.3313253012  0.3301587302  10.800000000  1.6395803022  0.0665984154  1.6395803022  150           0.0180351067
0.0032025363  0.0000233956  0.3500000000  0.3492063492  0.3360000000  0.3650793651  0.3644578313  0.3975903614  0.3433734940  0.3734939759  0.3698412698  14.400000000  1.4163960719  0.0665984154  1.4163960719  200           0.0187693214
0.0021147115  0.0000988138  0.3600000000  0.3650793651  0.3460000000  0.3333333333  0.3509036145  0.3433734940  0.3373493976  0.3493975904  0.3793650794  18.000000000  1.3107331657  0.0665984154  1.3107331657  250           0.0176462507
0.0015094086  0.0000584242  0.3400000000  0.3650793651  0.3400000000  0.3412698413  0.3463855422  0.3132530120  0.3554216867  0.3614457831  0.4063492063  21.600000000  1.2500479341  0.0665984154  1.2500479341  300           0.0175256252
0.0010356227  0.0000144605  0.3140000000  0.3809523810  0.3480000000  0.3968253968  0.3222891566  0.3012048193  0.4563253012  0.4277108434  0.3920634921  25.200000000  1.2019739366  0.0665984154  1.2019739366  350           0.0190285301
0.0006285555  -0.000005683  0.3400000000  0.3492063492  0.3300000000  0.3650793651  0.3403614458  0.3373493976  0.4352409639  0.4397590361  0.3539682540  28.800000000  1.1592270279  0.0665984154  1.1592270279  400           0.0196150017
0.0003928308  -0.000000434  0.3320000000  0.3412698413  0.3280000000  0.3650793651  0.3328313253  0.3313253012  0.4367469880  0.4457831325  0.3507936508  32.400000000  1.1369524717  0.0665984154  1.1369524717  450           0.0185612869
0.0002878660  -0.000003003  0.3360000000  0.3333333333  0.3340000000  0.3571428571  0.3328313253  0.3313253012  0.4367469880  0.4457831325  0.3460317460  36.000000000  1.1263944197  0.0665984154  1.1263944197  500           0.0211733150
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 29
	normlizetype: 0-1
	output_dir: train_output/32b42a299503277ef1f9bd8291971864
	save_model_every_checkpoint: False
	seed: 56735490
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 30
	class_balanced: False
	data_augmentation: True
	lr: 0.00026287121638468136
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.005149224998029627
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3660000000  0.3492063492  0.3620000000  0.3412698413  0.3418674699  0.3313253012  0.3358433735  0.3313253012  0.3952380952  0.0000000000  1.0071789026  0.0240306854  0             0.3569607735
0.4880000000  0.4603174603  0.4580000000  0.4365079365  0.7183734940  0.7289156627  0.8102409639  0.8072289157  0.5174603175  3.0000000000  0.8730544412  0.0303378105  50            0.0423599339
0.5580000000  0.5238095238  0.6060000000  0.5079365079  0.7771084337  0.8192771084  0.8087349398  0.7650602410  0.6777777778  6.0000000000  0.6690234214  0.0303378105  100           0.0421317482
0.6120000000  0.5476190476  0.6300000000  0.5396825397  0.8388554217  0.8614457831  0.7921686747  0.7590361446  0.6920634921  9.0000000000  0.5140673077  0.0303378105  150           0.0433875561
0.6540000000  0.5714285714  0.6800000000  0.5634920635  0.8509036145  0.8855421687  0.8599397590  0.8373493976  0.6984126984  12.000000000  0.4364861792  0.0303378105  200           0.0413653135
0.7080000000  0.6031746032  0.7040000000  0.5873015873  0.8539156627  0.8855421687  0.9548192771  0.9277108434  0.7095238095  15.000000000  0.3415695357  0.0303378105  250           0.0398301315
0.7460000000  0.5952380952  0.7280000000  0.6190476190  0.8644578313  0.8915662651  0.9698795181  0.9277108434  0.6984126984  18.000000000  0.3033971301  0.0303378105  300           0.0395745468
0.8140000000  0.6587301587  0.7780000000  0.6349206349  0.8734939759  0.8915662651  0.9759036145  0.9397590361  0.6793650794  21.000000000  0.2727575409  0.0303378105  350           0.0383603239
0.8420000000  0.7222222222  0.8140000000  0.6587301587  0.8810240964  0.8855421687  0.9774096386  0.9457831325  0.6809523810  24.000000000  0.2279326479  0.0303378105  400           0.0376686859
0.8420000000  0.6666666667  0.8320000000  0.6825396825  0.8855421687  0.8915662651  0.9864457831  0.9457831325  0.6888888889  27.000000000  0.1928257951  0.0303378105  450           0.0388616896
0.8600000000  0.7063492063  0.8520000000  0.6984126984  0.8780120482  0.8855421687  0.9864457831  0.9457831325  0.6968253968  30.000000000  0.1720758477  0.0303378105  500           0.0384272480
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 43
	normlizetype: 0-1
	output_dir: train_output/eeda5a9afa4858e544c8b89d6dc85051
	save_model_every_checkpoint: False
	seed: 85534836
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	class_balanced: False
	data_augmentation: True
	ib_lambda: 84.60824949151358
	ib_penalty_anneal_iters: 70
	irm_lambda: 26794.595373962893
	irm_penalty_anneal_iters: 6
	lr: 1.0731991123556439e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 6.356201338925228e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0231826901  0.0009200231  0.2980000000  0.2936507937  0.3460000000  0.3809523810  0.2289156627  0.2650602410  0.2138554217  0.1807228916  0.2936507937  0.0000000000  1.1105538607  0.0557985306  1.1105538607  0             0.3463907242
0.0227008208  0.0002735273  0.3940000000  0.4206349206  0.4160000000  0.3809523810  0.5135542169  0.4879518072  0.4713855422  0.5120481928  0.3968253968  3.3000000000  4.0650812447  0.0621170998  4.0650812447  50            0.0185850668
0.0224035314  0.0000730135  0.4140000000  0.4365079365  0.4500000000  0.4126984127  0.5391566265  0.5180722892  0.5120481928  0.5301204819  0.4126984127  6.6000000000  4.2123714328  0.0621170998  4.2123714328  100           0.0190164661
0.0221230902  -0.000004993  0.4180000000  0.4206349206  0.4200000000  0.3730158730  0.5421686747  0.5180722892  0.5015060241  0.5602409639  0.3952380952  9.9000000000  2.8170067620  0.0621170998  2.8170067620  150           0.0175599766
0.0217092019  -0.000075858  0.4300000000  0.4523809524  0.4220000000  0.4206349206  0.5286144578  0.5240963855  0.4472891566  0.5000000000  0.4190476190  13.200000000  0.8832056308  0.0621170998  0.8832056308  200           0.0186301804
0.0221347324  -0.000331307  0.4260000000  0.4761904762  0.4300000000  0.3730158730  0.4713855422  0.4156626506  0.5060240964  0.5060240964  0.3714285714  16.500000000  -5.922457487  0.0621170998  -5.922457487  250           0.0185449839
0.0218997737  0.0001683305  0.3860000000  0.3809523810  0.3780000000  0.3571428571  0.4442771084  0.4518072289  0.3719879518  0.3674698795  0.3746031746  19.800000000  7.4404951763  0.0621170998  7.4404951763  300           0.0187859678
0.0215634966  0.0005426138  0.3880000000  0.4285714286  0.3760000000  0.3730158730  0.4352409639  0.4277108434  0.3960843373  0.3554216867  0.4349206349  23.100000000  17.438927626  0.0621170998  17.438927626  350           0.0181270933
0.0213353737  0.0001141226  0.3740000000  0.4047619048  0.3640000000  0.3571428571  0.4081325301  0.4036144578  0.3960843373  0.3554216867  0.4158730159  26.400000000  5.9435413384  0.0621170998  5.9435413384  400           0.0187375021
0.0212312358  0.0000439109  0.3800000000  0.4285714286  0.3620000000  0.3730158730  0.3870481928  0.3915662651  0.4066265060  0.3734939759  0.4634920635  29.700000000  4.0489928222  0.0621170998  4.0489928222  450           0.0185257673
0.0209743821  0.0002434168  0.4240000000  0.4761904762  0.3980000000  0.3968253968  0.3885542169  0.4216867470  0.4141566265  0.3915662651  0.4904761905  33.000000000  9.3762676501  0.0621170998  9.3762676501  500           0.0191391373
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output/43dffe179c43eac58489513c6c4bf0bb
	save_model_every_checkpoint: False
	seed: 2100829187
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	class_balanced: False
	data_augmentation: True
	lr: 0.00018486359452623148
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.812885384798702e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3760000000  0.3571428571  0.3520000000  0.3492063492  0.2469879518  0.2650602410  0.2846385542  0.2469879518  0.3396825397  0.0000000000  1.0093383789  0.0228753090  0             0.3476665020
0.8140000000  0.7222222222  0.7200000000  0.6190476190  0.8358433735  0.8493975904  0.7891566265  0.7349397590  0.6460317460  2.7000000000  0.5654805920  0.0291824341  50            0.0406193399
0.8800000000  0.7777777778  0.8160000000  0.7063492063  0.8990963855  0.8855421687  0.9834337349  0.9698795181  0.6619047619  5.4000000000  0.2105044331  0.0291824341  100           0.0415719604
0.9260000000  0.8253968254  0.8960000000  0.7698412698  0.9277108434  0.8915662651  0.9819277108  0.9759036145  0.6253968254  8.1000000000  0.0995326904  0.0291824341  150           0.0412219143
0.9680000000  0.8968253968  0.9560000000  0.8650793651  0.9352409639  0.8975903614  0.9909638554  0.9759036145  0.5682539683  10.800000000  0.0725377031  0.0291824341  200           0.0400612545
0.9880000000  0.9206349206  0.9720000000  0.8888888889  0.9442771084  0.8855421687  0.9879518072  0.9638554217  0.5841269841  13.500000000  0.0602864594  0.0291824341  250           0.0433562374
0.9700000000  0.8968253968  0.9520000000  0.8968253968  0.9759036145  0.9277108434  0.9969879518  0.9879518072  0.6000000000  16.200000000  0.0300081017  0.0291824341  300           0.0424493313
0.9880000000  0.9285714286  0.9720000000  0.9444444444  0.9653614458  0.9337349398  0.9984939759  0.9939759036  0.5904761905  18.900000000  0.0405133291  0.0291824341  350           0.0441888571
0.9880000000  0.9285714286  0.9800000000  0.9126984127  0.9954819277  0.9578313253  1.0000000000  1.0000000000  0.5746031746  21.600000000  0.0238417719  0.0291824341  400           0.0409642696
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.9141566265  0.8614457831  0.9759036145  0.9638554217  0.4492063492  24.300000000  0.0208951472  0.0291824341  450           0.0477066040
0.9980000000  0.9603174603  0.9940000000  0.9365079365  0.9924698795  0.9578313253  1.0000000000  1.0000000000  0.5523809524  27.000000000  0.0194388179  0.0291824341  500           0.0418169737
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 4
	normlizetype: 0-1
	output_dir: train_output/7091c8e5f460d1a59f75c794491a8215
	save_model_every_checkpoint: False
	seed: 494741888
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	class_balanced: False
	data_augmentation: True
	lr: 1.4524944240203903e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 6.326696718610415e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3180000000  0.3174603175  0.3160000000  0.3253968254  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2873015873  0.0000000000  1.2456704378  0.0194082260  0             0.3634042740
0.3620000000  0.4047619048  0.3860000000  0.4126984127  0.3388554217  0.3554216867  0.2515060241  0.2469879518  0.3634920635  1.8000000000  1.1519571066  0.0257153511  50            0.0406154299
0.3760000000  0.4206349206  0.3960000000  0.4523809524  0.4171686747  0.4638554217  0.3960843373  0.3433734940  0.4428571429  3.6000000000  1.1112259746  0.0257153511  100           0.0403748751
0.3860000000  0.4365079365  0.4260000000  0.4523809524  0.4789156627  0.4939759036  0.5240963855  0.5060240964  0.4476190476  5.4000000000  1.0806514430  0.0257153511  150           0.0403406096
0.3880000000  0.4603174603  0.4340000000  0.4523809524  0.4954819277  0.4879518072  0.5978915663  0.5722891566  0.4682539683  7.2000000000  1.0750579524  0.0257153511  200           0.0386006594
0.4180000000  0.4523809524  0.4560000000  0.4761904762  0.5045180723  0.5000000000  0.6370481928  0.5963855422  0.4714285714  9.0000000000  1.0565569949  0.0257153511  250           0.0387956047
0.4120000000  0.4920634921  0.4880000000  0.4920634921  0.5045180723  0.5120481928  0.6596385542  0.6024096386  0.4746031746  10.800000000  1.0419072461  0.0257153511  300           0.0387835217
0.4260000000  0.4920634921  0.5000000000  0.5158730159  0.5421686747  0.5301204819  0.6656626506  0.6265060241  0.4746031746  12.600000000  1.0317229593  0.0257153511  350           0.0408762550
0.4260000000  0.4920634921  0.5120000000  0.5317460317  0.5602409639  0.5301204819  0.6867469880  0.6265060241  0.4873015873  14.400000000  1.0245407355  0.0257153511  400           0.0377543020
0.4360000000  0.4920634921  0.5020000000  0.4920634921  0.5858433735  0.5481927711  0.6942771084  0.6566265060  0.4984126984  16.200000000  1.0141836035  0.0257153511  450           0.0392333984
0.4440000000  0.4841269841  0.5020000000  0.5079365079  0.6054216867  0.5542168675  0.7078313253  0.6626506024  0.5047619048  18.000000000  1.0043124306  0.0257153511  500           0.0388029051
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 2
	normlizetype: 0-1
	output_dir: train_output/3649b22e002ccf1e1327d8715ac1e0d4
	save_model_every_checkpoint: False
	seed: 1601812359
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 25
	class_balanced: False
	data_augmentation: True
	ib_lambda: 92801.8202459409
	ib_penalty_anneal_iters: 69
	irm_lambda: 15.27125896858225
	irm_penalty_anneal_iters: 1
	lr: 3.207929136369226e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.005100223533962902
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0299383365  0.0058164820  0.2440000000  0.3095238095  0.2780000000  0.2777777778  0.2590361446  0.3012048193  0.2319277108  0.2289156627  0.2746031746  0.0000000000  1.1401114464  0.0438771248  1.1401114464  0             0.3160631657
0.0301556012  0.0005644766  0.5000000000  0.4523809524  0.5560000000  0.5952380952  0.4894578313  0.4879518072  0.5015060241  0.5120481928  0.5650793651  2.5000000000  1.0550278580  0.0485568047  1.0550278580  50            0.0183974218
0.0211912303  0.0005397724  0.3560000000  0.3650793651  0.3740000000  0.3412698413  0.3569277108  0.3674698795  0.4593373494  0.4759036145  0.3253968254  5.0000000000  819.35395704  0.0485568047  819.35395704  100           0.0183115101
0.0014122368  0.0000106937  0.3280000000  0.3253968254  0.3400000000  0.3253968254  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3492063492  7.5000000000  132.15100540  0.0485568047  132.15100540  150           0.0178375101
0.0001735844  0.0000021131  0.3280000000  0.3253968254  0.3340000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  10.000000000  17.206787691  0.0485568047  17.206787691  200           0.0161593390
0.0000434788  0.0000003401  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  12.500000000  5.1331126022  0.0485568047  5.1331126022  250           0.0194029617
0.0000257023  -0.000000004  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  15.000000000  3.4834431458  0.0485568047  3.4834431458  300           0.0196403456
0.0000158440  0.0000004570  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  17.500000000  2.5689180636  0.0485568047  2.5689180636  350           0.0178609324
0.0000108315  -0.000000168  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  20.000000000  2.1036100674  0.0485568047  2.1036100674  400           0.0180881643
0.0000072068  0.0000000501  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  22.500000000  1.7671491718  0.0485568047  1.7671491718  450           0.0180391312
0.0000060020  0.0000000301  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  25.000000000  1.6554700565  0.0485568047  1.6554700565  500           0.0180530691
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 46
	normlizetype: 0-1
	output_dir: train_output/66ac1fe6ef11b7512ede0fa99e58ef44
	save_model_every_checkpoint: False
	seed: 703771635
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	ib_lambda: 945.503795189531
	ib_penalty_anneal_iters: 2340
	irm_lambda: 48403.155612390074
	irm_penalty_anneal_iters: 1
	lr: 5.819263934682494e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 9.005702063600195e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0274071470  0.0064162943  0.2620000000  0.3095238095  0.2980000000  0.2936507937  0.3343373494  0.3132530120  0.2921686747  0.3132530120  0.2253968254  0.0000000000  1.1753970385  0.0272607803  1.1753970385  0             0.3774538040
0.0273947709  0.0007183515  0.3340000000  0.3888888889  0.3640000000  0.3730158730  0.4713855422  0.4638554217  0.3463855422  0.3012048193  0.3206349206  1.5000000000  35.876182079  0.0332741737  35.876182079  50            0.0176645231
0.0266889066  0.0004836188  0.3860000000  0.3809523810  0.4140000000  0.4365079365  0.4894578313  0.4759036145  0.3780120482  0.3554216867  0.3746031746  3.0000000000  24.511433429  0.0332741737  24.511433429  100           0.0171890259
0.0266203820  -0.000342119  0.3900000000  0.4206349206  0.4120000000  0.4444444444  0.5466867470  0.4879518072  0.4367469880  0.3855421687  0.4015873016  4.5000000000  -15.47313714  0.0332741737  -15.47313714  150           0.0181247997
0.0262121328  0.0001388338  0.4200000000  0.4285714286  0.4340000000  0.4682539683  0.5496987952  0.5120481928  0.4457831325  0.4216867470  0.3984126984  6.0000000000  7.8064313126  0.0332741737  7.8064313126  200           0.0178280210
0.0260112851  0.0003475874  0.4300000000  0.4444444444  0.4440000000  0.4603174603  0.5692771084  0.5180722892  0.4503012048  0.4397590361  0.4142857143  7.5000000000  17.911493234  0.0332741737  17.911493234  250           0.0171124554
0.0258450614  -0.000065046  0.4280000000  0.4603174603  0.4600000000  0.4841269841  0.5783132530  0.5421686747  0.4623493976  0.4759036145  0.4396825397  9.0000000000  -2.061250815  0.0332741737  -2.061250815  300           0.0183837986
0.0256915054  0.0000209471  0.4460000000  0.4603174603  0.4640000000  0.5079365079  0.5753012048  0.5421686747  0.4337349398  0.4457831325  0.4222222222  10.500000000  2.0970505619  0.0332741737  2.0970505619  350           0.0184279966
0.0257651849  -0.000328448  0.4660000000  0.4444444444  0.4540000000  0.4920634921  0.5692771084  0.5421686747  0.4231927711  0.4397590361  0.4190476190  12.000000000  -14.81704316  0.0332741737  -14.81704316  400           0.0186016369
0.0259912451  0.0002541660  0.4460000000  0.4285714286  0.4580000000  0.4841269841  0.5647590361  0.5722891566  0.4412650602  0.4397590361  0.4111111111  13.500000000  13.389218463  0.0332741737  13.389218463  450           0.0185546017
0.0256743037  0.0000085668  0.4420000000  0.4365079365  0.4600000000  0.4682539683  0.5572289157  0.5662650602  0.4337349398  0.4578313253  0.4000000000  15.000000000  1.4984694970  0.0332741737  1.4984694970  500           0.0165954447
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 31
	normlizetype: 0-1
	output_dir: train_output/75c9065f46c980261649b8fa34e5ae69
	save_model_every_checkpoint: False
	seed: 1559317621
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.1229974340507805
	gda: True
	lr: 0.00010792585688755117
	lr_d: 5.0526552815100354e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.05757451100933628
	weight_decay: 0.001082552882210441
	weight_decay_d: 0.009939728433808335
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3333333333  0.0000000000  0.0064624902  1.1562924385  0.0650110245  0             0.4746241570
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  3.9000000000  0.0090830091  1.1962316394  0.0656800270  50            0.0354879808
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  7.8000000000  0.0076867475  1.1958184171  0.0656800270  100           0.0340162802
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2304216867  0.2349397590  0.3269841270  11.700000000  0.0079438075  1.1845673966  0.0656800270  150           0.0355908632
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  15.600000000  0.0087993472  1.1934524846  0.0656800270  200           0.0346878767
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2304216867  0.2349397590  0.3269841270  19.500000000  0.0088778814  1.1966726422  0.0656800270  250           0.0335983562
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  23.400000000  0.0085262323  1.1961900949  0.0656800270  300           0.0356125641
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3253968254  27.300000000  0.0083037680  1.1940957570  0.0656800270  350           0.0357398605
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2304216867  0.2349397590  0.3269841270  31.200000000  0.0093295741  1.2014681077  0.0656800270  400           0.0345758867
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  35.100000000  0.0092515847  1.1932538271  0.0656800270  450           0.0351705790
0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.2274096386  0.2349397590  0.3269841270  39.000000000  0.0089459954  1.1892895889  0.0656800270  500           0.0345505238
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output/32405d8404903fc03aa8f766cc8e931c
	save_model_every_checkpoint: False
	seed: 931336771
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	class_balanced: False
	data_augmentation: True
	ib_lambda: 50653.72008636415
	ib_penalty_anneal_iters: 2
	irm_lambda: 541.2240750182476
	irm_penalty_anneal_iters: 41
	lr: 0.00018486359452623148
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.812885384798702e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0257456750  0.0711810738  0.3840000000  0.3650793651  0.3980000000  0.4206349206  0.3463855422  0.3614457831  0.4653614458  0.4638554217  0.4000000000  0.0000000000  1.3120187521  0.0460729599  1.3120187521  0             0.3207106590
0.0013446486  0.0000494854  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  2.7000000000  46.668440022  0.0525350571  46.668440022  50            0.0183836985
0.0000000053  0.0000001829  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  5.4000000000  1.0988248563  0.0525350571  1.0988248563  100           0.0174929953
0.0000000067  0.0000002039  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  8.1000000000  1.0988939714  0.0525350571  1.0988939714  150           0.0178336334
0.0000000000  0.0000000984  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  10.800000000  1.0985176086  0.0525350571  1.0985176086  200           0.0182295609
0.0000000000  -0.000000024  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  13.500000000  1.0984549546  0.0525350571  1.0984549546  250           0.0177355146
0.0000000000  0.0000002576  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  16.200000000  1.0985338020  0.0525350571  1.0985338020  300           0.0179515219
0.0000000000  0.0000002156  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  18.900000000  1.0984062123  0.0525350571  1.0984062123  350           0.0181103325
0.0000000001  0.0000005013  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  21.600000000  1.0986718512  0.0525350571  1.0986718512  400           0.0201557398
0.0000000002  0.0000001671  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  24.300000000  1.0985136771  0.0525350571  1.0985136771  450           0.0178864336
0.0000000000  0.0000001473  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  27.000000000  1.0984020400  0.0525350571  1.0984020400  500           0.0170549154
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 16
	normlizetype: 0-1
	output_dir: train_output/9577e8afd602bb216d4e8f011d96ff08
	save_model_every_checkpoint: False
	seed: 986930462
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0001342232359864321
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.1975155295174919e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3760000000  0.3492063492  0.3260000000  0.3492063492  0.3177710843  0.3192771084  0.4111445783  0.4156626506  0.3793650794  0.0000000000  1.0547447205  0.0247988701  0             0.3379371166
0.4780000000  0.4126984127  0.4300000000  0.4444444444  0.7138554217  0.6626506024  0.7409638554  0.6867469880  0.5634920635  3.2000000000  0.9958577371  0.0311059952  50            0.0382471132
0.5200000000  0.4603174603  0.4900000000  0.4920634921  0.8147590361  0.8132530120  0.8358433735  0.8012048193  0.6222222222  6.4000000000  0.8505258203  0.0311059952  100           0.0415932655
0.5720000000  0.5158730159  0.5280000000  0.4603174603  0.8554216867  0.8554216867  0.8644578313  0.8192771084  0.6507936508  9.6000000000  0.7244185293  0.0311059952  150           0.0412242079
0.5920000000  0.5396825397  0.5580000000  0.5158730159  0.8750000000  0.8734939759  0.8644578313  0.8313253012  0.7111111111  12.800000000  0.6198542148  0.0311059952  200           0.0425637245
0.6140000000  0.5634920635  0.5940000000  0.5555555556  0.8780120482  0.8734939759  0.8569277108  0.8253012048  0.7206349206  16.000000000  0.5615942574  0.0311059952  250           0.0421268845
0.6580000000  0.5952380952  0.6340000000  0.5873015873  0.8810240964  0.8855421687  0.8584337349  0.8313253012  0.7301587302  19.200000000  0.5167058867  0.0311059952  300           0.0433140039
0.6940000000  0.6031746032  0.6840000000  0.6269841270  0.8810240964  0.8855421687  0.8629518072  0.8132530120  0.7396825397  22.400000000  0.4707054698  0.0311059952  350           0.0400990582
0.7000000000  0.6111111111  0.7200000000  0.6428571429  0.8810240964  0.8855421687  0.8734939759  0.8192771084  0.7238095238  25.600000000  0.4255068511  0.0311059952  400           0.0390765142
0.7600000000  0.6666666667  0.7440000000  0.6666666667  0.8810240964  0.8855421687  0.8674698795  0.8313253012  0.7349206349  28.800000000  0.3900343561  0.0311059952  450           0.0426630306
0.7800000000  0.6666666667  0.7720000000  0.6825396825  0.8780120482  0.8855421687  0.8915662651  0.8433734940  0.7142857143  32.000000000  0.3501913887  0.0311059952  500           0.0414123392
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output/0c1b856b63e052b7dfdfd5356c255d55
	save_model_every_checkpoint: False
	seed: 1217640629
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3460000000  0.3412698413  0.3320000000  0.3571428571  0.3388554217  0.3433734940  0.5316265060  0.5602409639  0.3920634921  0.0000000000  0.5956966877  1.1155616045  0.0539793968  0             0.4375696182
0.6100000000  0.5476190476  0.6440000000  0.6111111111  0.6912650602  0.6807228916  0.7680722892  0.7469879518  0.6380952381  3.2000000000  0.1911622435  0.9887432170  0.0604138374  50            0.1443745804
0.6300000000  0.6269841270  0.5640000000  0.5079365079  0.6551204819  0.6566265060  0.9548192771  0.9638554217  0.6555555556  6.4000000000  0.2301713383  0.8195065200  0.0604138374  100           0.1488429213
0.7080000000  0.7063492063  0.6480000000  0.6746031746  0.7424698795  0.7289156627  0.8057228916  0.8373493976  0.6428571429  9.6000000000  0.2349315292  0.6526862943  0.0604138374  150           0.1546713591
0.8000000000  0.7698412698  0.6700000000  0.6904761905  0.6882530120  0.6807228916  0.7996987952  0.8132530120  0.7793650794  12.800000000  0.2502890703  0.5672237390  0.0604138374  200           0.1530157852
0.7420000000  0.6904761905  0.6320000000  0.6746031746  0.8945783133  0.8915662651  0.8885542169  0.9036144578  0.8158730159  16.000000000  0.2311532339  0.5342369950  0.0604138374  250           0.1518258142
0.7720000000  0.7380952381  0.7160000000  0.7142857143  0.8960843373  0.8975903614  0.8012048193  0.7951807229  0.6428571429  19.200000000  0.1983832785  0.5272901982  0.0604138374  300           0.1503783417
0.6960000000  0.6904761905  0.6940000000  0.6904761905  0.8975903614  0.8915662651  0.8825301205  0.8795180723  0.6301587302  22.400000000  0.2345690078  0.4891341126  0.0604138374  350           0.1596595097
0.8100000000  0.7857142857  0.8160000000  0.7698412698  0.8990963855  0.8614457831  0.9819277108  0.9638554217  0.6984126984  25.600000000  0.2199842331  0.4836540043  0.0604138374  400           0.1513437462
0.7760000000  0.7698412698  0.7920000000  0.7460317460  0.8599397590  0.8373493976  0.8147590361  0.8012048193  0.4111111111  28.800000000  0.2187957937  0.4531918615  0.0604138374  450           0.1487447214
0.8160000000  0.7777777778  0.7320000000  0.6507936508  0.9864457831  0.9698795181  0.8765060241  0.8313253012  0.9031746032  32.000000000  0.2205846033  0.4434222656  0.0604138374  500           0.1455210733
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 21
	normlizetype: 0-1
	output_dir: train_output/df0ad2aca3970f338af91ce1b1f5ea0c
	save_model_every_checkpoint: False
	seed: 279477938
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2.40453979989861
	gda: True
	lr: 6.91377517769638e-06
	lr_d: 0.0013429610903954888
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.012987906371377351
	weight_decay: 0.004281776758381881
	weight_decay_d: 1.1671746178406461e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3520000000  0.3888888889  0.3640000000  0.3333333333  0.2500000000  0.2409638554  0.3268072289  0.2831325301  0.3619047619  0.0000000000  0.0027184947  1.1486678123  0.0210790634  0             0.4493141174
0.3700000000  0.3968253968  0.3640000000  0.3333333333  0.2484939759  0.2469879518  0.3463855422  0.3132530120  0.3666666667  1.1000000000  0.0025113614  1.1386004138  0.0236740112  50            0.0836158991
0.3720000000  0.4126984127  0.3640000000  0.3333333333  0.2515060241  0.2469879518  0.3433734940  0.3253012048  0.3634920635  2.2000000000  0.0027136279  1.1549084330  0.0236740112  100           0.0849914694
0.3660000000  0.3968253968  0.3680000000  0.3333333333  0.2484939759  0.2469879518  0.3478915663  0.3313253012  0.3650793651  3.3000000000  0.0026372099  1.1427747703  0.0236740112  150           0.0850222731
0.3740000000  0.3968253968  0.3580000000  0.3412698413  0.2530120482  0.2530120482  0.3463855422  0.3373493976  0.3619047619  4.4000000000  0.0030652470  1.1512305188  0.0236740112  200           0.0897312260
0.3640000000  0.3968253968  0.3660000000  0.3333333333  0.2605421687  0.2590361446  0.3448795181  0.3433734940  0.3619047619  5.5000000000  0.0028805350  1.1362855196  0.0236740112  250           0.0887329102
0.3740000000  0.4047619048  0.3640000000  0.3412698413  0.2620481928  0.2530120482  0.3463855422  0.3253012048  0.3682539683  6.6000000000  0.0025879676  1.1444413614  0.0236740112  300           0.0889440250
0.3720000000  0.4047619048  0.3620000000  0.3333333333  0.2515060241  0.2469879518  0.3509036145  0.3192771084  0.3666666667  7.7000000000  0.0026910243  1.1677775168  0.0236740112  350           0.0986169767
0.3760000000  0.4126984127  0.3660000000  0.3492063492  0.2620481928  0.2530120482  0.3493975904  0.3253012048  0.3682539683  8.8000000000  0.0027629730  1.1423907256  0.0236740112  400           0.1034703255
0.3740000000  0.4047619048  0.3660000000  0.3492063492  0.2545180723  0.2469879518  0.3448795181  0.3433734940  0.3682539683  9.9000000000  0.0027309073  1.1567737412  0.0236740112  450           0.0871097755
0.3720000000  0.4047619048  0.3700000000  0.3412698413  0.2605421687  0.2590361446  0.3448795181  0.3313253012  0.3666666667  11.000000000  0.0028240612  1.1650044370  0.0236740112  500           0.0860729599
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 30
	normlizetype: 0-1
	output_dir: train_output/281ab686798c9e793a7b45e91089f56a
	save_model_every_checkpoint: False
	seed: 1403327303
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	class_balanced: False
	data_augmentation: True
	ib_lambda: 14372.611054428095
	ib_penalty_anneal_iters: 199
	irm_lambda: 536.9527252594155
	irm_penalty_anneal_iters: 27
	lr: 1.5000005301577322e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.0042201907446770565
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0315693617  0.0043838178  0.3340000000  0.3492063492  0.3440000000  0.3809523810  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.2904761905  0.0000000000  1.1496407986  0.0262093544  1.1496407986  0             0.4140086174
0.0326050351  0.0002557933  0.3860000000  0.3968253968  0.3680000000  0.3730158730  0.3870481928  0.3915662651  0.4171686747  0.4277108434  0.3714285714  1.4000000000  1.1101960647  0.0322380066  1.1101960647  50            0.0194199038
0.0325317542  0.0009067798  0.4840000000  0.4761904762  0.5000000000  0.5158730159  0.5150602410  0.5060240964  0.5120481928  0.5542168675  0.4428571429  2.8000000000  1.5565756249  0.0322380066  1.5565756249  100           0.0180930948
0.0319274002  0.0005890798  0.4860000000  0.4682539683  0.5220000000  0.5238095238  0.5376506024  0.5000000000  0.4337349398  0.4819277108  0.4571428571  4.2000000000  1.3823452020  0.0322380066  1.3823452020  150           0.0190944004
0.0317182196  0.0005328347  0.4960000000  0.4682539683  0.4600000000  0.5000000000  0.4849397590  0.4698795181  0.4006024096  0.3975903614  0.4317460317  5.6000000000  19.941051678  0.0322380066  19.941051678  200           0.0182440615
0.0157175498  -0.000097983  0.4300000000  0.4126984127  0.3880000000  0.3888888889  0.3493975904  0.3493975904  0.3373493976  0.3253012048  0.3650793651  7.0000000000  226.93426162  0.0322380066  226.93426162  250           0.0192486382
0.0043788727  -0.000056045  0.3720000000  0.3333333333  0.3400000000  0.3253968254  0.3328313253  0.3313253012  0.3358433735  0.3313253012  0.3682539683  8.4000000000  63.998264160  0.0322380066  63.998264160  300           0.0170039129
0.0018853050  -0.000004420  0.3400000000  0.3412698413  0.3380000000  0.3412698413  0.3328313253  0.3313253012  0.3388554217  0.3313253012  0.3619047619  9.8000000000  28.190645103  0.0322380066  28.190645103  350           0.0175026226
0.0009196060  -0.000031130  0.3400000000  0.3412698413  0.3340000000  0.3492063492  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3412698413  11.200000000  14.299077205  0.0322380066  14.299077205  400           0.0175578308
0.0006310963  -0.000003473  0.3440000000  0.3412698413  0.3340000000  0.3412698413  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3412698413  12.600000000  10.167891235  0.0322380066  10.167891235  450           0.0200628614
0.0004478800  0.0000019720  0.3400000000  0.3412698413  0.3320000000  0.3412698413  0.3298192771  0.3313253012  0.3328313253  0.3313253012  0.3396825397  14.000000000  7.5373621178  0.0322380066  7.5373621178  500           0.0183179045
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 34
	normlizetype: 0-1
	output_dir: train_output/bc24292e6c65ee9a13a8e8b7fed01f44
	save_model_every_checkpoint: False
	seed: 1074461966
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 23
	class_balanced: False
	data_augmentation: True
	lr: 4.1745474684167584e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 4.737369176421509e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.2460000000  0.2698412698  0.2840000000  0.2539682540  0.2936746988  0.2349397590  0.3162650602  0.3493975904  0.2365079365  0.0000000000  1.2132915258  0.0213341713  0             0.4307281971
0.3940000000  0.4206349206  0.3660000000  0.3888888889  0.6581325301  0.6445783133  0.5271084337  0.5662650602  0.4349206349  2.3000000000  1.0795903707  0.0276412964  50            0.0407772493
0.5000000000  0.5000000000  0.4980000000  0.4444444444  0.7213855422  0.7168674699  0.6972891566  0.7048192771  0.5682539683  4.6000000000  1.0318391407  0.0276412964  100           0.0403892374
0.5540000000  0.5317460317  0.5500000000  0.4682539683  0.7650602410  0.8192771084  0.6852409639  0.6807228916  0.6333333333  6.9000000000  0.9777073133  0.0276412964  150           0.0406559896
0.5440000000  0.5476190476  0.5700000000  0.5158730159  0.7816265060  0.8253012048  0.6807228916  0.6746987952  0.6507936508  9.2000000000  0.9439375687  0.0276412964  200           0.0405206823
0.5500000000  0.5476190476  0.5680000000  0.5079365079  0.7951807229  0.8433734940  0.6987951807  0.6867469880  0.6476190476  11.500000000  0.9080798399  0.0276412964  250           0.0404005957
0.5360000000  0.5634920635  0.5500000000  0.4920634921  0.8117469880  0.8734939759  0.7454819277  0.7650602410  0.6476190476  13.800000000  0.8672344017  0.0276412964  300           0.0408536291
0.5540000000  0.5714285714  0.5560000000  0.4841269841  0.8253012048  0.8795180723  0.7484939759  0.7650602410  0.6634920635  16.100000000  0.8338030016  0.0276412964  350           0.0406004143
0.5740000000  0.5873015873  0.5660000000  0.4920634921  0.8509036145  0.8975903614  0.7530120482  0.7590361446  0.6888888889  18.400000000  0.7809968972  0.0276412964  400           0.0407061195
0.5760000000  0.5793650794  0.5740000000  0.5000000000  0.8448795181  0.8975903614  0.7545180723  0.7650602410  0.7079365079  20.700000000  0.7483139694  0.0276412964  450           0.0393007851
0.5820000000  0.5873015873  0.5920000000  0.5079365079  0.8629518072  0.8975903614  0.7590361446  0.7710843373  0.7428571429  23.000000000  0.7300786197  0.0276412964  500           0.0399803162
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 41
	normlizetype: 0-1
	output_dir: train_output/ab48630593e56b1b25f4d8185f358b76
	save_model_every_checkpoint: False
	seed: 147678384
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.295556244138854
	gda: True
	lr: 2.848538320538549e-05
	lr_d: 4.219718344769841e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.3059911979208366
	weight_decay: 0.0005889003795888928
	weight_decay_d: 8.223205239792253e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3360000000  0.3412698413  0.3280000000  0.3253968254  0.3313253012  0.3253012048  0.4698795181  0.4819277108  0.3793650794  0.0000000000  0.0484958701  1.1529231071  0.0708212852  0             0.3523051739
0.3360000000  0.4047619048  0.3200000000  0.3015873016  0.3433734940  0.3373493976  0.4472891566  0.4638554217  0.3809523810  4.3000000000  0.0261031960  1.1263199091  0.0722379684  50            0.0376969862
0.3360000000  0.4126984127  0.3200000000  0.3015873016  0.3418674699  0.3313253012  0.4442771084  0.4638554217  0.3809523810  8.6000000000  0.0299652755  1.1283844113  0.0722379684  100           0.0374742889
0.3360000000  0.4047619048  0.3240000000  0.3015873016  0.3433734940  0.3373493976  0.4442771084  0.4638554217  0.3793650794  12.900000000  0.0273866892  1.1292407584  0.0722379684  150           0.0365489578
0.3340000000  0.4047619048  0.3220000000  0.3015873016  0.3433734940  0.3373493976  0.4472891566  0.4638554217  0.3761904762  17.200000000  0.0278174457  1.1292921376  0.0722379684  200           0.0351905251
0.3360000000  0.4047619048  0.3200000000  0.3015873016  0.3403614458  0.3373493976  0.4442771084  0.4638554217  0.3793650794  21.500000000  0.0314651735  1.1270305371  0.0722379684  250           0.0361939240
0.3340000000  0.4047619048  0.3180000000  0.3015873016  0.3433734940  0.3373493976  0.4442771084  0.4638554217  0.3793650794  25.800000000  0.0309562213  1.1289153528  0.0722379684  300           0.0350235033
0.3360000000  0.4126984127  0.3220000000  0.3015873016  0.3448795181  0.3313253012  0.4472891566  0.4638554217  0.3761904762  30.100000000  0.0288465190  1.1247613883  0.0722379684  350           0.0348291826
0.3360000000  0.4126984127  0.3220000000  0.3015873016  0.3433734940  0.3373493976  0.4472891566  0.4638554217  0.3841269841  34.400000000  0.0278864138  1.1265819287  0.0722379684  400           0.0376286936
0.3320000000  0.4047619048  0.3220000000  0.3015873016  0.3418674699  0.3313253012  0.4412650602  0.4638554217  0.3761904762  38.700000000  0.0282440547  1.1313480330  0.0722379684  450           0.0401074409
0.3340000000  0.4047619048  0.3180000000  0.3015873016  0.3433734940  0.3373493976  0.4442771084  0.4638554217  0.3793650794  43.000000000  0.0280920076  1.1302199721  0.0722379684  500           0.0340578794
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 41
	normlizetype: 0-1
	output_dir: train_output/6b38e6ebdcf76ec4819bd37b252578b4
	save_model_every_checkpoint: False
	seed: 150252849
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	class_balanced: False
	data_augmentation: True
	lr: 2.848538320538549e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0005889003795888928
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3220000000  0.3968253968  0.3280000000  0.3492063492  0.2831325301  0.2891566265  0.3012048193  0.2530120482  0.3412698413  0.0000000000  1.1192345619  0.0297250748  0             0.3913450241
0.4760000000  0.4285714286  0.4980000000  0.4920634921  0.5617469880  0.5602409639  0.5376506024  0.5481927711  0.4888888889  4.3000000000  1.0772813582  0.0359859467  50            0.0391961050
0.4820000000  0.4603174603  0.4800000000  0.4444444444  0.6792168675  0.6927710843  0.6731927711  0.6807228916  0.4984126984  8.6000000000  1.0173627436  0.0359859467  100           0.0398817587
0.4660000000  0.4682539683  0.4340000000  0.4126984127  0.7319277108  0.7951807229  0.7560240964  0.7590361446  0.4825396825  12.900000000  0.9655830777  0.0359859467  150           0.0403088188
0.5020000000  0.5000000000  0.4880000000  0.4682539683  0.7289156627  0.7831325301  0.7846385542  0.7891566265  0.5111111111  17.200000000  0.8976195645  0.0359859467  200           0.0410496902
0.5180000000  0.5238095238  0.5060000000  0.4761904762  0.7259036145  0.7710843373  0.8042168675  0.8072289157  0.5285714286  21.500000000  0.8300675523  0.0359859467  250           0.0397161627
0.5500000000  0.5396825397  0.5140000000  0.5000000000  0.7454819277  0.7771084337  0.8222891566  0.8072289157  0.5650793651  25.800000000  0.7816521895  0.0359859467  300           0.0395862865
0.5760000000  0.5634920635  0.5560000000  0.5555555556  0.7590361446  0.7951807229  0.8237951807  0.8253012048  0.5968253968  30.100000000  0.7350032043  0.0359859467  350           0.0401711273
0.5860000000  0.5714285714  0.5660000000  0.5555555556  0.7846385542  0.8132530120  0.8117469880  0.8253012048  0.6158730159  34.400000000  0.6853608370  0.0359859467  400           0.0389082384
0.5900000000  0.5873015873  0.5980000000  0.5793650794  0.8042168675  0.8192771084  0.8162650602  0.8313253012  0.6269841270  38.700000000  0.6376681888  0.0359859467  450           0.0386537886
0.6200000000  0.6031746032  0.6340000000  0.6031746032  0.8237951807  0.8253012048  0.8222891566  0.8313253012  0.6523809524  43.000000000  0.6014184016  0.0359859467  500           0.0412443829
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 8
	normlizetype: 0-1
	output_dir: train_output/f38f179fe1a8f383633f9d113569f6f7
	save_model_every_checkpoint: False
	seed: 48353065
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.305597505683036
	gda: True
	lr: 0.00016380547867477334
	lr_d: 0.0004560921396616716
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 9.0197132396305
	weight_decay: 1.4236172918593402e-05
	weight_decay_d: 2.988916639814755e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3540000000  0.3809523810  0.3620000000  0.3730158730  0.3885542169  0.3975903614  0.3207831325  0.3313253012  0.3730158730  0.0000000000  0.6183453798  1.1100592613  0.0355830193  0             0.3588161469
0.3300000000  0.3333333333  0.3560000000  0.3730158730  0.3554216867  0.3734939759  0.3554216867  0.3493975904  0.3904761905  2.0000000000  0.7510611394  1.1117355204  0.0385394096  50            0.0509389639
0.3320000000  0.3333333333  0.3580000000  0.3730158730  0.3644578313  0.3734939759  0.3554216867  0.3493975904  0.3904761905  4.0000000000  0.7793387520  1.1172859883  0.0385394096  100           0.0481367636
0.3300000000  0.3253968254  0.3560000000  0.3809523810  0.3644578313  0.3614457831  0.3524096386  0.3734939759  0.3857142857  6.0000000000  0.7673438507  1.1159690189  0.0385394096  150           0.0471597910
0.3260000000  0.3333333333  0.3560000000  0.3650793651  0.3644578313  0.3734939759  0.3629518072  0.3554216867  0.3873015873  8.0000000000  0.7742019099  1.1156900978  0.0385394096  200           0.0495365000
0.3280000000  0.3333333333  0.3560000000  0.3650793651  0.3689759036  0.3674698795  0.3659638554  0.3674698795  0.3920634921  10.000000000  0.7878325877  1.1166385818  0.0385394096  250           0.0505257607
0.3300000000  0.3253968254  0.3560000000  0.3809523810  0.3644578313  0.3855421687  0.3539156627  0.3674698795  0.3857142857  12.000000000  0.7369484505  1.1111732507  0.0385394096  300           0.0471948338
0.3300000000  0.3333333333  0.3560000000  0.3730158730  0.3584337349  0.3614457831  0.3569277108  0.3554216867  0.3904761905  14.000000000  0.7527930173  1.1179159594  0.0385394096  350           0.0464464664
0.3280000000  0.3333333333  0.3540000000  0.3730158730  0.3644578313  0.3855421687  0.3478915663  0.3554216867  0.3857142857  16.000000000  0.7717686558  1.1174808311  0.0385394096  400           0.0505601168
0.3320000000  0.3253968254  0.3520000000  0.3730158730  0.3629518072  0.3674698795  0.3569277108  0.3554216867  0.3920634921  18.000000000  0.8045780316  1.1171802568  0.0385394096  450           0.0488719702
0.3320000000  0.3333333333  0.3560000000  0.3730158730  0.3614457831  0.3734939759  0.3599397590  0.3554216867  0.3904761905  20.000000000  0.8135206878  1.1075973010  0.0385394096  500           0.0497728777
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 35
	normlizetype: 0-1
	output_dir: train_output/20de9823a702830363b65aabc6993626
	save_model_every_checkpoint: False
	seed: 1781010255
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	lr: 4.048637909021825e-06
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0027187287407379923
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3380000000  0.3174603175  0.3200000000  0.3174603175  0.4487951807  0.4457831325  0.4743975904  0.5120481928  0.3285714286  0.0000000000  1.1395976543  0.0164361000  0             0.4109642506
0.4080000000  0.3730158730  0.3880000000  0.3174603175  0.4487951807  0.4939759036  0.5060240964  0.4939759036  0.3619047619  0.8000000000  1.0732625067  0.0227432251  50            0.0402851391
0.4040000000  0.4603174603  0.4120000000  0.3730158730  0.4698795181  0.4578313253  0.5271084337  0.5301204819  0.3714285714  1.6000000000  1.0826680923  0.0227432251  100           0.0374431372
0.4100000000  0.4841269841  0.4300000000  0.3730158730  0.4789156627  0.4578313253  0.5481927711  0.5301204819  0.3698412698  2.4000000000  1.0731119573  0.0227432251  150           0.0368479395
0.4000000000  0.4841269841  0.4380000000  0.3571428571  0.4774096386  0.4518072289  0.5451807229  0.5301204819  0.3682539683  3.2000000000  1.0489923048  0.0227432251  200           0.0366550684
0.3980000000  0.4761904762  0.4380000000  0.3571428571  0.4774096386  0.4638554217  0.5436746988  0.5361445783  0.3714285714  4.0000000000  1.0578894556  0.0227432251  250           0.0363408947
0.4020000000  0.4761904762  0.4400000000  0.3650793651  0.4849397590  0.4819277108  0.5451807229  0.5301204819  0.3825396825  4.8000000000  1.0631354499  0.0227432251  300           0.0364440727
0.4120000000  0.4761904762  0.4480000000  0.3650793651  0.4924698795  0.4879518072  0.5496987952  0.5361445783  0.3888888889  5.6000000000  1.0601603281  0.0227432251  350           0.0414035702
0.4140000000  0.4841269841  0.4480000000  0.3730158730  0.4954819277  0.4879518072  0.5587349398  0.5361445783  0.3952380952  6.4000000000  1.0394281149  0.0227432251  400           0.0402446365
0.4140000000  0.4682539683  0.4520000000  0.3809523810  0.5060240964  0.5180722892  0.5617469880  0.5361445783  0.3984126984  7.2000000000  1.0343559146  0.0227432251  450           0.0372622728
0.4220000000  0.4682539683  0.4560000000  0.3809523810  0.5120481928  0.5180722892  0.5617469880  0.5361445783  0.4079365079  8.0000000000  1.0468240535  0.0227432251  500           0.0394646406
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 47
	normlizetype: 0-1
	output_dir: train_output/beb7ae682242a9b72ecf8142fa5108a6
	save_model_every_checkpoint: False
	seed: 763321556
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 21
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.32518554200740407
	gda: True
	lr: 0.00018728400841352565
	lr_d: 0.00023727411503146438
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 2.593164378313842
	weight_decay: 1.227783669831511e-05
	weight_decay_d: 0.00010395921905525715
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3340000000  0.3333333333  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3333333333  0.0000000000  0.5367962122  1.2058826685  0.0364885330  0             0.4238119125
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  2.1000000000  0.5144876428  1.1868142605  0.0382981300  50            0.0841094303
0.3340000000  0.3333333333  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  4.2000000000  0.4552106251  1.2031843853  0.0382981300  100           0.0871906090
0.3340000000  0.3333333333  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  6.3000000000  0.4747618189  1.1770481777  0.0382981300  150           0.0824566841
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  8.4000000000  0.4844770466  1.1888788581  0.0382981300  200           0.0827469349
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  10.500000000  0.4963616244  1.1907147169  0.0382981300  250           0.0893098497
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  12.600000000  0.5293798012  1.1851522946  0.0382981300  300           0.0845771503
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  14.700000000  0.4920195732  1.1874063826  0.0382981300  350           0.0862330580
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  16.800000000  0.5029082373  1.1940162206  0.0382981300  400           0.0890593290
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  18.900000000  0.5096046650  1.1822541738  0.0382981300  450           0.0809704924
0.3340000000  0.3333333333  0.3280000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  21.000000000  0.4807480523  1.1882256722  0.0382981300  500           0.0839896727
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 49
	normlizetype: 0-1
	output_dir: train_output/a0597f0653a598a6073f150a4398a58b
	save_model_every_checkpoint: False
	seed: 946585863
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 16
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 1.0292951932082206
	gda: True
	lr: 0.0002781384725024363
	lr_d: 0.0014737898060726592
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.05261346176146395
	weight_decay: 0.0011460964943044245
	weight_decay_d: 1.5657728723266327e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3160000000  0.3333333333  0.3380000000  0.3253968254  0.3509036145  0.3554216867  0.4457831325  0.4578313253  0.3523809524  0.0000000000  0.0076049953  1.1049786806  0.0290651321  0             0.3666479588
0.3080000000  0.3174603175  0.3500000000  0.3174603175  0.3478915663  0.3795180723  0.4457831325  0.4457831325  0.3476190476  1.6000000000  0.0089611687  1.1171119499  0.0308618546  50            0.0464378119
0.3120000000  0.3095238095  0.3460000000  0.3174603175  0.3448795181  0.3795180723  0.4397590361  0.4457831325  0.3444444444  3.2000000000  0.0094068433  1.1134844351  0.0308618546  100           0.0449296761
0.3060000000  0.3095238095  0.3480000000  0.3253968254  0.3524096386  0.3734939759  0.4427710843  0.4457831325  0.3428571429  4.8000000000  0.0082837289  1.1137573290  0.0308618546  150           0.0444009352
0.3080000000  0.3174603175  0.3460000000  0.3174603175  0.3493975904  0.3855421687  0.4427710843  0.4457831325  0.3428571429  6.4000000000  0.0088059030  1.1127033782  0.0308618546  200           0.0467139196
0.3100000000  0.3174603175  0.3500000000  0.3174603175  0.3448795181  0.3795180723  0.4382530120  0.4397590361  0.3476190476  8.0000000000  0.0090322094  1.1147780323  0.0308618546  250           0.0460175085
0.3120000000  0.3174603175  0.3440000000  0.3095238095  0.3433734940  0.3734939759  0.4397590361  0.4457831325  0.3412698413  9.6000000000  0.0092171315  1.1162380075  0.0308618546  300           0.0467065382
0.3120000000  0.3174603175  0.3440000000  0.3174603175  0.3524096386  0.3855421687  0.4397590361  0.4457831325  0.3476190476  11.200000000  0.0092128279  1.1217227697  0.0308618546  350           0.0485275078
0.3060000000  0.3095238095  0.3420000000  0.3174603175  0.3509036145  0.3795180723  0.4367469880  0.4457831325  0.3428571429  12.800000000  0.0093413013  1.1189820862  0.0308618546  400           0.0478919506
0.3040000000  0.3095238095  0.3460000000  0.3174603175  0.3509036145  0.3795180723  0.4367469880  0.4457831325  0.3476190476  14.400000000  0.0084732878  1.1124633026  0.0308618546  450           0.0493384027
0.3100000000  0.3095238095  0.3440000000  0.3174603175  0.3433734940  0.3734939759  0.4442771084  0.4397590361  0.3492063492  16.000000000  0.0086312048  1.1266036987  0.0308618546  500           0.0451923990
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 34
	normlizetype: 0-1
	output_dir: train_output/d88d9f3af4de2f68c6f69d538ceb9479
	save_model_every_checkpoint: False
	seed: 650465891
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 23
	class_balanced: False
	data_augmentation: True
	ib_lambda: 2032.763840585689
	ib_penalty_anneal_iters: 263
	irm_lambda: 6.442913945142169
	irm_penalty_anneal_iters: 606
	lr: 4.1745474684167584e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 4.737369176421509e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0272816960  0.0014461183  0.2520000000  0.2460317460  0.3040000000  0.2857142857  0.2394578313  0.2349397590  0.2605421687  0.2590361446  0.2269841270  0.0000000000  1.0821579695  0.0404543877  1.0821579695  0             0.3568141460
0.0264159762  0.0046669152  0.5400000000  0.5317460317  0.5260000000  0.5476190476  0.6972891566  0.6445783133  0.7846385542  0.8253012048  0.5793650794  2.3000000000  1.0380355537  0.0454874039  1.0380355537  50            0.0177219820
0.0611968438  0.0167703834  0.5960000000  0.5476190476  0.6100000000  0.6031746032  0.6867469880  0.6746987952  0.8042168675  0.8433734940  0.6777777778  4.6000000000  0.8124618244  0.0454874039  0.8124618244  100           0.0178489780
0.1247394189  0.0118597260  0.7220000000  0.6825396825  0.6400000000  0.6349206349  0.7033132530  0.6927710843  0.8162650602  0.8554216867  0.7269841270  6.9000000000  0.6168953103  0.0454874039  0.6168953103  150           0.0182363653
0.1772376466  0.0113157462  0.8300000000  0.7142857143  0.6860000000  0.7063492063  0.8358433735  0.8132530120  0.8524096386  0.8795180723  0.7238095238  9.2000000000  0.5373497218  0.0454874039  0.5373497218  200           0.0177061129
0.2246006107  0.0137834836  0.8300000000  0.6984126984  0.7120000000  0.6666666667  0.8614457831  0.8554216867  0.8734939759  0.8915662651  0.6650793651  11.500000000  0.4723138481  0.0454874039  0.4723138481  250           0.0177024698
0.1320629084  0.5262205216  0.3400000000  0.3333333333  0.3380000000  0.3333333333  0.3403614458  0.3614457831  0.4427710843  0.4457831325  0.3380952381  13.800000000  145.87471087  0.0454874039  145.87471087  300           0.0170842171
0.0185911185  1.2316063899  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  16.100000000  40.841106872  0.0454874039  40.841106872  350           0.0181544828
0.0100322751  0.5859113565  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  18.400000000  22.518009491  0.0454874039  22.518009491  400           0.0180061388
0.0053720198  0.1891609604  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  20.700000000  12.439238929  0.0454874039  12.439238929  450           0.0173789501
0.0033946439  0.0700997792  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  23.000000000  8.2058039188  0.0454874039  8.2058039188  500           0.0175476837
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 3
	normlizetype: 0-1
	output_dir: train_output/2660dfccefb6d0d95f084fed2912b2b1
	save_model_every_checkpoint: False
	seed: 1491201208
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 34
	class_balanced: False
	data_augmentation: True
	lr: 4.075301710543684e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 1.046949588651311e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3660000000  0.3571428571  0.3580000000  0.3650793651  0.3298192771  0.3313253012  0.3313253012  0.3373493976  0.3666666667  0.0000000000  1.1308811903  0.0261478424  0             0.3917198181
0.3860000000  0.3412698413  0.3640000000  0.3571428571  0.3659638554  0.3554216867  0.5075301205  0.5000000000  0.3634920635  3.4000000000  1.0875055325  0.0335907936  50            0.0410510635
0.4380000000  0.3968253968  0.4140000000  0.4047619048  0.4759036145  0.5060240964  0.5647590361  0.5843373494  0.4444444444  6.8000000000  1.0297376490  0.0335907936  100           0.0390560007
0.5160000000  0.4285714286  0.5260000000  0.5396825397  0.5572289157  0.6265060241  0.5978915663  0.6204819277  0.5587301587  10.200000000  0.9879492128  0.0335907936  150           0.0405084753
0.5660000000  0.4444444444  0.5900000000  0.6031746032  0.6430722892  0.7048192771  0.6310240964  0.6566265060  0.6190476190  13.600000000  0.9347542787  0.0335907936  200           0.0392252779
0.5680000000  0.4682539683  0.5900000000  0.5476190476  0.6867469880  0.7469879518  0.6596385542  0.6867469880  0.6428571429  17.000000000  0.8991009665  0.0335907936  250           0.0388103628
0.5880000000  0.4841269841  0.5700000000  0.5317460317  0.7259036145  0.7951807229  0.6731927711  0.7048192771  0.6714285714  20.400000000  0.8645337784  0.0335907936  300           0.0412625027
0.5860000000  0.4920634921  0.5600000000  0.5396825397  0.7575301205  0.8373493976  0.6852409639  0.7048192771  0.6904761905  23.800000000  0.8049444473  0.0335907936  350           0.0396658421
0.5940000000  0.5000000000  0.5600000000  0.5396825397  0.7725903614  0.8493975904  0.6927710843  0.7108433735  0.7015873016  27.200000000  0.7733750188  0.0335907936  400           0.0385496092
0.5920000000  0.5238095238  0.5580000000  0.5396825397  0.7816265060  0.8493975904  0.7063253012  0.7168674699  0.7063492063  30.600000000  0.7378923917  0.0335907936  450           0.0381612301
0.6060000000  0.5158730159  0.5600000000  0.5634920635  0.8087349398  0.8975903614  0.7138554217  0.7228915663  0.7222222222  34.000000000  0.7037978637  0.0335907936  500           0.0390225554
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 19
	normlizetype: 0-1
	output_dir: train_output/b30f72d44a68997b6398c95066872bd6
	save_model_every_checkpoint: False
	seed: 564445136
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	class_balanced: False
	data_augmentation: True
	ib_lambda: 8.096409012960427
	ib_penalty_anneal_iters: 1
	irm_lambda: 749.7636165559097
	irm_penalty_anneal_iters: 1009
	lr: 3.63194222460564e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0038261244966893123
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0257685613  0.0161221884  0.3620000000  0.3809523810  0.3760000000  0.3968253968  0.3087349398  0.2831325301  0.3704819277  0.3855421687  0.4079365079  0.0000000000  1.2336928844  0.0262093544  1.2336928844  0             0.3649034500
0.0125712419  0.0021670018  0.5280000000  0.4682539683  0.5180000000  0.5793650794  0.5240963855  0.4939759036  0.5858433735  0.5481927711  0.4841269841  1.4000000000  1.1561847377  0.0322380066  1.1561847377  50            0.0176674509
0.0076081966  0.0090251653  0.5080000000  0.4285714286  0.4460000000  0.4523809524  0.6792168675  0.6204819277  0.7771084337  0.8072289157  0.4269841270  2.8000000000  1.0479638147  0.0322380066  1.0479638147  100           0.0179536152
0.0098572159  0.0195160028  0.5540000000  0.5079365079  0.5940000000  0.5873015873  0.7108433735  0.6506024096  0.7530120482  0.7349397590  0.5555555556  4.2000000000  0.9990750015  0.0322380066  0.9990750015  150           0.0174661398
0.0124182964  0.0275916472  0.5800000000  0.5317460317  0.5860000000  0.5714285714  0.7319277108  0.6746987952  0.8373493976  0.8433734940  0.5126984127  5.6000000000  0.9616320097  0.0322380066  0.9616320097  200           0.0178276920
0.0129686932  0.0348846511  0.5960000000  0.5317460317  0.6480000000  0.5873015873  0.7259036145  0.7228915663  0.8298192771  0.8132530120  0.5444444444  7.0000000000  0.9472101259  0.0322380066  0.9472101259  250           0.0174088907
0.0148570293  0.0408383195  0.5920000000  0.5396825397  0.6240000000  0.5793650794  0.7454819277  0.7289156627  0.8343373494  0.8313253012  0.5619047619  8.4000000000  0.9250660765  0.0322380066  0.9250660765  300           0.0175021935
0.0154986049  0.0439564634  0.6240000000  0.5634920635  0.6780000000  0.5952380952  0.7274096386  0.7048192771  0.8644578313  0.8915662651  0.6015873016  9.8000000000  0.9147141528  0.0322380066  0.9147141528  350           0.0175537014
0.0165744888  0.0499370984  0.6540000000  0.5793650794  0.6840000000  0.6031746032  0.7936746988  0.7771084337  0.8403614458  0.8313253012  0.5888888889  11.200000000  0.8961744988  0.0322380066  0.8961744988  400           0.0186146784
0.0179240482  0.0550142545  0.6740000000  0.6269841270  0.6900000000  0.6269841270  0.7786144578  0.7650602410  0.8599397590  0.8614457831  0.5984126984  12.600000000  0.8743624234  0.0322380066  0.8743624234  450           0.0191898203
0.0190886380  0.0531374595  0.6760000000  0.5952380952  0.6960000000  0.6507936508  0.8177710843  0.7891566265  0.8132530120  0.8072289157  0.6158730159  14.000000000  0.8606326580  0.0322380066  0.8606326580  500           0.0178760433
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output/bac60ee4bfc1ed759d5cae92ae98ba2b
	save_model_every_checkpoint: False
	seed: 1353787662
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.1458260446338375
	gda: True
	lr: 0.00018486359452623148
	lr_d: 0.0017476073345275033
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.018069222822422647
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.004128658159026448
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3380000000  0.3492063492  0.3500000000  0.3095238095  0.3207831325  0.3072289157  0.3403614458  0.3373493976  0.3476190476  0.0000000000  0.0008676497  1.1154450178  0.0460433960  0             0.4087467194
0.3600000000  0.3730158730  0.3600000000  0.3650793651  0.3102409639  0.3012048193  0.3509036145  0.3554216867  0.3619047619  2.7000000000  0.0021173894  1.1515290833  0.0473690033  50            0.0541407394
0.3600000000  0.3730158730  0.3620000000  0.3730158730  0.3102409639  0.3012048193  0.3448795181  0.3554216867  0.3634920635  5.4000000000  0.0024156303  1.1440871406  0.0473690033  100           0.0519015074
0.3620000000  0.3730158730  0.3620000000  0.3650793651  0.3102409639  0.3012048193  0.3524096386  0.3614457831  0.3634920635  8.1000000000  0.0024094267  1.1509282684  0.0473690033  150           0.0524743986
0.3640000000  0.3730158730  0.3640000000  0.3730158730  0.3072289157  0.3012048193  0.3539156627  0.3674698795  0.3666666667  10.800000000  0.0025551240  1.1444501114  0.0473690033  200           0.0474038887
0.3600000000  0.3730158730  0.3660000000  0.3650793651  0.3087349398  0.2951807229  0.3584337349  0.3614457831  0.3634920635  13.500000000  0.0022241699  1.1379909849  0.0473690033  250           0.0477646780
0.3640000000  0.3650793651  0.3620000000  0.3650793651  0.3102409639  0.3012048193  0.3539156627  0.3554216867  0.3634920635  16.200000000  0.0022719340  1.1494616985  0.0473690033  300           0.0473037004
0.3600000000  0.3730158730  0.3680000000  0.3730158730  0.3102409639  0.3012048193  0.3584337349  0.3614457831  0.3634920635  18.900000000  0.0023793094  1.1462635708  0.0473690033  350           0.0485002232
0.3620000000  0.3809523810  0.3660000000  0.3730158730  0.3102409639  0.3012048193  0.3584337349  0.3734939759  0.3666666667  21.600000000  0.0026146868  1.1481119609  0.0473690033  400           0.0491831684
0.3640000000  0.3730158730  0.3640000000  0.3571428571  0.3102409639  0.3012048193  0.3463855422  0.3493975904  0.3634920635  24.300000000  0.0023476204  1.1505220222  0.0473690033  450           0.0480878687
0.3580000000  0.3650793651  0.3660000000  0.3730158730  0.3102409639  0.3012048193  0.3493975904  0.3614457831  0.3619047619  27.000000000  0.0022714096  1.1486922908  0.0473690033  500           0.0473534966
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 8
	normlizetype: 0-1
	output_dir: train_output/a30fe06faea0c2476d66c7d2787979a6
	save_model_every_checkpoint: False
	seed: 291799789
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	class_balanced: False
	data_augmentation: True
	lr: 0.00016380547867477334
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.4236172918593402e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3180000000  0.2619047619  0.3060000000  0.2936507937  0.2123493976  0.1626506024  0.2936746988  0.3433734940  0.3190476190  0.0000000000  1.1435775757  0.0201768875  0             0.3383510113
0.4300000000  0.4603174603  0.4140000000  0.4206349206  0.6777108434  0.6385542169  0.7334337349  0.7168674699  0.4857142857  2.0000000000  0.9969941330  0.0264840126  50            0.0396892643
0.5780000000  0.6031746032  0.5140000000  0.5238095238  0.8509036145  0.7891566265  0.7289156627  0.7108433735  0.6079365079  4.0000000000  0.8717206573  0.0264840126  100           0.0400061131
0.6040000000  0.6190476190  0.5640000000  0.5873015873  0.8524096386  0.8072289157  0.7560240964  0.7469879518  0.6507936508  6.0000000000  0.7523126388  0.0264840126  150           0.0403347397
0.6080000000  0.6269841270  0.6100000000  0.5952380952  0.8674698795  0.8313253012  0.7635542169  0.7650602410  0.6539682540  8.0000000000  0.6422510755  0.0264840126  200           0.0426977682
0.6500000000  0.6507936508  0.6240000000  0.6190476190  0.8750000000  0.8614457831  0.8057228916  0.8012048193  0.6746031746  10.000000000  0.5584495407  0.0264840126  250           0.0397931576
0.6540000000  0.6587301587  0.6540000000  0.6269841270  0.8810240964  0.8614457831  0.8418674699  0.8253012048  0.6603174603  12.000000000  0.5007259220  0.0264840126  300           0.0395310831
0.6680000000  0.6666666667  0.6780000000  0.6507936508  0.8810240964  0.8614457831  0.8524096386  0.8433734940  0.6365079365  14.000000000  0.4228500730  0.0264840126  350           0.0393793297
0.7180000000  0.7063492063  0.7020000000  0.6587301587  0.8810240964  0.8734939759  0.8689759036  0.8493975904  0.6507936508  16.000000000  0.4062834156  0.0264840126  400           0.0395516777
0.7280000000  0.7142857143  0.7200000000  0.6507936508  0.8840361446  0.8734939759  0.9171686747  0.8734939759  0.6317460317  18.000000000  0.3450259960  0.0264840126  450           0.0395292664
0.7760000000  0.7698412698  0.7560000000  0.6904761905  0.8885542169  0.8795180723  0.9472891566  0.9337349398  0.6666666667  20.000000000  0.3123389983  0.0264840126  500           0.0393781233
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 40
	normlizetype: 0-1
	output_dir: train_output/885ed85fe0d3e119940d0c56b91992a9
	save_model_every_checkpoint: False
	seed: 32609154
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 35
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 0.7537079925282834
	gda: True
	lr: 7.829058482062479e-05
	lr_d: 0.0024732796530418802
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 1.8711976260509988
	weight_decay: 2.6037334324031243e-05
	weight_decay_d: 0.0017954337175137784
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3940000000  0.4365079365  0.4500000000  0.4047619048  0.4036144578  0.3855421687  0.4879518072  0.4819277108  0.3920634921  0.0000000000  0.1204557493  1.1481283903  0.0593137741  0             0.3660478592
0.3840000000  0.3888888889  0.3820000000  0.3730158730  0.3644578313  0.3614457831  0.4352409639  0.4397590361  0.3730158730  3.5000000000  0.1966272480  1.1180139732  0.0618886948  50            0.0344105530
0.3900000000  0.3968253968  0.3840000000  0.3730158730  0.3644578313  0.3614457831  0.4352409639  0.4397590361  0.3730158730  7.0000000000  0.2067080155  1.1162914038  0.0618886948  100           0.0363139772
0.3900000000  0.4047619048  0.3860000000  0.3730158730  0.3689759036  0.3674698795  0.4337349398  0.4337349398  0.3682539683  10.500000000  0.2023473468  1.1197588444  0.0618886948  150           0.0338108635
0.3820000000  0.3968253968  0.3800000000  0.3730158730  0.3644578313  0.3734939759  0.4382530120  0.4397590361  0.3761904762  14.000000000  0.1969666088  1.1185704875  0.0618886948  200           0.0351326036
0.3800000000  0.3888888889  0.3840000000  0.3730158730  0.3644578313  0.3614457831  0.4367469880  0.4457831325  0.3761904762  17.500000000  0.2109305346  1.1182030058  0.0618886948  250           0.0354189825
0.3880000000  0.3968253968  0.3920000000  0.3730158730  0.3674698795  0.3734939759  0.4382530120  0.4397590361  0.3761904762  21.000000000  0.2037376271  1.1203671217  0.0618886948  300           0.0351775408
0.3860000000  0.3888888889  0.3860000000  0.3730158730  0.3644578313  0.3614457831  0.4427710843  0.4457831325  0.3761904762  24.500000000  0.2185954112  1.1167384768  0.0618886948  350           0.0337760162
0.3880000000  0.3968253968  0.3820000000  0.3730158730  0.3674698795  0.3734939759  0.4412650602  0.4397590361  0.3730158730  28.000000000  0.1855596838  1.1133507156  0.0618886948  400           0.0346590424
0.3880000000  0.3968253968  0.3840000000  0.3730158730  0.3629518072  0.3554216867  0.4397590361  0.4457831325  0.3761904762  31.500000000  0.1961378707  1.1188326383  0.0618886948  450           0.0352141857
0.3860000000  0.3888888889  0.3820000000  0.3650793651  0.3629518072  0.3554216867  0.4457831325  0.4457831325  0.3761904762  35.000000000  0.1979711507  1.1191830993  0.0618886948  500           0.0339010525
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 23
	normlizetype: 0-1
	output_dir: train_output/c2bf503f3e0130e6430703af5290a941
	save_model_every_checkpoint: False
	seed: 1766053200
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	ib_lambda: 4.593776829698064
	ib_penalty_anneal_iters: 5819
	irm_lambda: 63.98272409873196
	irm_penalty_anneal_iters: 627
	lr: 0.00019694974226292723
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.0005037465137597051
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0241207667  0.0029515130  0.3800000000  0.3888888889  0.3460000000  0.3333333333  0.3539156627  0.3433734940  0.3298192771  0.3313253012  0.3619047619  0.0000000000  1.0959643126  0.0241770744  1.0959643126  0             0.3214178085
0.0774046234  0.0183955256  0.7200000000  0.7619047619  0.6920000000  0.6746031746  0.8765060241  0.8674698795  0.7981927711  0.7469879518  0.7269841270  1.3000000000  0.8382368064  0.0309615135  0.8382368064  50            0.0175279284
0.2888901517  0.0109768308  0.8640000000  0.8253968254  0.8240000000  0.7698412698  0.8539156627  0.8855421687  0.9397590361  0.9036144578  0.6031746032  2.6000000000  0.4952533042  0.0309615135  0.4952533042  100           0.0177233362
0.4754542726  0.0073948391  0.9120000000  0.8412698413  0.8760000000  0.7936507937  0.9743975904  0.9578313253  0.9322289157  0.8614457831  0.6222222222  3.9000000000  0.3836409998  0.0309615135  0.3836409998  150           0.0182526541
0.5846756208  0.0098329578  0.9320000000  0.8650793651  0.9300000000  0.8571428571  0.9759036145  0.9638554217  0.9909638554  0.9518072289  0.5809523810  5.2000000000  0.2695726159  0.0309615135  0.2695726159  200           0.0175606680
0.7531237841  0.0100376405  0.9580000000  0.9285714286  0.9520000000  0.8730158730  0.9954819277  0.9698795181  0.9683734940  0.9337349398  0.6492063492  6.5000000000  0.1995149286  0.0309615135  0.1995149286  250           0.0170090485
0.9145623231  0.0035659766  0.9820000000  0.9126984127  0.9580000000  0.8650793651  0.9849397590  0.9638554217  1.0000000000  1.0000000000  0.5968253968  7.8000000000  0.1526645626  0.0309615135  0.1526645626  300           0.0184409952
1.0728979146  0.0027216916  0.9800000000  0.9206349206  0.9800000000  0.8888888889  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.6873015873  9.1000000000  0.1159589612  0.0309615135  0.1159589612  350           0.0176448727
1.1029402614  0.0011108105  0.9920000000  0.9603174603  0.9940000000  0.9285714286  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.5555555556  10.400000000  0.1061368061  0.0309615135  0.1061368061  400           0.0177291775
1.2307363963  0.0032077626  0.9840000000  0.9126984127  0.9860000000  0.8888888889  0.9984939759  0.9939759036  0.9954819277  0.9819277108  0.6714285714  11.700000000  0.0804930580  0.0309615135  0.0804930580  450           0.0174029255
1.3414770412  0.0013404778  1.0000000000  0.9523809524  0.9980000000  0.9126984127  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4523809524  13.000000000  0.0574623021  0.0309615135  0.0574623021  500           0.0171104717
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 41
	normlizetype: 0-1
	output_dir: train_output/bf1a595d6f4b5068bd405b1245ec9514
	save_model_every_checkpoint: False
	seed: 151229126
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.1737617252141524
	ib_penalty_anneal_iters: 111
	irm_lambda: 1.2961155100056618
	irm_penalty_anneal_iters: 253
	lr: 2.848538320538549e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0005889003795888928
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0187828392  0.0004899964  0.3140000000  0.3333333333  0.3200000000  0.3492063492  0.4337349398  0.3975903614  0.5572289157  0.5421686747  0.3428571429  0.0000000000  1.1063783169  0.0708665848  1.1063783169  0             0.3174834251
0.0231038050  0.0086440271  0.5280000000  0.5158730159  0.5020000000  0.5238095238  0.7168674699  0.6867469880  0.7484939759  0.7289156627  0.5222222222  4.3000000000  1.0046927488  0.0764126778  1.0046927488  50            0.0182488012
0.0589145945  0.0158801068  0.6060000000  0.6031746032  0.6020000000  0.6587301587  0.7801204819  0.7710843373  0.7876506024  0.7530120482  0.6571428571  8.6000000000  0.7903088725  0.0764126778  0.7903088725  100           0.0183013678
0.1101888508  0.0138772750  0.6820000000  0.6746031746  0.6580000000  0.6587301587  0.8388554217  0.8373493976  0.8253012048  0.7951807229  0.7063492063  12.900000000  0.6317159986  0.0764126778  0.6317159986  150           0.0184903288
0.1458552045  0.0172946369  0.7400000000  0.7142857143  0.7180000000  0.6587301587  0.8689759036  0.8614457831  0.8539156627  0.8373493976  0.7031746032  17.200000000  0.5529100960  0.0764126778  0.5529100960  200           0.0188146782
0.1803095469  0.0126984837  0.8600000000  0.7936507937  0.7700000000  0.7063492063  0.8960843373  0.8734939759  0.8855421687  0.8433734940  0.6888888889  21.500000000  0.5016504896  0.0764126778  0.5016504896  250           0.0182555962
0.2135028303  0.0139614340  0.8620000000  0.7857142857  0.8060000000  0.7142857143  0.9277108434  0.9036144578  0.9006024096  0.8674698795  0.6365079365  25.800000000  0.4431878257  0.0764126778  0.4431878257  300           0.0185682106
0.2457203430  0.0135258840  0.8760000000  0.8174603175  0.8420000000  0.6904761905  0.9533132530  0.9457831325  0.9487951807  0.9277108434  0.6539682540  30.100000000  0.4034072375  0.0764126778  0.4034072375  350           0.0188071728
0.2619820979  0.0141639024  0.9040000000  0.8492063492  0.8740000000  0.7777777778  0.9728915663  0.9759036145  0.9698795181  0.9397590361  0.6444444444  34.400000000  0.3575681555  0.0764126778  0.3575681555  400           0.0184924269
0.2777623284  0.0137313267  0.9260000000  0.9126984127  0.9140000000  0.7936507937  0.9849397590  0.9879518072  0.9864457831  0.9698795181  0.6492063492  38.700000000  0.3247505713  0.0764126778  0.3247505713  450           0.0186960983
0.2875596827  0.0139822546  0.9340000000  0.9047619048  0.9260000000  0.8015873016  0.9864457831  0.9939759036  0.9954819277  0.9698795181  0.6174603175  43.000000000  0.2953215075  0.0764126778  0.2953215075  500           0.0182980585
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 5
	normlizetype: 0-1
	output_dir: train_output/0ba3146deb353c46e15b29027dbfc348
	save_model_every_checkpoint: False
	seed: 509698346
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	ib_lambda: 3.2917587403931643
	ib_penalty_anneal_iters: 592
	irm_lambda: 2640.1763536267918
	irm_penalty_anneal_iters: 643
	lr: 2.396851744571906e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 7.934460670892474e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0284390841  -0.000317501  0.3020000000  0.2301587302  0.2900000000  0.2777777778  0.2274096386  0.2228915663  0.1867469880  0.1566265060  0.2238095238  0.0000000000  1.1135164499  0.0272607803  1.1135164499  0             0.3752043247
0.0282106456  0.0008994541  0.5300000000  0.4920634921  0.4740000000  0.5000000000  0.7786144578  0.7650602410  0.7198795181  0.6987951807  0.5285714286  1.5000000000  1.0574618614  0.0332741737  1.0574618614  50            0.0179036093
0.0368414352  0.0133167806  0.6000000000  0.5793650794  0.5540000000  0.5317460317  0.7921686747  0.7951807229  0.7801204819  0.7590361446  0.6190476190  3.0000000000  0.9393686295  0.0332741737  0.9393686295  100           0.0169121122
0.0589133932  0.0201468571  0.6400000000  0.6428571429  0.6360000000  0.5238095238  0.7951807229  0.8192771084  0.8599397590  0.8253012048  0.6825396825  4.5000000000  0.8046239233  0.0332741737  0.8046239233  150           0.0176575851
0.0901329917  0.0196089392  0.6400000000  0.6190476190  0.6800000000  0.6111111111  0.7710843373  0.7831325301  0.8719879518  0.8253012048  0.6825396825  6.0000000000  0.6917930388  0.0332741737  0.6917930388  200           0.0172121763
0.1207028164  0.0170796860  0.7080000000  0.6984126984  0.7040000000  0.5714285714  0.8448795181  0.8493975904  0.8719879518  0.8493975904  0.7269841270  7.5000000000  0.6088113558  0.0332741737  0.6088113558  250           0.0180009890
0.1558662724  0.0147909492  0.7220000000  0.7142857143  0.7040000000  0.6111111111  0.8674698795  0.8674698795  0.8750000000  0.8493975904  0.7396825397  9.0000000000  0.5264563006  0.0332741737  0.5264563006  300           0.0188721371
0.1833434567  0.0111658732  0.7520000000  0.7460317460  0.7120000000  0.6111111111  0.8870481928  0.8855421687  0.8674698795  0.8554216867  0.7079365079  10.500000000  0.4964988351  0.0332741737  0.4964988351  350           0.0165644407
0.2062425122  0.0088407338  0.8220000000  0.8174603175  0.7360000000  0.6428571429  0.8885542169  0.8915662651  0.8870481928  0.8855421687  0.7380952381  12.000000000  0.4704698575  0.0332741737  0.4704698575  400           0.0174538708
0.2339222163  0.0161574935  0.8400000000  0.8174603175  0.7580000000  0.6507936508  0.8855421687  0.8795180723  0.8975903614  0.8915662651  0.7000000000  13.500000000  0.4308280170  0.0332741737  0.4308280170  450           0.0173392487
0.2586485136  0.0150821232  0.8560000000  0.8333333333  0.7940000000  0.6587301587  0.9006024096  0.8915662651  0.9262048193  0.9096385542  0.6841269841  15.000000000  0.3854301077  0.0332741737  0.3854301077  500           0.0188228369
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 25
	normlizetype: 0-1
	output_dir: train_output/7acb2b48a2345e525255a13162c9d20a
	save_model_every_checkpoint: False
	seed: 1464921008
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	lr: 5.146604061136627e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.00038542677274601146
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3560000000  0.3730158730  0.3480000000  0.3333333333  0.2966867470  0.2590361446  0.3915662651  0.4216867470  0.3460317460  0.0000000000  1.0700112581  0.0170950890  0             0.4682185650
0.6000000000  0.6111111111  0.5720000000  0.5634920635  0.8132530120  0.7951807229  0.7274096386  0.6807228916  0.6698412698  1.2000000000  0.9164113832  0.0234022141  50            0.0394965744
0.6200000000  0.6031746032  0.5980000000  0.6190476190  0.8674698795  0.8433734940  0.8147590361  0.7891566265  0.6492063492  2.4000000000  0.6529158390  0.0234022141  100           0.0400277138
0.7000000000  0.6190476190  0.6460000000  0.6666666667  0.8795180723  0.8554216867  0.8072289157  0.7831325301  0.6476190476  3.6000000000  0.5120339090  0.0234022141  150           0.0400318766
0.7200000000  0.6507936508  0.6640000000  0.6349206349  0.8975903614  0.8915662651  0.8975903614  0.8915662651  0.5936507937  4.8000000000  0.4088802025  0.0234022141  200           0.0455127144
0.7760000000  0.6825396825  0.7100000000  0.6587301587  0.9126506024  0.8915662651  0.9262048193  0.9216867470  0.6333333333  6.0000000000  0.3303784689  0.0234022141  250           0.0409190512
0.8420000000  0.7380952381  0.7300000000  0.6984126984  0.9096385542  0.8915662651  0.9638554217  0.9518072289  0.6619047619  7.2000000000  0.2739032722  0.0234022141  300           0.0400321817
0.8700000000  0.8253968254  0.7880000000  0.7301587302  0.9367469880  0.9036144578  0.9789156627  0.9518072289  0.6603174603  8.4000000000  0.1990467672  0.0234022141  350           0.0390326643
0.9060000000  0.8333333333  0.8420000000  0.7619047619  0.9036144578  0.8795180723  0.9789156627  0.9397590361  0.6761904762  9.6000000000  0.1964923884  0.0234022141  400           0.0402961969
0.9040000000  0.8253968254  0.8680000000  0.7698412698  0.9698795181  0.9518072289  0.9954819277  0.9819277108  0.6523809524  10.800000000  0.1751344655  0.0234022141  450           0.0401422215
0.9200000000  0.8571428571  0.8500000000  0.7698412698  0.9397590361  0.9036144578  0.9954819277  0.9819277108  0.6523809524  12.000000000  0.1343515602  0.0234022141  500           0.0404999256
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 1
	normlizetype: 0-1
	output_dir: train_output/17af8f34350b98734c5c5534e0768b5c
	save_model_every_checkpoint: False
	seed: 1794062631
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	class_balanced: False
	data_augmentation: True
	lr: 1.1906162909279581e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.00044832883881609976
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.2840000000  0.3095238095  0.2860000000  0.2619047619  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2603174603  0.0000000000  1.1103354692  0.0278754234  0             0.4159162045
0.4640000000  0.4920634921  0.4520000000  0.4365079365  0.6671686747  0.7048192771  0.8117469880  0.7650602410  0.4079365079  3.9000000000  1.0235351169  0.0338573456  50            0.0388139868
0.5120000000  0.5396825397  0.5200000000  0.4920634921  0.7409638554  0.7469879518  0.8192771084  0.8072289157  0.4984126984  7.8000000000  0.8679488790  0.0338573456  100           0.0380404091
0.5720000000  0.5952380952  0.5520000000  0.5158730159  0.8087349398  0.8012048193  0.8418674699  0.8253012048  0.5587301587  11.700000000  0.7211977994  0.0338573456  150           0.0395617199
0.5920000000  0.5793650794  0.5740000000  0.5555555556  0.8629518072  0.8493975904  0.8463855422  0.8313253012  0.5920634921  15.600000000  0.6104403782  0.0346245766  200           0.0382943583
0.6080000000  0.6031746032  0.5980000000  0.5476190476  0.8750000000  0.8614457831  0.8614457831  0.8313253012  0.6301587302  19.500000000  0.5263463652  0.0346245766  250           0.0386171055
0.6300000000  0.6190476190  0.6200000000  0.5476190476  0.8825301205  0.8674698795  0.8915662651  0.8674698795  0.6587301587  23.400000000  0.4774673331  0.0346245766  300           0.0403634357
0.6500000000  0.6111111111  0.6280000000  0.5476190476  0.8780120482  0.8614457831  0.8960843373  0.8734939759  0.6619047619  27.300000000  0.4078249884  0.0346245766  350           0.0439497328
0.6800000000  0.6349206349  0.6400000000  0.5793650794  0.8855421687  0.8674698795  0.9442771084  0.9216867470  0.6888888889  31.200000000  0.3748772120  0.0346245766  400           0.0410687447
0.7000000000  0.6587301587  0.6480000000  0.6190476190  0.8870481928  0.8614457831  0.9412650602  0.9337349398  0.6904761905  35.100000000  0.3313254040  0.0346245766  450           0.0427980042
0.7200000000  0.6904761905  0.6700000000  0.6111111111  0.8795180723  0.8674698795  0.9593373494  0.9337349398  0.6968253968  39.000000000  0.3039159068  0.0346245766  500           0.0396323109
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 2
	normlizetype: 0-1
	output_dir: train_output/d3d7ffd48e5cc71f9d2db69464080efa
	save_model_every_checkpoint: False
	seed: 810576640
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 25
	class_balanced: False
	data_augmentation: True
	lr: 3.207929136369226e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.005100223533962902
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3900000000  0.4126984127  0.3960000000  0.4365079365  0.4457831325  0.4337349398  0.3945783133  0.4096385542  0.4492063492  0.0000000000  1.0946382284  0.0221052170  0             0.3420031071
0.3600000000  0.3333333333  0.4260000000  0.4444444444  0.3960843373  0.4277108434  0.5000000000  0.5301204819  0.4396825397  2.5000000000  1.0776059580  0.0284123421  50            0.0404150343
0.4540000000  0.3650793651  0.4820000000  0.5158730159  0.5165662651  0.5361445783  0.6340361446  0.6084337349  0.4571428571  5.0000000000  1.0470326388  0.0284123421  100           0.0395827579
0.5000000000  0.4365079365  0.5100000000  0.5317460317  0.5873493976  0.5783132530  0.7319277108  0.7108433735  0.4587301587  7.5000000000  1.0169444239  0.0284123421  150           0.0398369503
0.5140000000  0.4761904762  0.5320000000  0.5476190476  0.6250000000  0.5843373494  0.7289156627  0.7228915663  0.4698412698  10.000000000  0.9917252469  0.0284123421  200           0.0392208719
0.5120000000  0.4682539683  0.5160000000  0.5158730159  0.6882530120  0.6927710843  0.7349397590  0.7228915663  0.4698412698  12.500000000  0.9652802169  0.0284123421  250           0.0402796030
0.5320000000  0.4523809524  0.5200000000  0.5238095238  0.6957831325  0.7108433735  0.7243975904  0.7048192771  0.4920634921  15.000000000  0.9372954524  0.0284123421  300           0.0401186037
0.5320000000  0.4523809524  0.5060000000  0.5079365079  0.7078313253  0.7228915663  0.7515060241  0.7409638554  0.4714285714  17.500000000  0.9206427193  0.0284123421  350           0.0395156622
0.5460000000  0.4761904762  0.5240000000  0.5317460317  0.7108433735  0.7469879518  0.7319277108  0.7108433735  0.5031746032  20.000000000  0.8743294537  0.0284123421  400           0.0393854952
0.5460000000  0.4841269841  0.5140000000  0.5158730159  0.7259036145  0.7469879518  0.7394578313  0.7289156627  0.5190476190  22.500000000  0.8545651102  0.0284123421  450           0.0405120993
0.5560000000  0.4920634921  0.5360000000  0.5238095238  0.7304216867  0.7530120482  0.7394578313  0.7168674699  0.5285714286  25.000000000  0.8322460639  0.0284123421  500           0.0391434622
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 44
	normlizetype: 0-1
	output_dir: train_output/766525203148564d89c70b3821f5fc61
	save_model_every_checkpoint: False
	seed: 702318757
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.7308525351332358
	gda: True
	lr: 8.785759245690127e-05
	lr_d: 0.002696092550779668
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 3.2854583576764242
	weight_decay: 1.4986321472569955e-06
	weight_decay_d: 2.9237266557512802e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.2860000000  0.3174603175  0.3460000000  0.3571428571  0.4352409639  0.3915662651  0.1295180723  0.1445783133  0.2412698413  0.0000000000  0.1843812168  1.1505901814  0.0210790634  0             0.3350496292
0.2580000000  0.2857142857  0.3720000000  0.3730158730  0.3945783133  0.3373493976  0.1626506024  0.1566265060  0.2634920635  1.1000000000  0.4531161687  1.1186255479  0.0236740112  50            0.0337478256
0.2540000000  0.2936507937  0.3720000000  0.3730158730  0.3930722892  0.3433734940  0.1611445783  0.1626506024  0.2698412698  2.2000000000  0.4200422940  1.1240382195  0.0236740112  100           0.0352061510
0.2560000000  0.2857142857  0.3720000000  0.3730158730  0.3975903614  0.3373493976  0.1641566265  0.1626506024  0.2619047619  3.3000000000  0.4411724252  1.1266679454  0.0236740112  150           0.0333236074
0.2580000000  0.2857142857  0.3680000000  0.3730158730  0.3915662651  0.3373493976  0.1686746988  0.1686746988  0.2666666667  4.4000000000  0.4689567892  1.1222205639  0.0236740112  200           0.0347072601
0.2540000000  0.2936507937  0.3720000000  0.3650793651  0.3915662651  0.3373493976  0.1641566265  0.1626506024  0.2634920635  5.5000000000  0.4802881601  1.1164247656  0.0236740112  250           0.0343981838
0.2540000000  0.2857142857  0.3700000000  0.3650793651  0.3945783133  0.3373493976  0.1611445783  0.1626506024  0.2634920635  6.6000000000  0.4843271090  1.1232578397  0.0236740112  300           0.0347271872
0.2580000000  0.2936507937  0.3740000000  0.3650793651  0.3945783133  0.3373493976  0.1641566265  0.1626506024  0.2698412698  7.7000000000  0.4302828572  1.1241869879  0.0236740112  350           0.0338223267
0.2500000000  0.3095238095  0.3740000000  0.3650793651  0.3915662651  0.3373493976  0.1611445783  0.1746987952  0.2650793651  8.8000000000  0.4244221637  1.1262661982  0.0236740112  400           0.0353702450
0.2520000000  0.2936507937  0.3720000000  0.3650793651  0.3915662651  0.3373493976  0.1671686747  0.1626506024  0.2634920635  9.9000000000  0.4476377867  1.1221420717  0.0236740112  450           0.0334778261
0.2520000000  0.2777777778  0.3740000000  0.3650793651  0.3915662651  0.3373493976  0.1596385542  0.1566265060  0.2634920635  11.000000000  0.4082466975  1.1234798861  0.0236740112  500           0.0336897564
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output/9194948a2df6c72b9bc0a23780ec18c2
	save_model_every_checkpoint: False
	seed: 901745634
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0005
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.4400000000  0.3095238095  0.4320000000  0.3888888889  0.4578313253  0.4698795181  0.5195783133  0.4638554217  0.3428571429  0.0000000000  1.0828311443  0.0247988701  0             0.3523550034
0.9120000000  0.8412698413  0.9040000000  0.8095238095  0.9307228916  0.9036144578  0.9081325301  0.8614457831  0.6492063492  3.2000000000  0.3786486706  0.0311059952  50            0.0374099016
0.9420000000  0.8253968254  0.9420000000  0.9126984127  0.9337349398  0.9036144578  0.9668674699  0.9156626506  0.6920634921  6.4000000000  0.1064627314  0.0311059952  100           0.0384017372
0.8900000000  0.7539682540  0.9400000000  0.9206349206  0.9909638554  0.9759036145  1.0000000000  1.0000000000  0.5825396825  9.6000000000  0.0564502228  0.0311059952  150           0.0388853550
0.9940000000  0.9444444444  0.9880000000  0.9523809524  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.5984126984  12.800000000  0.0268539318  0.0311059952  200           0.0382988071
0.9980000000  0.9444444444  0.9920000000  0.9444444444  1.0000000000  0.9759036145  1.0000000000  1.0000000000  0.5873015873  16.000000000  0.0239602499  0.0311059952  250           0.0377975082
0.9940000000  0.9523809524  0.9860000000  0.9365079365  1.0000000000  0.9759036145  1.0000000000  1.0000000000  0.6111111111  19.200000000  0.0134793093  0.0311059952  300           0.0383588219
1.0000000000  0.9761904762  0.9980000000  0.9603174603  0.9864457831  0.9457831325  1.0000000000  1.0000000000  0.4619047619  22.400000000  0.0076143248  0.0311059952  350           0.0383997726
0.9980000000  0.9761904762  1.0000000000  0.9523809524  0.9879518072  0.9277108434  1.0000000000  1.0000000000  0.4555555556  25.600000000  0.0206468310  0.0311059952  400           0.0388998318
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9066265060  0.8554216867  0.9849397590  0.9638554217  0.3349206349  28.800000000  0.0395808344  0.0311059952  450           0.0379184914
0.9980000000  0.9603174603  1.0000000000  0.9603174603  0.9984939759  0.9698795181  0.9984939759  0.9939759036  0.5238095238  32.000000000  0.0061004444  0.0311059952  500           0.0382645035
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 28
	normlizetype: 0-1
	output_dir: train_output/253a565ef1e7807e09e0a32873059516
	save_model_every_checkpoint: False
	seed: 855598625
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 1.9317307358066127
	gda: True
	lr: 5.6004462478267e-05
	lr_d: 0.00016561611101266517
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.02030220011767443
	weight_decay: 0.0010077262711597086
	weight_decay_d: 0.0019264281915019228
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3300000000  0.3412698413  0.3380000000  0.3412698413  0.3177710843  0.3072289157  0.4006024096  0.4096385542  0.3174603175  0.0000000000  0.0031652099  1.1533081532  0.0355830193  0             0.3863024712
0.3340000000  0.3174603175  0.3280000000  0.3412698413  0.3268072289  0.3192771084  0.3990963855  0.3795180723  0.3206349206  2.0000000000  0.0021689706  1.1258332515  0.0385394096  50            0.0866038799
0.3300000000  0.3174603175  0.3280000000  0.3492063492  0.3313253012  0.3132530120  0.4021084337  0.3795180723  0.3238095238  4.0000000000  0.0021671948  1.1211180806  0.0385394096  100           0.0836822605
0.3320000000  0.3253968254  0.3320000000  0.3333333333  0.3177710843  0.3192771084  0.3990963855  0.3795180723  0.3158730159  6.0000000000  0.0024349106  1.1195783234  0.0385394096  150           0.0817056942
0.3280000000  0.3174603175  0.3220000000  0.3333333333  0.3313253012  0.3132530120  0.4081325301  0.3795180723  0.3158730159  8.0000000000  0.0024788314  1.1191899276  0.0385394096  200           0.0829421520
0.3280000000  0.3253968254  0.3240000000  0.3492063492  0.3298192771  0.3072289157  0.4036144578  0.3734939759  0.3206349206  10.000000000  0.0024887911  1.1238351655  0.0385394096  250           0.0848568773
0.3300000000  0.3174603175  0.3280000000  0.3492063492  0.3313253012  0.3132530120  0.3990963855  0.3795180723  0.3222222222  12.000000000  0.0024719387  1.1176200008  0.0385394096  300           0.0857973623
0.3300000000  0.3174603175  0.3260000000  0.3492063492  0.3237951807  0.3072289157  0.3975903614  0.3734939759  0.3238095238  14.000000000  0.0022459556  1.1263312054  0.0385394096  350           0.0844747496
0.3280000000  0.3333333333  0.3220000000  0.3492063492  0.3328313253  0.3192771084  0.4066265060  0.3734939759  0.3222222222  16.000000000  0.0025823080  1.1193477464  0.0385394096  400           0.0842598343
0.3280000000  0.3253968254  0.3280000000  0.3492063492  0.3313253012  0.3132530120  0.4021084337  0.3795180723  0.3190476190  18.000000000  0.0022915674  1.1152533555  0.0385394096  450           0.0850063276
0.3260000000  0.3253968254  0.3300000000  0.3412698413  0.3298192771  0.3313253012  0.4096385542  0.3855421687  0.3142857143  20.000000000  0.0025347121  1.1206091976  0.0385394096  500           0.0849329662
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 15
	normlizetype: 0-1
	output_dir: train_output/e70ff35f93120b22215eaf6e1c8c6798
	save_model_every_checkpoint: False
	seed: 1404819760
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 0.18543577063479916
	gda: True
	lr: 3.947537104470031e-05
	lr_d: 5.433406647514704e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.3249713961479866
	weight_decay: 0.0010784038403040138
	weight_decay_d: 2.3820733582780973e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.2980000000  0.3571428571  0.3100000000  0.3015873016  0.3328313253  0.3072289157  0.4322289157  0.4397590361  0.2952380952  0.0000000000  0.0655276999  1.1135225296  0.0337662697  0             0.3373143673
0.3320000000  0.3174603175  0.3060000000  0.3571428571  0.3328313253  0.3433734940  0.3268072289  0.3192771084  0.3603174603  1.9000000000  0.0433996506  1.1340730071  0.0366406441  50            0.0351426554
0.3320000000  0.3253968254  0.3080000000  0.3650793651  0.3192771084  0.3493975904  0.3418674699  0.3313253012  0.3555555556  3.8000000000  0.0425287200  1.1237440324  0.0366406441  100           0.0343046713
0.3280000000  0.3174603175  0.3100000000  0.3571428571  0.3253012048  0.3373493976  0.3313253012  0.3253012048  0.3571428571  5.7000000000  0.0449525333  1.1253913522  0.0366406441  150           0.0331392670
0.3240000000  0.3174603175  0.3080000000  0.3333333333  0.3298192771  0.3313253012  0.3328313253  0.3313253012  0.3603174603  7.6000000000  0.0398615182  1.1247681355  0.0366406441  200           0.0351818562
0.3240000000  0.3095238095  0.3060000000  0.3492063492  0.3222891566  0.3253012048  0.3298192771  0.3313253012  0.3571428571  9.5000000000  0.0388037869  1.1268389177  0.0366406441  250           0.0343511677
0.3320000000  0.3095238095  0.3060000000  0.3412698413  0.3237951807  0.3313253012  0.3283132530  0.3253012048  0.3619047619  11.400000000  0.0403021386  1.1275255156  0.0366406441  300           0.0342194796
0.3340000000  0.3174603175  0.3080000000  0.3571428571  0.3222891566  0.3373493976  0.3313253012  0.3253012048  0.3555555556  13.300000000  0.0372638402  1.1336650658  0.0366406441  350           0.0336127138
0.3240000000  0.3095238095  0.3060000000  0.3492063492  0.3283132530  0.3373493976  0.3237951807  0.3192771084  0.3603174603  15.200000000  0.0413818428  1.1312268996  0.0366406441  400           0.0357011843
0.3260000000  0.3095238095  0.3060000000  0.3492063492  0.3313253012  0.3373493976  0.3298192771  0.3192771084  0.3619047619  17.100000000  0.0396235383  1.1256176901  0.0366406441  450           0.0339296532
0.3280000000  0.3095238095  0.3040000000  0.3412698413  0.3237951807  0.3433734940  0.3328313253  0.3313253012  0.3571428571  19.000000000  0.0382155646  1.1237801671  0.0366406441  500           0.0329334784
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 13
	normlizetype: 0-1
	output_dir: train_output/cd19aded911c985410ee8cb96268bc11
	save_model_every_checkpoint: False
	seed: 1088784427
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 40
	class_balanced: False
	data_augmentation: True
	lr: 0.0001332442845099019
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 2.7643974709171963e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3380000000  0.3412698413  0.3360000000  0.3333333333  0.3298192771  0.3313253012  0.3328313253  0.3313253012  0.3396825397  0.0000000000  1.0519258976  0.0292015076  0             0.3894305229
0.5820000000  0.5952380952  0.5640000000  0.5079365079  0.8117469880  0.8132530120  0.8268072289  0.8614457831  0.6428571429  4.0000000000  0.9248048806  0.0351929665  50            0.0380822802
0.6260000000  0.5952380952  0.6180000000  0.5634920635  0.8629518072  0.8614457831  0.7921686747  0.8554216867  0.6936507937  8.0000000000  0.6560859334  0.0351929665  100           0.0385150957
0.6740000000  0.6269841270  0.6480000000  0.6031746032  0.8734939759  0.9036144578  0.8358433735  0.8614457831  0.7126984127  12.000000000  0.4755376810  0.0351929665  150           0.0384158564
0.7380000000  0.6587301587  0.6840000000  0.6428571429  0.8734939759  0.9036144578  0.9231927711  0.8975903614  0.7047619048  16.000000000  0.3748088408  0.0351929665  200           0.0383035755
0.8300000000  0.7301587302  0.7460000000  0.6666666667  0.8855421687  0.8915662651  0.9608433735  0.9518072289  0.6920634921  20.000000000  0.2961412001  0.0351929665  250           0.0382026291
0.8620000000  0.7619047619  0.7820000000  0.6904761905  0.8915662651  0.9036144578  0.9864457831  0.9939759036  0.6809523810  24.000000000  0.2429929632  0.0351929665  300           0.0384473991
0.9020000000  0.7936507937  0.8120000000  0.7063492063  0.8915662651  0.9036144578  0.9804216867  0.9939759036  0.6936507937  28.000000000  0.1973101676  0.0351929665  350           0.0386444855
0.9240000000  0.8333333333  0.8520000000  0.7539682540  0.8945783133  0.9036144578  0.9804216867  0.9939759036  0.6761904762  32.000000000  0.1648857069  0.0351929665  400           0.0388791609
0.9400000000  0.8333333333  0.8700000000  0.7619047619  0.8975903614  0.9036144578  0.9819277108  1.0000000000  0.6666666667  36.000000000  0.1409342676  0.0351929665  450           0.0381023121
0.9580000000  0.8492063492  0.9180000000  0.8015873016  0.9096385542  0.9036144578  0.9909638554  1.0000000000  0.6523809524  40.000000000  0.1299122441  0.0351929665  500           0.0388294220
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 10
	normlizetype: 0-1
	output_dir: train_output/60fd9b9d9306aa56c7db5d22d7a840f5
	save_model_every_checkpoint: False
	seed: 289700802
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	class_balanced: False
	data_augmentation: True
	lr: 2.8201039162457077e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 3.538451007661713e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3540000000  0.3492063492  0.3120000000  0.3730158730  0.2138554217  0.2530120482  0.3463855422  0.3734939759  0.3142857143  0.0000000000  1.0726799965  0.0164437294  0             0.3404753208
0.5400000000  0.5317460317  0.5260000000  0.4841269841  0.7394578313  0.7289156627  0.6746987952  0.6746987952  0.5174603175  0.9000000000  1.0098727560  0.0227508545  50            0.0362239456
0.5740000000  0.5238095238  0.4660000000  0.4285714286  0.8102409639  0.8192771084  0.7936746988  0.7771084337  0.5333333333  1.8000000000  0.8689957070  0.0227508545  100           0.0368993711
0.6280000000  0.5793650794  0.5600000000  0.4841269841  0.8569277108  0.8493975904  0.7725903614  0.7771084337  0.6301587302  2.7000000000  0.7504255164  0.0227508545  150           0.0366080856
0.6320000000  0.6111111111  0.6060000000  0.5634920635  0.7966867470  0.7771084337  0.7756024096  0.7650602410  0.7015873016  3.6000000000  0.6413107616  0.0227508545  200           0.0368259573
0.6700000000  0.6349206349  0.6380000000  0.5555555556  0.8704819277  0.8674698795  0.7620481928  0.7228915663  0.7158730159  4.5000000000  0.5559979457  0.0227508545  250           0.0356749010
0.6400000000  0.5952380952  0.6180000000  0.5634920635  0.8840361446  0.8614457831  0.8237951807  0.7771084337  0.6857142857  5.4000000000  0.5223889792  0.0227508545  300           0.0372204161
0.6960000000  0.6031746032  0.6540000000  0.6031746032  0.8765060241  0.8554216867  0.8087349398  0.7650602410  0.7238095238  6.3000000000  0.4346395051  0.0227508545  350           0.0360668659
0.7460000000  0.6587301587  0.6840000000  0.6031746032  0.8719879518  0.8493975904  0.8283132530  0.8072289157  0.7492063492  7.2000000000  0.3950464588  0.0227508545  400           0.0381808138
0.7200000000  0.6746031746  0.7040000000  0.6190476190  0.8870481928  0.8734939759  0.9548192771  0.9156626506  0.7476190476  8.1000000000  0.3659225115  0.0227508545  450           0.0380235243
0.7480000000  0.6587301587  0.7100000000  0.5952380952  0.8960843373  0.8734939759  0.9668674699  0.9397590361  0.7174603175  9.0000000000  0.3363725892  0.0227508545  500           0.0377108908
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 3
	normlizetype: 0-1
	output_dir: train_output/ec23763ec23c882b6c981bf22f1f81c2
	save_model_every_checkpoint: False
	seed: 1255310510
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 34
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 0.3320283313161775
	gda: True
	lr: 4.075301710543684e-05
	lr_d: 0.0014762022871228908
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.01089289782697276
	weight_decay: 1.046949588651311e-05
	weight_decay_d: 0.0007192670864814079
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3280000000  0.3809523810  0.3240000000  0.3015873016  0.3524096386  0.3614457831  0.2228915663  0.2409638554  0.3761904762  0.0000000000  0.0024236382  1.1106653214  0.0566935539  0             0.3323190212
0.3340000000  0.3095238095  0.3220000000  0.3095238095  0.3554216867  0.3493975904  0.2003012048  0.1987951807  0.3222222222  3.4000000000  0.0015204612  1.1492814374  0.0587058067  50            0.0351017618
0.3340000000  0.3095238095  0.3200000000  0.3095238095  0.3569277108  0.3554216867  0.2003012048  0.1987951807  0.3269841270  6.8000000000  0.0012704581  1.1525691295  0.0587058067  100           0.0347124147
0.3340000000  0.3095238095  0.3160000000  0.3095238095  0.3599397590  0.3554216867  0.2003012048  0.1987951807  0.3253968254  10.200000000  0.0013642256  1.1447923756  0.0587058067  150           0.0337444925
0.3340000000  0.3095238095  0.3220000000  0.3095238095  0.3554216867  0.3493975904  0.2033132530  0.1987951807  0.3222222222  13.600000000  0.0014433566  1.1476291728  0.0587058067  200           0.0338710022
0.3340000000  0.3015873016  0.3200000000  0.3015873016  0.3554216867  0.3493975904  0.2033132530  0.1987951807  0.3238095238  17.000000000  0.0014301185  1.1536108828  0.0587058067  250           0.0345602417
0.3360000000  0.3095238095  0.3220000000  0.3095238095  0.3569277108  0.3554216867  0.2003012048  0.1987951807  0.3238095238  20.400000000  0.0013755085  1.1520748997  0.0587058067  300           0.0341111612
0.3300000000  0.3095238095  0.3200000000  0.3095238095  0.3599397590  0.3554216867  0.2003012048  0.1987951807  0.3253968254  23.800000000  0.0013008453  1.1483850646  0.0587058067  350           0.0337850761
0.3360000000  0.3015873016  0.3200000000  0.3015873016  0.3569277108  0.3554216867  0.2003012048  0.1987951807  0.3238095238  27.200000000  0.0012520117  1.1472189999  0.0587058067  400           0.0341881800
0.3320000000  0.3095238095  0.3180000000  0.3015873016  0.3569277108  0.3554216867  0.2003012048  0.1987951807  0.3269841270  30.600000000  0.0012565645  1.1484846473  0.0587058067  450           0.0337713623
0.3340000000  0.3174603175  0.3180000000  0.3095238095  0.3599397590  0.3554216867  0.2003012048  0.1987951807  0.3253968254  34.000000000  0.0013102492  1.1459111071  0.0587058067  500           0.0347025919
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 37
	normlizetype: 0-1
	output_dir: train_output/8d83223f96ad67a8fec9f7aff27f83fb
	save_model_every_checkpoint: False
	seed: 371222437
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	ib_lambda: 18.163391243007602
	ib_penalty_anneal_iters: 455
	irm_lambda: 183.6920331087705
	irm_penalty_anneal_iters: 70
	lr: 8.122386866890388e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.00010895616253593228
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0229928121  -0.009958196  0.3240000000  0.3174603175  0.3080000000  0.3253968254  0.3539156627  0.3915662651  0.5135542169  0.4879518072  0.3222222222  0.0000000000  1.0615237951  0.0210933685  1.0615237951  0             0.3235850334
0.0302883077  0.0097221388  0.5680000000  0.5158730159  0.4780000000  0.4920634921  0.7454819277  0.7168674699  0.8343373494  0.8313253012  0.5253968254  1.1000000000  0.9852972329  0.0282964706  0.9852972329  50            0.0182367706
0.0587002305  0.0140330836  0.6740000000  0.6428571429  0.6580000000  0.6269841270  0.7831325301  0.7590361446  0.6686746988  0.6987951807  0.6841269841  2.2000000000  1.7195779228  0.0282964706  1.7195779228  100           0.0170405769
0.0644826121  0.0110547367  0.6060000000  0.5396825397  0.6080000000  0.6111111111  0.6837349398  0.6626506024  0.6957831325  0.7108433735  0.6000000000  3.3000000000  2.8104063094  0.0282964706  2.8104063094  150           0.0177088070
0.0612898279  -0.003692471  0.6720000000  0.6507936508  0.6360000000  0.6428571429  0.6777108434  0.6987951807  0.4126506024  0.3975903614  0.6412698413  4.4000000000  0.1574281001  0.0282964706  0.1574281001  200           0.0176301861
0.0524921832  0.0111772374  0.4820000000  0.4047619048  0.5400000000  0.5396825397  0.7259036145  0.6746987952  0.6024096386  0.6265060241  0.4190476190  5.5000000000  2.9249971271  0.0282964706  2.9249971271  250           0.0173174763
0.0394183742  0.0013771344  0.5140000000  0.3888888889  0.5440000000  0.5238095238  0.7409638554  0.6746987952  0.6762048193  0.7289156627  0.4000000000  6.6000000000  1.2020715582  0.0282964706  1.2020715582  300           0.0173969555
0.0402133975  0.0032056807  0.5440000000  0.5158730159  0.5580000000  0.5476190476  0.6566265060  0.6626506024  0.3990963855  0.4156626506  0.4603174603  7.7000000000  1.5222627592  0.0282964706  1.5222627592  350           0.0174342346
0.0397398346  0.0011243176  0.5460000000  0.5238095238  0.5500000000  0.5238095238  0.6581325301  0.6445783133  0.4759036145  0.4819277108  0.4936507937  8.8000000000  1.1550069010  0.0282964706  1.1550069010  400           0.0164213562
0.0410516047  -0.001897651  0.6200000000  0.5952380952  0.5300000000  0.5793650794  0.7243975904  0.7168674699  0.5572289157  0.5903614458  0.5365079365  9.9000000000  0.5929581606  0.0282964706  0.5929581606  450           0.0177995348
0.0384596577  0.0019919103  0.6660000000  0.6507936508  0.6180000000  0.6111111111  0.6987951807  0.6987951807  0.4759036145  0.4457831325  0.6285714286  11.000000000  1.9303878498  0.0282964706  1.9303878498  500           0.0178942347
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 12
	normlizetype: 0-1
	output_dir: train_output/7af19fe9456c72aadf5c553f9a517099
	save_model_every_checkpoint: False
	seed: 596320502
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1310.1003762743412
	ib_penalty_anneal_iters: 308
	irm_lambda: 7628.050781589325
	irm_penalty_anneal_iters: 15
	lr: 0.0002779717688784654
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.0006183744461455339
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0231142398  0.0053324532  0.3700000000  0.3809523810  0.3520000000  0.3412698413  0.3478915663  0.3433734940  0.3328313253  0.3313253012  0.4079365079  0.0000000000  1.1486814022  0.0621557236  1.1486814022  0             0.3165893555
0.0439542284  0.0122658027  0.5200000000  0.5079365079  0.5420000000  0.5476190476  0.6596385542  0.5783132530  0.6716867470  0.6506024096  0.5317460317  3.7000000000  80.045310974  0.0687260628  80.045310974  50            0.0183011246
0.0355732370  0.0002046497  0.5540000000  0.5396825397  0.5340000000  0.5079365079  0.7349397590  0.6867469880  0.6957831325  0.6626506024  0.5126984127  7.4000000000  2.5055398798  0.0687260628  2.5055398798  100           0.0188542843
0.0353447222  0.0004825858  0.4460000000  0.4523809524  0.4580000000  0.4365079365  0.6415662651  0.5662650602  0.6024096386  0.6265060241  0.4063492063  11.100000000  4.6407186174  0.0687260628  4.6407186174  150           0.0181682825
0.0321829136  0.0015053351  0.4740000000  0.4920634921  0.4780000000  0.4126984127  0.5903614458  0.5180722892  0.6009036145  0.6807228916  0.4809523810  14.800000000  12.475996677  0.0687260628  12.475996677  200           0.0196377230
0.0308287304  0.0014493668  0.4340000000  0.4047619048  0.5320000000  0.5079365079  0.5707831325  0.5120481928  0.5602409639  0.6144578313  0.4730158730  18.500000000  12.057658429  0.0687260628  12.057658429  250           0.0179260111
0.0220803967  0.0001113283  0.2760000000  0.2857142857  0.3400000000  0.3333333333  0.5045180723  0.4759036145  0.5617469880  0.5963855422  0.2936507937  22.200000000  1.8779133129  0.0687260628  1.8779133129  300           0.0176918459
0.0121015623  0.0008363601  0.3480000000  0.3650793651  0.3500000000  0.2936507937  0.5888554217  0.5240963855  0.6355421687  0.6265060241  0.3222222222  25.900000000  19.262831363  0.0687260628  19.262831363  350           0.0186861849
0.0013744662  0.0000819940  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3192771084  0.2289156627  0.3012048193  0.2650602410  0.3349206349  29.600000000  3.5190998697  0.0687260628  3.5190998697  400           0.0182293844
0.0005563610  0.0000231757  0.3360000000  0.3333333333  0.3380000000  0.3333333333  0.3298192771  0.3313253012  0.4382530120  0.4397590361  0.3365079365  33.300000000  2.0020933270  0.0687260628  2.0020933270  450           0.0178316832
0.0003226251  -0.000000953  0.3460000000  0.3412698413  0.3480000000  0.3333333333  0.3253012048  0.3132530120  0.2816265060  0.2710843373  0.3460317460  37.000000000  1.5135015917  0.0687260628  1.5135015917  500           0.0182759666
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 2
	normlizetype: 0-1
	output_dir: train_output/947f45bf27116ab9ddaec54e231d9e74
	save_model_every_checkpoint: False
	seed: 1116634306
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 25
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.3521685892612245
	gda: True
	lr: 3.207929136369226e-05
	lr_d: 6.269632842201235e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 5.089108187638736
	weight_decay: 0.005100223533962902
	weight_decay_d: 0.004188460570199925
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3317460317  0.0000000000  1.5775946379  1.2480089664  0.0438494682  0             0.3715972900
0.3360000000  0.3253968254  0.3300000000  0.3333333333  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  2.5000000000  1.3549004096  1.2763007355  0.0452179909  50            0.0474201155
0.3340000000  0.3253968254  0.3340000000  0.3333333333  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3253968254  5.0000000000  1.4624043876  1.2794695067  0.0452179909  100           0.0481842089
0.3340000000  0.3253968254  0.3340000000  0.3333333333  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  7.5000000000  1.2938882777  1.2761652350  0.0452179909  150           0.0502361155
0.3340000000  0.3253968254  0.3340000000  0.3412698413  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  10.000000000  1.4228125751  1.2773922515  0.0452179909  200           0.0481652737
0.3340000000  0.3253968254  0.3320000000  0.3412698413  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  12.500000000  1.3996653736  1.2626813197  0.0452179909  250           0.0481607533
0.3380000000  0.3253968254  0.3320000000  0.3412698413  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  15.000000000  1.4603095728  1.2712936640  0.0452179909  300           0.0491235781
0.3360000000  0.3253968254  0.3340000000  0.3333333333  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  17.500000000  1.4009744155  1.2689876318  0.0452179909  350           0.0481364536
0.3360000000  0.3253968254  0.3340000000  0.3333333333  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3253968254  20.000000000  1.3574902582  1.2694197917  0.0452179909  400           0.0483381081
0.3360000000  0.3253968254  0.3320000000  0.3412698413  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  22.500000000  1.4820748973  1.2744187474  0.0452179909  450           0.0483168507
0.3340000000  0.3253968254  0.3320000000  0.3412698413  0.3313253012  0.3253012048  0.2243975904  0.2228915663  0.3269841270  25.000000000  1.3129281008  1.2761915231  0.0452179909  500           0.0484071159
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 44
	normlizetype: 0-1
	output_dir: train_output/5bd71e833d858489cc1175cdd5b645df
	save_model_every_checkpoint: False
	seed: 2080446661
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.9023298649109041
	ib_penalty_anneal_iters: 2868
	irm_lambda: 24.41573636767335
	irm_penalty_anneal_iters: 511
	lr: 8.785759245690127e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.4986321472569955e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0260341987  0.0320749134  0.3440000000  0.3333333333  0.3520000000  0.3571428571  0.2409638554  0.2289156627  0.3825301205  0.4337349398  0.3460317460  0.0000000000  1.2279156446  0.0210933685  1.2279156446  0             0.3408257961
0.0299349498  0.0094826583  0.6060000000  0.5952380952  0.5520000000  0.5873015873  0.7605421687  0.7530120482  0.7680722892  0.7469879518  0.5809523810  1.1000000000  0.9685709107  0.0282964706  0.9685709107  50            0.0170728827
0.0879384437  0.0153668543  0.6820000000  0.7063492063  0.6940000000  0.6666666667  0.8102409639  0.7590361446  0.8509036145  0.8373493976  0.6571428571  2.2000000000  0.6894768441  0.0282964706  0.6894768441  100           0.0188046360
0.1595042802  0.0096453957  0.7920000000  0.7857142857  0.7540000000  0.7222222222  0.8674698795  0.8192771084  0.8765060241  0.8674698795  0.6603174603  3.3000000000  0.5169072163  0.0282964706  0.5169072163  150           0.0169946527
0.2147684669  0.0157569646  0.8740000000  0.8174603175  0.8020000000  0.7698412698  0.9186746988  0.8433734940  0.9457831325  0.9156626506  0.6619047619  4.4000000000  0.4402285987  0.0282964706  0.4402285987  200           0.0178128815
0.2675563821  0.0083655617  0.8460000000  0.7777777778  0.7760000000  0.6904761905  0.9292168675  0.8734939759  0.9322289157  0.9216867470  0.6396825397  5.5000000000  0.3699793756  0.0282964706  0.3699793756  250           0.0177009296
0.3203911683  0.0035978059  0.9300000000  0.8492063492  0.9040000000  0.7936507937  0.9397590361  0.8795180723  1.0000000000  1.0000000000  0.6365079365  6.6000000000  0.3275211006  0.0282964706  0.3275211006  300           0.0174269915
0.3548624033  0.0062576842  0.8820000000  0.8412698413  0.8580000000  0.7539682540  0.9322289157  0.8855421687  0.9743975904  0.9457831325  0.4904761905  7.7000000000  0.2808790991  0.0282964706  0.2808790991  350           0.0171581841
0.4059566802  0.0057252221  0.9500000000  0.8968253968  0.9480000000  0.8333333333  0.9849397590  0.9638554217  0.9954819277  0.9939759036  0.6047619048  8.8000000000  0.2556666091  0.0282964706  0.2556666091  400           0.0175413847
0.4411714870  0.0064340216  0.9780000000  0.9206349206  0.9700000000  0.8571428571  0.9834337349  0.9578313253  0.9984939759  0.9939759036  0.5412698413  9.9000000000  0.2052372454  0.0282964706  0.2052372454  450           0.0175141191
0.4808204079  0.0068346091  0.9840000000  0.8888888889  0.9700000000  0.8730158730  0.9849397590  0.9759036145  0.9984939759  0.9939759036  0.5746031746  11.000000000  0.1761499213  0.0282964706  0.1761499213  500           0.0174993515
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 4
	normlizetype: 0-1
	output_dir: train_output/c45ea498e152142b0eec53a8292836e8
	save_model_every_checkpoint: False
	seed: 367224568
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2.681217153200234
	gda: True
	lr: 1.4524944240203903e-05
	lr_d: 0.00217162506584862
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.03428936266887475
	weight_decay: 6.326696718610415e-06
	weight_decay_d: 2.1080017465121002e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3160000000  0.3015873016  0.2980000000  0.3015873016  0.4533132530  0.4518072289  0.3253012048  0.3012048193  0.3507936508  0.0000000000  0.0058804369  1.1481896639  0.0320668221  0             0.3972625732
0.3240000000  0.3015873016  0.3140000000  0.2936507937  0.4503012048  0.4518072289  0.3147590361  0.2951807229  0.3428571429  1.8000000000  0.0054049135  1.1345760942  0.0348973274  50            0.0796247292
0.3280000000  0.3095238095  0.3180000000  0.3174603175  0.4337349398  0.4578313253  0.3147590361  0.2951807229  0.3476190476  3.6000000000  0.0048733027  1.1433322549  0.0348973274  100           0.0820767021
0.3260000000  0.3015873016  0.3180000000  0.3015873016  0.4382530120  0.4518072289  0.3147590361  0.2951807229  0.3444444444  5.4000000000  0.0056230728  1.1308122873  0.0348973274  150           0.0829972219
0.3240000000  0.3095238095  0.3200000000  0.3174603175  0.4397590361  0.4457831325  0.3207831325  0.2951807229  0.3460317460  7.2000000000  0.0055155261  1.1307982588  0.0348973274  200           0.0824764681
0.3300000000  0.3015873016  0.3180000000  0.3174603175  0.4337349398  0.4457831325  0.3207831325  0.2951807229  0.3460317460  9.0000000000  0.0055947245  1.1365329385  0.0348973274  250           0.0813982010
0.3260000000  0.3015873016  0.3200000000  0.3253968254  0.4367469880  0.4457831325  0.3147590361  0.2951807229  0.3507936508  10.800000000  0.0061320775  1.1379424787  0.0348973274  300           0.0814284706
0.3280000000  0.3095238095  0.3200000000  0.3095238095  0.4352409639  0.4518072289  0.3177710843  0.2951807229  0.3460317460  12.600000000  0.0057212626  1.1334247994  0.0348973274  350           0.0836410522
0.3320000000  0.3095238095  0.3220000000  0.3253968254  0.4367469880  0.4457831325  0.3207831325  0.2951807229  0.3476190476  14.400000000  0.0055025826  1.1396040130  0.0348973274  400           0.0838004923
0.3240000000  0.2936507937  0.3280000000  0.3253968254  0.4382530120  0.4518072289  0.3222891566  0.3012048193  0.3523809524  16.200000000  0.0051038724  1.1299727297  0.0348973274  450           0.0835261059
0.3260000000  0.3095238095  0.3240000000  0.3253968254  0.4367469880  0.4457831325  0.3207831325  0.2951807229  0.3507936508  18.000000000  0.0051477694  1.1399682570  0.0348973274  500           0.0812115049
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 1
	normlizetype: 0-1
	output_dir: train_output/072efc4fa3d11b8b9e01c30951d5c827
	save_model_every_checkpoint: False
	seed: 1841667674
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.702212143805776
	gda: True
	lr: 1.1906162909279581e-05
	lr_d: 6.700771289296927e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.26535225943004515
	weight_decay: 0.00044832883881609976
	weight_decay_d: 0.00010096814830489473
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3420000000  0.3968253968  0.3440000000  0.3253968254  0.3433734940  0.3373493976  0.4518072289  0.4457831325  0.3238095238  0.0000000000  0.0251637753  1.1622054577  0.0650110245  0             0.3397629261
0.3440000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3365079365  3.9000000000  0.0320655788  1.1249633884  0.0656800270  50            0.0334737396
0.3460000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3333333333  7.8000000000  0.0305297489  1.1182079530  0.0656800270  100           0.0342367935
0.3460000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3349206349  11.700000000  0.0294369755  1.1155456090  0.0656800270  150           0.0337821436
0.3420000000  0.3650793651  0.3380000000  0.3095238095  0.3343373494  0.3253012048  0.4713855422  0.4518072289  0.3365079365  15.600000000  0.0320512816  1.1199042058  0.0656800270  200           0.0342871189
0.3460000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3349206349  19.500000000  0.0314230044  1.1169104552  0.0656800270  250           0.0330105734
0.3440000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3349206349  23.400000000  0.0318295582  1.1163520575  0.0656800270  300           0.0328507710
0.3460000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4683734940  0.4518072289  0.3349206349  27.300000000  0.0302442804  1.1202972889  0.0656800270  350           0.0333087587
0.3460000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3349206349  31.200000000  0.0315909463  1.1154470205  0.0656800270  400           0.0337243795
0.3440000000  0.3650793651  0.3380000000  0.3095238095  0.3313253012  0.3253012048  0.4713855422  0.4518072289  0.3365079365  35.100000000  0.0315209973  1.1209215522  0.0656800270  450           0.0359916449
0.3440000000  0.3650793651  0.3380000000  0.3174603175  0.3313253012  0.3253012048  0.4683734940  0.4518072289  0.3333333333  39.000000000  0.0314901252  1.1211207533  0.0656800270  500           0.0344824791
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 42
	normlizetype: 0-1
	output_dir: train_output/ef9588edaddf6d3e1451daa7ae366f6a
	save_model_every_checkpoint: False
	seed: 1248113699
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.9028372395534956
	gda: True
	lr: 9.421443606372291e-06
	lr_d: 0.00013694777472892744
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 7.514624572765864
	weight_decay: 9.220948243966033e-05
	weight_decay_d: 0.002961445807195283
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3560000000  0.3968253968  0.3120000000  0.3174603175  0.3388554217  0.3313253012  0.2635542169  0.2469879518  0.3460317460  0.0000000000  1.5148468018  1.1574615240  0.0337662697  0             0.3960220814
0.3440000000  0.3968253968  0.3300000000  0.3095238095  0.3780120482  0.3795180723  0.3087349398  0.3433734940  0.3079365079  1.9000000000  1.3614540786  1.1459537053  0.0366406441  50            0.0349791384
0.3440000000  0.3968253968  0.3300000000  0.3095238095  0.3765060241  0.3734939759  0.3027108434  0.3433734940  0.3095238095  3.8000000000  1.3531981963  1.1432350540  0.0366406441  100           0.0330031300
0.3380000000  0.3968253968  0.3300000000  0.3015873016  0.3719879518  0.3795180723  0.3042168675  0.3493975904  0.3063492063  5.7000000000  1.3673185050  1.1515566969  0.0366406441  150           0.0363080120
0.3480000000  0.3888888889  0.3280000000  0.3015873016  0.3734939759  0.3734939759  0.3057228916  0.3433734940  0.3079365079  7.6000000000  1.2579705548  1.1509273195  0.0366406441  200           0.0393933153
0.3460000000  0.3888888889  0.3320000000  0.3095238095  0.3765060241  0.3855421687  0.3057228916  0.3433734940  0.3063492063  9.5000000000  1.1971639082  1.1394893408  0.0366406441  250           0.0345569086
0.3440000000  0.3888888889  0.3320000000  0.3095238095  0.3765060241  0.3734939759  0.3027108434  0.3433734940  0.3079365079  11.400000000  1.4663735956  1.1509394240  0.0366406441  300           0.0394822884
0.3360000000  0.3888888889  0.3340000000  0.3174603175  0.3795180723  0.3734939759  0.3012048193  0.3493975904  0.3031746032  13.300000000  1.5121580052  1.1492059588  0.0366406441  350           0.0369435549
0.3420000000  0.3968253968  0.3320000000  0.3015873016  0.3719879518  0.3795180723  0.2996987952  0.3433734940  0.3063492063  15.200000000  1.3401792198  1.1565612435  0.0366406441  400           0.0363950491
0.3420000000  0.3968253968  0.3300000000  0.3095238095  0.3734939759  0.3734939759  0.3012048193  0.3493975904  0.3095238095  17.100000000  1.2895142671  1.1465491390  0.0366406441  450           0.0356845760
0.3460000000  0.3888888889  0.3260000000  0.3015873016  0.3734939759  0.3734939759  0.2996987952  0.3433734940  0.3095238095  19.000000000  1.3616961586  1.1577340746  0.0366406441  500           0.0327987003
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 1
	normlizetype: 0-1
	output_dir: train_output/df221520a54d74aec55584a9ac6eabc0
	save_model_every_checkpoint: False
	seed: 1050501260
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	class_balanced: False
	data_augmentation: True
	ib_lambda: 2.661822006035993
	ib_penalty_anneal_iters: 1222
	irm_lambda: 65030.52212762795
	irm_penalty_anneal_iters: 2
	lr: 1.1906162909279581e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.00044832883881609976
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0228431374  0.0030782805  0.3560000000  0.3333333333  0.3400000000  0.3253968254  0.3237951807  0.3554216867  0.3780120482  0.3795180723  0.3380952381  0.0000000000  1.1302827597  0.0650520325  1.1302827597  0             0.3203823566
0.0223278184  0.0003328916  0.4380000000  0.3730158730  0.4340000000  0.4444444444  0.4457831325  0.4819277108  0.3418674699  0.3554216867  0.4412698413  3.9000000000  18.453152222  0.0705394745  18.453152222  50            0.0194734907
0.0217575975  -0.000088604  0.4340000000  0.4047619048  0.4020000000  0.3968253968  0.4548192771  0.4457831325  0.3629518072  0.3795180723  0.4349206349  7.8000000000  -4.675462369  0.0705394745  -4.675462369  100           0.0182336187
0.0216439385  -0.000031076  0.3980000000  0.3888888889  0.3620000000  0.3571428571  0.4036144578  0.3855421687  0.3584337349  0.3614457831  0.3746031746  11.700000000  -0.934230588  0.0705394745  -0.934230588  150           0.0177007198
0.0219724339  -0.000018426  0.4140000000  0.3809523810  0.3700000000  0.3650793651  0.3584337349  0.3614457831  0.3313253012  0.3493975904  0.4015873016  15.600000000  -0.115336530  0.0705394745  -0.115336530  200           0.0196159506
0.0224004626  -0.000175217  0.3820000000  0.3571428571  0.3580000000  0.3412698413  0.3509036145  0.3433734940  0.3403614458  0.3373493976  0.3428571429  19.500000000  -10.31281591  0.0705394745  -10.31281591  250           0.0173465347
0.0224732428  0.0001038775  0.4240000000  0.4365079365  0.4080000000  0.3809523810  0.4759036145  0.4939759036  0.3885542169  0.3975903614  0.3920634921  23.400000000  7.8318771124  0.0705394745  7.8318771124  300           0.0188161707
0.0219393810  0.0000343618  0.4060000000  0.4047619048  0.3700000000  0.3571428571  0.3554216867  0.3493975904  0.3493975904  0.3373493976  0.3634920635  27.300000000  3.3151995087  0.0705394745  3.3151995087  350           0.0183299398
0.0220657505  -0.000145961  0.3920000000  0.3968253968  0.3600000000  0.3412698413  0.3509036145  0.3433734940  0.3463855422  0.3373493976  0.3428571429  31.200000000  -8.414439306  0.0705394745  -8.414439306  400           0.0174476004
0.0223017888  -0.000152257  0.4140000000  0.4047619048  0.3680000000  0.3492063492  0.3810240964  0.3674698795  0.3493975904  0.3493975904  0.3714285714  35.100000000  -8.827551755  0.0705394745  -8.827551755  450           0.0179792881
0.0222203439  -0.000018879  0.4160000000  0.3968253968  0.3660000000  0.3492063492  0.3644578313  0.3493975904  0.3463855422  0.3373493976  0.3523809524  39.000000000  -0.154607362  0.0705394745  -0.154607362  500           0.0188238001
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 45
	normlizetype: 0-1
	output_dir: train_output/6d202a0a786acff964f648ff17d26be2
	save_model_every_checkpoint: False
	seed: 232481615
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	lr: 8.92658249908763e-06
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.003607553785079441
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3560000000  0.3333333333  0.3520000000  0.3412698413  0.4126506024  0.4216867470  0.4367469880  0.4698795181  0.4015873016  0.0000000000  1.1004199982  0.0174822807  0             0.3807313442
0.3820000000  0.3571428571  0.3800000000  0.3809523810  0.4277108434  0.4578313253  0.3795180723  0.4939759036  0.4047619048  1.3000000000  1.1019126093  0.0237894058  50            0.0405877876
0.3600000000  0.3412698413  0.3740000000  0.3650793651  0.4337349398  0.4698795181  0.4096385542  0.4939759036  0.3888888889  2.6000000000  1.0967259908  0.0237894058  100           0.0404272556
0.3640000000  0.3333333333  0.3700000000  0.3730158730  0.4533132530  0.5000000000  0.3915662651  0.4819277108  0.3904761905  3.9000000000  1.1003998756  0.0237894058  150           0.0419310856
0.3760000000  0.3333333333  0.3780000000  0.3730158730  0.4924698795  0.4879518072  0.4201807229  0.5361445783  0.3936507937  5.2000000000  1.0786991239  0.0237894058  200           0.0432092905
0.3760000000  0.3333333333  0.3840000000  0.3730158730  0.5406626506  0.5481927711  0.4503012048  0.5722891566  0.3936507937  6.5000000000  1.0686133873  0.0237894058  250           0.0427526951
0.3820000000  0.3333333333  0.3900000000  0.3809523810  0.5722891566  0.5903614458  0.5075301205  0.5843373494  0.4047619048  7.8000000000  1.0560337007  0.0237894058  300           0.0422125006
0.3840000000  0.3492063492  0.3980000000  0.3888888889  0.5813253012  0.6024096386  0.5286144578  0.5722891566  0.4126984127  9.1000000000  1.0571838975  0.0237894058  350           0.0410765076
0.4060000000  0.3492063492  0.4000000000  0.3888888889  0.6084337349  0.5903614458  0.5632530120  0.5903614458  0.4190476190  10.400000000  1.0591808081  0.0237894058  400           0.0409862423
0.4120000000  0.3492063492  0.4060000000  0.3888888889  0.6204819277  0.6144578313  0.6024096386  0.6144578313  0.4269841270  11.700000000  1.0387318194  0.0237894058  450           0.0418973398
0.4160000000  0.3571428571  0.4040000000  0.3888888889  0.6234939759  0.6385542169  0.6250000000  0.6204819277  0.4222222222  13.000000000  1.0288301814  0.0237894058  500           0.0425364161
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 29
	normlizetype: 0-1
	output_dir: train_output/e7b332b7a294eb9209187f3c54321a36
	save_model_every_checkpoint: False
	seed: 223926794
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 30
	class_balanced: False
	data_augmentation: True
	ib_lambda: 6312.369086746944
	ib_penalty_anneal_iters: 2
	irm_lambda: 1.5928427358380803
	irm_penalty_anneal_iters: 766
	lr: 0.00026287121638468136
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.005149224998029627
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0279937238  0.0176773481  0.3200000000  0.2777777778  0.3320000000  0.3730158730  0.3147590361  0.3313253012  0.3569277108  0.3192771084  0.3904761905  0.0000000000  1.1905620098  0.0503883362  1.1905620098  0             0.3573560715
0.0019067125  0.0001691430  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  3.0000000000  10.028028595  0.0561728477  10.028028595  50            0.0185220432
0.0001000717  0.0000011935  0.3440000000  0.3333333333  0.3340000000  0.3412698413  0.3283132530  0.3253012048  0.3358433735  0.3433734940  0.3269841270  6.0000000000  1.7302056932  0.0561728477  1.7302056932  100           0.0183373117
0.0000410049  0.0000005442  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  9.0000000000  1.3567681193  0.0561728477  1.3567681193  150           0.0182182741
0.0000016872  0.0000026222  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  12.000000000  1.1083789229  0.0561728477  1.1083789229  200           0.0190928745
0.0000000345  0.0000043616  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  15.000000000  1.0978638506  0.0561728477  1.0978638506  250           0.0184219551
0.0000000135  0.0000124042  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  18.000000000  1.0966888714  0.0561728477  1.0966888714  300           0.0177177954
0.0000000158  0.0000025160  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  21.000000000  1.0973441553  0.0561728477  1.0973441553  350           0.0177045250
0.0000000860  0.0000139588  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  24.000000000  1.0979861808  0.0561728477  1.0979861808  400           0.0166655159
0.0000000103  0.0000327993  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  27.000000000  1.0962676716  0.0561728477  1.0962676716  450           0.0201976347
0.0000000000  0.0000030494  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  30.000000000  1.0970297265  0.0561728477  1.0970297265  500           0.0191085958
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 28
	normlizetype: 0-1
	output_dir: train_output/4789b1ffd6abcfdfc1a58f7e76179129
	save_model_every_checkpoint: False
	seed: 2077052119
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	class_balanced: False
	data_augmentation: True
	lr: 5.6004462478267e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0010077262711597086
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.2900000000  0.3095238095  0.3140000000  0.2857142857  0.3448795181  0.2951807229  0.1957831325  0.1686746988  0.2412698413  0.0000000000  1.2111265659  0.0201768875  0             0.3694245815
0.5860000000  0.5714285714  0.5660000000  0.5317460317  0.8298192771  0.8614457831  0.8539156627  0.8614457831  0.6349206349  2.0000000000  0.8418848956  0.0264840126  50            0.0387100840
0.7120000000  0.6904761905  0.6460000000  0.5952380952  0.8629518072  0.8614457831  0.8704819277  0.8674698795  0.6809523810  4.0000000000  0.4808610755  0.0264840126  100           0.0393072128
0.7920000000  0.7380952381  0.7620000000  0.6428571429  0.8930722892  0.8855421687  0.9653614458  0.9578313253  0.6761904762  6.0000000000  0.3517346007  0.0264840126  150           0.0392166519
0.8940000000  0.7698412698  0.8180000000  0.7301587302  0.8795180723  0.8915662651  0.9743975904  0.9457831325  0.6523809524  8.0000000000  0.2531199507  0.0264840126  200           0.0386056423
0.8960000000  0.8015873016  0.8300000000  0.6904761905  0.8930722892  0.8975903614  0.9819277108  0.9518072289  0.6825396825  10.000000000  0.1926891722  0.0264840126  250           0.0395360947
0.9340000000  0.8809523810  0.8600000000  0.7063492063  0.9262048193  0.9216867470  0.9879518072  0.9638554217  0.6190476190  12.000000000  0.1546980843  0.0264840126  300           0.0391731834
0.9500000000  0.8492063492  0.9160000000  0.7936507937  0.9006024096  0.9156626506  0.9894578313  0.9698795181  0.5936507937  14.000000000  0.1429930570  0.0264840126  350           0.0392872858
0.9720000000  0.9126984127  0.9180000000  0.7698412698  0.9352409639  0.9578313253  0.9984939759  0.9819277108  0.5952380952  16.000000000  0.1171672784  0.0264840126  400           0.0400181437
0.9780000000  0.9126984127  0.9420000000  0.8095238095  0.9743975904  0.9698795181  1.0000000000  0.9879518072  0.5238095238  18.000000000  0.0862774955  0.0264840126  450           0.0399489927
0.9700000000  0.9126984127  0.9560000000  0.8492063492  0.9472891566  0.9578313253  0.9984939759  0.9819277108  0.5904761905  20.000000000  0.0790475321  0.0264840126  500           0.0388186741
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 29
	normlizetype: 0-1
	output_dir: train_output/50494b42915f0c9c43660e2412c4e163
	save_model_every_checkpoint: False
	seed: 1787862803
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 30
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.8464043913036958
	gda: True
	lr: 0.00026287121638468136
	lr_d: 0.0014285250883683928
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 8.302446639814901
	weight_decay: 0.005149224998029627
	weight_decay_d: 3.220552377596373e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3080000000  0.3253968254  0.3540000000  0.3650793651  0.3027108434  0.2951807229  0.2153614458  0.2108433735  0.3253968254  0.0000000000  0.9112135768  1.1254087687  0.0503559113  0             0.4369976521
0.3100000000  0.2777777778  0.3620000000  0.3730158730  0.2846385542  0.2469879518  0.2243975904  0.1987951807  0.3126984127  3.0000000000  0.7153963408  1.1280808544  0.0519390106  50            0.0830204773
0.2960000000  0.2777777778  0.3580000000  0.3809523810  0.2906626506  0.2469879518  0.2289156627  0.2168674699  0.3142857143  6.0000000000  0.7920982677  1.1189066386  0.0519390106  100           0.0815391588
0.3080000000  0.2777777778  0.3640000000  0.3809523810  0.2921686747  0.2530120482  0.2259036145  0.2168674699  0.3095238095  9.0000000000  0.7687038380  1.1270236635  0.0519390106  150           0.0856264400
0.3000000000  0.2777777778  0.3660000000  0.3730158730  0.2966867470  0.2469879518  0.2289156627  0.2168674699  0.3142857143  12.000000000  0.8157722157  1.1251953650  0.0519390106  200           0.0844507408
0.3000000000  0.2857142857  0.3640000000  0.3809523810  0.2951807229  0.2530120482  0.2319277108  0.2289156627  0.3126984127  15.000000000  0.7574581569  1.1276715875  0.0519390106  250           0.0910850000
0.3040000000  0.2857142857  0.3600000000  0.3809523810  0.2951807229  0.2530120482  0.2274096386  0.2228915663  0.3095238095  18.000000000  0.7521678299  1.1270779300  0.0519390106  300           0.0866177082
0.3020000000  0.2936507937  0.3600000000  0.3730158730  0.2891566265  0.2530120482  0.2364457831  0.2349397590  0.3158730159  21.000000000  0.7743321040  1.1270390368  0.0519390106  350           0.0892667198
0.3000000000  0.2777777778  0.3660000000  0.3730158730  0.3027108434  0.2590361446  0.2364457831  0.2469879518  0.3047619048  24.000000000  0.8408449113  1.1214449048  0.0519390106  400           0.0884906960
0.3060000000  0.2698412698  0.3640000000  0.3730158730  0.2906626506  0.2469879518  0.2213855422  0.1987951807  0.3190476190  27.000000000  0.7616186127  1.1243942881  0.0519390106  450           0.0827546883
0.3040000000  0.2777777778  0.3600000000  0.3730158730  0.2936746988  0.2469879518  0.2243975904  0.1987951807  0.3174603175  30.000000000  0.7158531758  1.1224102235  0.0519390106  500           0.0824369001
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 22
	normlizetype: 0-1
	output_dir: train_output/0d936e1d4459463bc83b4dbe4dcb86bc
	save_model_every_checkpoint: False
	seed: 968753467
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	class_balanced: False
	data_augmentation: True
	lr: 0.00016412676305809594
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 5.166436845791644e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3220000000  0.3253968254  0.3240000000  0.3492063492  0.3283132530  0.3253012048  0.2198795181  0.2168674699  0.2809523810  0.0000000000  1.1230337620  0.0252666473  0             0.3613574505
0.5440000000  0.5000000000  0.4700000000  0.5079365079  0.7469879518  0.7469879518  0.8057228916  0.8493975904  0.5492063492  3.3000000000  0.9820400822  0.0323524475  50            0.0403804111
0.6540000000  0.6031746032  0.6000000000  0.5793650794  0.8237951807  0.8493975904  0.7635542169  0.7891566265  0.7333333333  6.6000000000  0.7944322133  0.0323524475  100           0.0400894213
0.6680000000  0.6507936508  0.6400000000  0.6031746032  0.8358433735  0.8614457831  0.7756024096  0.8132530120  0.7555555556  9.9000000000  0.6614049715  0.0323524475  150           0.0389061737
0.6600000000  0.6031746032  0.6300000000  0.5952380952  0.8614457831  0.8554216867  0.7906626506  0.8253012048  0.7380952381  13.200000000  0.5674722207  0.0323524475  200           0.0420472193
0.6740000000  0.6269841270  0.6400000000  0.6031746032  0.8795180723  0.8795180723  0.8313253012  0.8674698795  0.7333333333  16.500000000  0.4948380524  0.0323524475  250           0.0411585188
0.7020000000  0.6111111111  0.6600000000  0.6190476190  0.8840361446  0.8734939759  0.8478915663  0.8975903614  0.7238095238  19.800000000  0.4018619990  0.0323524475  300           0.0406814766
0.7540000000  0.6746031746  0.6760000000  0.6190476190  0.8719879518  0.8734939759  0.8900602410  0.9216867470  0.7476190476  23.100000000  0.3762669128  0.0323524475  350           0.0415020227
0.7600000000  0.6587301587  0.6920000000  0.6507936508  0.8825301205  0.8795180723  0.9201807229  0.9698795181  0.7063492063  26.400000000  0.3169501549  0.0323524475  400           0.0412796783
0.7800000000  0.6666666667  0.7080000000  0.6428571429  0.8975903614  0.9036144578  0.9503012048  0.9939759036  0.7031746032  29.700000000  0.2806741154  0.0323524475  450           0.0393653345
0.8020000000  0.6825396825  0.7280000000  0.6746031746  0.8945783133  0.9036144578  0.9623493976  0.9939759036  0.6936507937  33.000000000  0.2553241354  0.0323524475  500           0.0432297039
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 47
	normlizetype: 0-1
	output_dir: train_output/6e8a4bcbc2559278d8281b51097704bb
	save_model_every_checkpoint: False
	seed: 808789368
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 21
	class_balanced: False
	data_augmentation: True
	lr: 0.00018728400841352565
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.227783669831511e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3480000000  0.3650793651  0.3380000000  0.3412698413  0.3358433735  0.3313253012  0.4397590361  0.4457831325  0.3682539683  0.0000000000  0.9822193980  0.0205640793  0             0.4137406349
0.7460000000  0.6031746032  0.7220000000  0.6825396825  0.8554216867  0.8433734940  0.8057228916  0.8614457831  0.6634920635  2.1000000000  0.6116498846  0.0268712044  50            0.0411332607
0.8120000000  0.7460317460  0.7540000000  0.7142857143  0.8870481928  0.8975903614  0.9653614458  0.9698795181  0.7111111111  4.2000000000  0.2385457093  0.0268712044  100           0.0409343481
0.9080000000  0.8333333333  0.8240000000  0.7777777778  0.8960843373  0.8734939759  0.9894578313  0.9698795181  0.6428571429  6.3000000000  0.1453435653  0.0268712044  150           0.0395176697
0.9760000000  0.8571428571  0.9080000000  0.8412698413  0.8810240964  0.8493975904  0.9728915663  0.9638554217  0.5603174603  8.4000000000  0.0962749309  0.0268712044  200           0.0398272848
0.9840000000  0.9365079365  0.9560000000  0.8888888889  0.8569277108  0.8132530120  0.9698795181  0.9397590361  0.4650793651  10.500000000  0.0634521927  0.0268712044  250           0.0395694685
0.9540000000  0.8571428571  0.8860000000  0.8174603175  0.9638554217  0.9518072289  1.0000000000  1.0000000000  0.5492063492  12.600000000  0.0496246976  0.0268712044  300           0.0432618761
0.9960000000  0.9126984127  0.9800000000  0.8968253968  0.9066265060  0.8915662651  0.9969879518  0.9759036145  0.4968253968  14.700000000  0.0545305522  0.0268712044  350           0.0402244425
0.9520000000  0.8333333333  0.9200000000  0.8253968254  0.9939759036  0.9879518072  1.0000000000  1.0000000000  0.5380952381  16.800000000  0.0382600600  0.0268712044  400           0.0394376802
1.0000000000  0.9603174603  0.9960000000  0.9126984127  0.9442771084  0.9096385542  0.9969879518  0.9759036145  0.3730158730  18.900000000  0.0266368419  0.0268712044  450           0.0390051508
0.9780000000  0.8968253968  0.9440000000  0.8253968254  0.9939759036  0.9879518072  0.9984939759  0.9939759036  0.5158730159  21.000000000  0.0265566336  0.0268712044  500           0.0395870113
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 5
	normlizetype: 0-1
	output_dir: train_output/cdaae3e63685b84ad4a06118336a1824
	save_model_every_checkpoint: False
	seed: 992463217
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	lr: 2.396851744571906e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 7.934460670892474e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3140000000  0.3730158730  0.3000000000  0.3412698413  0.3418674699  0.3192771084  0.2319277108  0.2530120482  0.2396825397  0.0000000000  1.1826199293  0.0182523727  0             0.3437469006
0.4780000000  0.5158730159  0.5000000000  0.5238095238  0.7033132530  0.6807228916  0.8554216867  0.8554216867  0.5206349206  1.5000000000  1.0187841141  0.0245594978  50            0.0390830374
0.5600000000  0.5476190476  0.5360000000  0.5238095238  0.7605421687  0.7048192771  0.8689759036  0.8734939759  0.5841269841  3.0000000000  0.8490262485  0.0245594978  100           0.0399793911
0.6200000000  0.6031746032  0.5840000000  0.5714285714  0.8644578313  0.8795180723  0.8418674699  0.8253012048  0.6634920635  4.5000000000  0.6854952818  0.0245594978  150           0.0395988369
0.6420000000  0.6031746032  0.6040000000  0.5714285714  0.8750000000  0.8855421687  0.8237951807  0.8132530120  0.6936507937  6.0000000000  0.6094475538  0.0245594978  200           0.0406487274
0.6700000000  0.6507936508  0.6300000000  0.6111111111  0.8810240964  0.8975903614  0.8207831325  0.8012048193  0.7206349206  7.5000000000  0.5494325495  0.0245594978  250           0.0410247612
0.6980000000  0.6746031746  0.6480000000  0.6111111111  0.8870481928  0.8855421687  0.8765060241  0.8674698795  0.7380952381  9.0000000000  0.4917429948  0.0245594978  300           0.0425450945
0.7480000000  0.6984126984  0.6920000000  0.6349206349  0.8960843373  0.9096385542  0.8719879518  0.8493975904  0.7253968254  10.500000000  0.3987266839  0.0245594978  350           0.0392463493
0.7340000000  0.6587301587  0.7020000000  0.6190476190  0.9337349398  0.9036144578  0.8870481928  0.8614457831  0.6936507937  12.000000000  0.3630206531  0.0245594978  400           0.0409573841
0.7720000000  0.7222222222  0.7520000000  0.6428571429  0.8930722892  0.9216867470  0.9337349398  0.9277108434  0.7031746032  13.500000000  0.3459612647  0.0245594978  450           0.0423199940
0.8280000000  0.7777777778  0.7560000000  0.6666666667  0.9006024096  0.9277108434  0.9457831325  0.9397590361  0.6936507937  15.000000000  0.3033817792  0.0245594978  500           0.0412970591
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 32
	normlizetype: 0-1
	output_dir: train_output/77444d2027ac4688c8f1b7321d2fe957
	save_model_every_checkpoint: False
	seed: 753025805
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.6547904729246512
	gda: True
	lr: 1.183640744652948e-05
	lr_d: 0.0005145726873747254
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.40404663522942447
	weight_decay: 4.756462551889598e-05
	weight_decay_d: 0.005972279541486069
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3340000000  0.3333333333  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3269841270  0.0000000000  0.1866570264  1.2184140682  0.0304865837  0             0.3558812141
0.3340000000  0.3412698413  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3349206349  1.7000000000  0.0907855819  1.2173381233  0.0332732201  50            0.0341742706
0.3320000000  0.3412698413  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  3.4000000000  0.1029627497  1.2099364090  0.0332732201  100           0.0332986403
0.3320000000  0.3412698413  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  5.1000000000  0.0877668284  1.2180696726  0.0332732201  150           0.0346869850
0.3360000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  6.8000000000  0.0897487924  1.2179337430  0.0332732201  200           0.0351112890
0.3340000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3349206349  8.5000000000  0.0983188093  1.2085151172  0.0332732201  250           0.0343845367
0.3340000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3349206349  10.200000000  0.0888228726  1.2231559706  0.0332732201  300           0.0372168064
0.3320000000  0.3492063492  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  11.900000000  0.0964596557  1.2220279169  0.0332732201  350           0.0335204935
0.3340000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3349206349  13.600000000  0.0922792012  1.2192671633  0.0332732201  400           0.0346956778
0.3320000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  15.300000000  0.0929303552  1.2037091899  0.0332732201  450           0.0387306690
0.3320000000  0.3412698413  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.3365079365  17.000000000  0.0949771724  1.2111740112  0.0332732201  500           0.0336558008
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 17
	normlizetype: 0-1
	output_dir: train_output/f909deea26489ea112ca8610b9b1e1f9
	save_model_every_checkpoint: False
	seed: 677943803
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.0668026897302991
	gda: True
	lr: 3.6576986778443787e-06
	lr_d: 6.323104665766966e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 4.1317258463397035
	weight_decay: 2.9162717441192257e-05
	weight_decay_d: 0.00034840408378437686
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3060000000  0.3492063492  0.3480000000  0.3968253968  0.3192771084  0.2891566265  0.3298192771  0.3313253012  0.3158730159  0.0000000000  0.8600690961  1.2060331106  0.0304865837  0             0.3763504028
0.3100000000  0.3650793651  0.3460000000  0.3730158730  0.3147590361  0.3192771084  0.2891566265  0.2530120482  0.3333333333  1.7000000000  0.8290659848  1.1861934686  0.0332732201  50            0.0343688822
0.3120000000  0.3650793651  0.3460000000  0.3650793651  0.3057228916  0.3072289157  0.2891566265  0.2530120482  0.3317460317  3.4000000000  0.7845845234  1.1861194730  0.0332732201  100           0.0392160845
0.3120000000  0.3730158730  0.3460000000  0.3650793651  0.3072289157  0.3132530120  0.2906626506  0.2590361446  0.3285714286  5.1000000000  0.7824323574  1.1809484696  0.0332732201  150           0.0341147232
0.3100000000  0.3571428571  0.3480000000  0.3650793651  0.3102409639  0.3132530120  0.2891566265  0.2530120482  0.3253968254  6.8000000000  0.7786724302  1.1799362183  0.0332732201  200           0.0343946314
0.3120000000  0.3650793651  0.3500000000  0.3650793651  0.3102409639  0.3132530120  0.2891566265  0.2530120482  0.3333333333  8.5000000000  0.8696993783  1.1881134939  0.0332732201  250           0.0285078478
0.3140000000  0.3730158730  0.3440000000  0.3571428571  0.3072289157  0.3132530120  0.2891566265  0.2530120482  0.3301587302  10.200000000  0.8613022393  1.2042132449  0.0332732201  300           0.0299400711
0.3080000000  0.3730158730  0.3420000000  0.3730158730  0.3102409639  0.3132530120  0.2876506024  0.2590361446  0.3269841270  11.900000000  0.8883105418  1.1976072621  0.0332732201  350           0.0303147745
0.3140000000  0.3492063492  0.3460000000  0.3571428571  0.3072289157  0.3012048193  0.2891566265  0.2530120482  0.3333333333  13.600000000  0.8167754361  1.1847038388  0.0332732201  400           0.0320763445
0.3140000000  0.3492063492  0.3460000000  0.3571428571  0.3102409639  0.3132530120  0.2891566265  0.2530120482  0.3269841270  15.300000000  0.8394021678  1.1921217036  0.0332732201  450           0.0286450100
0.3120000000  0.3809523810  0.3460000000  0.3730158730  0.3057228916  0.3072289157  0.2876506024  0.2469879518  0.3285714286  17.000000000  0.8527849570  1.1791535592  0.0332732201  500           0.0325282526
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 14
	normlizetype: 0-1
	output_dir: train_output/030596882614dcbabffcdfb19784240e
	save_model_every_checkpoint: False
	seed: 1617422226
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	lr: 0.000224138265260081
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0001792475881200468
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3560000000  0.3174603175  0.3120000000  0.3492063492  0.2515060241  0.2590361446  0.3554216867  0.3855421687  0.3285714286  0.0000000000  1.0602225065  0.0164361000  0             0.3477525711
0.5480000000  0.4761904762  0.4920000000  0.5158730159  0.7168674699  0.6867469880  0.8207831325  0.8012048193  0.6238095238  0.8000000000  0.9208159971  0.0227432251  50            0.0377770567
0.6200000000  0.5317460317  0.5740000000  0.5714285714  0.8629518072  0.8373493976  0.7861445783  0.7951807229  0.6619047619  1.6000000000  0.7374510020  0.0227432251  100           0.0355472946
0.6560000000  0.6111111111  0.5880000000  0.5396825397  0.9036144578  0.8915662651  0.8283132530  0.8192771084  0.6968253968  2.4000000000  0.5822824311  0.0227432251  150           0.0354067707
0.7180000000  0.6428571429  0.6700000000  0.5793650794  0.9201807229  0.9096385542  0.8313253012  0.8313253012  0.7380952381  3.2000000000  0.5012054989  0.0227432251  200           0.0354569197
0.7540000000  0.6666666667  0.6960000000  0.5952380952  0.9096385542  0.8795180723  0.8629518072  0.8855421687  0.7317460317  4.0000000000  0.5101683447  0.0227432251  250           0.0359195232
0.7800000000  0.6746031746  0.7280000000  0.5952380952  0.9382530120  0.9216867470  0.9728915663  0.9397590361  0.7142857143  4.8000000000  0.4134785387  0.0227432251  300           0.0395937157
0.8160000000  0.7619047619  0.7480000000  0.6666666667  0.9638554217  0.9397590361  0.9412650602  0.9216867470  0.6746031746  5.6000000000  0.3421377963  0.0227432251  350           0.0357447958
0.8080000000  0.7222222222  0.7840000000  0.6507936508  0.9051204819  0.8734939759  0.9533132530  0.9337349398  0.6809523810  6.4000000000  0.2938955741  0.0227432251  400           0.0420008564
0.8760000000  0.8015873016  0.8120000000  0.6666666667  0.9472891566  0.9216867470  0.9819277108  0.9759036145  0.6603174603  7.2000000000  0.2419600198  0.0227432251  450           0.0386215162
0.9120000000  0.8095238095  0.8380000000  0.6825396825  0.9487951807  0.9156626506  0.9759036145  0.9518072289  0.6634920635  8.0000000000  0.2518286694  0.0227432251  500           0.0383542395
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 39
	normlizetype: 0-1
	output_dir: train_output/607ae65f1c5fccd0fa6d9e4c9429222c
	save_model_every_checkpoint: False
	seed: 862620606
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	class_balanced: False
	data_augmentation: True
	ib_lambda: 2025.0382368688713
	ib_penalty_anneal_iters: 54
	irm_lambda: 2803.207953424304
	irm_penalty_anneal_iters: 2812
	lr: 4.2493565572404076e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0009464542120224201
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0279392544  0.0045382380  0.2960000000  0.3809523810  0.3460000000  0.3571428571  0.4126506024  0.4578313253  0.5015060241  0.4759036145  0.4095238095  0.0000000000  1.1489760876  0.0604171753  1.1489760876  0             0.3219871521
0.0328046608  0.0078716399  0.5380000000  0.5873015873  0.5140000000  0.4920634921  0.7138554217  0.6987951807  0.7590361446  0.7349397590  0.5571428571  3.6000000000  0.9897113669  0.0665984154  0.9897113669  50            0.0168535566
0.0150068276  0.0062212508  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  7.2000000000  25.216451308  0.0665984154  25.216451308  100           0.0169721460
0.0008906129  0.0000875234  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  10.800000000  2.8994984913  0.0665984154  2.8994984913  150           0.0167919111
0.0004647744  0.0000750324  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  14.400000000  2.0397847629  0.0665984154  2.0397847629  200           0.0166460371
0.0003420429  0.0001511656  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  18.000000000  1.7914806151  0.0665984154  1.7914806151  250           0.0169324541
0.0002751398  0.0000783472  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  21.600000000  1.6562392068  0.0665984154  1.6562392068  300           0.0163602257
0.0002191423  0.0000375284  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  25.200000000  1.5408793736  0.0665984154  1.5408793736  350           0.0161904001
0.0001788622  -0.000011083  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  28.800000000  1.4594476724  0.0665984154  1.4594476724  400           0.0173930931
0.0001534111  0.0000424279  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  32.400000000  1.4074458933  0.0665984154  1.4074458933  450           0.0178280401
0.0001286822  0.0000200391  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  36.000000000  1.3575883389  0.0665984154  1.3575883389  500           0.0200591087
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 15
	normlizetype: 0-1
	output_dir: train_output/7165ba2db0c9cf7dc46792c0b7141bcd
	save_model_every_checkpoint: False
	seed: 567455439
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	class_balanced: False
	data_augmentation: True
	lr: 3.947537104470031e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0010784038403040138
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3420000000  0.3253968254  0.3380000000  0.3412698413  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3380952381  0.0000000000  1.0988134146  0.0197935104  0             0.3488395214
0.5460000000  0.5793650794  0.5520000000  0.5634920635  0.5496987952  0.5602409639  0.6475903614  0.6987951807  0.5174603175  1.9000000000  1.0287121856  0.0261006355  50            0.0397266912
0.5980000000  0.5873015873  0.5000000000  0.5000000000  0.7590361446  0.6987951807  0.7123493976  0.7530120482  0.4952380952  3.8000000000  0.9648884606  0.0261006355  100           0.0409775686
0.5960000000  0.6031746032  0.5200000000  0.5238095238  0.7861445783  0.7469879518  0.7274096386  0.7891566265  0.5095238095  5.7000000000  0.8870114934  0.0261006355  150           0.0434096479
0.6060000000  0.6031746032  0.5400000000  0.5158730159  0.7921686747  0.7710843373  0.7500000000  0.8072289157  0.5523809524  7.6000000000  0.8358652651  0.0261006355  200           0.0414431667
0.6060000000  0.6111111111  0.5440000000  0.5317460317  0.8057228916  0.7650602410  0.7771084337  0.8313253012  0.5920634921  9.5000000000  0.7737154114  0.0261006355  250           0.0407189465
0.6420000000  0.6507936508  0.5820000000  0.5793650794  0.8253012048  0.8072289157  0.7725903614  0.8253012048  0.6666666667  11.400000000  0.7349033737  0.0261006355  300           0.0398575687
0.6180000000  0.6031746032  0.5720000000  0.5714285714  0.8177710843  0.7891566265  0.7756024096  0.8253012048  0.6492063492  13.300000000  0.6726820540  0.0261006355  350           0.0401453972
0.6500000000  0.6190476190  0.5920000000  0.5793650794  0.8478915663  0.8614457831  0.7771084337  0.8313253012  0.6841269841  15.200000000  0.6167408764  0.0261006355  400           0.0397550440
0.6700000000  0.6587301587  0.6280000000  0.6111111111  0.8629518072  0.8734939759  0.7756024096  0.8253012048  0.7285714286  17.100000000  0.5905315024  0.0261006355  450           0.0388972425
0.6620000000  0.6111111111  0.6160000000  0.5793650794  0.8463855422  0.8554216867  0.7771084337  0.8313253012  0.7158730159  19.000000000  0.5315004569  0.0261006355  500           0.0394057608
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 18
	normlizetype: 0-1
	output_dir: train_output/cf6764ac048034b779ea914f6547ffd4
	save_model_every_checkpoint: False
	seed: 46373673
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.8655280609352687
	gda: True
	lr: 3.872163578520407e-06
	lr_d: 0.0005742394874017668
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.1688917199831298
	weight_decay: 0.0008766809489187495
	weight_decay_d: 0.001507505757017653
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3100000000  0.3253968254  0.2760000000  0.3174603175  0.3463855422  0.3493975904  0.4472891566  0.4156626506  0.3523809524  0.0000000000  0.0106168976  1.0706288815  0.0708212852  0             0.3475677967
0.3460000000  0.3412698413  0.2940000000  0.3492063492  0.3493975904  0.3373493976  0.4578313253  0.4457831325  0.3492063492  4.3000000000  0.0156821339  1.1096319175  0.0722379684  50            0.0467140579
0.3520000000  0.3412698413  0.2920000000  0.3571428571  0.3463855422  0.3373493976  0.4578313253  0.4457831325  0.3539682540  8.6000000000  0.0157058423  1.1084361243  0.0722379684  100           0.0480567217
0.3480000000  0.3412698413  0.2900000000  0.3492063492  0.3493975904  0.3373493976  0.4578313253  0.4457831325  0.3523809524  12.900000000  0.0143075335  1.1086689067  0.0722379684  150           0.0469753122
0.3460000000  0.3412698413  0.2940000000  0.3412698413  0.3509036145  0.3433734940  0.4578313253  0.4457831325  0.3507936508  17.200000000  0.0150148532  1.1101202631  0.0722379684  200           0.0472967339
0.3460000000  0.3412698413  0.2940000000  0.3412698413  0.3493975904  0.3373493976  0.4578313253  0.4457831325  0.3507936508  21.500000000  0.0157747780  1.1111889124  0.0722379684  250           0.0468020248
0.3440000000  0.3412698413  0.2980000000  0.3412698413  0.3539156627  0.3433734940  0.4578313253  0.4457831325  0.3507936508  25.800000000  0.0144198001  1.1094747281  0.0722379684  300           0.0470912504
0.3440000000  0.3412698413  0.2960000000  0.3492063492  0.3539156627  0.3433734940  0.4578313253  0.4457831325  0.3523809524  30.100000000  0.0145599286  1.1103222942  0.0722379684  350           0.0461711502
0.3420000000  0.3412698413  0.2960000000  0.3412698413  0.3509036145  0.3433734940  0.4578313253  0.4457831325  0.3507936508  34.400000000  0.0153316894  1.1066478848  0.0722379684  400           0.0473740101
0.3480000000  0.3412698413  0.2960000000  0.3412698413  0.3493975904  0.3373493976  0.4578313253  0.4457831325  0.3523809524  38.700000000  0.0150535962  1.1101437330  0.0722379684  450           0.0470648336
0.3440000000  0.3412698413  0.2960000000  0.3492063492  0.3539156627  0.3433734940  0.4578313253  0.4457831325  0.3507936508  43.000000000  0.0155915405  1.1089195967  0.0722379684  500           0.0466639996
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 35
	normlizetype: 0-1
	output_dir: train_output/f67cc08918dad5ee1c0f15a48620fc1c
	save_model_every_checkpoint: False
	seed: 8255819
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.3784085260152743
	gda: True
	lr: 4.048637909021825e-06
	lr_d: 0.002178137535466171
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.333910593499452
	weight_decay: 0.0027187287407379923
	weight_decay_d: 5.434120903221956e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3460000000  0.3095238095  0.3340000000  0.3333333333  0.2981927711  0.2650602410  0.3192771084  0.3493975904  0.3412698413  0.0000000000  0.0613387674  1.1495018005  0.0164556503  0             0.3841583729
0.3180000000  0.2777777778  0.3160000000  0.3333333333  0.2545180723  0.1987951807  0.3328313253  0.3072289157  0.3095238095  0.8000000000  0.0690203874  1.1284653783  0.0183744431  50            0.0395920181
0.3240000000  0.2857142857  0.3200000000  0.3412698413  0.2469879518  0.2048192771  0.3298192771  0.2831325301  0.3253968254  1.6000000000  0.0710520071  1.1434616351  0.0183744431  100           0.0374955559
0.3100000000  0.2698412698  0.3140000000  0.3174603175  0.2575301205  0.2228915663  0.3313253012  0.3012048193  0.3190476190  2.4000000000  0.0723053213  1.1329477739  0.0183744431  150           0.0378305340
0.3160000000  0.2698412698  0.3140000000  0.3333333333  0.2560240964  0.2048192771  0.3328313253  0.3072289157  0.3174603175  3.2000000000  0.0743994000  1.1398948550  0.0183744431  200           0.0373201609
0.3200000000  0.2777777778  0.3120000000  0.3333333333  0.2545180723  0.2108433735  0.3283132530  0.2891566265  0.3222222222  4.0000000000  0.0716641901  1.1274673355  0.0183744431  250           0.0372148371
0.3160000000  0.2698412698  0.3100000000  0.3412698413  0.2650602410  0.2289156627  0.3328313253  0.3192771084  0.3095238095  4.8000000000  0.0697368916  1.1337336707  0.0183744431  300           0.0370962334
0.3240000000  0.2698412698  0.3120000000  0.3333333333  0.2710843373  0.2289156627  0.3298192771  0.3313253012  0.3142857143  5.6000000000  0.0782105520  1.1442862272  0.0183744431  350           0.0374421597
0.3220000000  0.2777777778  0.3160000000  0.3333333333  0.2695783133  0.2228915663  0.3358433735  0.3192771084  0.3238095238  6.4000000000  0.0708333681  1.1343228912  0.0183744431  400           0.0439312220
0.3080000000  0.2777777778  0.3160000000  0.3253968254  0.2575301205  0.2228915663  0.3283132530  0.3132530120  0.3079365079  7.2000000000  0.0754110767  1.1345744014  0.0183744431  450           0.0393832588
0.3200000000  0.2777777778  0.3140000000  0.3333333333  0.2560240964  0.2168674699  0.3358433735  0.3192771084  0.3111111111  8.0000000000  0.0739877454  1.1334264803  0.0183744431  500           0.0414663935
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 10
	normlizetype: 0-1
	output_dir: train_output/6c670f173153d04019a88c195bbdfaec
	save_model_every_checkpoint: False
	seed: 1949551643
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.9872179145699788
	gda: True
	lr: 2.8201039162457077e-05
	lr_d: 3.436669112309501e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 1.2272387960016777
	weight_decay: 3.538451007661713e-05
	weight_decay_d: 1.4922332054967898e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3800000000  0.3412698413  0.3460000000  0.3730158730  0.3509036145  0.3554216867  0.5376506024  0.5000000000  0.3507936508  0.0000000000  0.0695222542  1.1074222326  0.0179972649  0             0.3784728050
0.3960000000  0.3253968254  0.3620000000  0.3412698413  0.3343373494  0.3253012048  0.5421686747  0.4939759036  0.3619047619  0.9000000000  0.1523937403  1.0955409217  0.0203423500  50            0.0773071384
0.3940000000  0.3174603175  0.3660000000  0.3492063492  0.3448795181  0.3313253012  0.5466867470  0.5120481928  0.3571428571  1.8000000000  0.1332364010  1.0984609127  0.0203423500  100           0.0772101831
0.3980000000  0.3333333333  0.3660000000  0.3571428571  0.3283132530  0.3253012048  0.5316265060  0.4879518072  0.3619047619  2.7000000000  0.1438434555  1.0991723967  0.0203423500  150           0.0814398289
0.3860000000  0.3253968254  0.3620000000  0.3412698413  0.3373493976  0.3373493976  0.5406626506  0.5120481928  0.3619047619  3.6000000000  0.1454724436  1.1024346781  0.0203423500  200           0.0749541855
0.3980000000  0.3333333333  0.3720000000  0.3492063492  0.3433734940  0.3373493976  0.5225903614  0.5000000000  0.3666666667  4.5000000000  0.1401691584  1.1009838295  0.0203423500  250           0.0772925854
0.3900000000  0.3333333333  0.3580000000  0.3412698413  0.3268072289  0.3433734940  0.5376506024  0.5000000000  0.3571428571  5.4000000000  0.1562184575  1.1025425482  0.0203423500  300           0.0748868132
0.4000000000  0.3333333333  0.3760000000  0.3412698413  0.3493975904  0.3373493976  0.5271084337  0.4939759036  0.3492063492  6.3000000000  0.1350406487  1.0975289869  0.0203423500  350           0.0758277225
0.3940000000  0.3253968254  0.3660000000  0.3492063492  0.3358433735  0.3433734940  0.5406626506  0.4879518072  0.3634920635  7.2000000000  0.1341406704  1.1032052875  0.0203423500  400           0.0752521896
0.3940000000  0.3174603175  0.3660000000  0.3492063492  0.3448795181  0.3313253012  0.5481927711  0.5180722892  0.3539682540  8.1000000000  0.1570388748  1.1052372718  0.0203423500  450           0.0741734886
0.4000000000  0.3333333333  0.3680000000  0.3412698413  0.3313253012  0.3253012048  0.5316265060  0.5000000000  0.3666666667  9.0000000000  0.1360938452  1.1025635934  0.0203423500  500           0.0763971758
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 27
	normlizetype: 0-1
	output_dir: train_output/c1d0457ed2aee62424c43320c0ad8bb5
	save_model_every_checkpoint: False
	seed: 1144487390
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	ib_lambda: 4.165748397390866
	ib_penalty_anneal_iters: 958
	irm_lambda: 4067.908067811791
	irm_penalty_anneal_iters: 317
	lr: 6.439485988956746e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 4.594913877597109e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0168539640  0.0182077661  0.4320000000  0.4206349206  0.3900000000  0.3650793651  0.3343373494  0.3253012048  0.3358433735  0.3192771084  0.5000000000  0.0000000000  1.2347263098  0.0226345062  1.2347263098  0             0.3209223747
0.0225818096  0.0058291012  0.5260000000  0.4761904762  0.4420000000  0.4603174603  0.8027108434  0.7650602410  0.8072289157  0.7710843373  0.5539682540  1.2000000000  1.0161486220  0.0302786827  1.0161486220  50            0.0178593302
0.0595871543  0.0205095409  0.6160000000  0.5396825397  0.6100000000  0.5634920635  0.8147590361  0.8012048193  0.8524096386  0.8313253012  0.6571428571  2.4000000000  0.7848418450  0.0302786827  0.7848418450  100           0.0175139046
0.1147807668  0.0185171117  0.6840000000  0.6269841270  0.7000000000  0.6269841270  0.8328313253  0.8132530120  0.8750000000  0.8493975904  0.7396825397  3.6000000000  0.6043469441  0.0302786827  0.6043469441  150           0.0170539045
0.1746219137  0.0111687245  0.7980000000  0.6666666667  0.7520000000  0.6904761905  0.8599397590  0.8373493976  0.8674698795  0.8433734940  0.6793650794  4.8000000000  0.5023112965  0.0302786827  0.5023112965  200           0.0176963139
0.2333517063  0.0152925140  0.8480000000  0.7619047619  0.7980000000  0.6825396825  0.8870481928  0.8734939759  0.8704819277  0.8674698795  0.5714285714  6.0000000000  0.4493625605  0.0302786827  0.4493625605  250           0.0169078493
0.2732526582  0.0075222575  0.8880000000  0.8095238095  0.8040000000  0.6984126984  0.9548192771  0.9036144578  0.9186746988  0.9036144578  0.6952380952  7.2000000000  0.3665466011  0.0302786827  0.3665466011  300           0.0182339573
0.3491721499  0.0101921359  0.8340000000  0.7619047619  0.7900000000  0.6825396825  0.8795180723  0.8795180723  0.8313253012  0.8072289157  0.6841269841  8.4000000000  24.876452214  0.0302786827  24.876452214  350           0.0176029444
0.3387026501  0.0097332293  0.8580000000  0.7460317460  0.8520000000  0.7301587302  0.8945783133  0.8795180723  0.8253012048  0.8313253012  0.6634920635  9.6000000000  39.983651158  0.0302786827  39.983651158  400           0.0167164135
0.2945979345  0.0079541768  0.8300000000  0.7460317460  0.8180000000  0.6984126984  0.9066265060  0.8915662651  0.8900602410  0.8975903614  0.6507936508  10.800000000  32.741104731  0.0302786827  32.741104731  450           0.0185325050
0.2987336782  0.0032080721  0.7660000000  0.7936507937  0.7960000000  0.7222222222  0.8539156627  0.8493975904  0.8689759036  0.8855421687  0.6031746032  12.000000000  13.490912199  0.0302786827  13.490912199  500           0.0172203350
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 42
	normlizetype: 0-1
	output_dir: train_output/5f740c0d13738ea6c5e8c326edc5df61
	save_model_every_checkpoint: False
	seed: 345476394
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	class_balanced: False
	data_augmentation: True
	lr: 9.421443606372291e-06
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 9.220948243966033e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3320000000  0.3333333333  0.3280000000  0.3492063492  0.3253012048  0.3253012048  0.4292168675  0.4397590361  0.3317460317  0.0000000000  1.0772632360  0.0197935104  0             0.3777616024
0.3780000000  0.3650793651  0.3380000000  0.3809523810  0.3298192771  0.3313253012  0.4533132530  0.4759036145  0.3650793651  1.9000000000  1.0699574840  0.0261006355  50            0.0426025915
0.4320000000  0.3888888889  0.3920000000  0.4126984127  0.3433734940  0.3132530120  0.4713855422  0.4638554217  0.3952380952  3.8000000000  1.0596844828  0.0261006355  100           0.0414912510
0.4580000000  0.4126984127  0.4360000000  0.4206349206  0.3644578313  0.3493975904  0.5030120482  0.5060240964  0.4031746032  5.7000000000  1.0544507933  0.0261006355  150           0.0412808561
0.4580000000  0.4206349206  0.4480000000  0.4206349206  0.3719879518  0.3674698795  0.5512048193  0.5662650602  0.4190476190  7.6000000000  1.0476725686  0.0261006355  200           0.0392352200
0.4560000000  0.4444444444  0.4600000000  0.4444444444  0.3825301205  0.3373493976  0.5481927711  0.4939759036  0.4095238095  9.5000000000  1.0481928873  0.0261006355  250           0.0400410223
0.4600000000  0.4444444444  0.4700000000  0.4285714286  0.4171686747  0.3674698795  0.5617469880  0.5240963855  0.4126984127  11.400000000  1.0381717253  0.0261006355  300           0.0396770620
0.4480000000  0.4523809524  0.4660000000  0.4365079365  0.4427710843  0.3734939759  0.5692771084  0.5301204819  0.4174603175  13.300000000  1.0360500598  0.0261006355  350           0.0390357065
0.4500000000  0.4444444444  0.4640000000  0.4365079365  0.4804216867  0.4156626506  0.5888554217  0.5602409639  0.4238095238  15.200000000  1.0423286819  0.0261006355  400           0.0402773571
0.4480000000  0.4523809524  0.4660000000  0.4365079365  0.5045180723  0.4518072289  0.5903614458  0.5662650602  0.4301587302  17.100000000  1.0233708847  0.0261006355  450           0.0387946892
0.4540000000  0.4523809524  0.4720000000  0.4444444444  0.5240963855  0.4578313253  0.5993975904  0.5783132530  0.4365079365  19.000000000  1.0226080990  0.0261006355  500           0.0410511303
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 34
	normlizetype: 0-1
	output_dir: train_output/c49681a9d0ff5d851af977936fe02e39
	save_model_every_checkpoint: False
	seed: 1504370232
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 23
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.28411449305770625
	gda: True
	lr: 4.1745474684167584e-05
	lr_d: 0.0026467625285176662
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 1.9350769365009155
	weight_decay: 4.737369176421509e-06
	weight_decay_d: 2.035121990184982e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3220000000  0.3174603175  0.3160000000  0.3412698413  0.3539156627  0.3192771084  0.2966867470  0.4036144578  0.3539682540  0.0000000000  0.1275025904  1.1228325367  0.0404286385  0             0.3944077492
0.3180000000  0.3253968254  0.3100000000  0.3492063492  0.3795180723  0.3373493976  0.2756024096  0.3192771084  0.3587301587  2.3000000000  0.1851282326  1.1176810312  0.0412602425  50            0.0851174116
0.3200000000  0.3253968254  0.3200000000  0.3492063492  0.3810240964  0.3313253012  0.2756024096  0.3192771084  0.3523809524  4.6000000000  0.1977257255  1.1151147556  0.0412602425  100           0.0820052910
0.3140000000  0.3174603175  0.3160000000  0.3492063492  0.3795180723  0.3373493976  0.2740963855  0.3132530120  0.3571428571  6.9000000000  0.1696581294  1.1233056426  0.0412602425  150           0.0822754288
0.3160000000  0.3333333333  0.3160000000  0.3492063492  0.3795180723  0.3373493976  0.2771084337  0.3253012048  0.3507936508  9.2000000000  0.1687088857  1.1132639503  0.0412602425  200           0.0872741652
0.3140000000  0.3174603175  0.3160000000  0.3571428571  0.3810240964  0.3313253012  0.2710843373  0.3253012048  0.3492063492  11.500000000  0.1777494805  1.1147003245  0.0412602425  250           0.0909006453
0.3180000000  0.3333333333  0.3200000000  0.3492063492  0.3795180723  0.3373493976  0.2740963855  0.3253012048  0.3492063492  13.800000000  0.1605749438  1.1220187593  0.0412602425  300           0.0883322239
0.3220000000  0.3253968254  0.3160000000  0.3492063492  0.3750000000  0.3433734940  0.2771084337  0.3253012048  0.3571428571  16.100000000  0.1727722915  1.1116310692  0.0412602425  350           0.0842533922
0.3180000000  0.3174603175  0.3140000000  0.3492063492  0.3795180723  0.3373493976  0.2725903614  0.3313253012  0.3603174603  18.400000000  0.1718545839  1.1193204498  0.0412602425  400           0.0848920488
0.3220000000  0.3333333333  0.3160000000  0.3571428571  0.3810240964  0.3313253012  0.2801204819  0.3493975904  0.3571428571  20.700000000  0.1604877791  1.1143475032  0.0412602425  450           0.0829705048
0.3140000000  0.3174603175  0.3160000000  0.3571428571  0.3765060241  0.3373493976  0.2695783133  0.3192771084  0.3587301587  23.000000000  0.1660058839  1.1161825752  0.0412602425  500           0.0843920040
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 11
	normlizetype: 0-1
	output_dir: train_output/21cd45ad83e3a29afd86c7d90acf2203
	save_model_every_checkpoint: False
	seed: 310531585
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	lr: 0.0001063542080951911
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.007283936884822311
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.0763254166  0.0190234184  0             0.3387260437
0.4980000000  0.4761904762  0.4940000000  0.4523809524  0.6987951807  0.7710843373  0.7364457831  0.7650602410  0.4936507937  1.7000000000  1.0063393927  0.0253305435  50            0.0402656651
0.6220000000  0.5634920635  0.5940000000  0.4920634921  0.7469879518  0.7831325301  0.6942771084  0.7409638554  0.6714285714  3.4000000000  0.8456446505  0.0253305435  100           0.0378947163
0.5960000000  0.5714285714  0.5760000000  0.5000000000  0.7996987952  0.8373493976  0.7740963855  0.7831325301  0.6523809524  5.1000000000  0.6785121727  0.0253305435  150           0.0363053036
0.6320000000  0.5873015873  0.6040000000  0.5238095238  0.8328313253  0.8734939759  0.8313253012  0.8072289157  0.6730158730  6.8000000000  0.6242997640  0.0253305435  200           0.0368407488
0.6720000000  0.6111111111  0.6440000000  0.5555555556  0.8674698795  0.8915662651  0.8448795181  0.8373493976  0.7015873016  8.5000000000  0.5262693334  0.0253305435  250           0.0372366571
0.6820000000  0.6031746032  0.6620000000  0.5476190476  0.8644578313  0.8915662651  0.8509036145  0.8373493976  0.7000000000  10.200000000  0.4526506352  0.0253305435  300           0.0370822239
0.7120000000  0.6428571429  0.7000000000  0.6031746032  0.8734939759  0.9156626506  0.9066265060  0.9156626506  0.7317460317  11.900000000  0.4027467871  0.0253305435  350           0.0380327559
0.7480000000  0.6746031746  0.7160000000  0.5793650794  0.8840361446  0.9216867470  0.9472891566  0.9337349398  0.7190476190  13.600000000  0.3595022491  0.0253305435  400           0.0392230034
0.7640000000  0.6984126984  0.7380000000  0.5714285714  0.9021084337  0.9337349398  0.9819277108  0.9638554217  0.7095238095  15.300000000  0.3230594683  0.0253305435  450           0.0392036581
0.8100000000  0.7142857143  0.7620000000  0.6111111111  0.9006024096  0.9277108434  0.9789156627  0.9518072289  0.7269841270  17.000000000  0.2841693068  0.0253305435  500           0.0394002151
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 44
	normlizetype: 0-1
	output_dir: train_output/67cc9e27829bea60ad508a3abcbe9b7d
	save_model_every_checkpoint: False
	seed: 2137411061
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	lr: 8.785759245690127e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.4986321472569955e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3100000000  0.3412698413  0.2900000000  0.2460317460  0.3945783133  0.3614457831  0.4834337349  0.4638554217  0.3079365079  0.0000000000  1.1239310503  0.0167117119  0             0.4072296619
0.5880000000  0.5952380952  0.4940000000  0.4761904762  0.8418674699  0.8253012048  0.7981927711  0.7951807229  0.5507936508  1.1000000000  0.8583320862  0.0230188370  50            0.0399007893
0.7220000000  0.6984126984  0.6420000000  0.6269841270  0.8719879518  0.8614457831  0.9578313253  0.9277108434  0.7396825397  2.2000000000  0.5252785432  0.0230188370  100           0.0418087387
0.7340000000  0.6587301587  0.6900000000  0.6825396825  0.8840361446  0.8734939759  0.9623493976  0.9457831325  0.6174603175  3.3000000000  0.3196708235  0.0230188370  150           0.0412358379
0.8340000000  0.7142857143  0.7440000000  0.6825396825  0.8569277108  0.8493975904  0.9367469880  0.9156626506  0.7253968254  4.4000000000  0.2760312693  0.0230188370  200           0.0376615381
0.9240000000  0.8412698413  0.8340000000  0.7063492063  0.8900602410  0.8493975904  0.9277108434  0.8795180723  0.6333333333  5.5000000000  0.2065315253  0.0230188370  250           0.0392347622
0.9220000000  0.8253968254  0.8640000000  0.7857142857  0.9066265060  0.8795180723  0.9789156627  0.9759036145  0.6047619048  6.6000000000  0.1513902143  0.0230188370  300           0.0403354597
0.9200000000  0.8253968254  0.8660000000  0.7936507937  0.9487951807  0.9036144578  0.9969879518  0.9879518072  0.6190476190  7.7000000000  0.1285250745  0.0230188370  350           0.0400511599
0.9740000000  0.8888888889  0.9300000000  0.8253968254  0.9397590361  0.8915662651  0.9894578313  0.9698795181  0.5444444444  8.8000000000  0.1246710242  0.0230188370  400           0.0402509880
0.9800000000  0.9365079365  0.9460000000  0.8015873016  0.9397590361  0.8554216867  0.9743975904  0.9698795181  0.4952380952  9.9000000000  0.1012876390  0.0230188370  450           0.0400560284
0.9820000000  0.9126984127  0.9600000000  0.8333333333  0.9804216867  0.9337349398  0.9984939759  0.9698795181  0.5523809524  11.000000000  0.0802163506  0.0230188370  500           0.0404347277
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 40
	normlizetype: 0-1
	output_dir: train_output/5ea4b4237641dbb276e46427f1da8d7f
	save_model_every_checkpoint: False
	seed: 268388693
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 35
	class_balanced: False
	data_augmentation: True
	lr: 7.829058482062479e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.6037334324031243e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3380000000  0.3333333333  0.3600000000  0.3571428571  0.1867469880  0.1566265060  0.4051204819  0.4156626506  0.4063492063  0.0000000000  1.0790448189  0.0262627602  0             0.3407833576
0.4280000000  0.3968253968  0.4100000000  0.4126984127  0.5105421687  0.5120481928  0.6144578313  0.6024096386  0.4063492063  3.5000000000  1.0407416391  0.0338540077  50            0.0384494400
0.4920000000  0.5000000000  0.4920000000  0.5000000000  0.7153614458  0.6927710843  0.7213855422  0.7289156627  0.4984126984  7.0000000000  0.9800798774  0.0338540077  100           0.0394875002
0.5180000000  0.5158730159  0.4780000000  0.5158730159  0.7650602410  0.7108433735  0.7680722892  0.7710843373  0.5587301587  10.500000000  0.9006043684  0.0338540077  150           0.0384469509
0.5660000000  0.5396825397  0.4980000000  0.4920634921  0.7635542169  0.7289156627  0.8343373494  0.8313253012  0.6174603175  14.000000000  0.8266354644  0.0338540077  200           0.0393700838
0.5800000000  0.5793650794  0.5260000000  0.4920634921  0.7996987952  0.7650602410  0.8478915663  0.8373493976  0.6317460317  17.500000000  0.7525907910  0.0338540077  250           0.0387402248
0.6000000000  0.5714285714  0.5580000000  0.5317460317  0.7996987952  0.8012048193  0.8463855422  0.8433734940  0.6444444444  21.000000000  0.6733132708  0.0338540077  300           0.0397692537
0.6200000000  0.5952380952  0.5900000000  0.5634920635  0.8313253012  0.8313253012  0.8478915663  0.8493975904  0.6857142857  24.500000000  0.6334551042  0.0338540077  350           0.0425814867
0.6180000000  0.5952380952  0.5860000000  0.5634920635  0.8328313253  0.8253012048  0.8493975904  0.8433734940  0.6761904762  28.000000000  0.5670280790  0.0338540077  400           0.0444044161
0.6320000000  0.6031746032  0.5960000000  0.5714285714  0.8448795181  0.8614457831  0.8509036145  0.8493975904  0.6777777778  31.500000000  0.5447294551  0.0338540077  450           0.0431611156
0.6640000000  0.6111111111  0.6400000000  0.6031746032  0.8554216867  0.8915662651  0.8448795181  0.8373493976  0.6952380952  35.000000000  0.4941708493  0.0338540077  500           0.0406171846
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 19
	normlizetype: 0-1
	output_dir: train_output/1bfd39a8ccf4c07f2ef0ce5ce8844a71
	save_model_every_checkpoint: False
	seed: 194532680
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	class_balanced: False
	data_augmentation: True
	lr: 3.63194222460564e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0038261244966893123
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3500000000  0.3809523810  0.3180000000  0.3095238095  0.3478915663  0.3433734940  0.3012048193  0.3132530120  0.3126984127  0.0000000000  1.1395779848  0.0178670883  0             0.3409605026
0.5620000000  0.5000000000  0.4540000000  0.4365079365  0.8463855422  0.8072289157  0.7710843373  0.7951807229  0.5095238095  1.4000000000  0.9702260673  0.0241742134  50            0.0413488483
0.6360000000  0.5555555556  0.5880000000  0.5238095238  0.8358433735  0.8493975904  0.7816265060  0.7771084337  0.6365079365  2.8000000000  0.7567629755  0.0241742134  100           0.0417397118
0.6580000000  0.6031746032  0.6160000000  0.5317460317  0.8719879518  0.8975903614  0.7635542169  0.7771084337  0.6714285714  4.2000000000  0.5816184658  0.0241742134  150           0.0412091303
0.6820000000  0.6111111111  0.6380000000  0.5476190476  0.8810240964  0.9096385542  0.8810240964  0.8493975904  0.6634920635  5.6000000000  0.4595169508  0.0241742134  200           0.0419043732
0.7560000000  0.7142857143  0.6840000000  0.5952380952  0.8734939759  0.8915662651  0.9307228916  0.8915662651  0.7317460317  7.0000000000  0.3841238406  0.0241742134  250           0.0414664602
0.7640000000  0.6984126984  0.6900000000  0.5952380952  0.8780120482  0.8975903614  0.9789156627  0.9518072289  0.7142857143  8.4000000000  0.3087232849  0.0241742134  300           0.0384266186
0.7980000000  0.7460317460  0.7220000000  0.6587301587  0.8810240964  0.8975903614  0.9819277108  0.9638554217  0.7238095238  9.8000000000  0.2482015279  0.0241742134  350           0.0400332737
0.8420000000  0.7619047619  0.7800000000  0.6825396825  0.9021084337  0.8855421687  0.9954819277  0.9939759036  0.6904761905  11.200000000  0.2329824134  0.0241742134  400           0.0385382938
0.8880000000  0.8174603175  0.8000000000  0.6825396825  0.8780120482  0.8734939759  0.9774096386  0.9698795181  0.6920634921  12.600000000  0.1795972192  0.0241742134  450           0.0379669952
0.8760000000  0.8015873016  0.8160000000  0.7142857143  0.8795180723  0.8795180723  0.9834337349  0.9698795181  0.7142857143  14.000000000  0.1672932032  0.0241742134  500           0.0392547846
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 9
	normlizetype: 0-1
	output_dir: train_output/54163cb82d248b8f83835f575ba89c9a
	save_model_every_checkpoint: False
	seed: 2015624930
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	ib_lambda: 3.4514975568890356
	ib_penalty_anneal_iters: 3
	irm_lambda: 32387.51228665897
	irm_penalty_anneal_iters: 40
	lr: 1.2644242605786893e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 2.240269970837554e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0213192105  0.0002263886  0.3220000000  0.3333333333  0.3260000000  0.3412698413  0.3102409639  0.2891566265  0.2650602410  0.2409638554  0.2920634921  0.0000000000  1.1055495739  0.0241770744  1.1055495739  0             0.3301126957
0.0169492539  0.0010458029  0.3900000000  0.3968253968  0.4240000000  0.4761904762  0.5271084337  0.5542168675  0.6310240964  0.6084337349  0.3888888889  1.3000000000  3.5816683555  0.0309615135  3.5816683555  50            0.0159930515
0.0155260785  -0.000344550  0.3980000000  0.4047619048  0.3880000000  0.4206349206  0.4518072289  0.4216867470  0.4804216867  0.4518072289  0.4031746032  2.6000000000  -10.02082122  0.0309615135  -10.02082122  100           0.0184527349
0.0149994832  0.0001119290  0.3920000000  0.4047619048  0.3960000000  0.4841269841  0.4623493976  0.4277108434  0.4879518072  0.4698795181  0.3809523810  3.9000000000  4.7572964251  0.0309615135  4.7572964251  150           0.0177232170
0.0149696918  0.0000738862  0.3940000000  0.3809523810  0.3920000000  0.4682539683  0.3719879518  0.3674698795  0.3990963855  0.4277108434  0.4015873016  5.2000000000  3.5278704405  0.0309615135  3.5278704405  200           0.0176862907
0.0148165214  0.0000435291  0.4160000000  0.4047619048  0.4080000000  0.4841269841  0.4111445783  0.4036144578  0.4126506024  0.4216867470  0.4111111111  6.5000000000  2.5469096518  0.0309615135  2.5469096518  250           0.0180194092
0.0149891896  -0.000027020  0.3940000000  0.3809523810  0.4200000000  0.5000000000  0.4171686747  0.3915662651  0.4081325301  0.4156626506  0.3873015873  7.8000000000  0.2582152176  0.0309615135  0.2582152176  300           0.0188386250
0.0148647488  0.0006164364  0.4200000000  0.3888888889  0.4260000000  0.5158730159  0.4548192771  0.4096385542  0.4503012048  0.4518072289  0.3888888889  9.1000000000  21.093437929  0.0309615135  21.093437929  350           0.0182012606
0.0152555425  -0.000338053  0.3480000000  0.3492063492  0.3780000000  0.4365079365  0.4698795181  0.4698795181  0.4668674699  0.4578313253  0.3920634921  10.400000000  -9.816922421  0.0309615135  -9.816922421  400           0.0184245348
0.0155896166  0.0002407433  0.3960000000  0.4126984127  0.4320000000  0.5396825397  0.5150602410  0.4939759036  0.4698795181  0.4578313253  0.4142857143  11.700000000  8.9347579050  0.0309615135  8.9347579050  450           0.0172326708
0.0156292504  -0.000087729  0.3980000000  0.4047619048  0.4340000000  0.5238095238  0.5331325301  0.5301204819  0.5195783133  0.4879518072  0.4190476190  13.000000000  -1.697868590  0.0309615135  -1.697868590  500           0.0174865198
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 28
	normlizetype: 0-1
	output_dir: train_output/f2f697154d44204f23788fc73625388b
	save_model_every_checkpoint: False
	seed: 152544753
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	class_balanced: False
	data_augmentation: True
	ib_lambda: 10.829335547772187
	ib_penalty_anneal_iters: 445
	irm_lambda: 1.0484530546014077
	irm_penalty_anneal_iters: 5
	lr: 5.6004462478267e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0010077262711597086
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0269990340  0.0030796635  0.3300000000  0.3333333333  0.3300000000  0.3333333333  0.3674698795  0.3373493976  0.2379518072  0.2409638554  0.3126984127  0.0000000000  1.1453049183  0.0356054306  1.1453049183  0             0.3479430676
0.0369294320  0.0134562544  0.6180000000  0.5634920635  0.5180000000  0.4841269841  0.7695783133  0.7409638554  0.8358433735  0.8253012048  0.6523809524  2.0000000000  0.9547582877  0.0434269905  0.9547582877  50            0.0160593843
0.1149063773  0.0198376694  0.7120000000  0.6746031746  0.6580000000  0.5793650794  0.7981927711  0.7831325301  0.8177710843  0.8012048193  0.7507936508  4.0000000000  0.6771763837  0.0434269905  0.6771763837  100           0.0175648928
0.1984290683  0.0134799188  0.7960000000  0.7142857143  0.7200000000  0.6428571429  0.9352409639  0.9578313253  0.8644578313  0.8313253012  0.7603174603  6.0000000000  0.5112377989  0.0434269905  0.5112377989  150           0.0177320385
0.2701211828  0.0166189360  0.8440000000  0.7619047619  0.7420000000  0.6190476190  0.9457831325  0.9518072289  0.8900602410  0.8734939759  0.7269841270  8.0000000000  0.4329135752  0.0434269905  0.4329135752  200           0.0174119854
0.3495028317  0.0127712420  0.8860000000  0.7857142857  0.7960000000  0.6825396825  0.9608433735  0.9397590361  0.9457831325  0.9277108434  0.7206349206  10.000000000  0.3552910766  0.0434269905  0.3552910766  250           0.0184974146
0.4133254677  0.0073748558  0.9180000000  0.8174603175  0.8600000000  0.6904761905  0.9819277108  0.9518072289  0.9563253012  0.9457831325  0.7222222222  12.000000000  0.2990051052  0.0434269905  0.2990051052  300           0.0185637140
0.4727783155  0.0097378567  0.9480000000  0.8492063492  0.8940000000  0.7698412698  0.9939759036  0.9759036145  0.9849397590  0.9759036145  0.7015873016  14.000000000  0.2574710488  0.0434269905  0.2574710488  350           0.0180196095
0.5381544733  0.0073074247  0.9580000000  0.8412698413  0.9380000000  0.8095238095  0.9894578313  0.9698795181  0.9969879518  1.0000000000  0.6904761905  16.000000000  0.2246071115  0.0434269905  0.2246071115  400           0.0173982191
0.5854635561  0.0081323469  0.9380000000  0.8333333333  0.9520000000  0.9126984127  0.9683734940  0.9337349398  0.9984939759  0.9939759036  0.4444444444  18.000000000  0.8843402174  0.0434269905  0.8843402174  450           0.0183858490
0.1004957658  0.0438371686  0.6360000000  0.5238095238  0.7000000000  0.6190476190  0.6280120482  0.5963855422  0.7710843373  0.7831325301  0.3666666667  20.000000000  1.7706904864  0.0434269905  1.7706904864  500           0.0173807764
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 45
	normlizetype: 0-1
	output_dir: train_output/8c1012652eeb3d4ff3f5cf52172fe47e
	save_model_every_checkpoint: False
	seed: 730445857
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.1772057470526027
	gda: True
	lr: 8.92658249908763e-06
	lr_d: 0.00018624285451730542
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.5133289094718352
	weight_decay: 0.003607553785079441
	weight_decay_d: 3.17050217157384e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3180000000  0.3412698413  0.3420000000  0.3253968254  0.3629518072  0.3554216867  0.3509036145  0.3192771084  0.3349206349  0.0000000000  0.0937493518  1.1097390652  0.0241608620  0             0.3413655758
0.3420000000  0.3571428571  0.3480000000  0.3730158730  0.3478915663  0.3674698795  0.3780120482  0.3433734940  0.3555555556  1.3000000000  0.0729429530  1.1256824851  0.0260071754  50            0.0475164700
0.3320000000  0.3571428571  0.3560000000  0.3730158730  0.3418674699  0.3674698795  0.3795180723  0.3493975904  0.3476190476  2.6000000000  0.0725563697  1.1260318470  0.0260071754  100           0.0514795256
0.3360000000  0.3571428571  0.3500000000  0.3730158730  0.3478915663  0.3674698795  0.3780120482  0.3433734940  0.3587301587  3.9000000000  0.0636872208  1.1274421072  0.0260071754  150           0.0479569530
0.3340000000  0.3571428571  0.3480000000  0.3730158730  0.3509036145  0.3674698795  0.3780120482  0.3433734940  0.3539682540  5.2000000000  0.0630710568  1.1266221333  0.0260071754  200           0.0482340240
0.3380000000  0.3492063492  0.3460000000  0.3650793651  0.3509036145  0.3674698795  0.3870481928  0.3313253012  0.3571428571  6.5000000000  0.0719007094  1.1363630152  0.0260071754  250           0.0504360437
0.3360000000  0.3571428571  0.3420000000  0.3650793651  0.3493975904  0.3614457831  0.3795180723  0.3373493976  0.3587301587  7.8000000000  0.0724989501  1.1246880317  0.0260071754  300           0.0477221441
0.3400000000  0.3650793651  0.3480000000  0.3730158730  0.3448795181  0.3674698795  0.3750000000  0.3554216867  0.3460317460  9.1000000000  0.0700784003  1.1214326668  0.0260071754  350           0.0440785885
0.3360000000  0.3492063492  0.3520000000  0.3730158730  0.3478915663  0.3674698795  0.3795180723  0.3493975904  0.3492063492  10.400000000  0.0744772847  1.1325620556  0.0260071754  400           0.0407214832
0.3460000000  0.3571428571  0.3520000000  0.3730158730  0.3509036145  0.3674698795  0.3780120482  0.3554216867  0.3523809524  11.700000000  0.0654640989  1.1226467538  0.0260071754  450           0.0405131388
0.3440000000  0.3650793651  0.3500000000  0.3730158730  0.3599397590  0.3674698795  0.3855421687  0.3493975904  0.3476190476  13.000000000  0.0726454360  1.1245258665  0.0260071754  500           0.0409484577
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 26
	normlizetype: 0-1
	output_dir: train_output/72ab0213e8810a154ce9144a66daa39d
	save_model_every_checkpoint: False
	seed: 204326829
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.0359322820557086
	gda: True
	lr: 8.565284674514954e-05
	lr_d: 0.0016464449923483699
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.8687873119868984
	weight_decay: 6.458460261300383e-06
	weight_decay_d: 0.00018555444233230934
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3420000000  0.2698412698  0.3420000000  0.4603174603  0.3689759036  0.3674698795  0.1250000000  0.1506024096  0.3142857143  0.0000000000  0.1298766732  1.1236902475  0.0621166229  0             0.3397874832
0.3100000000  0.2857142857  0.3080000000  0.4047619048  0.3253012048  0.3012048193  0.2168674699  0.2891566265  0.2888888889  3.7000000000  0.0893316658  1.1380611444  0.0643215179  50            0.0358198500
0.3100000000  0.2698412698  0.3080000000  0.4047619048  0.3298192771  0.3072289157  0.2138554217  0.2771084337  0.2888888889  7.4000000000  0.0870485640  1.1380459356  0.0643215179  100           0.0356065750
0.3060000000  0.2698412698  0.3100000000  0.4047619048  0.3253012048  0.2891566265  0.2108433735  0.2891566265  0.2904761905  11.100000000  0.0878872197  1.1371871972  0.0643215179  150           0.0372305059
0.3140000000  0.2777777778  0.3140000000  0.3968253968  0.3268072289  0.3072289157  0.2138554217  0.2771084337  0.2888888889  14.800000000  0.0857543020  1.1366827583  0.0643215179  200           0.0329603291
0.3120000000  0.2619047619  0.3080000000  0.3968253968  0.3268072289  0.2951807229  0.2198795181  0.3012048193  0.2904761905  18.500000000  0.0910939621  1.1431276155  0.0643215179  250           0.0355178976
0.3120000000  0.2698412698  0.3080000000  0.4047619048  0.3253012048  0.3012048193  0.2153614458  0.2831325301  0.2936507937  22.200000000  0.0857435722  1.1348038673  0.0643215179  300           0.0342041588
0.3120000000  0.2777777778  0.3100000000  0.4126984127  0.3237951807  0.2831325301  0.2123493976  0.2831325301  0.2920634921  25.900000000  0.0839614702  1.1379671311  0.0643215179  350           0.0376646805
0.3100000000  0.2777777778  0.3120000000  0.4047619048  0.3298192771  0.2951807229  0.2168674699  0.3012048193  0.2904761905  29.600000000  0.0864250886  1.1337584543  0.0643215179  400           0.0352151966
0.3080000000  0.2777777778  0.3080000000  0.4047619048  0.3298192771  0.2951807229  0.2123493976  0.2831325301  0.2888888889  33.300000000  0.0914544163  1.1389237928  0.0643215179  450           0.0382853889
0.3140000000  0.2698412698  0.3100000000  0.4047619048  0.3298192771  0.2951807229  0.2123493976  0.2831325301  0.2888888889  37.000000000  0.0800997342  1.1415652871  0.0643215179  500           0.0352789927
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 16
	normlizetype: 0-1
	output_dir: train_output/5238e4ff4f5375ad04a43a06316fe9bf
	save_model_every_checkpoint: False
	seed: 194725016
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.27195552323647176
	ib_penalty_anneal_iters: 116
	irm_lambda: 0.11281799963167974
	irm_penalty_anneal_iters: 1581
	lr: 0.0001342232359864321
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.1975155295174919e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0239062794  0.0025525680  0.3460000000  0.3571428571  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3428571429  0.0000000000  1.1255896091  0.0540137291  1.1255896091  0             0.3453154564
0.0836152999  0.0117586308  0.7240000000  0.6666666667  0.6900000000  0.6428571429  0.8388554217  0.8734939759  0.8388554217  0.8253012048  0.7269841270  3.2000000000  0.7560979319  0.0604467392  0.7560979319  50            0.0184236670
0.2766625583  0.0089611824  0.8760000000  0.8015873016  0.8020000000  0.7301587302  0.8810240964  0.8975903614  0.9713855422  0.9819277108  0.6095238095  6.4000000000  0.4163342708  0.0604467392  0.4163342708  100           0.0180967808
0.3223643258  0.0115431257  0.9280000000  0.8333333333  0.9380000000  0.8095238095  0.9111445783  0.9096385542  0.9984939759  0.9939759036  0.5634920635  9.6000000000  0.3607543778  0.0604467392  0.3607543778  150           0.0203886414
0.2564879796  0.0158834612  0.9600000000  0.8253968254  0.9500000000  0.8253968254  0.9789156627  0.9879518072  0.9984939759  0.9939759036  0.6031746032  12.800000000  0.2906567374  0.0604467392  0.2906567374  200           0.0188829756
0.2631028911  0.0139430589  0.9820000000  0.8492063492  0.9860000000  0.8730158730  0.9789156627  0.9759036145  1.0000000000  1.0000000000  0.5936507937  16.000000000  0.2326042911  0.0604467392  0.2326042911  250           0.0191261911
0.2525401211  0.0112513024  0.9980000000  0.9126984127  0.9920000000  0.8730158730  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4968253968  19.200000000  0.1900103685  0.0604467392  0.1900103685  300           0.0191311884
0.2518022844  0.0103950538  0.9980000000  0.9285714286  1.0000000000  0.8888888889  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4682539683  22.400000000  0.1628300285  0.0604467392  0.1628300285  350           0.0180132961
0.2441949525  0.0087631470  1.0000000000  0.9365079365  0.9980000000  0.9047619048  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4666666667  25.600000000  0.1401843904  0.0604467392  0.1401843904  400           0.0189858437
0.2328085458  0.0080117391  0.9980000000  0.9523809524  1.0000000000  0.9126984127  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4222222222  28.800000000  0.1236998966  0.0604467392  0.1236998966  450           0.0184904385
0.2272014645  0.0069991117  1.0000000000  0.9444444444  1.0000000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4841269841  32.000000000  0.1096711342  0.0604467392  0.1096711342  500           0.0182645845
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 49
	normlizetype: 0-1
	output_dir: train_output/21b222dbf6ee2040b2c90434321196d3
	save_model_every_checkpoint: False
	seed: 2132017358
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 16
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.16800888778632717
	ib_penalty_anneal_iters: 5
	irm_lambda: 4362.274127609393
	irm_penalty_anneal_iters: 625
	lr: 0.0002781384725024363
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0011460964943044245
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0225064717  0.0335907638  0.3740000000  0.3730158730  0.3940000000  0.4285714286  0.4743975904  0.4759036145  0.3463855422  0.3614457831  0.3380952381  0.0000000000  1.2462526560  0.0290842056  1.2462526560  0             0.3726060390
0.1091508772  0.0086163252  0.7200000000  0.6587301587  0.7160000000  0.6349206349  0.8463855422  0.8313253012  0.7906626506  0.8012048193  0.6333333333  1.6000000000  0.7306411505  0.0349602699  0.7306411505  50            0.0150050259
0.2573730654  0.0111157310  0.8420000000  0.7936507937  0.8760000000  0.8174603175  0.9472891566  0.9457831325  0.9834337349  0.9698795181  0.6460317460  3.2000000000  0.4290378839  0.0349602699  0.4290378839  100           0.0149061823
0.2985208178  0.0093099146  0.9260000000  0.8809523810  0.8860000000  0.8253968254  0.9954819277  0.9939759036  0.9789156627  0.9759036145  0.6571428571  4.8000000000  0.3088439247  0.0349602699  0.3088439247  150           0.0148766994
0.3380350274  0.0106064320  0.9860000000  0.9523809524  0.9900000000  0.9047619048  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.6730158730  6.4000000000  0.2022135542  0.0349602699  0.2022135542  200           0.0147011709
0.3235548574  0.0098489058  0.9940000000  0.9603174603  0.9940000000  0.9841269841  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5015873016  8.0000000000  0.1519413970  0.0349602699  0.1519413970  250           0.0150810671
0.3142491895  0.0058024823  1.0000000000  0.9682539683  1.0000000000  0.9603174603  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5000000000  9.6000000000  0.1298642680  0.0349602699  0.1298642680  300           0.0149273872
0.2937940747  0.0056001618  1.0000000000  0.9682539683  1.0000000000  0.9603174603  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.4063492063  11.200000000  0.1015753348  0.0349602699  0.1015753348  350           0.0185345507
0.2803400141  0.0065454827  0.9980000000  0.9682539683  0.9980000000  0.9603174603  0.9096385542  0.9156626506  0.9969879518  1.0000000000  0.4968253968  12.800000000  0.0933984672  0.0349602699  0.0933984672  400           0.0179313421
0.2584601265  0.0081945631  1.0000000000  0.9603174603  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5238095238  14.400000000  0.1006113039  0.0349602699  0.1006113039  450           0.0181757832
0.2502900365  0.0036096790  1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5031746032  16.000000000  0.0685637926  0.0349602699  0.0685637926  500           0.0181738091
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 13
	normlizetype: 0-1
	output_dir: train_output/3f90bbb035c6dca6796a072062984b8c
	save_model_every_checkpoint: False
	seed: 454034498
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 40
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1.7606121417976945
	ib_penalty_anneal_iters: 487
	irm_lambda: 75.19367161039429
	irm_penalty_anneal_iters: 2
	lr: 0.0001332442845099019
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 2.7643974709171963e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0261265170  0.0043773078  0.3120000000  0.2857142857  0.3140000000  0.3174603175  0.2424698795  0.2349397590  0.4412650602  0.4879518072  0.3507936508  0.0000000000  1.1522420645  0.0674304962  1.1522420645  0             0.3120627403
0.0236291827  0.0009892512  0.5660000000  0.5158730159  0.5240000000  0.5317460317  0.6234939759  0.6385542169  0.5572289157  0.5301204819  0.4428571429  4.0000000000  1.1216783857  0.0742220879  1.1216783857  50            0.0179732180
0.0162260631  0.0008065553  0.3920000000  0.4206349206  0.3820000000  0.3968253968  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3888888889  8.0000000000  1.1195688426  0.0742220879  1.1195688426  100           0.0183095980
0.0136198416  0.0004204773  0.4040000000  0.4126984127  0.4020000000  0.4047619048  0.3629518072  0.3433734940  0.3388554217  0.3433734940  0.4222222222  12.000000000  1.0951322603  0.0742220879  1.0951322603  150           0.0191932487
0.0137353782  0.0005893942  0.5480000000  0.5634920635  0.5160000000  0.5714285714  0.2981927711  0.2650602410  0.4653614458  0.5361445783  0.4936507937  16.000000000  1.1175695169  0.0742220879  1.1175695169  200           0.0178537560
0.0133990447  0.0001261122  0.3960000000  0.3650793651  0.3360000000  0.3650793651  0.4984939759  0.4397590361  0.3960843373  0.4156626506  0.3460317460  20.000000000  1.0837892723  0.0742220879  1.0837892723  250           0.0183685780
0.0127615067  0.0005869486  0.4780000000  0.4365079365  0.4720000000  0.5079365079  0.4954819277  0.4759036145  0.4262048193  0.4518072289  0.5380952381  24.000000000  1.1153682423  0.0742220879  1.1153682423  300           0.0176668358
0.0132512367  -0.000094648  0.5280000000  0.5476190476  0.5620000000  0.5714285714  0.4322289157  0.4156626506  0.4638554217  0.4939759036  0.5238095238  28.000000000  1.0690876770  0.0742220879  1.0690876770  350           0.0186844587
0.0163254860  0.0015470527  0.3260000000  0.3492063492  0.3560000000  0.3650793651  0.4111445783  0.4277108434  0.4472891566  0.4518072289  0.2222222222  32.000000000  1.1799922156  0.0742220879  1.1799922156  400           0.0190234613
0.0116739132  0.0000948734  0.4380000000  0.4285714286  0.4220000000  0.4603174603  0.3388554217  0.3433734940  0.4367469880  0.4578313253  0.3158730159  36.000000000  1.0847638083  0.0742220879  1.0847638083  450           0.0188056517
0.0115096566  -0.000073378  0.3400000000  0.3730158730  0.3420000000  0.3730158730  0.3328313253  0.3313253012  0.4367469880  0.4457831325  0.3222222222  40.000000000  1.0658539248  0.0742220879  1.0658539248  500           0.0183555889
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 8
	normlizetype: 0-1
	output_dir: train_output/3f16dbac42624169091f5e837be97686
	save_model_every_checkpoint: False
	seed: 1543367923
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 20
	class_balanced: False
	data_augmentation: True
	ib_lambda: 83.02339357589456
	ib_penalty_anneal_iters: 1
	irm_lambda: 1.8838285530562104
	irm_penalty_anneal_iters: 247
	lr: 0.00016380547867477334
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.4236172918593402e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0272576846  0.0141192079  0.3260000000  0.3412698413  0.2940000000  0.3492063492  0.3388554217  0.3433734940  0.2243975904  0.2228915663  0.3333333333  0.0000000000  1.1640899181  0.0356054306  1.1640899181  0             0.3314795494
0.0018830421  -0.000046553  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  2.0000000000  1.2539879227  0.0434269905  1.2539879227  50            0.0186062241
0.0000007583  0.0000007615  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  4.0000000000  1.0982592440  0.0434269905  1.0982592440  100           0.0172695971
0.0000002539  0.0000019021  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  6.0000000000  1.0976937985  0.0434269905  1.0976937985  150           0.0184517670
0.0000003388  0.0000038696  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  8.0000000000  1.0977478886  0.0434269905  1.0977478886  200           0.0177754498
0.0000003490  0.0000053405  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  10.000000000  1.0976205039  0.0434269905  1.0976205039  250           0.0166213799
0.0000011007  0.0000039110  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  12.000000000  1.0979012108  0.0434269905  1.0979012108  300           0.0183749342
0.0000003536  0.0000019467  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  14.000000000  1.0969412088  0.0434269905  1.0969412088  350           0.0161223078
0.0000000735  0.0000070319  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  16.000000000  1.0974675441  0.0434269905  1.0974675441  400           0.0153422499
0.0000000032  0.0000156162  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  18.000000000  1.0974099994  0.0434269905  1.0974099994  450           0.0149443913
0.0000000030  0.0000152816  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  20.000000000  1.0971752739  0.0434269905  1.0971752739  500           0.0153589010
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 5
	normlizetype: 0-1
	output_dir: train_output/49279ef1e66e19d63655082e1d8d773c
	save_model_every_checkpoint: False
	seed: 703309521
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.3320860672773234
	gda: True
	lr: 2.396851744571906e-05
	lr_d: 5.7846372931035575e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.020845462880834064
	weight_decay: 7.934460670892474e-06
	weight_decay_d: 5.2490864308614515e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3720000000  0.3333333333  0.3300000000  0.3412698413  0.4186746988  0.3975903614  0.3373493976  0.3614457831  0.3936507937  0.0000000000  0.0023023423  1.1115972996  0.0272426605  0             0.3308982849
0.3520000000  0.3333333333  0.3000000000  0.3253968254  0.5000000000  0.5301204819  0.3614457831  0.3975903614  0.4349206349  1.5000000000  0.0026199158  1.1164684033  0.0290546417  50            0.0288092518
0.3620000000  0.3333333333  0.3040000000  0.3253968254  0.5000000000  0.5180722892  0.3659638554  0.3915662651  0.4285714286  3.0000000000  0.0025514955  1.1093645382  0.0290546417  100           0.0284077787
0.3560000000  0.3412698413  0.3100000000  0.3333333333  0.4939759036  0.5180722892  0.3614457831  0.3855421687  0.4301587302  4.5000000000  0.0030113207  1.1129485369  0.0290546417  150           0.0286320686
0.3500000000  0.3253968254  0.3080000000  0.3333333333  0.5000000000  0.5301204819  0.3584337349  0.3855421687  0.4333333333  6.0000000000  0.0026359459  1.1112482405  0.0290546417  200           0.0296342945
0.3520000000  0.3412698413  0.2860000000  0.3174603175  0.5105421687  0.5240963855  0.3599397590  0.3795180723  0.4238095238  7.5000000000  0.0025886235  1.1105710316  0.0290546417  250           0.0285194111
0.3500000000  0.3333333333  0.2940000000  0.3412698413  0.5030120482  0.5180722892  0.3614457831  0.3855421687  0.4269841270  9.0000000000  0.0027746903  1.1149319386  0.0290546417  300           0.0285500717
0.3520000000  0.3333333333  0.2920000000  0.3412698413  0.5015060241  0.5240963855  0.3704819277  0.3975903614  0.4301587302  10.500000000  0.0026642556  1.1071925306  0.0290546417  350           0.0283605385
0.3520000000  0.3412698413  0.3020000000  0.3253968254  0.5015060241  0.5240963855  0.3659638554  0.3915662651  0.4285714286  12.000000000  0.0028586774  1.1095463157  0.0290546417  400           0.0282897234
0.3500000000  0.3253968254  0.2940000000  0.3333333333  0.5045180723  0.5240963855  0.3659638554  0.3915662651  0.4285714286  13.500000000  0.0026483911  1.1043115020  0.0290546417  450           0.0284146595
0.3520000000  0.3333333333  0.3040000000  0.3253968254  0.4894578313  0.5120481928  0.3554216867  0.3855421687  0.4333333333  15.000000000  0.0027632082  1.1097452927  0.0290546417  500           0.0283782578
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 23
	normlizetype: 0-1
	output_dir: train_output/a8ea42b772a7d403d7198609c055f67f
	save_model_every_checkpoint: False
	seed: 1595014822
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.066573155679765
	gda: True
	lr: 0.00019694974226292723
	lr_d: 0.001014381795331393
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.13109342890245454
	weight_decay: 0.0005037465137597051
	weight_decay_d: 8.00775650520616e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3320000000  0.3095238095  0.3300000000  0.3333333333  0.3237951807  0.2951807229  0.4442771084  0.4397590361  0.3634920635  0.0000000000  0.0233518481  1.1537926197  0.0241608620  0             0.3290266991
0.3400000000  0.3253968254  0.3400000000  0.3492063492  0.3072289157  0.3132530120  0.5240963855  0.5662650602  0.3587301587  1.3000000000  0.0187400289  1.1048652911  0.0260071754  50            0.0293551302
0.3360000000  0.3174603175  0.3400000000  0.3412698413  0.3102409639  0.3253012048  0.5286144578  0.5722891566  0.3539682540  2.6000000000  0.0173885283  1.1089386296  0.0260071754  100           0.0294696665
0.3480000000  0.3253968254  0.3420000000  0.3412698413  0.3087349398  0.3072289157  0.5496987952  0.5722891566  0.3587301587  3.9000000000  0.0180164388  1.0986872077  0.0260071754  150           0.0291678381
0.3400000000  0.3174603175  0.3340000000  0.3333333333  0.3072289157  0.3132530120  0.5361445783  0.5662650602  0.3555555556  5.2000000000  0.0183473442  1.1010580850  0.0260071754  200           0.0292038488
0.3460000000  0.3174603175  0.3400000000  0.3492063492  0.3072289157  0.3132530120  0.5361445783  0.5662650602  0.3587301587  6.5000000000  0.0180550326  1.1003863835  0.0260071754  250           0.0288677454
0.3460000000  0.3174603175  0.3440000000  0.3412698413  0.3072289157  0.3132530120  0.5331325301  0.5662650602  0.3571428571  7.8000000000  0.0164890900  1.0980344892  0.0260071754  300           0.0295692301
0.3400000000  0.3174603175  0.3400000000  0.3412698413  0.3117469880  0.3192771084  0.5376506024  0.5722891566  0.3603174603  9.1000000000  0.0179656592  1.1063988209  0.0260071754  350           0.0292633104
0.3380000000  0.3253968254  0.3400000000  0.3412698413  0.3102409639  0.3132530120  0.5256024096  0.5602409639  0.3587301587  10.400000000  0.0194976391  1.1047865200  0.0260071754  400           0.0293541145
0.3400000000  0.3253968254  0.3380000000  0.3412698413  0.3147590361  0.3192771084  0.5331325301  0.5662650602  0.3555555556  11.700000000  0.0194495245  1.1066594052  0.0260071754  450           0.0291246843
0.3380000000  0.3253968254  0.3400000000  0.3571428571  0.3102409639  0.3132530120  0.5316265060  0.5722891566  0.3555555556  13.000000000  0.0170238335  1.1063753653  0.0260071754  500           0.0296237612
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 19
	normlizetype: 0-1
	output_dir: train_output/9b77b6dd1e4f595899bb3b0f1eab898f
	save_model_every_checkpoint: False
	seed: 1859773317
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.9298021202833087
	gda: True
	lr: 3.63194222460564e-05
	lr_d: 0.0005457702307805218
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 7.8534607381755945
	weight_decay: 0.0038261244966893123
	weight_decay_d: 2.0213628807193595e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.2980000000  0.3253968254  0.3380000000  0.3650793651  0.4683734940  0.4397590361  0.3780120482  0.3674698795  0.3396825397  0.0000000000  1.4732700586  1.1238791943  0.0261921883  0             0.3406310081
0.3180000000  0.3333333333  0.3420000000  0.3809523810  0.4593373494  0.4156626506  0.3478915663  0.3072289157  0.3412698413  1.4000000000  1.4526993096  1.1369229627  0.0280194283  50            0.0472383690
0.3140000000  0.3333333333  0.3520000000  0.3809523810  0.4653614458  0.4277108434  0.3463855422  0.3132530120  0.3380952381  2.8000000000  1.4522479701  1.1163592315  0.0280194283  100           0.0484013367
0.3180000000  0.3333333333  0.3400000000  0.3809523810  0.4653614458  0.4277108434  0.3463855422  0.3132530120  0.3380952381  4.2000000000  1.5320153630  1.1249507260  0.0280194283  150           0.0462962008
0.3180000000  0.3253968254  0.3480000000  0.3809523810  0.4608433735  0.4216867470  0.3478915663  0.3192771084  0.3444444444  5.6000000000  1.3545638859  1.1317626905  0.0280194283  200           0.0485562944
0.3120000000  0.3253968254  0.3420000000  0.3809523810  0.4593373494  0.4156626506  0.3524096386  0.3132530120  0.3396825397  7.0000000000  1.4093487358  1.1298756671  0.0280194283  250           0.0466770554
0.3100000000  0.3095238095  0.3420000000  0.3809523810  0.4623493976  0.4277108434  0.3418674699  0.3072289157  0.3396825397  8.4000000000  1.4357379663  1.1273248219  0.0280194283  300           0.0457315350
0.3160000000  0.3333333333  0.3480000000  0.3809523810  0.4638554217  0.4216867470  0.3448795181  0.3192771084  0.3380952381  9.8000000000  1.4707803363  1.1250314975  0.0280194283  350           0.0458204079
0.3160000000  0.3253968254  0.3380000000  0.3809523810  0.4653614458  0.4156626506  0.3524096386  0.3132530120  0.3412698413  11.200000000  1.3674998331  1.1157542276  0.0280194283  400           0.0481274128
0.3200000000  0.3253968254  0.3520000000  0.3809523810  0.4713855422  0.4277108434  0.3524096386  0.3132530120  0.3412698413  12.600000000  1.4145235652  1.1215782762  0.0280194283  450           0.0490592766
0.3200000000  0.3333333333  0.3400000000  0.3809523810  0.4683734940  0.4277108434  0.3509036145  0.3313253012  0.3380952381  14.000000000  1.4048600388  1.1245472527  0.0280194283  500           0.0487057543
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 16
	normlizetype: 0-1
	output_dir: train_output/4282d8cd4213f13b7a8def709c865d5a
	save_model_every_checkpoint: False
	seed: 199967735
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.4095633329052917
	gda: True
	lr: 0.0001342232359864321
	lr_d: 0.00236271054339449
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 1.451206578521028
	weight_decay: 1.1975155295174919e-06
	weight_decay_d: 2.7116851693847542e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3360000000  0.3253968254  0.3600000000  0.3492063492  0.4111445783  0.3915662651  0.4397590361  0.4457831325  0.3603174603  0.0000000000  0.0961088240  1.1223547459  0.0539793968  0             0.3775632381
0.3540000000  0.3571428571  0.3300000000  0.4126984127  0.4307228916  0.4096385542  0.4578313253  0.4457831325  0.4000000000  3.2000000000  0.0953719397  1.1120011377  0.0557227135  50            0.0350719309
0.3540000000  0.3492063492  0.3320000000  0.4126984127  0.4277108434  0.4096385542  0.4593373494  0.4397590361  0.4000000000  6.4000000000  0.0927334569  1.1163019109  0.0557227135  100           0.0343313646
0.3540000000  0.3492063492  0.3280000000  0.4206349206  0.4246987952  0.4096385542  0.4593373494  0.4397590361  0.3952380952  9.6000000000  0.1010641389  1.1123607230  0.0557227135  150           0.0345933390
0.3540000000  0.3571428571  0.3280000000  0.4206349206  0.4307228916  0.4096385542  0.4653614458  0.4518072289  0.3952380952  12.800000000  0.1103127512  1.1133369040  0.0557227135  200           0.0344665956
0.3520000000  0.3571428571  0.3260000000  0.4126984127  0.4246987952  0.4096385542  0.4668674699  0.4457831325  0.4000000000  16.000000000  0.1106765892  1.1145750380  0.0557227135  250           0.0341607666
0.3540000000  0.3571428571  0.3340000000  0.4126984127  0.4277108434  0.4096385542  0.4638554217  0.4578313253  0.3952380952  19.200000000  0.0981884535  1.1104554653  0.0557227135  300           0.0339149666
0.3540000000  0.3571428571  0.3340000000  0.4126984127  0.4216867470  0.4096385542  0.4593373494  0.4397590361  0.3984126984  22.400000000  0.0930302685  1.1134620762  0.0557227135  350           0.0345510101
0.3480000000  0.3492063492  0.3320000000  0.4126984127  0.4216867470  0.4096385542  0.4578313253  0.4457831325  0.3968253968  25.600000000  0.1097147974  1.1096601987  0.0557227135  400           0.0331661272
0.3520000000  0.3492063492  0.3280000000  0.4206349206  0.4126506024  0.4096385542  0.4623493976  0.4518072289  0.3952380952  28.800000000  0.0913989562  1.1140621543  0.0557227135  450           0.0347931480
0.3500000000  0.3492063492  0.3300000000  0.4126984127  0.4262048193  0.4156626506  0.4668674699  0.4457831325  0.3984126984  32.000000000  0.0924491714  1.1060177779  0.0557227135  500           0.0348383951
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 49
	normlizetype: 0-1
	output_dir: train_output/bc8f534c7290f6c8568f38bc4d12b954
	save_model_every_checkpoint: False
	seed: 649386850
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 16
	class_balanced: False
	data_augmentation: True
	lr: 0.0002781384725024363
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0011460964943044245
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.2860000000  0.2857142857  0.2980000000  0.3015873016  0.2078313253  0.2168674699  0.2213855422  0.2108433735  0.2968253968  0.0000000000  1.0796587467  0.0186352730  0             0.3876576424
0.5880000000  0.5000000000  0.5520000000  0.4841269841  0.7168674699  0.6987951807  0.8102409639  0.7831325301  0.6333333333  1.6000000000  0.8566820729  0.0249423981  50            0.0387959528
0.6400000000  0.5793650794  0.5920000000  0.5238095238  0.8719879518  0.8734939759  0.8659638554  0.8493975904  0.6174603175  3.2000000000  0.5886336482  0.0249423981  100           0.0386614513
0.7140000000  0.6428571429  0.6620000000  0.5873015873  0.8825301205  0.8915662651  0.9352409639  0.9096385542  0.6666666667  4.8000000000  0.4505362701  0.0249423981  150           0.0384365273
0.7600000000  0.6746031746  0.7280000000  0.6349206349  0.8780120482  0.8734939759  0.9653614458  0.9457831325  0.6317460317  6.4000000000  0.3577142337  0.0249423981  200           0.0380908108
0.8400000000  0.6984126984  0.8020000000  0.6507936508  0.8975903614  0.8795180723  0.9698795181  0.9397590361  0.6507936508  8.0000000000  0.2432305743  0.0249423981  250           0.0384626818
0.8680000000  0.7063492063  0.8340000000  0.6984126984  0.9186746988  0.9156626506  0.9864457831  0.9578313253  0.6253968254  9.6000000000  0.2209627952  0.0249423981  300           0.0382421207
0.9280000000  0.8015873016  0.8620000000  0.6904761905  0.9141566265  0.8855421687  0.9924698795  0.9698795181  0.6507936508  11.200000000  0.1894376354  0.0249423981  350           0.0390633965
0.9440000000  0.8571428571  0.8760000000  0.7380952381  0.8930722892  0.8614457831  0.9728915663  0.9397590361  0.6079365079  12.800000000  0.1475068489  0.0249423981  400           0.0384672928
0.9540000000  0.8730158730  0.9380000000  0.7301587302  0.9533132530  0.9337349398  0.9924698795  0.9698795181  0.6317460317  14.400000000  0.1364621461  0.0249423981  450           0.0385512447
0.9620000000  0.9126984127  0.9540000000  0.7777777778  0.9352409639  0.9216867470  0.9969879518  0.9879518072  0.6269841270  16.000000000  0.1165968893  0.0249423981  500           0.0387011623
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 22
	normlizetype: 0-1
	output_dir: train_output/061fa20eb51913d8ab9aa93f8efe218b
	save_model_every_checkpoint: False
	seed: 1765676856
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.9735911516567937
	gda: True
	lr: 0.00016412676305809594
	lr_d: 0.00189571898336595
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.032202731967993205
	weight_decay: 5.166436845791644e-06
	weight_decay_d: 4.260576486921119e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3100000000  0.2539682540  0.3360000000  0.3333333333  0.3780120482  0.3915662651  0.3960843373  0.4397590361  0.2841269841  0.0000000000  0.0026074797  1.1026452780  0.0557632446  0             0.3431031704
0.3080000000  0.2777777778  0.3100000000  0.2936507937  0.2695783133  0.3433734940  0.3795180723  0.3614457831  0.2809523810  3.3000000000  0.0023564767  1.1208987212  0.0578651428  50            0.0358350611
0.3080000000  0.2698412698  0.3060000000  0.2936507937  0.2635542169  0.3313253012  0.3810240964  0.3795180723  0.2841269841  6.6000000000  0.0021264147  1.1225704956  0.0578651428  100           0.0303685951
0.3140000000  0.2698412698  0.3040000000  0.3015873016  0.2725903614  0.3433734940  0.3825301205  0.3855421687  0.2841269841  9.9000000000  0.0021397700  1.1218411112  0.0578651428  150           0.0341001844
0.3120000000  0.2698412698  0.3080000000  0.2936507937  0.2695783133  0.3433734940  0.3825301205  0.3855421687  0.2841269841  13.200000000  0.0023621079  1.1253989100  0.0578651428  200           0.0364751291
0.3060000000  0.2698412698  0.3080000000  0.2936507937  0.2665662651  0.3433734940  0.3795180723  0.3734939759  0.2809523810  16.500000000  0.0023414995  1.1220106816  0.0578651428  250           0.0350972605
0.3100000000  0.2698412698  0.3140000000  0.2936507937  0.2710843373  0.3493975904  0.3825301205  0.3855421687  0.2825396825  19.800000000  0.0028152102  1.1205071521  0.0578651428  300           0.0365748692
0.3080000000  0.2857142857  0.3100000000  0.2936507937  0.2665662651  0.3433734940  0.3795180723  0.3734939759  0.2825396825  23.100000000  0.0023071136  1.1235590434  0.0578651428  350           0.0348830795
0.3080000000  0.2698412698  0.3080000000  0.2936507937  0.2710843373  0.3373493976  0.3870481928  0.3795180723  0.2809523810  26.400000000  0.0024750957  1.1203023577  0.0578651428  400           0.0334563589
0.3080000000  0.2777777778  0.3100000000  0.3015873016  0.2680722892  0.3373493976  0.3704819277  0.3734939759  0.2793650794  29.700000000  0.0023027427  1.1263409638  0.0578651428  450           0.0349695158
0.3080000000  0.2698412698  0.3100000000  0.2936507937  0.2635542169  0.3313253012  0.3810240964  0.3674698795  0.2825396825  33.000000000  0.0023881558  1.1217847514  0.0578651428  500           0.0343509817
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 26
	normlizetype: 0-1
	output_dir: train_output/e373d1238b084a65489eff7fff789dc2
	save_model_every_checkpoint: False
	seed: 144899932
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1.5630893273153386
	ib_penalty_anneal_iters: 84
	irm_lambda: 93.38540416309847
	irm_penalty_anneal_iters: 70
	lr: 8.565284674514954e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 6.458460261300383e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0229185373  0.0036959469  0.3460000000  0.3650793651  0.3360000000  0.3333333333  0.3463855422  0.3373493976  0.3418674699  0.3192771084  0.3333333333  0.0000000000  1.1480778456  0.0621557236  1.1480778456  0             0.3139703274
0.0544786203  0.0115238944  0.6900000000  0.6666666667  0.6560000000  0.6587301587  0.8750000000  0.8614457831  0.8584337349  0.8433734940  0.7698412698  3.7000000000  0.8262253368  0.0687260628  0.8262253368  50            0.0186319017
0.1503443168  0.0120144431  0.7900000000  0.7460317460  0.6880000000  0.7142857143  0.6957831325  0.6987951807  0.7861445783  0.7710843373  0.6857142857  7.4000000000  1.2288564405  0.0687260628  1.2288564405  100           0.0189098978
0.1506361282  0.0035759594  0.7540000000  0.7380952381  0.6940000000  0.6904761905  0.7424698795  0.7168674699  0.8734939759  0.8674698795  0.6777777778  11.100000000  1.1352912328  0.0687260628  1.1352912328  150           0.0179812098
0.1427382988  0.0051615037  0.6880000000  0.6587301587  0.6900000000  0.6825396825  0.7108433735  0.7228915663  0.7620481928  0.7710843373  0.6492063492  14.800000000  1.2750728902  0.0687260628  1.2750728902  200           0.0175394106
0.1434608349  0.0029572139  0.7500000000  0.7857142857  0.7020000000  0.6587301587  0.7786144578  0.7771084337  0.8644578313  0.8433734940  0.6079365079  18.500000000  1.0690671009  0.0687260628  1.0690671009  250           0.0182110786
0.1336714730  0.0028038879  0.7340000000  0.7539682540  0.6980000000  0.6507936508  0.8659638554  0.8614457831  0.8734939759  0.8554216867  0.6523809524  22.200000000  1.0513690388  0.0687260628  1.0513690388  300           0.0181130028
0.1132112624  0.0032219627  0.7080000000  0.6904761905  0.6920000000  0.6428571429  0.6882530120  0.6807228916  0.8614457831  0.8433734940  0.5111111111  25.900000000  1.0933380398  0.0687260628  1.0933380398  350           0.0186630630
0.1101897503  -0.003045870  0.7280000000  0.7142857143  0.6960000000  0.6746031746  0.7740963855  0.7831325301  0.8509036145  0.8132530120  0.6492063492  29.600000000  0.5072104144  0.0687260628  0.5072104144  400           0.0200077915
0.1090635251  0.0015254889  0.7040000000  0.7222222222  0.6980000000  0.6507936508  0.6822289157  0.6686746988  0.8644578313  0.8433734940  0.6063492063  33.300000000  0.9457212144  0.0687260628  0.9457212144  450           0.0194175196
0.1028447279  0.0025703606  0.6800000000  0.6507936508  0.6740000000  0.6904761905  0.6972891566  0.7168674699  0.8855421687  0.8674698795  0.4904761905  37.000000000  1.0194565228  0.0687260628  1.0194565228  500           0.0197819471
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 40
	normlizetype: 0-1
	output_dir: train_output/6d379806f9dbcb4068a8e6f0f3912ac7
	save_model_every_checkpoint: False
	seed: 55447117
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 35
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.6368310605453614
	ib_penalty_anneal_iters: 4707
	irm_lambda: 3.0028645615306493
	irm_penalty_anneal_iters: 12
	lr: 7.829058482062479e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.6037334324031243e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0255837478  0.0028745437  0.3280000000  0.3492063492  0.2860000000  0.2936507937  0.2906626506  0.3313253012  0.4804216867  0.5000000000  0.3825396825  0.0000000000  1.1444855928  0.0593509674  1.1444855928  0             0.3291435242
0.0556790265  0.0049843151  0.6020000000  0.5634920635  0.5940000000  0.5634920635  0.7515060241  0.7891566265  0.7695783133  0.7771084337  0.6380952381  3.5000000000  0.8869369376  0.0654253960  0.8869369376  50            0.0184442520
0.1563177125  0.0088826466  0.7960000000  0.7380952381  0.7520000000  0.6587301587  0.7289156627  0.7831325301  0.8162650602  0.8313253012  0.7174603175  7.0000000000  0.5887781787  0.0654253960  0.5887781787  100           0.0220270538
0.2774473426  0.0031839321  0.8220000000  0.7619047619  0.8040000000  0.6904761905  0.8840361446  0.8614457831  0.9081325301  0.8855421687  0.7380952381  10.500000000  0.4256830400  0.0654253960  0.4256830400  150           0.0195300531
0.3917433542  0.0044701137  0.9000000000  0.8730158730  0.8700000000  0.7460317460  0.9307228916  0.9277108434  0.9186746988  0.9036144578  0.6841269841  14.000000000  0.3420967022  0.0654253960  0.3420967022  200           0.0210152435
0.4998527282  0.0025234486  0.9260000000  0.8730158730  0.9160000000  0.8015873016  0.9397590361  0.9518072289  0.9819277108  0.9638554217  0.6317460317  17.500000000  0.2692719612  0.0654253960  0.2692719612  250           0.0180369949
0.5850937009  0.0029029327  0.9540000000  0.8968253968  0.9400000000  0.8095238095  0.9713855422  0.9698795181  0.9984939759  0.9939759036  0.5888888889  21.000000000  0.2232652682  0.0654253960  0.2232652682  300           0.0179699183
0.6701479626  0.0033087856  0.9840000000  0.9206349206  0.9480000000  0.8174603175  0.9804216867  0.9819277108  1.0000000000  1.0000000000  0.5412698413  24.500000000  0.1639922354  0.0654253960  0.1639922354  350           0.0187824726
0.7648409069  0.0025084334  0.9880000000  0.9365079365  0.9740000000  0.8571428571  0.9984939759  0.9939759036  0.9894578313  0.9819277108  0.5746031746  28.000000000  0.1409201229  0.0654253960  0.1409201229  400           0.0179232740
0.8423189199  0.0021439457  0.9920000000  0.9365079365  0.9780000000  0.8888888889  0.9984939759  0.9939759036  0.9894578313  0.9819277108  0.5523809524  31.500000000  0.1130203967  0.0654253960  0.1130203967  450           0.0178684998
0.9014861691  0.0015855797  0.9960000000  0.9285714286  0.9920000000  0.8809523810  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5269841270  35.000000000  0.0864741670  0.0654253960  0.0864741670  500           0.0161620331
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 7
	normlizetype: 0-1
	output_dir: train_output/7908266045c8e65dd784e6afe56c8c9f
	save_model_every_checkpoint: False
	seed: 1369984930
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	lr: 0.00010032967548752757
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.696474495087739e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.2980000000  0.3095238095  0.3180000000  0.3571428571  0.3433734940  0.3614457831  0.1280120482  0.1024096386  0.2746031746  0.0000000000  1.1226685047  0.0170950890  0             0.3424050808
0.4820000000  0.4682539683  0.4840000000  0.4841269841  0.7319277108  0.7469879518  0.6641566265  0.6445783133  0.4412698413  1.2000000000  1.0414054656  0.0234022141  50            0.0388910055
0.4900000000  0.4761904762  0.4540000000  0.4603174603  0.7575301205  0.7409638554  0.8057228916  0.7771084337  0.4761904762  2.4000000000  0.8965090227  0.0234022141  100           0.0422347403
0.5880000000  0.5079365079  0.5400000000  0.4920634921  0.7740963855  0.7469879518  0.8403614458  0.8072289157  0.6095238095  3.6000000000  0.7732824695  0.0234022141  150           0.0378803253
0.6180000000  0.5238095238  0.6060000000  0.5476190476  0.8222891566  0.7951807229  0.8177710843  0.7771084337  0.6666666667  4.8000000000  0.6649730664  0.0234022141  200           0.0390823841
0.6420000000  0.5396825397  0.6120000000  0.5634920635  0.8659638554  0.8614457831  0.8298192771  0.8012048193  0.6634920635  6.0000000000  0.5851642364  0.0234022141  250           0.0417864370
0.6680000000  0.5555555556  0.6540000000  0.5793650794  0.8750000000  0.8493975904  0.8493975904  0.8192771084  0.6746031746  7.2000000000  0.5169895601  0.0234022141  300           0.0414022160
0.6960000000  0.5793650794  0.6580000000  0.5952380952  0.8780120482  0.8734939759  0.8674698795  0.8433734940  0.7031746032  8.4000000000  0.4678777581  0.0234022141  350           0.0410355282
0.7500000000  0.6111111111  0.6920000000  0.5952380952  0.8629518072  0.8734939759  0.8328313253  0.7891566265  0.6857142857  9.6000000000  0.4009289461  0.0234022141  400           0.0386821651
0.7560000000  0.6349206349  0.7060000000  0.6111111111  0.8915662651  0.8795180723  0.9096385542  0.8795180723  0.7285714286  10.800000000  0.3642411184  0.0234022141  450           0.0404662561
0.7860000000  0.6428571429  0.7160000000  0.6031746032  0.8840361446  0.8734939759  0.8915662651  0.8674698795  0.7206349206  12.000000000  0.3459918422  0.0234022141  500           0.0395230675
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 37
	normlizetype: 0-1
	output_dir: train_output/b16071faa2686e88eb01b043e3a18682
	save_model_every_checkpoint: False
	seed: 1862312028
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	lr: 8.122386866890388e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.00010895616253593228
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3349206349  0.0000000000  1.2288155556  0.0167117119  0             0.3381128311
0.4960000000  0.4523809524  0.4440000000  0.4841269841  0.5647590361  0.5000000000  0.6009036145  0.6084337349  0.4730158730  1.1000000000  1.0786087108  0.0230188370  50            0.0378912544
0.5520000000  0.5317460317  0.5440000000  0.5317460317  0.6837349398  0.5783132530  0.6716867470  0.6385542169  0.5857142857  2.2000000000  0.9600649393  0.0230188370  100           0.0380865955
0.5740000000  0.5317460317  0.5600000000  0.5238095238  0.7876506024  0.7530120482  0.6912650602  0.6686746988  0.6142857143  3.3000000000  0.8918327045  0.0230188370  150           0.0395646763
0.5920000000  0.5555555556  0.5800000000  0.5317460317  0.8328313253  0.8132530120  0.7304216867  0.7048192771  0.6301587302  4.4000000000  0.7798464823  0.0230188370  200           0.0431073284
0.5880000000  0.5873015873  0.5820000000  0.5396825397  0.8810240964  0.8493975904  0.7334337349  0.7048192771  0.6507936508  5.5000000000  0.7356691635  0.0230188370  250           0.0410480595
0.6040000000  0.5952380952  0.5860000000  0.5396825397  0.8810240964  0.8493975904  0.7515060241  0.7168674699  0.6777777778  6.6000000000  0.6152383220  0.0230188370  300           0.0428569555
0.6220000000  0.6111111111  0.6340000000  0.5793650794  0.8840361446  0.8373493976  0.7680722892  0.7108433735  0.6873015873  7.7000000000  0.5635979015  0.0230188370  350           0.0418547297
0.6380000000  0.6031746032  0.6280000000  0.5634920635  0.8915662651  0.8433734940  0.8042168675  0.7590361446  0.6904761905  8.8000000000  0.5677232081  0.0230188370  400           0.0425761843
0.6460000000  0.6349206349  0.6540000000  0.5873015873  0.8915662651  0.8554216867  0.7921686747  0.7590361446  0.6746031746  9.9000000000  0.4978084123  0.0230188370  450           0.0424582958
0.6720000000  0.6746031746  0.6700000000  0.6111111111  0.8915662651  0.8433734940  0.7831325301  0.7590361446  0.7079365079  11.000000000  0.4966525251  0.0230188370  500           0.0421657658
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 39
	normlizetype: 0-1
	output_dir: train_output/ec74adc881ee687d2e529d187e50609a
	save_model_every_checkpoint: False
	seed: 169558323
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	class_balanced: False
	data_augmentation: True
	lr: 4.2493565572404076e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0009464542120224201
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3260000000  0.3174603175  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3365079365  0.0000000000  1.0922703743  0.0263772011  0             0.3417446613
0.6040000000  0.6190476190  0.5360000000  0.5873015873  0.7966867470  0.7771084337  0.8102409639  0.8433734940  0.6507936508  3.6000000000  0.8700265896  0.0339241028  50            0.0435260010
0.7060000000  0.6746031746  0.6320000000  0.6507936508  0.8734939759  0.8674698795  0.8147590361  0.8614457831  0.7444444444  7.2000000000  0.5487787819  0.0339241028  100           0.0449725294
0.8060000000  0.7301587302  0.7220000000  0.7142857143  0.8674698795  0.8554216867  0.8689759036  0.8734939759  0.6809523810  10.800000000  0.4049835354  0.0339241028  150           0.0426743412
0.8540000000  0.7698412698  0.7660000000  0.7619047619  0.8870481928  0.8493975904  0.9487951807  0.9638554217  0.6825396825  14.400000000  0.3092037520  0.0339241028  200           0.0453177357
0.8640000000  0.8015873016  0.8180000000  0.7539682540  0.9051204819  0.8855421687  0.9789156627  0.9638554217  0.6650793651  18.000000000  0.2316587019  0.0339241028  250           0.0411144161
0.9240000000  0.8333333333  0.8660000000  0.8015873016  0.8975903614  0.8554216867  0.9789156627  0.9759036145  0.6507936508  21.600000000  0.1840764442  0.0339241028  300           0.0430845642
0.9400000000  0.8412698413  0.8940000000  0.8174603175  0.9171686747  0.8975903614  0.9924698795  0.9819277108  0.6428571429  25.200000000  0.1499094237  0.0339241028  350           0.0416262770
0.9640000000  0.8492063492  0.8960000000  0.8253968254  0.9518072289  0.9397590361  0.9924698795  0.9939759036  0.5873015873  28.800000000  0.1301264404  0.0339241028  400           0.0417570353
0.9600000000  0.8412698413  0.9160000000  0.8492063492  0.9231927711  0.9096385542  0.9984939759  0.9939759036  0.6142857143  32.400000000  0.1163297797  0.0339241028  450           0.0403115320
0.9880000000  0.9126984127  0.9420000000  0.8730158730  0.9503012048  0.9096385542  0.9924698795  0.9819277108  0.5603174603  36.000000000  0.0940755855  0.0339241028  500           0.0405461645
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 31
	normlizetype: 0-1
	output_dir: train_output/98df774f6c1985fac60de39a0d3aeb8b
	save_model_every_checkpoint: False
	seed: 1360362850
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	class_balanced: False
	data_augmentation: True
	lr: 0.00010792585688755117
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.001082552882210441
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3680000000  0.3888888889  0.3580000000  0.4047619048  0.3358433735  0.3192771084  0.4156626506  0.4457831325  0.3952380952  0.0000000000  1.1457291842  0.0278754234  0             0.3403193951
0.5640000000  0.5555555556  0.5680000000  0.5000000000  0.7635542169  0.7650602410  0.7725903614  0.7409638554  0.5873015873  3.9000000000  0.9308115888  0.0338573456  50            0.0414417219
0.6020000000  0.6031746032  0.6060000000  0.5158730159  0.8810240964  0.8493975904  0.7756024096  0.7530120482  0.6904761905  7.8000000000  0.7026445615  0.0338573456  100           0.0391291714
0.6260000000  0.6190476190  0.6160000000  0.5555555556  0.8810240964  0.8493975904  0.8027108434  0.7891566265  0.7428571429  11.700000000  0.5414211839  0.0338573456  150           0.0395627737
0.6380000000  0.6349206349  0.6280000000  0.5873015873  0.8810240964  0.8493975904  0.8599397590  0.8373493976  0.7539682540  15.600000000  0.4230923551  0.0346245766  200           0.0402912903
0.6900000000  0.6587301587  0.6780000000  0.6349206349  0.8795180723  0.8554216867  0.9006024096  0.8795180723  0.7873015873  19.500000000  0.3858052224  0.0346245766  250           0.0396191168
0.7600000000  0.6587301587  0.7220000000  0.6666666667  0.8810240964  0.8614457831  0.9246987952  0.9036144578  0.7841269841  23.400000000  0.3211748254  0.0346245766  300           0.0396911621
0.8100000000  0.7063492063  0.7520000000  0.7063492063  0.8840361446  0.8734939759  0.9382530120  0.9096385542  0.7730158730  27.300000000  0.2661771592  0.0346245766  350           0.0393798018
0.8380000000  0.7380952381  0.7980000000  0.6825396825  0.8930722892  0.8734939759  0.9503012048  0.9216867470  0.7682539683  31.200000000  0.2382959497  0.0346245766  400           0.0406866503
0.8600000000  0.7460317460  0.8400000000  0.6825396825  0.8810240964  0.8614457831  0.9262048193  0.8975903614  0.7587301587  35.100000000  0.1933649033  0.0346245766  450           0.0396462965
0.8800000000  0.7460317460  0.8640000000  0.7380952381  0.8900602410  0.8734939759  0.9578313253  0.9397590361  0.7523809524  39.000000000  0.1784112093  0.0346245766  500           0.0407797909
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 36
	normlizetype: 0-1
	output_dir: train_output/5da1424a0ac12bfda1091050f6aae062
	save_model_every_checkpoint: False
	seed: 1639371499
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1112.251794508828
	ib_penalty_anneal_iters: 11
	irm_lambda: 34.03118337967275
	irm_penalty_anneal_iters: 22
	lr: 1.5717124715347616e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.00019407120641339628
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0258882940  0.0028098761  0.3300000000  0.2936507937  0.3560000000  0.3015873016  0.3313253012  0.2891566265  0.4819277108  0.4819277108  0.3206349206  0.0000000000  1.1242122650  0.0320873260  1.1242122650  0             0.3101582527
0.0162861763  0.0001438658  0.3680000000  0.3253968254  0.3960000000  0.3492063492  0.3358433735  0.3192771084  0.4593373494  0.4638554217  0.2968253968  1.8000000000  13.381185984  0.0384402275  13.381185984  50            0.0185868216
0.0033311167  -0.000050334  0.3440000000  0.3412698413  0.3400000000  0.3253968254  0.3117469880  0.2831325301  0.3704819277  0.3614457831  0.3317460317  3.6000000000  4.8007489395  0.0384402275  4.8007489395  100           0.0179792976
0.0011120821  0.0000130776  0.3400000000  0.3253968254  0.3400000000  0.3253968254  0.3524096386  0.3493975904  0.3478915663  0.3072289157  0.3222222222  5.4000000000  2.3345687056  0.0384402275  2.3345687056  150           0.0183179855
0.0004454050  0.0000044130  0.3220000000  0.3333333333  0.3280000000  0.3412698413  0.3237951807  0.3313253012  0.4397590361  0.4457831325  0.3523809524  7.2000000000  1.5938665152  0.0384402275  1.5938665152  200           0.0175859976
0.0001696247  -0.000001739  0.3280000000  0.3333333333  0.3280000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3476190476  9.0000000000  1.2866475391  0.0384402275  1.2866475391  250           0.0180283403
0.0000934750  0.0000003606  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3380952381  10.800000000  1.2020027804  0.0384402275  1.2020027804  300           0.0178482437
0.0000588552  0.0000000475  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  12.600000000  1.1637614655  0.0384402275  1.1637614655  350           0.0170281935
0.0000361985  0.0000000256  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  14.400000000  1.1385158563  0.0384402275  1.1385158563  400           0.0176076174
0.0000265800  -0.000000024  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  16.200000000  1.1279853821  0.0384402275  1.1279853821  450           0.0172385693
0.0000215818  0.0000003594  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  18.000000000  1.1225087643  0.0384402275  1.1225087643  500           0.0175628710
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 33
	normlizetype: 0-1
	output_dir: train_output/857ba2d372fb96eeda9320dd50e4ab34
	save_model_every_checkpoint: False
	seed: 471112798
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	lr: 1.5327155575590226e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008901835195953863
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3160000000  0.3253968254  0.3080000000  0.3095238095  0.3373493976  0.3373493976  0.3704819277  0.4096385542  0.2968253968  0.0000000000  1.1865600348  0.0182523727  0             0.3890440464
0.4600000000  0.4047619048  0.4220000000  0.3412698413  0.3493975904  0.3493975904  0.4472891566  0.4397590361  0.4539682540  1.5000000000  1.0993841314  0.0245594978  50            0.0385012293
0.5100000000  0.4682539683  0.4820000000  0.3650793651  0.4548192771  0.4216867470  0.5075301205  0.4518072289  0.5412698413  3.0000000000  1.0653975236  0.0245594978  100           0.0392868471
0.4900000000  0.4365079365  0.4580000000  0.3968253968  0.5210843373  0.4819277108  0.5481927711  0.4819277108  0.5412698413  4.5000000000  1.0367123842  0.0245594978  150           0.0385478544
0.4940000000  0.4365079365  0.4400000000  0.4047619048  0.5858433735  0.5240963855  0.5903614458  0.5421686747  0.5269841270  6.0000000000  1.0253091204  0.0245594978  200           0.0381614971
0.4980000000  0.4523809524  0.4280000000  0.3968253968  0.6370481928  0.5481927711  0.6972891566  0.6325301205  0.5269841270  7.5000000000  1.0003314328  0.0245594978  250           0.0388493204
0.5220000000  0.4920634921  0.4600000000  0.4285714286  0.6566265060  0.5783132530  0.7304216867  0.6807228916  0.5507936508  9.0000000000  0.9809795749  0.0245594978  300           0.0386798906
0.5260000000  0.5238095238  0.4680000000  0.4285714286  0.6837349398  0.5903614458  0.7469879518  0.6987951807  0.5476190476  10.500000000  0.9520652843  0.0245594978  350           0.0389733601
0.5320000000  0.5396825397  0.4700000000  0.4444444444  0.7048192771  0.6506024096  0.7605421687  0.7289156627  0.5650793651  12.000000000  0.9375693882  0.0245594978  400           0.0398413610
0.5300000000  0.5555555556  0.4820000000  0.4523809524  0.7168674699  0.6626506024  0.7605421687  0.7289156627  0.5746031746  13.500000000  0.9089303064  0.0245594978  450           0.0384771156
0.5400000000  0.5634920635  0.4900000000  0.4603174603  0.7228915663  0.6626506024  0.7771084337  0.7831325301  0.5888888889  15.000000000  0.8890470529  0.0245594978  500           0.0388563871
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 32
	normlizetype: 0-1
	output_dir: train_output/da21d8354d66ed58e50eeca678b75b98
	save_model_every_checkpoint: False
	seed: 1804388852
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	ib_lambda: 3.1049160497724126
	ib_penalty_anneal_iters: 289
	irm_lambda: 10.855001495259817
	irm_penalty_anneal_iters: 9
	lr: 1.183640744652948e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 4.756462551889598e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0248123780  0.0067869448  0.3440000000  0.3571428571  0.3400000000  0.3492063492  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3412698413  0.0000000000  1.1430879831  0.0305061340  1.1430879831  0             0.3261852264
0.0258522551  -0.000174619  0.4540000000  0.5079365079  0.4460000000  0.4206349206  0.5512048193  0.5783132530  0.5843373494  0.5662650602  0.4444444444  1.7000000000  1.0893387079  0.0366358757  1.0893387079  50            0.0173749781
0.0270021321  0.0006250963  0.5360000000  0.5873015873  0.5420000000  0.5000000000  0.5436746988  0.5602409639  0.5632530120  0.5783132530  0.5317460317  3.4000000000  1.0528248823  0.0366358757  1.0528248823  100           0.0165633869
0.0284617624  0.0017701659  0.5320000000  0.5476190476  0.5560000000  0.5714285714  0.5662650602  0.6024096386  0.6024096386  0.6024096386  0.5619047619  5.1000000000  1.0496500349  0.0366358757  1.0496500349  150           0.0177854681
0.0307361871  0.0019529805  0.5080000000  0.5238095238  0.5620000000  0.5238095238  0.4262048193  0.4397590361  0.5753012048  0.5783132530  0.5333333333  6.8000000000  1.0344835019  0.0366358757  1.0344835019  200           0.0181470299
0.0329934704  -0.000177430  0.5180000000  0.5238095238  0.5380000000  0.5555555556  0.4834337349  0.5240963855  0.5888554217  0.5963855422  0.5412698413  8.5000000000  0.9938269794  0.0366358757  0.9938269794  250           0.0180572605
0.0355942126  0.0013651689  0.5260000000  0.5317460317  0.5520000000  0.5634920635  0.4759036145  0.5180722892  0.5888554217  0.6084337349  0.5682539683  10.200000000  1.0068887711  0.0366358757  1.0068887711  300           0.0186253119
0.0350015444  0.0021510247  0.5320000000  0.5238095238  0.5660000000  0.5476190476  0.4969879518  0.5301204819  0.5993975904  0.6144578313  0.5698412698  11.900000000  1.1021986866  0.0366358757  1.1021986866  350           0.0191078997
0.0337867376  0.0030116525  0.5400000000  0.5158730159  0.5580000000  0.5793650794  0.4984939759  0.5481927711  0.5993975904  0.6265060241  0.5841269841  13.600000000  1.0867387807  0.0366358757  1.0867387807  400           0.0183649302
0.0323649925  -0.001238120  0.5660000000  0.5000000000  0.5280000000  0.5634920635  0.5873493976  0.6385542169  0.6144578313  0.6506024096  0.6000000000  15.300000000  1.0531462216  0.0366358757  1.0531462216  450           0.0185392094
0.0317597314  0.0011257502  0.5340000000  0.4841269841  0.5560000000  0.5714285714  0.4668674699  0.5301204819  0.5993975904  0.6265060241  0.5809523810  17.000000000  1.0465070391  0.0366358757  1.0465070391  500           0.0184654760
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 21
	normlizetype: 0-1
	output_dir: train_output/f1f8a33cab2a5f81e32d5902eb18bd56
	save_model_every_checkpoint: False
	seed: 1372153641
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	class_balanced: False
	data_augmentation: True
	ib_lambda: 62.408376920287324
	ib_penalty_anneal_iters: 2
	irm_lambda: 105.22631752663723
	irm_penalty_anneal_iters: 25
	lr: 6.91377517769638e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.004281776758381881
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0272720084  0.0134775005  0.3480000000  0.3412698413  0.3220000000  0.3730158730  0.3388554217  0.3433734940  0.2906626506  0.2951807229  0.3206349206  0.0000000000  1.2074977160  0.0210933685  1.2074977160  0             0.3256874084
0.0192486891  0.0018202796  0.3940000000  0.3571428571  0.4140000000  0.4285714286  0.3403614458  0.3012048193  0.4487951807  0.4457831325  0.3904761905  1.1000000000  2.3289343309  0.0282964706  2.3289343309  50            0.0185976410
0.0142879434  -0.000284688  0.4000000000  0.3571428571  0.4040000000  0.4523809524  0.3599397590  0.3313253012  0.4442771084  0.4277108434  0.4000000000  2.2000000000  1.9546458077  0.0282964706  1.9546458077  100           0.0183882380
0.0113005584  -0.000143598  0.3840000000  0.3492063492  0.4000000000  0.4603174603  0.3448795181  0.3554216867  0.4156626506  0.3855421687  0.3936507937  3.3000000000  1.7789932704  0.0282964706  1.7789932704  150           0.0174572468
0.0092688726  0.0001476645  0.3800000000  0.3492063492  0.3740000000  0.4523809524  0.3554216867  0.3614457831  0.4066265060  0.3734939759  0.3841269841  4.4000000000  1.6802423692  0.0282964706  1.6802423692  200           0.0166345167
0.0075508966  -0.000301869  0.4080000000  0.3492063492  0.3760000000  0.4603174603  0.3614457831  0.3614457831  0.4156626506  0.3734939759  0.3841269841  5.5000000000  1.5340003514  0.0282964706  1.5340003514  250           0.0173118830
0.0064366134  0.0000079074  0.3880000000  0.3492063492  0.3740000000  0.4682539683  0.3524096386  0.3373493976  0.4096385542  0.3734939759  0.3841269841  6.6000000000  1.4937760496  0.0282964706  1.4937760496  300           0.0176524448
0.0052148399  0.0001286190  0.3980000000  0.3650793651  0.3660000000  0.4682539683  0.3569277108  0.3433734940  0.4111445783  0.3674698795  0.3841269841  7.7000000000  1.4344867349  0.0282964706  1.4344867349  350           0.0179783821
0.0044363989  0.0001013522  0.4120000000  0.3888888889  0.3700000000  0.4523809524  0.3418674699  0.3192771084  0.4021084337  0.3554216867  0.3920634921  8.8000000000  1.3785668564  0.0282964706  1.3785668564  400           0.0184175110
0.0038171143  0.0000670153  0.3980000000  0.4047619048  0.3620000000  0.4285714286  0.3298192771  0.3192771084  0.3855421687  0.3734939759  0.3809523810  9.9000000000  1.3365717793  0.0282964706  1.3365717793  450           0.0172857809
0.0032666044  -0.000092193  0.3920000000  0.3888888889  0.3580000000  0.4126984127  0.3388554217  0.3313253012  0.3780120482  0.3674698795  0.3650793651  11.000000000  1.2877355266  0.0282964706  1.2877355266  500           0.0163892794
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 18
	normlizetype: 0-1
	output_dir: train_output/733c1239bcd8c27b77b65e754a0024d8
	save_model_every_checkpoint: False
	seed: 1031971524
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1023.9200967793355
	ib_penalty_anneal_iters: 33
	irm_lambda: 0.2195209280241071
	irm_penalty_anneal_iters: 93
	lr: 3.872163578520407e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008766809489187495
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0262846574  0.0024551901  0.2960000000  0.2857142857  0.3360000000  0.3333333333  0.3734939759  0.3734939759  0.0948795181  0.0903614458  0.2666666667  0.0000000000  1.1319545507  0.0708665848  1.1319545507  0             0.3693571091
0.0244980028  0.0007638635  0.4620000000  0.4444444444  0.3960000000  0.4682539683  0.3930722892  0.3795180723  0.5195783133  0.5240963855  0.4238095238  4.3000000000  9.5469788623  0.0764126778  9.5469788623  50            0.0175002432
0.0159806723  -0.000017922  0.3540000000  0.3650793651  0.3400000000  0.3809523810  0.3087349398  0.3433734940  0.3780120482  0.3915662651  0.3063492063  8.6000000000  17.453729400  0.0764126778  17.453729400  100           0.0179642820
0.0089306365  -0.000001321  0.3180000000  0.2936507937  0.3200000000  0.2857142857  0.3237951807  0.3554216867  0.2801204819  0.2409638554  0.2428571429  12.900000000  10.240462875  0.0764126778  10.240462875  150           0.0173025513
0.0053390563  0.0000487700  0.3220000000  0.2777777778  0.3280000000  0.3492063492  0.3463855422  0.3373493976  0.2530120482  0.2289156627  0.2476190476  17.200000000  6.5657859707  0.0764126778  6.5657859707  200           0.0178176165
0.0034736728  0.0000476955  0.3080000000  0.2539682540  0.3340000000  0.3650793651  0.3945783133  0.3493975904  0.3704819277  0.3614457831  0.2777777778  21.500000000  4.6556896639  0.0764126778  4.6556896639  250           0.0184995365
0.0023068296  -0.000017619  0.3200000000  0.3253968254  0.3420000000  0.3730158730  0.3554216867  0.3614457831  0.4337349398  0.4216867470  0.3349206349  25.800000000  3.4596381044  0.0764126778  3.4596381044  300           0.0179321766
0.0016187664  0.0000096520  0.3340000000  0.3253968254  0.3260000000  0.3253968254  0.3388554217  0.3313253012  0.4367469880  0.4337349398  0.3492063492  30.100000000  2.7541068172  0.0764126778  2.7541068172  350           0.0193004847
0.0012264807  -0.000005199  0.3340000000  0.3253968254  0.3300000000  0.3412698413  0.3328313253  0.3313253012  0.4382530120  0.4397590361  0.3396825397  34.400000000  2.3533376312  0.0764126778  2.3533376312  400           0.0189378357
0.0009999979  -0.000000004  0.3340000000  0.3253968254  0.3320000000  0.3412698413  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3380952381  38.700000000  2.1209582996  0.0764126778  2.1209582996  450           0.0190628004
0.0008110644  0.0000030869  0.3320000000  0.3333333333  0.3320000000  0.3412698413  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3380952381  43.000000000  1.9274617696  0.0764126778  1.9274617696  500           0.0192763996
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 43
	normlizetype: 0-1
	output_dir: train_output/2d7459abd2106220123d331ba85a2beb
	save_model_every_checkpoint: False
	seed: 678560482
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	class_balanced: False
	data_augmentation: True
	lr: 1.0731991123556439e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 6.356201338925228e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3580000000  0.3571428571  0.3540000000  0.3333333333  0.3509036145  0.3313253012  0.3795180723  0.3734939759  0.3746031746  0.0000000000  1.1028624773  0.0252666473  0             0.5948798656
0.4840000000  0.4920634921  0.4220000000  0.4444444444  0.7304216867  0.7168674699  0.6942771084  0.7048192771  0.4380952381  3.3000000000  1.0131483066  0.0323524475  50            0.0451705790
0.5200000000  0.5079365079  0.4600000000  0.4682539683  0.7710843373  0.7590361446  0.7048192771  0.7108433735  0.4920634921  6.6000000000  0.9097517705  0.0323524475  100           0.0461160755
0.5560000000  0.5714285714  0.4960000000  0.4841269841  0.7876506024  0.7891566265  0.7243975904  0.7289156627  0.5555555556  9.9000000000  0.8206523550  0.0323524475  150           0.0472543144
0.5980000000  0.5952380952  0.5600000000  0.5079365079  0.7981927711  0.8192771084  0.7093373494  0.7168674699  0.6126984127  13.200000000  0.7202132881  0.0323524475  200           0.0458372116
0.6140000000  0.6031746032  0.5820000000  0.5555555556  0.8614457831  0.8554216867  0.7695783133  0.7530120482  0.6587301587  16.500000000  0.6529821455  0.0323524475  250           0.0480818272
0.6200000000  0.6031746032  0.6160000000  0.5873015873  0.8765060241  0.8795180723  0.7650602410  0.7469879518  0.6825396825  19.800000000  0.5887695688  0.0323524475  300           0.0453590631
0.6440000000  0.6031746032  0.6460000000  0.6111111111  0.8780120482  0.8855421687  0.7846385542  0.7891566265  0.7031746032  23.100000000  0.5466126722  0.0323524475  350           0.0460173035
0.6600000000  0.6031746032  0.6700000000  0.5873015873  0.8689759036  0.8855421687  0.8222891566  0.8192771084  0.6841269841  26.400000000  0.4901057613  0.0323524475  400           0.0422835875
0.6740000000  0.6031746032  0.6800000000  0.6428571429  0.8795180723  0.8915662651  0.8087349398  0.8132530120  0.7142857143  29.700000000  0.4609118181  0.0323524475  450           0.0453177786
0.7000000000  0.6587301587  0.7020000000  0.6507936508  0.8750000000  0.8855421687  0.8448795181  0.8373493976  0.7142857143  33.000000000  0.4209631532  0.0323524475  500           0.0415745211
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 9
	normlizetype: 0-1
	output_dir: train_output/ed2d745787f72f34ed76ca46f9d6c7d5
	save_model_every_checkpoint: False
	seed: 1188726882
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	lr: 1.2644242605786893e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 2.240269970837554e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3160000000  0.3174603175  0.3300000000  0.3333333333  0.3569277108  0.3433734940  0.4713855422  0.5000000000  0.3317460317  0.0000000000  1.1313630342  0.0174822807  0             0.6765236855
0.4280000000  0.4206349206  0.4020000000  0.3730158730  0.4171686747  0.4518072289  0.3885542169  0.3855421687  0.4603174603  1.3000000000  1.1016310823  0.0237894058  50            0.0438029099
0.4400000000  0.4841269841  0.4160000000  0.3650793651  0.4834337349  0.5000000000  0.4442771084  0.4397590361  0.4984126984  2.6000000000  1.0863894010  0.0237894058  100           0.0427963781
0.4240000000  0.4206349206  0.4060000000  0.3809523810  0.5165662651  0.5481927711  0.4789156627  0.4698795181  0.4507936508  3.9000000000  1.0647897136  0.0237894058  150           0.0433990908
0.4200000000  0.4285714286  0.4060000000  0.4047619048  0.5828313253  0.6084337349  0.5376506024  0.5602409639  0.4619047619  5.2000000000  1.0348085904  0.0237894058  200           0.0427619457
0.4260000000  0.4126984127  0.4140000000  0.4206349206  0.6234939759  0.6506024096  0.6009036145  0.6445783133  0.4698412698  6.5000000000  1.0071699047  0.0237894058  250           0.0428062248
0.4440000000  0.4126984127  0.4260000000  0.4206349206  0.6792168675  0.6927710843  0.6957831325  0.6987951807  0.4825396825  7.8000000000  1.0161967790  0.0237894058  300           0.0440431881
0.4640000000  0.4365079365  0.4400000000  0.4365079365  0.7003012048  0.7048192771  0.7515060241  0.7650602410  0.5079365079  9.1000000000  0.9971032178  0.0237894058  350           0.0428419542
0.4820000000  0.4444444444  0.4380000000  0.4365079365  0.7093373494  0.7048192771  0.7650602410  0.7710843373  0.5142857143  10.400000000  0.9717140198  0.0237894058  400           0.0432716036
0.4940000000  0.4523809524  0.4400000000  0.4206349206  0.7123493976  0.7168674699  0.7680722892  0.7951807229  0.5365079365  11.700000000  0.9455204427  0.0237894058  450           0.0442265797
0.5000000000  0.4365079365  0.4480000000  0.4365079365  0.7108433735  0.6987951807  0.7861445783  0.7951807229  0.5412698413  13.000000000  0.9462634075  0.0237894058  500           0.0474775648
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 36
	normlizetype: 0-1
	output_dir: train_output/c31141f4cb7d9ddab9345c30a1864943
	save_model_every_checkpoint: False
	seed: 1982984714
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 1.718430211474344
	gda: True
	lr: 1.5717124715347616e-05
	lr_d: 9.069059983992349e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.39874326197710963
	weight_decay: 0.00019407120641339628
	weight_decay_d: 0.006383202876455697
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3420000000  0.3492063492  0.3400000000  0.2936507937  0.3539156627  0.3674698795  0.2710843373  0.2650602410  0.3650793651  0.0000000000  0.0312745497  1.1012461185  0.0320668221  0             0.6746494770
0.3460000000  0.3412698413  0.3520000000  0.3095238095  0.3539156627  0.4156626506  0.2725903614  0.2469879518  0.3730158730  1.8000000000  0.0437069361  1.1249134898  0.0348973274  50            0.0867705488
0.3460000000  0.3253968254  0.3420000000  0.3015873016  0.3659638554  0.4036144578  0.2756024096  0.2590361446  0.3698412698  3.6000000000  0.0447418610  1.1166079521  0.0348973274  100           0.0860154915
0.3520000000  0.3253968254  0.3460000000  0.3095238095  0.3554216867  0.3975903614  0.2620481928  0.2771084337  0.3619047619  5.4000000000  0.0449475920  1.1169981599  0.0348973274  150           0.0891542673
0.3460000000  0.3253968254  0.3460000000  0.3015873016  0.3704819277  0.4096385542  0.2710843373  0.2650602410  0.3698412698  7.2000000000  0.0439721023  1.1213849616  0.0348973274  200           0.0853874159
0.3480000000  0.3253968254  0.3460000000  0.3015873016  0.3644578313  0.3975903614  0.2725903614  0.2710843373  0.3650793651  9.0000000000  0.0482175272  1.1228634191  0.0348973274  250           0.0839166975
0.3580000000  0.3333333333  0.3460000000  0.3095238095  0.3644578313  0.4096385542  0.2710843373  0.2650602410  0.3650793651  10.800000000  0.0440125059  1.1268895006  0.0348973274  300           0.0882197332
0.3460000000  0.3253968254  0.3420000000  0.3095238095  0.3599397590  0.4036144578  0.2665662651  0.2710843373  0.3698412698  12.600000000  0.0439597313  1.1148064947  0.0348973274  350           0.0868411398
0.3500000000  0.3253968254  0.3420000000  0.3174603175  0.3584337349  0.4096385542  0.2695783133  0.2590361446  0.3682539683  14.400000000  0.0441203399  1.1178114438  0.0348973274  400           0.0847423029
0.3500000000  0.3253968254  0.3420000000  0.3015873016  0.3569277108  0.4036144578  0.2680722892  0.2771084337  0.3650793651  16.200000000  0.0438874984  1.1259587717  0.0348973274  450           0.0867791653
0.3580000000  0.3333333333  0.3460000000  0.3095238095  0.3509036145  0.4156626506  0.2756024096  0.2590361446  0.3698412698  18.000000000  0.0443773245  1.1153083396  0.0348973274  500           0.0895571518
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 10
	normlizetype: 0-1
	output_dir: train_output/5fc79bcaa833d1e8247ac356864765da
	save_model_every_checkpoint: False
	seed: 1899362674
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	class_balanced: False
	data_augmentation: True
	ib_lambda: 10130.005625649008
	ib_penalty_anneal_iters: 102
	irm_lambda: 804.0718578937386
	irm_penalty_anneal_iters: 286
	lr: 2.8201039162457077e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 3.538451007661713e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0225837976  0.0331880078  0.3580000000  0.3492063492  0.3440000000  0.3412698413  0.4021084337  0.3674698795  0.2906626506  0.2710843373  0.3539682540  0.0000000000  1.2244976759  0.0180091858  1.2244976759  0             0.5963597298
0.0232859837  0.0029878385  0.4400000000  0.4603174603  0.4640000000  0.4761904762  0.4186746988  0.4337349398  0.5677710843  0.5722891566  0.4158730159  0.9000000000  1.0624689817  0.0250096321  1.0624689817  50            0.0176778173
0.0306391628  0.0052570634  0.4840000000  0.5000000000  0.4900000000  0.4761904762  0.6822289157  0.6566265060  0.7334337349  0.7409638554  0.5301587302  1.8000000000  0.9839627838  0.0250096321  0.9839627838  100           0.0190201473
0.0154979854  0.0056460185  0.3940000000  0.4365079365  0.4400000000  0.3809523810  0.3539156627  0.3674698795  0.4503012048  0.4518072289  0.3492063492  2.7000000000  150.85163661  0.0250096321  150.85163661  150           0.0184710646
0.0032030077  0.0002629207  0.3360000000  0.3333333333  0.3320000000  0.3333333333  0.3358433735  0.3433734940  0.4427710843  0.4457831325  0.3349206349  3.6000000000  33.524871711  0.0250096321  33.524871711  200           0.0186819649
0.0016631528  0.0006108976  0.3300000000  0.3412698413  0.3340000000  0.3333333333  0.3343373494  0.3373493976  0.4427710843  0.4457831325  0.3301587302  4.5000000000  17.942412490  0.0250096321  17.942412490  250           0.0173564482
0.0012470850  0.0004750127  0.3280000000  0.3492063492  0.3240000000  0.3333333333  0.3493975904  0.3493975904  0.4051204819  0.4277108434  0.3317460317  5.4000000000  13.741455707  0.0250096321  13.741455707  300           0.0171039486
0.0006613855  -0.000031229  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  6.3000000000  7.7742076397  0.0250096321  7.7742076397  350           0.0175260019
0.0002480083  0.0000119534  0.3600000000  0.3571428571  0.3220000000  0.3333333333  0.3810240964  0.4277108434  0.3373493976  0.3493975904  0.3428571429  7.2000000000  3.6193297815  0.0250096321  3.6193297815  400           0.0167059183
0.0000362450  -0.000001435  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3333333333  8.1000000000  1.4646005917  0.0250096321  1.4646005917  450           0.0164489269
0.0000089928  0.0000000770  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3333333333  9.0000000000  1.1896266341  0.0250096321  1.1896266341  500           0.0180977392
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 15
	normlizetype: 0-1
	output_dir: train_output/3edcd8b195034bc895c9762084243ff2
	save_model_every_checkpoint: False
	seed: 1903015815
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	class_balanced: False
	data_augmentation: True
	ib_lambda: 401.5955275119616
	ib_penalty_anneal_iters: 40
	irm_lambda: 267.39441352133804
	irm_penalty_anneal_iters: 3211
	lr: 3.947537104470031e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0010784038403040138
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0238593891  0.0148333674  0.3340000000  0.2936507937  0.2900000000  0.2380952381  0.4201807229  0.4277108434  0.2695783133  0.2710843373  0.2857142857  0.0000000000  1.2068635225  0.0337877274  1.2068635225  0             0.3853852749
0.0233723760  0.0053871306  0.3460000000  0.3333333333  0.3860000000  0.3333333333  0.4337349398  0.4216867470  0.5542168675  0.5421686747  0.3634920635  1.9000000000  2.6217842519  0.0403819084  2.6217842519  50            0.0174121857
0.0030864739  0.0003261019  0.3660000000  0.3174603175  0.3160000000  0.3333333333  0.3283132530  0.3132530120  0.3810240964  0.3915662651  0.4031746032  3.8000000000  2.3224486828  0.0403819084  2.3224486828  100           0.0179170656
0.0002436352  0.0000046885  0.3320000000  0.3174603175  0.3280000000  0.3174603175  0.3328313253  0.3192771084  0.4427710843  0.4457831325  0.3444444444  5.7000000000  1.1948225498  0.0403819084  1.1948225498  150           0.0172689772
0.0000434679  -0.000000712  0.3300000000  0.3333333333  0.3320000000  0.3253968254  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  7.6000000000  1.1155974126  0.0403819084  1.1155974126  200           0.0174584246
0.0000234507  0.0000003293  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  9.5000000000  1.1074034381  0.0403819084  1.1074034381  250           0.0186672878
0.0000131948  0.0000002066  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  11.400000000  1.1035154486  0.0403819084  1.1035154486  300           0.0173733902
0.0000084601  0.0000004000  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  13.300000000  1.1016659021  0.0403819084  1.1016659021  350           0.0185338545
0.0000062918  0.0000003253  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  15.200000000  1.1007214642  0.0403819084  1.1007214642  400           0.0179822445
0.0000043383  0.0000011522  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  17.100000000  1.1000294852  0.0403819084  1.1000294852  450           0.0177498150
0.0000040891  0.0000005050  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  19.000000000  1.0997526646  0.0403819084  1.0997526646  500           0.0182068205
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 26
	normlizetype: 0-1
	output_dir: train_output/828138dc3da4e768564fdec8b22d9d27
	save_model_every_checkpoint: False
	seed: 2062712475
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	class_balanced: False
	data_augmentation: True
	lr: 8.565284674514954e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 6.458460261300383e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3120000000  0.3095238095  0.3060000000  0.3412698413  0.3584337349  0.3373493976  0.5240963855  0.5060240964  0.3444444444  0.0000000000  1.1034979820  0.0275869370  0             0.3856208324
0.5180000000  0.4682539683  0.5260000000  0.5317460317  0.6370481928  0.6807228916  0.7560240964  0.7469879518  0.5015873016  3.7000000000  0.9913868201  0.0344033241  50            0.0378459930
0.6140000000  0.5634920635  0.5880000000  0.5476190476  0.7379518072  0.7831325301  0.8358433735  0.8493975904  0.6095238095  7.4000000000  0.7857655597  0.0344033241  100           0.0385256433
0.6280000000  0.5873015873  0.5940000000  0.5238095238  0.8373493976  0.8433734940  0.8539156627  0.8493975904  0.6603174603  11.100000000  0.6472150344  0.0344033241  150           0.0379285812
0.6560000000  0.6190476190  0.6140000000  0.5555555556  0.8734939759  0.8795180723  0.8614457831  0.8554216867  0.7063492063  14.800000000  0.5359702563  0.0344033241  200           0.0380131626
0.6900000000  0.6428571429  0.6280000000  0.5555555556  0.8780120482  0.8975903614  0.8810240964  0.8734939759  0.6984126984  18.500000000  0.4274088347  0.0344033241  250           0.0389327955
0.7420000000  0.6825396825  0.7000000000  0.5793650794  0.8930722892  0.8975903614  0.9367469880  0.9036144578  0.7555555556  22.200000000  0.3606268474  0.0344033241  300           0.0383974981
0.7600000000  0.6984126984  0.7060000000  0.5714285714  0.8780120482  0.8855421687  0.9412650602  0.9096385542  0.7428571429  25.900000000  0.3150393191  0.0344033241  350           0.0383486032
0.8000000000  0.7460317460  0.7540000000  0.6031746032  0.8810240964  0.8855421687  0.9728915663  0.9397590361  0.7698412698  29.600000000  0.2772050026  0.0344033241  400           0.0376080608
0.8400000000  0.7857142857  0.7560000000  0.6190476190  0.8734939759  0.8795180723  0.9713855422  0.9337349398  0.7555555556  33.300000000  0.2559306574  0.0344033241  450           0.0376907539
0.8360000000  0.7698412698  0.7760000000  0.6428571429  0.8930722892  0.8855421687  0.9894578313  0.9698795181  0.7396825397  37.000000000  0.2168725875  0.0344033241  500           0.0385294580
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output/8d1ef4148e9f14c4744de36bca0fd2c2
	save_model_every_checkpoint: False
	seed: 698608283
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	ib_lambda: 100.0
	ib_penalty_anneal_iters: 500
	irm_lambda: 100.0
	irm_penalty_anneal_iters: 500
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0259671751  0.0331289358  0.3680000000  0.3650793651  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.2209445238  0.0540137291  1.2209445238  0             0.3191728592
0.2568767277  0.0114290458  0.8620000000  0.8015873016  0.7800000000  0.7380952381  0.8825301205  0.8674698795  0.9292168675  0.9337349398  0.5222222222  3.2000000000  0.5969725215  0.0604467392  0.5969725215  50            0.0177302217
0.7486876738  0.0048707175  0.9800000000  0.8968253968  0.9680000000  0.8412698413  0.9879518072  0.9638554217  0.9984939759  0.9939759036  0.5253968254  6.4000000000  0.2242039917  0.0604467392  0.2242039917  100           0.0168715572
1.0660115671  0.0028409403  0.9860000000  0.9206349206  0.9840000000  0.8730158730  0.9728915663  0.9397590361  0.8990963855  0.8975903614  0.4761904762  9.6000000000  0.1089730825  0.0604467392  0.1089730825  150           0.0182865095
1.1379762387  0.0011454794  1.0000000000  0.9682539683  0.9940000000  0.9126984127  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4158730159  12.800000000  0.0693406797  0.0604467392  0.0693406797  200           0.0186157799
1.4566801691  0.0005965276  1.0000000000  0.9761904762  1.0000000000  0.9285714286  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3333333333  16.000000000  0.0333874484  0.0604467392  0.0333874484  250           0.0189545012
1.5675449896  0.0004206542  1.0000000000  0.9682539683  1.0000000000  0.8968253968  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.3476190476  19.200000000  0.0177260764  0.0604467392  0.0177260764  300           0.0180811548
1.7667939210  0.0002590053  1.0000000000  0.9761904762  1.0000000000  0.9047619048  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3476190476  22.400000000  0.0093051563  0.0604467392  0.0093051563  350           0.0171774292
1.8580677915  0.0001568673  1.0000000000  0.9761904762  1.0000000000  0.9206349206  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4206349206  25.600000000  0.0082880312  0.0604467392  0.0082880312  400           0.0175308275
1.8814578915  0.0000476585  1.0000000000  0.9761904762  1.0000000000  0.9126984127  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3111111111  28.800000000  0.0113394877  0.0604467392  0.0113394877  450           0.0180580759
1.7158999491  0.0003210999  1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3079365079  32.000000000  3.5991403609  0.0604467392  3.5991403609  500           0.0185808277
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 24
	normlizetype: 0-1
	output_dir: train_output/9eecaafd2bbb22dadb05d56a2064c8b8
	save_model_every_checkpoint: False
	seed: 1723210530
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 0.12580410496686742
	gda: True
	lr: 4.2550345485619685e-06
	lr_d: 6.0798944767365025e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.16815518834388057
	weight_decay: 2.5430730771167478e-05
	weight_decay_d: 0.006344796396926569
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3300000000  0.3174603175  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3015873016  0.0000000000  0.0377274789  1.2715570927  0.0603790283  0             0.3532383442
0.3280000000  0.3253968254  0.3340000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3047619048  3.6000000000  0.0351540923  1.2348129463  0.0629692078  50            0.0338327026
0.3280000000  0.3253968254  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3063492063  7.2000000000  0.0318207269  1.2303948832  0.0629692078  100           0.0348795795
0.3280000000  0.3253968254  0.3340000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3095238095  10.800000000  0.0340865577  1.2278040123  0.0629692078  150           0.0340868855
0.3280000000  0.3253968254  0.3340000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3111111111  14.400000000  0.0317080346  1.2360452890  0.0629692078  200           0.0349099588
0.3280000000  0.3253968254  0.3320000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3095238095  18.000000000  0.0358080309  1.2400893641  0.0629692078  250           0.0341589928
0.3280000000  0.3253968254  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3063492063  21.600000000  0.0338405410  1.2230336094  0.0629692078  300           0.0334738111
0.3280000000  0.3253968254  0.3340000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3095238095  25.200000000  0.0322080966  1.2358219004  0.0629692078  350           0.0345677567
0.3280000000  0.3253968254  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3047619048  28.800000000  0.0353023163  1.2233160019  0.0629692078  400           0.0339581633
0.3280000000  0.3253968254  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3111111111  32.400000000  0.0334220046  1.2313909435  0.0629692078  450           0.0331553221
0.3280000000  0.3253968254  0.3340000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3063492063  36.000000000  0.0350100631  1.2302586579  0.0629692078  500           0.0347876215
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 20
	normlizetype: 0-1
	output_dir: train_output/dd9fad0500ef6582dfcfd1cdb323097c
	save_model_every_checkpoint: False
	seed: 844909113
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1.5755814713441232e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.09483935072662e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3680000000  0.3492063492  0.3180000000  0.3650793651  0.3870481928  0.3433734940  0.3750000000  0.4638554217  0.3365079365  0.0000000000  1.0458910465  0.0247988701  0             0.3457067013
0.4180000000  0.4285714286  0.3560000000  0.3968253968  0.5527108434  0.5843373494  0.5180722892  0.5421686747  0.3920634921  3.2000000000  1.0816328955  0.0311059952  50            0.0373877478
0.4600000000  0.4682539683  0.4400000000  0.4682539683  0.6340361446  0.6686746988  0.5361445783  0.5421686747  0.4714285714  6.4000000000  1.0486113560  0.0311059952  100           0.0383523083
0.4880000000  0.5079365079  0.4720000000  0.4920634921  0.7198795181  0.7228915663  0.6490963855  0.6566265060  0.5174603175  9.6000000000  1.0233862579  0.0311059952  150           0.0388623714
0.5080000000  0.5000000000  0.5000000000  0.4920634921  0.7394578313  0.7289156627  0.7484939759  0.7289156627  0.5349206349  12.800000000  0.9889869702  0.0311059952  200           0.0381082296
0.5220000000  0.5000000000  0.4940000000  0.5000000000  0.7590361446  0.7590361446  0.8132530120  0.7951807229  0.5396825397  16.000000000  0.9540992343  0.0311059952  250           0.0395529127
0.5380000000  0.5000000000  0.5080000000  0.5079365079  0.7740963855  0.7831325301  0.8177710843  0.8132530120  0.5634920635  19.200000000  0.9253971839  0.0311059952  300           0.0394907808
0.5540000000  0.5079365079  0.5040000000  0.5000000000  0.7906626506  0.7891566265  0.8087349398  0.7891566265  0.5777777778  22.400000000  0.8966114497  0.0311059952  350           0.0393720531
0.5540000000  0.5158730159  0.4940000000  0.4920634921  0.7951807229  0.7951807229  0.8283132530  0.7951807229  0.5809523810  25.600000000  0.8678580427  0.0311059952  400           0.0382936716
0.5780000000  0.5476190476  0.5120000000  0.5079365079  0.8253012048  0.8072289157  0.8042168675  0.7831325301  0.5984126984  28.800000000  0.8275924742  0.0311059952  450           0.0380795670
0.5880000000  0.5714285714  0.5200000000  0.5079365079  0.8313253012  0.8072289157  0.7771084337  0.7590361446  0.6079365079  32.000000000  0.8002463925  0.0311059952  500           0.0388278437
Setting up a new session...
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 25
	normlizetype: 0-1
	output_dir: train_output/c8605c31d4267614a6383d9ec8454495
	save_model_every_checkpoint: False
	seed: 1380997127
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	ib_lambda: 122.38980907424576
	ib_penalty_anneal_iters: 232
	irm_lambda: 364.7912957860404
	irm_penalty_anneal_iters: 170
	lr: 5.146604061136627e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.00038542677274601146
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0320573524  0.0086366935  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.0972784758  0.0226345062  1.0972784758  0             0.3167550564
0.0353387290  0.0073109465  0.6060000000  0.6190476190  0.6060000000  0.5873015873  0.7018072289  0.7228915663  0.6641566265  0.7048192771  0.6063492063  1.2000000000  0.9952360415  0.0302786827  0.9952360415  50            0.0164544725
0.0729622456  0.0235511541  0.6200000000  0.5952380952  0.6400000000  0.6031746032  0.8102409639  0.7951807229  0.8448795181  0.8734939759  0.6349206349  2.4000000000  0.7870045686  0.0302786827  0.7870045686  100           0.0171769953
0.1394144450  0.0216643574  0.7280000000  0.7301587302  0.6880000000  0.6507936508  0.7876506024  0.7409638554  0.8343373494  0.8795180723  0.7015873016  3.6000000000  0.5863090187  0.0302786827  0.5863090187  150           0.0177779293
0.2007153004  0.0125278610  0.7360000000  0.7380952381  0.7060000000  0.6507936508  0.7409638554  0.7108433735  0.7981927711  0.8554216867  0.6730158730  4.8000000000  3.4399826020  0.0302786827  3.4399826020  200           0.0170102119
0.1948482001  0.0067608913  0.7340000000  0.7380952381  0.7300000000  0.6587301587  0.7424698795  0.7048192771  0.8463855422  0.8674698795  0.6904761905  6.0000000000  11.286090418  0.0302786827  11.286090418  250           0.0166025257
0.1270204319  0.0100345741  0.6440000000  0.6269841270  0.6620000000  0.6507936508  0.6837349398  0.6626506024  0.8102409639  0.8554216867  0.4714285714  7.2000000000  19.804011230  0.0302786827  19.804011230  300           0.0180446100
0.0866407786  0.0008057231  0.5000000000  0.4682539683  0.5600000000  0.5396825397  0.6340361446  0.6807228916  0.6490963855  0.7168674699  0.3714285714  8.4000000000  11.591204481  0.0302786827  11.591204481  350           0.0180300617
0.0628634725  0.0061013846  0.4480000000  0.4365079365  0.5140000000  0.5158730159  0.7033132530  0.6927710843  0.6581325301  0.6927710843  0.3714285714  9.6000000000  10.679458408  0.0302786827  10.679458408  400           0.0177506828
0.0430112802  0.0113236039  0.3660000000  0.3730158730  0.4040000000  0.3968253968  0.6099397590  0.6445783133  0.5918674699  0.6084337349  0.3634920635  10.800000000  10.230168323  0.0302786827  10.230168323  450           0.0173339701
0.0308229388  -0.000320262  0.4120000000  0.4126984127  0.5000000000  0.5079365079  0.5858433735  0.6445783133  0.5903614458  0.6265060241  0.3587301587  12.000000000  4.5576653433  0.0302786827  4.5576653433  500           0.0177634096
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 30
	normlizetype: 0-1
	output_dir: train_output/6a707c9919009a5e6a2c615940b0d6dd
	save_model_every_checkpoint: False
	seed: 162766566
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2.3632985262971253
	gda: True
	lr: 1.5000005301577322e-05
	lr_d: 3.650484141805548e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 1.9975602619956987
	weight_decay: 0.0042201907446770565
	weight_decay_d: 7.680106801670587e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.4100000000  0.3650793651  0.3580000000  0.3730158730  0.3222891566  0.2771084337  0.5135542169  0.5240963855  0.3968253968  0.0000000000  0.2682158947  1.0712543726  0.0261921883  0             0.3855793476
0.4280000000  0.3650793651  0.3660000000  0.3809523810  0.2966867470  0.2710843373  0.4668674699  0.4939759036  0.4158730159  1.4000000000  0.2670131324  1.0997631931  0.0280194283  50            0.0893423748
0.4380000000  0.3571428571  0.3700000000  0.3968253968  0.3147590361  0.2831325301  0.4472891566  0.4879518072  0.4142857143  2.8000000000  0.2409421744  1.1008244467  0.0280194283  100           0.0859688616
0.4400000000  0.3650793651  0.3700000000  0.4285714286  0.3042168675  0.2650602410  0.4563253012  0.4879518072  0.4190476190  4.2000000000  0.2419194078  1.1022360754  0.0280194283  150           0.0839348364
0.4280000000  0.3650793651  0.3680000000  0.4047619048  0.3147590361  0.2710843373  0.4563253012  0.4759036145  0.4047619048  5.6000000000  0.2401621567  1.1068149424  0.0280194283  200           0.0858422947
0.4360000000  0.3650793651  0.3700000000  0.4047619048  0.3192771084  0.2771084337  0.4442771084  0.4759036145  0.4222222222  7.0000000000  0.2441138966  1.1010329628  0.0280194283  250           0.0861566830
0.4440000000  0.3650793651  0.3720000000  0.4126984127  0.3117469880  0.2710843373  0.4533132530  0.4759036145  0.4174603175  8.4000000000  0.2383339953  1.1035785484  0.0280194283  300           0.0841269398
0.4420000000  0.3730158730  0.3700000000  0.3968253968  0.3042168675  0.2771084337  0.4472891566  0.4759036145  0.4222222222  9.8000000000  0.2231891230  1.0948379993  0.0280194283  350           0.0858164454
0.4420000000  0.3412698413  0.3660000000  0.3888888889  0.3012048193  0.2771084337  0.4668674699  0.4939759036  0.4174603175  11.200000000  0.2350648309  1.1024695039  0.0280194283  400           0.0842237425
0.4320000000  0.3809523810  0.3720000000  0.4126984127  0.3117469880  0.2831325301  0.4668674699  0.4939759036  0.4206349206  12.600000000  0.2399434615  1.0998521161  0.0280194283  450           0.0813009691
0.4280000000  0.3492063492  0.3720000000  0.4126984127  0.3268072289  0.2951807229  0.4352409639  0.4759036145  0.4206349206  14.000000000  0.2490650725  1.1148959470  0.0280194283  500           0.0833334494
Setting up a new session...
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 30
	normlizetype: 0-1
	output_dir: train_output/0ab4e4f5595fa984669a09f8f10ec4c8
	save_model_every_checkpoint: False
	seed: 1288979067
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 14
	class_balanced: False
	data_augmentation: True
	lr: 1.5000005301577322e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.0042201907446770565
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.0701295137  0.0178670883  0             0.3420982361
0.3860000000  0.3730158730  0.3500000000  0.3571428571  0.3945783133  0.4096385542  0.4006024096  0.3975903614  0.3777777778  1.4000000000  1.0642407167  0.0241742134  50            0.0393913412
0.4200000000  0.3968253968  0.3740000000  0.3571428571  0.4653614458  0.5000000000  0.5150602410  0.5662650602  0.3968253968  2.8000000000  1.0423251748  0.0241742134  100           0.0390526199
0.4380000000  0.4365079365  0.3920000000  0.3809523810  0.5045180723  0.5000000000  0.5542168675  0.6024096386  0.4158730159  4.2000000000  1.0371826971  0.0241742134  150           0.0396355724
0.4640000000  0.4444444444  0.4000000000  0.4047619048  0.5527108434  0.5361445783  0.5783132530  0.6144578313  0.4412698413  5.6000000000  1.0239731371  0.0241742134  200           0.0401076555
0.4820000000  0.4603174603  0.4040000000  0.4206349206  0.5798192771  0.5361445783  0.6099397590  0.6445783133  0.4587301587  7.0000000000  1.0310118783  0.0241742134  250           0.0402263451
0.4820000000  0.4682539683  0.4100000000  0.4206349206  0.5933734940  0.5542168675  0.6415662651  0.6385542169  0.4650793651  8.4000000000  1.0122974920  0.0241742134  300           0.0402819109
0.4840000000  0.4761904762  0.4180000000  0.4206349206  0.6114457831  0.6144578313  0.6701807229  0.6566265060  0.4841269841  9.8000000000  1.0037842035  0.0241742134  350           0.0393324471
0.4820000000  0.4761904762  0.4220000000  0.4206349206  0.6234939759  0.6385542169  0.7138554217  0.6987951807  0.4984126984  11.200000000  0.9814934301  0.0241742134  400           0.0402587843
0.4840000000  0.4761904762  0.4160000000  0.4285714286  0.6536144578  0.6506024096  0.7168674699  0.6867469880  0.5079365079  12.600000000  0.9922903204  0.0241742134  450           0.0418320179
0.4940000000  0.4761904762  0.4160000000  0.4285714286  0.6596385542  0.6265060241  0.7183734940  0.7048192771  0.5095238095  14.000000000  0.9899427700  0.0241742134  500           0.0412304592
Setting up a new session...
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 38
	normlizetype: 0-1
	output_dir: train_output/f9a2743eee15dfd885f880917f8f3b95
	save_model_every_checkpoint: False
	seed: 1096983951
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 1.8003331063433314
	gda: True
	lr: 0.0003054141477566941
	lr_d: 0.0002420511531223339
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.33192415831653754
	weight_decay: 0.002589420292952896
	weight_decay_d: 0.0003264121728404551
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3320000000  0.2936507937  0.3380000000  0.3412698413  0.3328313253  0.3313253012  0.4397590361  0.4337349398  0.2936507937  0.0000000000  0.0765087530  1.1282168627  0.0164556503  0             0.3973572254
0.3380000000  0.3095238095  0.3380000000  0.3571428571  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3031746032  0.8000000000  0.0686299372  1.1387163711  0.0183744431  50            0.0732011604
0.3360000000  0.3095238095  0.3400000000  0.3571428571  0.3358433735  0.3313253012  0.4367469880  0.4216867470  0.3047619048  1.6000000000  0.0869972175  1.1424103355  0.0183744431  100           0.0799958563
0.3300000000  0.3095238095  0.3440000000  0.3571428571  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3015873016  2.4000000000  0.0895619264  1.1418088102  0.0183744431  150           0.0834583187
Connection to remote host was lost.
on_close() takes 1 positional argument but 3 were given
0.3340000000  0.3095238095  0.3440000000  0.3650793651  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.2904761905  3.2000000000  0.0772852313  1.1441766715  0.0183744431  200           0.0839633322
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3280000000  0.3095238095  0.3380000000  0.3571428571  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3079365079  4.0000000000  0.0802709179  1.1476205468  0.0183744431  250           0.0838161707
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3300000000  0.3095238095  0.3340000000  0.3571428571  0.3358433735  0.3313253012  0.4367469880  0.4216867470  0.3063492063  4.8000000000  0.0843303834  1.1448137498  0.0183744431  300           0.0835383606
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3260000000  0.3095238095  0.3420000000  0.3571428571  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3111111111  5.6000000000  0.0923538152  1.1355677199  0.0183744431  350           0.0819799948
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3320000000  0.3095238095  0.3320000000  0.3571428571  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3063492063  6.4000000000  0.0776239295  1.1398003983  0.0183744431  400           0.0813432360
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3320000000  0.3174603175  0.3360000000  0.3492063492  0.3358433735  0.3313253012  0.4382530120  0.4277108434  0.3047619048  7.2000000000  0.0808259255  1.1548882890  0.0183744431  450           0.0802639198
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
0.3340000000  0.3095238095  0.3460000000  0.3571428571  0.3358433735  0.3313253012  0.4367469880  0.4216867470  0.3047619048  8.0000000000  0.0833001602  1.1315485549  0.0183744431  500           0.0828557968
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f0d59e08048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0d59e08048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0d59e08048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 38
	normlizetype: 0-1
	output_dir: train_output/4e2a420a8c884289bf61bad59505cb67
	save_model_every_checkpoint: False
	seed: 1628639127
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	ib_lambda: 4427.808868138759
	ib_penalty_anneal_iters: 854
	irm_lambda: 2538.8240244671892
	irm_penalty_anneal_iters: 58
	lr: 0.0003054141477566941
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.002589420292952896
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0309740417  -0.001386642  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3507936508  0.0000000000  1.1299985647  0.0164666176  1.1299985647  0             0.4021334648
0.0996766182  0.0094378347  0.6680000000  0.6666666667  0.6300000000  0.6507936508  0.8358433735  0.8132530120  0.8599397590  0.8734939759  0.7698412698  0.8000000000  0.7801052845  0.0225868225  0.7801052845  50            0.0190561533
0.1522901863  0.0269727287  0.5600000000  0.5079365079  0.6040000000  0.5952380952  0.7740963855  0.7590361446  0.8057228916  0.8253012048  0.5492063492  1.6000000000  68.919104827  0.0225868225  68.919104827  100           0.0186590576
0.0951505342  0.0183146413  0.6760000000  0.6587301587  0.6100000000  0.5952380952  0.8328313253  0.7891566265  0.6686746988  0.7108433735  0.6444444444  2.4000000000  47.311427588  0.0225868225  47.311427588  150           0.0191562510
0.0630695967  0.0158971108  0.6560000000  0.6349206349  0.6220000000  0.6111111111  0.5195783133  0.5361445783  0.4804216867  0.4879518072  0.5952380952  3.2000000000  41.208201515  0.0225868225  41.208201515  200           0.0180881548
0.0350339258  0.0131196456  0.5240000000  0.5317460317  0.4640000000  0.4761904762  0.3930722892  0.3915662651  0.3328313253  0.3313253012  0.5444444444  4.0000000000  34.252433513  0.0225868225  34.252433513  250           0.0184413910
0.0286474452  0.0023513053  0.5720000000  0.5158730159  0.5860000000  0.5873015873  0.5617469880  0.5722891566  0.4277108434  0.4096385542  0.4571428571  4.8000000000  6.9352259350  0.0225868225  6.9352259350  300           0.0179982281
0.0201600808  0.0062928861  0.3740000000  0.3412698413  0.3920000000  0.3968253968  0.3629518072  0.3915662651  0.4774096386  0.5000000000  0.3412698413  5.6000000000  17.003252382  0.0225868225  17.003252382  350           0.0191681433
0.0130661683  0.0022894608  0.3740000000  0.3492063492  0.3180000000  0.3333333333  0.4472891566  0.4397590361  0.4457831325  0.4457831325  0.4095238095  6.4000000000  6.8501819181  0.0225868225  6.8501819181  400           0.0176154041
0.0117970439  0.0018857838  0.4160000000  0.3968253968  0.3560000000  0.3492063492  0.4472891566  0.4277108434  0.5496987952  0.5722891566  0.4269841270  7.2000000000  5.8469823551  0.0225868225  5.8469823551  450           0.0175186539
0.0092644781  0.0009727006  0.3220000000  0.4126984127  0.3000000000  0.2857142857  0.3659638554  0.3795180723  0.4141566265  0.4277108434  0.3349206349  8.0000000000  3.5446006703  0.0225868225  3.5446006703  500           0.0177079153
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc88467e1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc88467e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc88467e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 42
	normlizetype: 0-1
	output_dir: train_output/6f13e85df52a48766a6f58c2a842c604
	save_model_every_checkpoint: False
	seed: 2103485419
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 19
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1.9027670779552528
	ib_penalty_anneal_iters: 201
	irm_lambda: 4.763859004759767
	irm_penalty_anneal_iters: 20
	lr: 9.421443606372291e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 9.220948243966033e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0219452120  0.0014634649  0.4000000000  0.3888888889  0.3560000000  0.3492063492  0.3524096386  0.3734939759  0.2424698795  0.2590361446  0.3523809524  0.0000000000  1.1493083239  0.0337877274  1.1493083239  0             0.4011027813
0.0200289431  0.0010166851  0.4400000000  0.4523809524  0.4800000000  0.4444444444  0.5135542169  0.4518072289  0.5647590361  0.5963855422  0.4523809524  1.9000000000  1.1027625299  0.0403819084  1.1027625299  50            0.0182586384
0.0207048624  0.0008364426  0.4960000000  0.5317460317  0.5560000000  0.5555555556  0.4683734940  0.4397590361  0.5798192771  0.6325301205  0.4777777778  3.8000000000  1.0570423555  0.0403819084  1.0570423555  100           0.0181414270
0.0234342422  0.0032707773  0.5020000000  0.5634920635  0.5920000000  0.5793650794  0.4804216867  0.4759036145  0.5451807229  0.6024096386  0.4714285714  5.7000000000  1.0262646794  0.0403819084  1.0262646794  150           0.0189709473
0.0276429362  0.0031895646  0.5020000000  0.5317460317  0.5820000000  0.5634920635  0.4804216867  0.4879518072  0.5376506024  0.5361445783  0.4317460317  7.6000000000  0.9902404404  0.0403819084  0.9902404404  200           0.0186867952
0.0303979745  0.0036811384  0.5000000000  0.5158730159  0.5680000000  0.5396825397  0.5150602410  0.5301204819  0.5572289157  0.5662650602  0.4000000000  9.5000000000  1.0175955319  0.0403819084  1.0175955319  250           0.0220877600
0.0313739353  0.0035478622  0.5080000000  0.5158730159  0.5860000000  0.5634920635  0.5030120482  0.5301204819  0.5512048193  0.5783132530  0.4349206349  11.400000000  1.0000563610  0.0403819084  1.0000563610  300           0.0182839108
0.0312924390  0.0028599052  0.5080000000  0.5158730159  0.5880000000  0.5714285714  0.5301204819  0.5542168675  0.5722891566  0.5903614458  0.4333333333  13.300000000  0.9777994418  0.0403819084  0.9777994418  350           0.0184063101
0.0325465474  0.0038785031  0.5100000000  0.5158730159  0.5840000000  0.5634920635  0.5361445783  0.5542168675  0.5963855422  0.5903614458  0.4142857143  15.200000000  0.9689923084  0.0403819084  0.9689923084  400           0.0186488867
0.0339079431  0.0023140324  0.5080000000  0.5158730159  0.5900000000  0.5634920635  0.5406626506  0.5481927711  0.6189759036  0.5843373494  0.4095238095  17.100000000  0.9290569282  0.0403819084  0.9290569282  450           0.0182332563
0.0346318600  0.0033560497  0.5120000000  0.5158730159  0.5960000000  0.5793650794  0.5406626506  0.5481927711  0.6551204819  0.6566265060  0.4238095238  19.000000000  0.9414220047  0.0403819084  0.9414220047  500           0.0187159967
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fb3148a61d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb3148a61d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb3148a61d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 14
	normlizetype: 0-1
	output_dir: train_output/bb0adc164789dd6e24db976c4df3cffb
	save_model_every_checkpoint: False
	seed: 1503044472
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	ib_lambda: 57967.65775882664
	ib_penalty_anneal_iters: 2323
	irm_lambda: 75107.68046144242
	irm_penalty_anneal_iters: 3775
	lr: 0.000224138265260081
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0001792475881200468
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0254465770  0.0157486647  0.3340000000  0.3650793651  0.3160000000  0.3412698413  0.3689759036  0.3072289157  0.1611445783  0.1506024096  0.3761904762  0.0000000000  1.1729141474  0.0164666176  1.1729141474  0             0.3774917126
0.0577299102  0.0183335926  0.6600000000  0.6031746032  0.6340000000  0.5476190476  0.6415662651  0.6265060241  0.7274096386  0.7530120482  0.6984126984  0.8000000000  0.8888499379  0.0225868225  0.8888499379  50            0.0184846973
0.1646702521  0.0187218787  0.7940000000  0.7301587302  0.6940000000  0.6349206349  0.8132530120  0.7831325301  0.8719879518  0.8734939759  0.6825396825  1.6000000000  0.5713562667  0.0225868225  0.5713562667  100           0.0192525339
0.3179293025  -0.000850145  0.8160000000  0.8015873016  0.7360000000  0.6428571429  0.8840361446  0.8855421687  1.0000000000  0.9879518072  0.7460317460  2.4000000000  0.4229924563  0.0225868225  0.4229924563  150           0.0185413074
0.4098513323  0.0102310599  0.8620000000  0.7936507937  0.8100000000  0.6825396825  0.9051204819  0.8975903614  0.9969879518  1.0000000000  0.6269841270  3.2000000000  0.3568418106  0.0225868225  0.3568418106  200           0.0216562939
0.5110506052  0.0090191179  0.9280000000  0.9047619048  0.9300000000  0.8412698413  0.9894578313  0.9819277108  0.9924698795  0.9698795181  0.5158730159  4.0000000000  0.2738082080  0.0225868225  0.2738082080  250           0.0206140041
0.6610686475  0.0006445716  0.9540000000  0.8492063492  0.9380000000  0.8095238095  0.9954819277  0.9939759036  0.9909638554  0.9879518072  0.5920634921  4.8000000000  0.1779090042  0.0225868225  0.1779090042  300           0.0179154491
0.7487202120  0.0030962797  0.9780000000  0.8968253968  0.9660000000  0.8730158730  0.9804216867  0.9819277108  1.0000000000  0.9879518072  0.5793650794  5.6000000000  0.1520590179  0.0225868225  0.1520590179  350           0.0178135586
0.8459983492  0.0034193183  0.9820000000  0.9126984127  0.9600000000  0.8809523810  0.9954819277  0.9939759036  0.9819277108  0.9638554217  0.4460317460  6.4000000000  0.1302201201  0.0225868225  0.1302201201  400           0.0191075659
0.9476065159  0.0015975783  0.9960000000  0.9047619048  0.9920000000  0.9047619048  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.5793650794  7.2000000000  0.0968255109  0.0225868225  0.0968255109  450           0.0183506632
1.0124924803  0.0034554396  0.9940000000  0.9603174603  0.9880000000  0.9285714286  0.9969879518  0.9759036145  0.9111445783  0.8855421687  0.4809523810  8.0000000000  0.0955263163  0.0225868225  0.0955263163  500           0.0169588327
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f6f5061e0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f6f5061e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f6f5061e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 11
	normlizetype: 0-1
	output_dir: train_output/0e8e50f4346cede53e822012c4b41f45
	save_model_every_checkpoint: False
	seed: 1504713880
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.16845181196308315
	gda: True
	lr: 0.0001063542080951911
	lr_d: 0.0013230745103418966
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.014694083180383486
	weight_decay: 0.007283936884822311
	weight_decay_d: 0.0008216030170571376
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3300000000  0.3968253968  0.3660000000  0.3730158730  0.3930722892  0.4036144578  0.4036144578  0.4216867470  0.3079365079  0.0000000000  0.0070728371  1.0864971876  0.0304865837  0             0.5517580509
0.3480000000  0.3730158730  0.3860000000  0.3809523810  0.4156626506  0.4337349398  0.4503012048  0.4277108434  0.3047619048  1.7000000000  0.0039488297  1.1733113408  0.0332732201  50            0.0470707464
0.3540000000  0.3730158730  0.3860000000  0.3888888889  0.4186746988  0.4337349398  0.4578313253  0.4337349398  0.3031746032  3.4000000000  0.0038008511  1.1731421804  0.0332732201  100           0.0486407375
0.3500000000  0.3809523810  0.3860000000  0.3809523810  0.4216867470  0.4216867470  0.4427710843  0.4096385542  0.3047619048  5.1000000000  0.0036110295  1.1835624862  0.0332732201  150           0.0483606720
0.3480000000  0.3809523810  0.3900000000  0.3888888889  0.4156626506  0.4216867470  0.4548192771  0.4337349398  0.3015873016  6.8000000000  0.0038785475  1.1841181111  0.0332732201  200           0.0476357937
0.3480000000  0.3809523810  0.3840000000  0.3888888889  0.4186746988  0.4096385542  0.4487951807  0.4216867470  0.3031746032  8.5000000000  0.0034031366  1.1595705271  0.0332732201  250           0.0470512295
0.3520000000  0.3809523810  0.3920000000  0.3888888889  0.4156626506  0.4337349398  0.4578313253  0.4337349398  0.3015873016  10.200000000  0.0037598287  1.1763056350  0.0332732201  300           0.0478960323
0.3520000000  0.3730158730  0.3920000000  0.3809523810  0.4186746988  0.4337349398  0.4608433735  0.4337349398  0.3047619048  11.900000000  0.0036160454  1.1552589226  0.0332732201  350           0.0485257530
0.3520000000  0.3809523810  0.3860000000  0.3888888889  0.4201807229  0.4397590361  0.4563253012  0.4397590361  0.3015873016  13.600000000  0.0036392173  1.1935829043  0.0332732201  400           0.0476854324
0.3540000000  0.3809523810  0.3920000000  0.3888888889  0.4171686747  0.4397590361  0.4608433735  0.4337349398  0.3031746032  15.300000000  0.0036442172  1.1634148097  0.0332732201  450           0.0480324936
0.3500000000  0.3809523810  0.3880000000  0.3888888889  0.4141566265  0.4277108434  0.4563253012  0.4397590361  0.3031746032  17.000000000  0.0038253518  1.1845038390  0.0332732201  500           0.0482238007
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7efd08d5a0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efd08d5a0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efd08d5a0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 46
	normlizetype: 0-1
	output_dir: train_output/03ac46e0515b40afbb33d7210014f10a
	save_model_every_checkpoint: False
	seed: 104903400
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.3794427976113952
	gda: True
	lr: 5.819263934682494e-06
	lr_d: 0.00014958567030426352
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.04991289418553073
	weight_decay: 9.005702063600195e-06
	weight_decay_d: 0.0017404561856420415
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3240000000  0.3015873016  0.3300000000  0.3253968254  0.4367469880  0.3614457831  0.4111445783  0.4277108434  0.3698412698  0.0000000000  0.0053726733  1.1016012430  0.0272426605  0             0.4565324783
0.3060000000  0.3333333333  0.3400000000  0.3253968254  0.4698795181  0.4216867470  0.4126506024  0.4216867470  0.3603174603  1.5000000000  0.0072850170  1.0956627560  0.0290546417  50            0.0489018011
0.3080000000  0.3253968254  0.3440000000  0.3253968254  0.4653614458  0.4156626506  0.4126506024  0.4216867470  0.3571428571  3.0000000000  0.0062536813  1.0939451408  0.0290546417  100           0.0525662231
0.3120000000  0.3333333333  0.3400000000  0.3333333333  0.4668674699  0.4216867470  0.4126506024  0.4216867470  0.3603174603  4.5000000000  0.0065514996  1.0945672178  0.0290546417  150           0.0510653067
0.3080000000  0.3492063492  0.3260000000  0.3412698413  0.4728915663  0.4216867470  0.4126506024  0.4337349398  0.3587301587  6.0000000000  0.0061563797  1.0870634174  0.0290546417  200           0.0513118935
0.3080000000  0.3253968254  0.3360000000  0.3253968254  0.4638554217  0.4216867470  0.4126506024  0.4216867470  0.3571428571  7.5000000000  0.0070867252  1.0919954252  0.0290546417  250           0.0477601719
0.3140000000  0.3412698413  0.3400000000  0.3412698413  0.4698795181  0.4216867470  0.4111445783  0.4277108434  0.3619047619  9.0000000000  0.0066553368  1.0959237492  0.0290546417  300           0.0502981710
0.3080000000  0.3333333333  0.3400000000  0.3412698413  0.4668674699  0.4216867470  0.4126506024  0.4337349398  0.3603174603  10.500000000  0.0067304163  1.0922005129  0.0290546417  350           0.0487932873
0.3100000000  0.3333333333  0.3380000000  0.3412698413  0.4668674699  0.4216867470  0.4141566265  0.4277108434  0.3603174603  12.000000000  0.0064911414  1.0884058213  0.0290546417  400           0.0502890587
0.3100000000  0.3253968254  0.3320000000  0.3174603175  0.4518072289  0.4096385542  0.4126506024  0.4216867470  0.3571428571  13.500000000  0.0068197073  1.0913707614  0.0290546417  450           0.0491786528
0.3020000000  0.3333333333  0.3400000000  0.3333333333  0.4683734940  0.4277108434  0.4141566265  0.4277108434  0.3603174603  15.000000000  0.0067770054  1.0963690758  0.0290546417  500           0.0485307693
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fb808741048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb808741048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb808741048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 12
	normlizetype: 0-1
	output_dir: train_output/caa36b67cb5195497e909ba69626ac44
	save_model_every_checkpoint: False
	seed: 1370488683
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 1.1979706663228542
	gda: True
	lr: 0.0002779717688784654
	lr_d: 0.0008830568136501807
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.033348063070913474
	weight_decay: 0.0006183744461455339
	weight_decay_d: 0.0051916577810613975
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3900000000  0.3492063492  0.3740000000  0.4523809524  0.3870481928  0.4277108434  0.3810240964  0.3795180723  0.4126984127  0.0000000000  0.0002558964  1.0952571630  0.0621166229  0             0.4320261478
0.3560000000  0.2857142857  0.3600000000  0.4126984127  0.3765060241  0.4096385542  0.3825301205  0.4216867470  0.3904761905  3.7000000000  0.0021096165  1.1011599326  0.0643215179  50            0.0866714811
0.3580000000  0.2857142857  0.3620000000  0.4206349206  0.3765060241  0.4096385542  0.3840361446  0.4156626506  0.3888888889  7.4000000000  0.0021101137  1.1039625645  0.0643215179  100           0.0876128483
0.3560000000  0.2857142857  0.3600000000  0.4126984127  0.3765060241  0.4096385542  0.3855421687  0.4216867470  0.3873015873  11.100000000  0.0019387920  1.0986738300  0.0643215179  150           0.0877098131
0.3580000000  0.2857142857  0.3600000000  0.4126984127  0.3765060241  0.4096385542  0.3855421687  0.4216867470  0.3841269841  14.800000000  0.0020901194  1.0990722752  0.0643215179  200           0.0879851866
0.3600000000  0.2936507937  0.3680000000  0.4206349206  0.3780120482  0.4156626506  0.3810240964  0.4156626506  0.3873015873  18.500000000  0.0018831857  1.0958846569  0.0643215179  250           0.0848561049
0.3540000000  0.2857142857  0.3600000000  0.4047619048  0.3765060241  0.3975903614  0.3765060241  0.4096385542  0.3888888889  22.200000000  0.0020453232  1.0994678307  0.0643215179  300           0.0874991274
0.3620000000  0.2777777778  0.3640000000  0.4126984127  0.3765060241  0.4096385542  0.3795180723  0.4216867470  0.3920634921  25.900000000  0.0022426156  1.0991317677  0.0643215179  350           0.0871175051
0.3500000000  0.2936507937  0.3580000000  0.3968253968  0.3734939759  0.3975903614  0.3900602410  0.4156626506  0.3809523810  29.600000000  0.0019846659  1.0988995051  0.0643215179  400           0.0921955872
0.3540000000  0.2777777778  0.3600000000  0.4206349206  0.3674698795  0.3975903614  0.3855421687  0.4216867470  0.3873015873  33.300000000  0.0019510591  1.1024929261  0.0643215179  450           0.0861543322
0.3560000000  0.2936507937  0.3600000000  0.3968253968  0.3734939759  0.3975903614  0.3900602410  0.4277108434  0.3809523810  37.000000000  0.0019197780  1.0950680637  0.0643215179  500           0.0861448145
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f8c2da6b0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8c2da6b0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8c2da6b0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 48
	normlizetype: 0-1
	output_dir: train_output/0e0bc5145579971a3f8096ca72a94b4a
	save_model_every_checkpoint: False
	seed: 466902567
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.17411770749853528
	gda: True
	lr: 3.359889134792047e-06
	lr_d: 5.591360130957274e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.41475951880344486
	weight_decay: 1.951688644028676e-06
	weight_decay_d: 0.008890284034235345
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3040000000  0.3571428571  0.3280000000  0.2619047619  0.2981927711  0.2891566265  0.2183734940  0.2590361446  0.2682539683  0.0000000000  0.0998768210  1.1166076660  0.0179972649  0             0.4148371220
0.3020000000  0.2936507937  0.3120000000  0.2777777778  0.2891566265  0.2650602410  0.1852409639  0.1867469880  0.2396825397  0.9000000000  0.0559233916  1.1251513886  0.0203423500  50            0.0926253033
0.3060000000  0.3015873016  0.3180000000  0.2777777778  0.2921686747  0.2771084337  0.2033132530  0.1987951807  0.2444444444  1.8000000000  0.0601408622  1.1219831300  0.0203423500  100           0.0818866968
0.2980000000  0.2936507937  0.3120000000  0.2857142857  0.2966867470  0.2590361446  0.1957831325  0.1927710843  0.2349206349  2.7000000000  0.0544071183  1.1271191669  0.0203423500  150           0.0824557209
0.3060000000  0.3015873016  0.3140000000  0.2777777778  0.2891566265  0.2650602410  0.2063253012  0.1987951807  0.2460317460  3.6000000000  0.0545459484  1.1231249070  0.0203423500  200           0.0829684114
0.2960000000  0.3015873016  0.3100000000  0.2777777778  0.3012048193  0.2650602410  0.2018072289  0.1807228916  0.2444444444  4.5000000000  0.0649371740  1.1246646810  0.0203423500  250           0.0822863388
0.2920000000  0.3015873016  0.3100000000  0.2619047619  0.2906626506  0.2831325301  0.1912650602  0.1987951807  0.2428571429  5.4000000000  0.0603249085  1.1199119616  0.0203423500  300           0.0832045507
0.3040000000  0.3015873016  0.3160000000  0.2777777778  0.2846385542  0.2710843373  0.2093373494  0.1987951807  0.2460317460  6.3000000000  0.0576362142  1.1255311966  0.0203423500  350           0.0822267103
0.3020000000  0.3095238095  0.3140000000  0.2619047619  0.2876506024  0.2710843373  0.1927710843  0.1927710843  0.2428571429  7.2000000000  0.0614387864  1.1292421222  0.0203423500  400           0.0829049921
0.2960000000  0.2936507937  0.3140000000  0.2936507937  0.2981927711  0.2530120482  0.2018072289  0.1927710843  0.2444444444  8.1000000000  0.0532714785  1.1247890782  0.0203423500  450           0.0837646818
0.3000000000  0.3174603175  0.3140000000  0.2857142857  0.2906626506  0.2710843373  0.2048192771  0.2048192771  0.2428571429  9.0000000000  0.0633088188  1.1208939385  0.0203423500  500           0.0849523211
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7efe1c20c0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efe1c20c0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efe1c20c0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 25
	normlizetype: 0-1
	output_dir: train_output/ca9b6ce14bcabd6707b110aff98023d6
	save_model_every_checkpoint: False
	seed: 1006883726
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.8183595158934198
	gda: True
	lr: 5.146604061136627e-05
	lr_d: 0.0028135033592684546
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.6962212628354729
	weight_decay: 0.00038542677274601146
	weight_decay_d: 9.464242811842353e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3440000000  0.3253968254  0.3080000000  0.2698412698  0.4246987952  0.3975903614  0.3042168675  0.2891566265  0.3539682540  0.0000000000  0.2589768767  1.1655987501  0.0226192474  0             0.3745236397
0.3480000000  0.3253968254  0.3460000000  0.3253968254  0.4246987952  0.3975903614  0.2816265060  0.2710843373  0.3603174603  1.2000000000  0.1518239259  1.1582750154  0.0244770050  50            0.0351673269
0.3440000000  0.3253968254  0.3420000000  0.3333333333  0.4111445783  0.3795180723  0.2876506024  0.2831325301  0.3634920635  2.4000000000  0.1421900469  1.1507946253  0.0244770050  100           0.0355590582
0.3500000000  0.3253968254  0.3440000000  0.3253968254  0.4156626506  0.3855421687  0.2801204819  0.2530120482  0.3587301587  3.6000000000  0.1377807101  1.1498594046  0.0244770050  150           0.0353048182
0.3480000000  0.3412698413  0.3440000000  0.3174603175  0.4262048193  0.4036144578  0.2756024096  0.2710843373  0.3714285714  4.8000000000  0.1318222171  1.1497687054  0.0244770050  200           0.0357138968
0.3440000000  0.3253968254  0.3480000000  0.3253968254  0.4231927711  0.3915662651  0.2801204819  0.2771084337  0.3650793651  6.0000000000  0.1386863195  1.1541210914  0.0244770050  250           0.0363687849
0.3440000000  0.3253968254  0.3360000000  0.3253968254  0.4096385542  0.3975903614  0.2831325301  0.2771084337  0.3603174603  7.2000000000  0.1465039357  1.1567918634  0.0244770050  300           0.0356068563
0.3480000000  0.3333333333  0.3460000000  0.3253968254  0.4262048193  0.4036144578  0.2740963855  0.2650602410  0.3682539683  8.4000000000  0.1399497084  1.1580673885  0.0244770050  350           0.0364381838
0.3480000000  0.3253968254  0.3480000000  0.3174603175  0.4201807229  0.3915662651  0.2801204819  0.2771084337  0.3650793651  9.6000000000  0.1454800296  1.1518596697  0.0244770050  400           0.0374754333
0.3500000000  0.3253968254  0.3520000000  0.3253968254  0.4171686747  0.3915662651  0.2831325301  0.2650602410  0.3603174603  10.800000000  0.1400077223  1.1437184381  0.0244770050  450           0.0361559010
0.3480000000  0.3333333333  0.3420000000  0.3174603175  0.4186746988  0.3975903614  0.2756024096  0.2831325301  0.3666666667  12.000000000  0.1371421234  1.1542090416  0.0244770050  500           0.0365638256
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f1d8a9741d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f1d8a9741d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f1d8a9741d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 11
	normlizetype: 0-1
	output_dir: train_output/c686838b1083cae2933f4c164dfe1598
	save_model_every_checkpoint: False
	seed: 335560538
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	ib_lambda: 3893.6685722579427
	ib_penalty_anneal_iters: 77
	irm_lambda: 2.808110141152446
	irm_penalty_anneal_iters: 30
	lr: 0.0001063542080951911
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.007283936884822311
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0221829880  0.0044321539  0.4100000000  0.3333333333  0.4060000000  0.3730158730  0.4668674699  0.5060240964  0.4141566265  0.3795180723  0.3365079365  0.0000000000  1.1912126541  0.0305061340  1.1912126541  0             0.4082570076
0.0449781432  0.0114763750  0.6440000000  0.6349206349  0.6240000000  0.6587301587  0.7048192771  0.7228915663  0.7545180723  0.7409638554  0.7190476190  1.7000000000  0.8881647646  0.0366358757  0.8881647646  50            0.0178591871
0.0685055037  0.0168984306  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3349206349  3.4000000000  60.622671201  0.0366358757  60.622671201  100           0.0188913441
0.0034777245  0.0062251983  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  5.1000000000  14.674477272  0.0366358757  14.674477272  150           0.0189732122
0.0015792669  -0.000167383  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  6.8000000000  7.2482602310  0.0366358757  7.2482602310  200           0.0185354805
0.0007568999  0.0000555837  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  8.5000000000  4.0474612093  0.0366358757  4.0474612093  250           0.0189178467
0.0003803660  0.0001328861  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  10.200000000  2.5772626829  0.0366358757  2.5772626829  300           0.0178125286
0.0002672867  0.0000527685  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  11.900000000  2.1365238714  0.0366358757  2.1365238714  350           0.0186067009
0.0002034717  0.0000782719  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  13.600000000  1.8886783671  0.0366358757  1.8886783671  400           0.0181571579
0.0001607131  0.0000221026  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  15.300000000  1.7213627887  0.0366358757  1.7213627887  450           0.0178594637
0.0001277665  0.0000246026  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  17.000000000  1.5927992511  0.0366358757  1.5927992511  500           0.0179713583
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f8ae05c10b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8ae05c10b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f8ae05c10b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 39
	normlizetype: 0-1
	output_dir: train_output/5fd4e0a2d5872fbd5722bdf944b1082c
	save_model_every_checkpoint: False
	seed: 733200287
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.2126073210970188
	gda: True
	lr: 4.2493565572404076e-05
	lr_d: 0.0011138324086836001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 3.90817147691627
	weight_decay: 0.0009464542120224201
	weight_decay_d: 0.000519821071169375
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3040000000  0.3174603175  0.3180000000  0.3095238095  0.2635542169  0.2710843373  0.2650602410  0.3012048193  0.3000000000  0.0000000000  0.2509765327  1.1024123430  0.0603790283  0             0.3852972984
0.3180000000  0.3412698413  0.2900000000  0.3412698413  0.3072289157  0.3253012048  0.4051204819  0.4036144578  0.2857142857  3.6000000000  0.3335715064  1.1301672912  0.0629692078  50            0.0483626366
0.3160000000  0.3412698413  0.2900000000  0.3253968254  0.3147590361  0.3313253012  0.4126506024  0.4096385542  0.2888888889  7.2000000000  0.3352905431  1.1222817779  0.0629692078  100           0.0500898552
0.3100000000  0.3492063492  0.2920000000  0.3333333333  0.3057228916  0.3192771084  0.4156626506  0.4096385542  0.2904761905  10.800000000  0.2950384165  1.1248388147  0.0629692078  150           0.0504110813
0.3140000000  0.3412698413  0.2860000000  0.3333333333  0.3132530120  0.3253012048  0.4081325301  0.4156626506  0.2888888889  14.400000000  0.2913826885  1.1217840385  0.0629692078  200           0.0487208271
0.3200000000  0.3412698413  0.2980000000  0.3412698413  0.3057228916  0.3192771084  0.4036144578  0.4096385542  0.2857142857  18.000000000  0.3181716635  1.1215333843  0.0629692078  250           0.0489284801
0.3160000000  0.3492063492  0.2900000000  0.3333333333  0.3117469880  0.3192771084  0.4036144578  0.4096385542  0.2873015873  21.600000000  0.2870049495  1.1246306849  0.0629692078  300           0.0507142735
0.3200000000  0.3412698413  0.2920000000  0.3333333333  0.3072289157  0.3253012048  0.4096385542  0.4096385542  0.2904761905  25.200000000  0.3200070561  1.1233830833  0.0629692078  350           0.0504444790
0.3200000000  0.3412698413  0.2900000000  0.3333333333  0.3087349398  0.3192771084  0.4081325301  0.4156626506  0.2873015873  28.800000000  0.3165904211  1.1187713313  0.0629692078  400           0.0503735638
0.3160000000  0.3412698413  0.2860000000  0.3333333333  0.3132530120  0.3253012048  0.4006024096  0.4096385542  0.2920634921  32.400000000  0.3320668977  1.1256823397  0.0629692078  450           0.0492017794
0.3180000000  0.3333333333  0.2900000000  0.3333333333  0.3117469880  0.3192771084  0.4111445783  0.4156626506  0.2888888889  36.000000000  0.3148210055  1.1233866239  0.0629692078  500           0.0484824133
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fbfbad741d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbfbad741d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fbfbad741d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 17
	normlizetype: 0-1
	output_dir: train_output/cbe7e4a4ef2f5b5b87df4b722299064f
	save_model_every_checkpoint: False
	seed: 1528925078
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	lr: 3.6576986778443787e-06
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.9162717441192257e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3720000000  0.3412698413  0.3680000000  0.4285714286  0.2846385542  0.3192771084  0.3734939759  0.3855421687  0.4190476190  0.0000000000  0.9580072761  0.0190234184  0             0.3872952461
0.4060000000  0.4444444444  0.4180000000  0.4047619048  0.5030120482  0.5180722892  0.5000000000  0.5662650602  0.4317460317  1.7000000000  1.0913120878  0.0253305435  50            0.0419415426
0.4480000000  0.4682539683  0.4440000000  0.4126984127  0.6280120482  0.6566265060  0.6114457831  0.6626506024  0.4571428571  3.4000000000  1.0497231245  0.0253305435  100           0.0425501060
0.4740000000  0.4761904762  0.4500000000  0.4126984127  0.6987951807  0.7108433735  0.7334337349  0.7650602410  0.4698412698  5.1000000000  1.0202419353  0.0253305435  150           0.0421368313
0.4980000000  0.5317460317  0.4800000000  0.4523809524  0.7228915663  0.7349397590  0.7771084337  0.7349397590  0.5111111111  6.8000000000  0.9881448531  0.0253305435  200           0.0430021906
0.4880000000  0.5158730159  0.4640000000  0.4285714286  0.7500000000  0.7469879518  0.8042168675  0.8072289157  0.5063492063  8.5000000000  0.9552578211  0.0253305435  250           0.0426825476
0.5380000000  0.5634920635  0.4980000000  0.4523809524  0.7680722892  0.7951807229  0.8132530120  0.7831325301  0.5571428571  10.200000000  0.9354202390  0.0253305435  300           0.0418388176
0.5400000000  0.5714285714  0.4900000000  0.4603174603  0.7560240964  0.7951807229  0.8463855422  0.8072289157  0.5428571429  11.900000000  0.8865275466  0.0253305435  350           0.0417930317
0.5560000000  0.5793650794  0.4940000000  0.4682539683  0.7756024096  0.8132530120  0.8524096386  0.8192771084  0.5571428571  13.600000000  0.8374880886  0.0253305435  400           0.0410713387
0.5940000000  0.6031746032  0.5480000000  0.4920634921  0.7801204819  0.8192771084  0.8313253012  0.7951807229  0.6111111111  15.300000000  0.8176882815  0.0253305435  450           0.0422666931
0.5920000000  0.6111111111  0.5560000000  0.4920634921  0.7936746988  0.8253012048  0.8433734940  0.7951807229  0.6126984127  17.000000000  0.7841845238  0.0253305435  500           0.0431404161
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f159d2830b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f159d2830b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f159d2830b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 14
	normlizetype: 0-1
	output_dir: train_output/735a22c1dd7c015c47731ea2d96f8437
	save_model_every_checkpoint: False
	seed: 1929101800
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.2538830033927169
	gda: True
	lr: 0.000224138265260081
	lr_d: 4.411922070071961e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.5303635156073083
	weight_decay: 0.0001792475881200468
	weight_decay_d: 9.973358926790432e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3160000000  0.3333333333  0.3580000000  0.3333333333  0.3283132530  0.3253012048  0.3072289157  0.2771084337  0.2920634921  0.0000000000  0.1893610656  1.1674458981  0.0164556503  0             0.4003844261
0.3400000000  0.3492063492  0.3240000000  0.3015873016  0.3629518072  0.3433734940  0.3975903614  0.3855421687  0.3285714286  0.8000000000  0.1039263038  1.1244754422  0.0183744431  50            0.0342820692
0.3480000000  0.3412698413  0.3180000000  0.2936507937  0.3569277108  0.3433734940  0.3900602410  0.3915662651  0.3285714286  1.6000000000  0.1114993444  1.1427392840  0.0183744431  100           0.0326298523
0.3400000000  0.3492063492  0.3140000000  0.2936507937  0.3719879518  0.3554216867  0.3885542169  0.3855421687  0.3285714286  2.4000000000  0.0910923258  1.1351537943  0.0183744431  150           0.0331257439
0.3340000000  0.3492063492  0.3100000000  0.2936507937  0.3704819277  0.3493975904  0.3990963855  0.3915662651  0.3285714286  3.2000000000  0.1002547432  1.1294981432  0.0183744431  200           0.0327490282
0.3360000000  0.3333333333  0.3140000000  0.2936507937  0.3765060241  0.3614457831  0.3990963855  0.3915662651  0.3269841270  4.0000000000  0.1091836315  1.1348520637  0.0183744431  250           0.0329970598
0.3380000000  0.3492063492  0.3180000000  0.2857142857  0.3704819277  0.3493975904  0.3930722892  0.3915662651  0.3285714286  4.8000000000  0.0894022176  1.1402903867  0.0183744431  300           0.0324902058
0.3320000000  0.3333333333  0.3120000000  0.3015873016  0.3659638554  0.3554216867  0.3915662651  0.3855421687  0.3285714286  5.6000000000  0.1087334121  1.1401325452  0.0183744431  350           0.0323054123
0.3400000000  0.3571428571  0.3160000000  0.2936507937  0.3674698795  0.3493975904  0.3885542169  0.3855421687  0.3238095238  6.4000000000  0.1062899995  1.1359286404  0.0183744431  400           0.0321489477
0.3360000000  0.3412698413  0.3180000000  0.3015873016  0.3644578313  0.3493975904  0.3870481928  0.3795180723  0.3285714286  7.2000000000  0.1147589346  1.1404678178  0.0183744431  450           0.0329360247
0.3340000000  0.3492063492  0.3220000000  0.2857142857  0.3719879518  0.3554216867  0.4081325301  0.3915662651  0.3238095238  8.0000000000  0.0905441136  1.1248547840  0.0183744431  500           0.0323887682
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f4b0cce01d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4b0cce01d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4b0cce01d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 32
	normlizetype: 0-1
	output_dir: train_output/d3a7fdd5ddefb280f9b2a1d1174e2a33
	save_model_every_checkpoint: False
	seed: 569841045
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	lr: 1.183640744652948e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 4.756462551889598e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3380000000  0.3095238095  0.3120000000  0.2698412698  0.2048192771  0.2048192771  0.3057228916  0.3313253012  0.3809523810  0.0000000000  1.1174802780  0.0190234184  0             0.3950705528
0.4060000000  0.3650793651  0.3580000000  0.3571428571  0.2846385542  0.2469879518  0.4954819277  0.5481927711  0.4523809524  1.7000000000  1.1159186554  0.0253305435  50            0.0440882969
0.4320000000  0.4285714286  0.3860000000  0.4047619048  0.4683734940  0.4879518072  0.5542168675  0.5542168675  0.5301587302  3.4000000000  1.0860587573  0.0253305435  100           0.0418512154
0.4560000000  0.4285714286  0.4020000000  0.4285714286  0.5632530120  0.6024096386  0.5527108434  0.5602409639  0.5650793651  5.1000000000  1.0872004282  0.0253305435  150           0.0431744814
0.4640000000  0.4603174603  0.4300000000  0.4365079365  0.5963855422  0.6265060241  0.5737951807  0.5843373494  0.5539682540  6.8000000000  1.0599872994  0.0253305435  200           0.0473214483
0.4660000000  0.4523809524  0.4460000000  0.4365079365  0.6204819277  0.6385542169  0.6144578313  0.6385542169  0.5666666667  8.5000000000  1.0530525720  0.0253305435  250           0.0470177984
0.4600000000  0.4523809524  0.4520000000  0.4682539683  0.6250000000  0.6445783133  0.6234939759  0.6626506024  0.5634920635  10.200000000  1.0295068216  0.0253305435  300           0.0496616173
0.4500000000  0.4365079365  0.4520000000  0.4761904762  0.6385542169  0.6626506024  0.6219879518  0.6445783133  0.5444444444  11.900000000  1.0376251912  0.0253305435  350           0.0455446959
0.4460000000  0.4523809524  0.4540000000  0.4444444444  0.6536144578  0.6746987952  0.6415662651  0.6626506024  0.5349206349  13.600000000  1.0139357591  0.0253305435  400           0.0446980143
0.4520000000  0.4682539683  0.4580000000  0.4444444444  0.6626506024  0.6867469880  0.6536144578  0.6746987952  0.5253968254  15.300000000  0.9934734786  0.0253305435  450           0.0448612261
0.4580000000  0.4841269841  0.4580000000  0.4365079365  0.6701807229  0.7048192771  0.6807228916  0.6867469880  0.5158730159  17.000000000  1.0060081422  0.0253305435  500           0.0439481497
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f004f0f9048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f004f0f9048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f004f0f9048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 23
	normlizetype: 0-1
	output_dir: train_output/ac680a439d8d852710270c101cec9ca7
	save_model_every_checkpoint: False
	seed: 1115300780
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	lr: 0.00019694974226292723
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.0005037465137597051
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.4480000000  0.3888888889  0.3800000000  0.3809523810  0.3222891566  0.3734939759  0.3915662651  0.3975903614  0.4825396825  0.0000000000  1.1091244221  0.0174822807  0             0.3965475559
0.7620000000  0.7142857143  0.6620000000  0.5873015873  0.8072289157  0.7951807229  0.8915662651  0.8313253012  0.8158730159  1.3000000000  0.6892822051  0.0237894058  50            0.0437922716
0.8740000000  0.8095238095  0.7720000000  0.6507936508  0.8493975904  0.8674698795  0.9503012048  0.8975903614  0.7492063492  2.6000000000  0.3375552420  0.0237894058  100           0.0430705786
0.9400000000  0.8730158730  0.8200000000  0.7539682540  0.9081325301  0.8855421687  0.9668674699  0.9277108434  0.6555555556  3.9000000000  0.1966016474  0.0237894058  150           0.0456584883
0.9520000000  0.8809523810  0.8920000000  0.7539682540  0.9578313253  0.9638554217  0.9924698795  0.9819277108  0.6904761905  5.2000000000  0.1198905557  0.0237894058  200           0.0416055775
0.9880000000  0.9682539683  0.9560000000  0.8650793651  0.9789156627  0.9638554217  0.9954819277  0.9819277108  0.5777777778  6.5000000000  0.0924758278  0.0237894058  250           0.0422086668
0.9920000000  0.9523809524  0.9420000000  0.8333333333  0.9337349398  0.9277108434  0.9954819277  0.9819277108  0.5936507937  7.8000000000  0.0870758414  0.0237894058  300           0.0419687414
0.9980000000  0.9841269841  0.9800000000  0.9126984127  0.9563253012  0.9337349398  0.9984939759  0.9819277108  0.5809523810  9.1000000000  0.0542109879  0.0237894058  350           0.0426303053
0.9960000000  0.9761904762  0.9860000000  0.9206349206  0.9804216867  0.9578313253  0.9954819277  0.9819277108  0.6047619048  10.400000000  0.0643748222  0.0237894058  400           0.0438434076
0.9960000000  0.9841269841  0.9920000000  0.9285714286  0.9728915663  0.9759036145  0.9969879518  0.9879518072  0.6174603175  11.700000000  0.0449886516  0.0237894058  450           0.0440798044
1.0000000000  0.9920634921  0.9940000000  0.9206349206  0.9969879518  0.9879518072  1.0000000000  0.9879518072  0.5984126984  13.000000000  0.0334579273  0.0237894058  500           0.0432885408
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fe116c9e0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fe116c9e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fe116c9e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 33
	normlizetype: 0-1
	output_dir: train_output/eca15034177ce26e7596ac4bc15d7b5c
	save_model_every_checkpoint: False
	seed: 838193814
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.2890995767559048
	gda: True
	lr: 1.5327155575590226e-05
	lr_d: 0.0002086151402095389
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.9677667755733412
	weight_decay: 0.0008901835195953863
	weight_decay_d: 0.00018167468401890222
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3600000000  0.3492063492  0.3540000000  0.3253968254  0.3328313253  0.3192771084  0.3644578313  0.4096385542  0.3444444444  0.0000000000  0.6680042744  1.1230987310  0.0272426605  0             0.4228448868
0.3740000000  0.3730158730  0.3560000000  0.3253968254  0.3328313253  0.3192771084  0.3599397590  0.4156626506  0.3523809524  1.5000000000  0.4248218405  1.1356150389  0.0290546417  50            0.0852736759
0.3580000000  0.3650793651  0.3580000000  0.3333333333  0.3328313253  0.3192771084  0.3674698795  0.4216867470  0.3523809524  3.0000000000  0.4586277020  1.1345562720  0.0290546417  100           0.0862453079
0.3600000000  0.3650793651  0.3560000000  0.3333333333  0.3328313253  0.3192771084  0.3704819277  0.4216867470  0.3507936508  4.5000000000  0.4049616949  1.1331176782  0.0290546417  150           0.0901721382
0.3540000000  0.3809523810  0.3540000000  0.3333333333  0.3328313253  0.3192771084  0.3674698795  0.4216867470  0.3492063492  6.0000000000  0.4361840838  1.1462846780  0.0290546417  200           0.0876740503
0.3640000000  0.3730158730  0.3640000000  0.3333333333  0.3328313253  0.3192771084  0.3599397590  0.4036144578  0.3619047619  7.5000000000  0.4312975773  1.1311466694  0.0290546417  250           0.0877677059
0.3520000000  0.3571428571  0.3560000000  0.3253968254  0.3328313253  0.3192771084  0.3704819277  0.4096385542  0.3539682540  9.0000000000  0.4239231841  1.1430746841  0.0290546417  300           0.0912739658
0.3720000000  0.3730158730  0.3600000000  0.3333333333  0.3328313253  0.3192771084  0.3584337349  0.4096385542  0.3587301587  10.500000000  0.4745136866  1.1348132288  0.0290546417  350           0.0907946968
0.3600000000  0.3730158730  0.3520000000  0.3333333333  0.3328313253  0.3192771084  0.3599397590  0.4036144578  0.3476190476  12.000000000  0.4331566554  1.1271091771  0.0290546417  400           0.0877509451
0.3640000000  0.3571428571  0.3560000000  0.3253968254  0.3328313253  0.3192771084  0.3689759036  0.4156626506  0.3539682540  13.500000000  0.4339609957  1.1238731909  0.0290546417  450           0.0873319340
0.3640000000  0.3730158730  0.3560000000  0.3333333333  0.3328313253  0.3192771084  0.3584337349  0.4096385542  0.3571428571  15.000000000  0.4000446512  1.1328757405  0.0290546417  500           0.0854547596
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f33a7a85048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f33a7a85048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f33a7a85048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 9
	normlizetype: 0-1
	output_dir: train_output/66afd526da5ded1fdfa1185cd7a2b770
	save_model_every_checkpoint: False
	seed: 1055588413
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 0.7863579244975221
	gda: True
	lr: 1.2644242605786893e-05
	lr_d: 0.0009309714434329615
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 1.7401297880390447
	weight_decay: 2.240269970837554e-05
	weight_decay_d: 0.006008142228932282
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3120000000  0.3650793651  0.3300000000  0.3015873016  0.3780120482  0.4036144578  0.4427710843  0.4216867470  0.3587301587  0.0000000000  0.2198611200  1.0617815256  0.0241608620  0             0.4641308784
0.3280000000  0.3492063492  0.3160000000  0.2857142857  0.3885542169  0.4216867470  0.4472891566  0.4277108434  0.3666666667  1.3000000000  0.2012031922  1.1048087859  0.0260071754  50            0.0886428642
0.3260000000  0.3333333333  0.3140000000  0.2857142857  0.3780120482  0.4036144578  0.4503012048  0.4277108434  0.3555555556  2.6000000000  0.2014059732  1.1109554815  0.0260071754  100           0.0885482454
0.3340000000  0.3571428571  0.3240000000  0.2936507937  0.3915662651  0.4216867470  0.4533132530  0.4277108434  0.3650793651  3.9000000000  0.1999520651  1.1014250827  0.0260071754  150           0.0890687323
0.3220000000  0.3333333333  0.3140000000  0.2936507937  0.3780120482  0.4036144578  0.4503012048  0.4277108434  0.3619047619  5.2000000000  0.2211596357  1.1057228708  0.0260071754  200           0.0899214458
0.3260000000  0.3571428571  0.3240000000  0.2857142857  0.3915662651  0.4216867470  0.4472891566  0.4156626506  0.3603174603  6.5000000000  0.1948181158  1.1092003703  0.0260071754  250           0.0892039347
0.3200000000  0.3333333333  0.3160000000  0.2857142857  0.3855421687  0.4096385542  0.4487951807  0.4337349398  0.3587301587  7.8000000000  0.1998369614  1.0914594173  0.0260071754  300           0.0889492512
0.3360000000  0.3412698413  0.3240000000  0.2857142857  0.3870481928  0.4156626506  0.4457831325  0.4337349398  0.3650793651  9.1000000000  0.2037378516  1.1050301647  0.0260071754  350           0.0892414045
0.3300000000  0.3492063492  0.3160000000  0.2857142857  0.3915662651  0.4216867470  0.4427710843  0.4216867470  0.3650793651  10.400000000  0.2140334632  1.1074390602  0.0260071754  400           0.0885322094
0.3240000000  0.3492063492  0.3180000000  0.2936507937  0.3915662651  0.4216867470  0.4442771084  0.4156626506  0.3666666667  11.700000000  0.2130515224  1.1028129101  0.0260071754  450           0.0874329615
0.3220000000  0.3333333333  0.3220000000  0.2936507937  0.3810240964  0.4036144578  0.4487951807  0.4337349398  0.3571428571  13.000000000  0.2421120085  1.1083701134  0.0260071754  500           0.0877857780
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fdea80520b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fdea80520b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fdea80520b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 20
	normlizetype: 0-1
	output_dir: train_output/fe796b0f4c8c4c9a122282f2a93cb51f
	save_model_every_checkpoint: False
	seed: 1727685329
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 0.17644535335106432
	gda: True
	lr: 1.5755814713441232e-05
	lr_d: 9.636043751430535e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.2253660165001628
	weight_decay: 1.09483935072662e-06
	weight_decay_d: 1.1348597337314795e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3620000000  0.3571428571  0.3260000000  0.3095238095  0.3298192771  0.3313253012  0.3222891566  0.3253012048  0.3698412698  0.0000000000  0.0344230495  1.1937528849  0.0539793968  0             0.3976359367
0.3600000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  3.2000000000  0.0350242689  1.1684057975  0.0557227135  50            0.0491255188
0.3600000000  0.3412698413  0.3240000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  6.4000000000  0.0317194252  1.1612629080  0.0557227135  100           0.0500741434
0.3640000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  9.6000000000  0.0316664447  1.1627020049  0.0557227135  150           0.0483102846
0.3600000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  12.800000000  0.0337084015  1.1613230276  0.0557227135  200           0.0490638447
0.3580000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  16.000000000  0.0307969785  1.1715798092  0.0557227135  250           0.0506283617
0.3580000000  0.3412698413  0.3240000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  19.200000000  0.0290895946  1.1600803447  0.0557227135  300           0.0520836782
0.3600000000  0.3412698413  0.3240000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  22.400000000  0.0302476398  1.1575608015  0.0557227135  350           0.0497566652
0.3600000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  25.600000000  0.0324932450  1.1591630411  0.0557227135  400           0.0491270208
0.3600000000  0.3412698413  0.3260000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  28.800000000  0.0329028081  1.1671636653  0.0557227135  450           0.0489664888
0.3580000000  0.3412698413  0.3220000000  0.3174603175  0.3253012048  0.3253012048  0.3283132530  0.3373493976  0.3888888889  32.000000000  0.0312855919  1.1665989828  0.0557227135  500           0.0485617018
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fd8d8bab048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fd8d8bab048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fd8d8bab048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 45
	normlizetype: 0-1
	output_dir: train_output/db1e6b4e7b08b37753eb82da5e850e2d
	save_model_every_checkpoint: False
	seed: 862861223
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 13
	class_balanced: False
	data_augmentation: True
	ib_lambda: 4.74111017350068
	ib_penalty_anneal_iters: 542
	irm_lambda: 65510.404521072574
	irm_penalty_anneal_iters: 11
	lr: 8.92658249908763e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.003607553785079441
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0233399216  0.0052175699  0.3400000000  0.2777777778  0.3500000000  0.3015873016  0.3418674699  0.3433734940  0.4231927711  0.4156626506  0.3476190476  0.0000000000  1.1480094194  0.0241770744  1.1480094194  0             0.3628971577
0.0238776525  0.0004896421  0.3560000000  0.3492063492  0.3200000000  0.3888888889  0.4533132530  0.4759036145  0.3810240964  0.3554216867  0.2476190476  1.3000000000  11.972561690  0.0309615135  11.972561690  50            0.0177794409
0.0240526542  0.0002363370  0.4020000000  0.3650793651  0.3420000000  0.3492063492  0.4743975904  0.4759036145  0.4563253012  0.4156626506  0.2841269841  2.6000000000  16.577808351  0.0309615135  16.577808351  100           0.0183587122
0.0238069945  -0.000251117  0.3540000000  0.3492063492  0.3240000000  0.3968253968  0.3418674699  0.3554216867  0.4307228916  0.4337349398  0.2936507937  3.9000000000  -15.35716153  0.0309615135  -15.35716153  150           0.0191429710
0.0238024325  -0.000228366  0.4100000000  0.3968253968  0.3420000000  0.3888888889  0.3855421687  0.3855421687  0.4472891566  0.4518072289  0.3222222222  5.2000000000  -13.87041061  0.0309615135  -13.87041061  200           0.0180804110
0.0239138737  -0.000891830  0.3820000000  0.3730158730  0.3540000000  0.4126984127  0.3629518072  0.3554216867  0.4457831325  0.4457831325  0.3253968254  6.5000000000  -57.33580398  0.0309615135  -57.33580398  250           0.0179594326
0.0239299664  -0.000449310  0.3520000000  0.3253968254  0.3240000000  0.3492063492  0.3418674699  0.3313253012  0.4427710843  0.4457831325  0.3365079365  7.8000000000  -28.35597148  0.0309615135  -28.35597148  300           0.0192855167
0.0241887651  -0.000357797  0.3800000000  0.3492063492  0.3420000000  0.3888888889  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3476190476  9.1000000000  -22.34463378  0.0309615135  -22.34463378  350           0.0182590723
0.0237507044  -0.000151718  0.4240000000  0.3730158730  0.3760000000  0.4285714286  0.3373493976  0.3373493976  0.4457831325  0.4457831325  0.3555555556  10.400000000  -8.856693754  0.0309615135  -8.856693754  400           0.0175026655
0.0233179656  0.0004241068  0.4160000000  0.3571428571  0.3960000000  0.4126984127  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3539682540  11.700000000  28.854724855  0.0309615135  28.854724855  450           0.0179841614
0.0236910293  0.0003898951  0.3820000000  0.3730158730  0.3740000000  0.4285714286  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3412698413  13.000000000  26.621198930  0.0309615135  26.621198930  500           0.0174600220
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f4bc47301d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4bc47301d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4bc47301d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 48
	normlizetype: 0-1
	output_dir: train_output/0e0bb4583a35d1b04133867e31b404ad
	save_model_every_checkpoint: False
	seed: 1219164740
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	class_balanced: False
	data_augmentation: True
	ib_lambda: 7303.19315200785
	ib_penalty_anneal_iters: 12
	irm_lambda: 4225.300105606618
	irm_penalty_anneal_iters: 9314
	lr: 3.359889134792047e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.951688644028676e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0280342456  -0.005722639  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4367469880  0.4457831325  0.3349206349  0.0000000000  1.0985293388  0.0180091858  1.0985293388  0             0.3931989670
0.0250321406  0.0005496082  0.2940000000  0.2698412698  0.3760000000  0.2777777778  0.3012048193  0.3253012048  0.3554216867  0.3734939759  0.3158730159  0.9000000000  139.16428224  0.0250096321  139.16428224  50            0.0180145741
0.0180519495  0.0006263066  0.2980000000  0.2777777778  0.3320000000  0.3015873016  0.2846385542  0.2710843373  0.2801204819  0.3132530120  0.2746031746  1.8000000000  132.94884674  0.0250096321  132.94884674  100           0.0183853340
0.0129153982  0.0004181331  0.3060000000  0.3174603175  0.3120000000  0.3174603175  0.2771084337  0.3012048193  0.2530120482  0.2530120482  0.2317460317  2.7000000000  95.430741272  0.0250096321  95.430741272  150           0.0184877491
0.0097985545  0.0001455677  0.3100000000  0.3333333333  0.3080000000  0.3571428571  0.3087349398  0.3072289157  0.2274096386  0.2108433735  0.2412698413  3.6000000000  72.665577545  0.0250096321  72.665577545  200           0.0182232904
0.0076446190  -0.000100328  0.3200000000  0.3412698413  0.3500000000  0.4126984127  0.3373493976  0.3493975904  0.2319277108  0.2289156627  0.2682539683  4.5000000000  56.928685150  0.0250096321  56.928685150  250           0.0181785870
0.0058030948  0.0000909080  0.3580000000  0.3333333333  0.3560000000  0.4126984127  0.3614457831  0.3614457831  0.2530120482  0.2530120482  0.3063492063  5.4000000000  43.483076324  0.0250096321  43.483076324  300           0.0188596725
0.0046327432  -0.000140459  0.3340000000  0.3174603175  0.3560000000  0.3809523810  0.3719879518  0.3554216867  0.3358433735  0.3915662651  0.3444444444  6.3000000000  34.932214546  0.0250096321  34.932214546  350           0.0175155497
0.0037647777  0.0000326192  0.3280000000  0.3412698413  0.3920000000  0.3571428571  0.4412650602  0.4397590361  0.3674698795  0.4939759036  0.3698412698  7.2000000000  28.593050384  0.0250096321  28.593050384  400           0.0180886745
0.0030758573  0.0000635185  0.3240000000  0.3888888889  0.3740000000  0.3650793651  0.4759036145  0.4457831325  0.4367469880  0.5301204819  0.3793650794  8.1000000000  23.558698616  0.0250096321  23.558698616  450           0.0183669281
0.0026402701  0.0000065370  0.3200000000  0.3809523810  0.3680000000  0.3888888889  0.4397590361  0.3975903614  0.4578313253  0.4939759036  0.3666666667  9.0000000000  20.380359306  0.0250096321  20.380359306  500           0.0180710268
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f14c7b4c0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f14c7b4c0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f14c7b4c0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 3
	normlizetype: 0-1
	output_dir: train_output/77eb8f13a419b91502e636005f00c161
	save_model_every_checkpoint: False
	seed: 545672602
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 34
	class_balanced: False
	data_augmentation: True
	ib_lambda: 19.739988838233486
	ib_penalty_anneal_iters: 9540
	irm_lambda: 29.3676220201571
	irm_penalty_anneal_iters: 3001
	lr: 4.075301710543684e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 1.046949588651311e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0263100415  0.0016864957  0.3580000000  0.4047619048  0.3760000000  0.3492063492  0.3463855422  0.3373493976  0.3253012048  0.3373493976  0.3746031746  0.0000000000  1.1134667397  0.0567297935  1.1134667397  0             0.4014663696
0.0386396615  0.0124252906  0.5580000000  0.5634920635  0.5820000000  0.5555555556  0.7484939759  0.7409638554  0.7951807229  0.8192771084  0.5619047619  3.4000000000  0.9283928442  0.0628299713  0.9283928442  50            0.0181617689
0.1083437516  0.0151521380  0.6740000000  0.6507936508  0.6440000000  0.6190476190  0.7861445783  0.7710843373  0.7936746988  0.8132530120  0.6587301587  6.8000000000  0.6458527118  0.0628299713  0.6458527118  100           0.0183122683
0.1922901988  0.0113601903  0.8140000000  0.7222222222  0.7040000000  0.5952380952  0.8810240964  0.8734939759  0.8599397590  0.8855421687  0.6333333333  10.200000000  0.5117832524  0.0628299713  0.5117832524  150           0.0190004396
0.2634412450  0.0131525501  0.8520000000  0.7698412698  0.7760000000  0.6666666667  0.9141566265  0.8855421687  0.8915662651  0.9277108434  0.6380952381  13.600000000  0.4276894420  0.0628299713  0.4276894420  200           0.0188590908
0.3331843770  0.0117884339  0.8880000000  0.8253968254  0.8440000000  0.7301587302  0.9533132530  0.9337349398  0.9307228916  0.9638554217  0.6015873016  17.000000000  0.3577790773  0.0628299713  0.3577790773  250           0.0188685322
0.3940343744  0.0114420950  0.9100000000  0.8333333333  0.8840000000  0.7460317460  0.9608433735  0.9518072289  0.9623493976  0.9698795181  0.6365079365  20.400000000  0.3150573540  0.0628299713  0.3150573540  300           0.0181888390
0.4551888835  0.0102274634  0.9360000000  0.8571428571  0.9340000000  0.7936507937  0.9533132530  0.9457831325  0.9894578313  0.9939759036  0.5476190476  23.800000000  0.2689871886  0.0628299713  0.2689871886  350           0.0194892359
0.5101196170  0.0092357037  0.9580000000  0.8888888889  0.9520000000  0.8174603175  0.9819277108  0.9759036145  0.9909638554  1.0000000000  0.5285714286  27.200000000  0.2336577708  0.0628299713  0.2336577708  400           0.0183481598
0.5684007573  0.0070893369  0.9700000000  0.8809523810  0.9640000000  0.8253968254  0.9894578313  0.9939759036  0.9939759036  1.0000000000  0.5222222222  30.600000000  0.2038495111  0.0628299713  0.2038495111  450           0.0195919418
0.6225835598  0.0073880394  0.9780000000  0.9285714286  0.9660000000  0.8650793651  0.9879518072  0.9759036145  0.9969879518  1.0000000000  0.5047619048  34.000000000  0.1660140423  0.0628299713  0.1660140423  500           0.0185560703
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f66f7f601d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f7f601d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f7f601d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 46
	normlizetype: 0-1
	output_dir: train_output/20d24f9082a92674b764d97780321f94
	save_model_every_checkpoint: False
	seed: 547571531
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	lr: 5.819263934682494e-06
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 9.005702063600195e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3460000000  0.3174603175  0.3600000000  0.3412698413  0.3569277108  0.3554216867  0.3358433735  0.3313253012  0.3476190476  0.0000000000  1.0590482950  0.0182523727  0             0.3863015175
0.3420000000  0.3174603175  0.3800000000  0.3412698413  0.4984939759  0.5000000000  0.5331325301  0.5301204819  0.3603174603  1.5000000000  1.0822685218  0.0245594978  50            0.0430990839
0.4400000000  0.4047619048  0.4440000000  0.4365079365  0.5632530120  0.5421686747  0.5617469880  0.5722891566  0.4380952381  3.0000000000  1.0475601959  0.0245594978  100           0.0425221062
0.4940000000  0.4841269841  0.5000000000  0.5000000000  0.6807228916  0.7228915663  0.6385542169  0.6746987952  0.5111111111  4.5000000000  1.0034091055  0.0245594978  150           0.0426760674
0.5780000000  0.5555555556  0.5260000000  0.4920634921  0.7168674699  0.7469879518  0.6250000000  0.6686746988  0.5587301587  6.0000000000  0.9718812633  0.0245594978  200           0.0423896694
0.5900000000  0.5634920635  0.5660000000  0.5238095238  0.7334337349  0.7409638554  0.6114457831  0.6626506024  0.5809523810  7.5000000000  0.9201276004  0.0245594978  250           0.0420969772
0.5720000000  0.5634920635  0.5560000000  0.4841269841  0.7560240964  0.7831325301  0.6671686747  0.7048192771  0.5746031746  9.0000000000  0.8853500760  0.0245594978  300           0.0412930441
0.5940000000  0.5952380952  0.5700000000  0.5238095238  0.7951807229  0.8192771084  0.6716867470  0.6987951807  0.5904761905  10.500000000  0.8446120560  0.0245594978  350           0.0437683439
0.6080000000  0.6269841270  0.5720000000  0.5158730159  0.8072289157  0.8313253012  0.6792168675  0.7168674699  0.6126984127  12.000000000  0.8284137809  0.0245594978  400           0.0443480682
0.6000000000  0.6349206349  0.5940000000  0.5317460317  0.8162650602  0.8313253012  0.6792168675  0.7168674699  0.6333333333  13.500000000  0.7711978114  0.0245594978  450           0.0415695810
0.6280000000  0.6428571429  0.6040000000  0.5396825397  0.8448795181  0.8734939759  0.6822289157  0.7168674699  0.6666666667  15.000000000  0.7387455213  0.0245594978  500           0.0431851625
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7faa19d00048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7faa19d00048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7faa19d00048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 7
	normlizetype: 0-1
	output_dir: train_output/22c3eb0079fd298b5d396967f589b4c7
	save_model_every_checkpoint: False
	seed: 2044460036
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2.5388291254856723
	gda: True
	lr: 0.00010032967548752757
	lr_d: 0.0002237628551758385
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 2.3345534850441325
	weight_decay: 1.696474495087739e-05
	weight_decay_d: 0.0004038516901690286
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3280000000  0.3650793651  0.3300000000  0.3253968254  0.3253012048  0.3373493976  0.3313253012  0.3253012048  0.3412698413  0.0000000000  0.3561327457  1.1473977566  0.0226192474  0             0.4334893227
0.3240000000  0.3730158730  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3428571429  1.2000000000  0.3917284770  1.1480166221  0.0244770050  50            0.0897386885
0.3240000000  0.3809523810  0.3320000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3396825397  2.4000000000  0.4579476479  1.1423932433  0.0244770050  100           0.0896983337
0.3240000000  0.3730158730  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3380952381  3.6000000000  0.4316823271  1.1431590652  0.0244770050  150           0.0887261963
0.3240000000  0.3730158730  0.3300000000  0.3253968254  0.3268072289  0.3313253012  0.3298192771  0.3072289157  0.3365079365  4.8000000000  0.4053718235  1.1317748761  0.0244770050  200           0.0898692226
0.3220000000  0.3730158730  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3428571429  6.0000000000  0.4070230943  1.1461806488  0.0244770050  250           0.0888571978
0.3220000000  0.3730158730  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3365079365  7.2000000000  0.4186583263  1.1374690056  0.0244770050  300           0.0892437935
0.3220000000  0.3730158730  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3396825397  8.4000000000  0.3921435100  1.1493798947  0.0244770050  350           0.0894076729
0.3240000000  0.3730158730  0.3300000000  0.3253968254  0.3268072289  0.3313253012  0.3298192771  0.3072289157  0.3396825397  9.6000000000  0.3777122885  1.1449852276  0.0244770050  400           0.0884717131
0.3240000000  0.3809523810  0.3300000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3396825397  10.800000000  0.4631024776  1.1487519431  0.0244770050  450           0.0877049494
0.3220000000  0.3730158730  0.3280000000  0.3253968254  0.3237951807  0.3313253012  0.3298192771  0.3072289157  0.3396825397  12.000000000  0.4070287177  1.1424604797  0.0244770050  500           0.0903296137
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7efd48a1e1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efd48a1e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efd48a1e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 27
	normlizetype: 0-1
	output_dir: train_output/d965a15b552b0ddc462a8698905483d2
	save_model_every_checkpoint: False
	seed: 1081941479
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	lr: 6.439485988956746e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 4.594913877597109e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3620000000  0.2936507937  0.3600000000  0.3571428571  0.2981927711  0.3132530120  0.3599397590  0.2590361446  0.3444444444  0.0000000000  1.1719080210  0.0170950890  0             0.3919587135
0.4180000000  0.4523809524  0.4300000000  0.4206349206  0.5346385542  0.5000000000  0.5000000000  0.4939759036  0.3904761905  1.2000000000  1.0534721982  0.0234022141  50            0.0446540928
0.4780000000  0.5317460317  0.4800000000  0.4523809524  0.5858433735  0.5963855422  0.5662650602  0.5783132530  0.4476190476  2.4000000000  1.0342510080  0.0234022141  100           0.0431436872
0.4900000000  0.5158730159  0.5000000000  0.5000000000  0.6234939759  0.6626506024  0.6250000000  0.6204819277  0.4904761905  3.6000000000  0.9864194870  0.0234022141  150           0.0435986996
0.5240000000  0.5000000000  0.5240000000  0.5079365079  0.6596385542  0.7108433735  0.6777108434  0.6506024096  0.5460317460  4.8000000000  0.9336431980  0.0234022141  200           0.0429520178
0.5400000000  0.5158730159  0.5180000000  0.5000000000  0.7108433735  0.7349397590  0.6942771084  0.6686746988  0.5650793651  6.0000000000  0.9096962059  0.0234022141  250           0.0438831997
0.5760000000  0.5238095238  0.5300000000  0.4920634921  0.7349397590  0.7710843373  0.7078313253  0.6867469880  0.5936507937  7.2000000000  0.8753270233  0.0234022141  300           0.0430047560
0.5860000000  0.5238095238  0.5240000000  0.4841269841  0.7500000000  0.7710843373  0.7439759036  0.7590361446  0.6031746032  8.4000000000  0.8562758255  0.0234022141  350           0.0429463673
0.6000000000  0.5317460317  0.5280000000  0.4841269841  0.7695783133  0.7891566265  0.7575301205  0.7650602410  0.6063492063  9.6000000000  0.8193934762  0.0234022141  400           0.0424935865
0.6080000000  0.5158730159  0.5420000000  0.4841269841  0.7725903614  0.7891566265  0.7620481928  0.7710843373  0.6190476190  10.800000000  0.7934146130  0.0234022141  450           0.0429964066
0.6240000000  0.5476190476  0.5520000000  0.5000000000  0.8042168675  0.8192771084  0.7816265060  0.7891566265  0.6603174603  12.000000000  0.7624162912  0.0234022141  500           0.0440088367
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7efc169221d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efc169221d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7efc169221d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 17
	normlizetype: 0-1
	output_dir: train_output/63327bd62e0379c84dc3d16a7aa046b4
	save_model_every_checkpoint: False
	seed: 1684589784
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 17
	class_balanced: False
	data_augmentation: True
	ib_lambda: 16510.26914569429
	ib_penalty_anneal_iters: 2
	irm_lambda: 19331.071852599518
	irm_penalty_anneal_iters: 187
	lr: 3.6576986778443787e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.9162717441192257e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0299517680  0.0051274085  0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3349206349  0.0000000000  1.1462028027  0.0305061340  1.1462028027  0             0.3660457134
0.0269049786  0.0055045965  0.3580000000  0.3174603175  0.3720000000  0.3253968254  0.3373493976  0.3734939759  0.2500000000  0.2409638554  0.3317460317  1.7000000000  434.60534105  0.0366358757  434.60534105  50            0.0190648508
0.0183974031  0.0059508517  0.3660000000  0.3571428571  0.3600000000  0.3253968254  0.3237951807  0.3554216867  0.2801204819  0.2530120482  0.3285714286  3.4000000000  304.88760528  0.0366358757  304.88760528  100           0.0179963398
0.0127381649  0.0021511967  0.3660000000  0.3253968254  0.3480000000  0.3253968254  0.3222891566  0.3373493976  0.3177710843  0.2951807229  0.3333333333  5.1000000000  211.43433227  0.0366358757  211.43433227  150           0.0176920366
0.0090310419  0.0016944087  0.3600000000  0.3412698413  0.3400000000  0.3412698413  0.3237951807  0.3192771084  0.3283132530  0.3253012048  0.3317460317  6.8000000000  160.15481384  0.0366358757  160.15481384  200           0.0188630438
0.0071068703  0.0005333757  0.3740000000  0.3492063492  0.3500000000  0.3333333333  0.3207831325  0.3192771084  0.3298192771  0.3192771084  0.3380952381  8.5000000000  128.75534545  0.0366358757  128.75534545  250           0.0174551392
0.0057310355  0.0001775938  0.3760000000  0.3412698413  0.3500000000  0.3333333333  0.3298192771  0.3192771084  0.3328313253  0.3313253012  0.3396825397  10.200000000  99.159806060  0.0366358757  99.159806060  300           0.0169339466
0.0048431793  -0.000034462  0.3800000000  0.3571428571  0.3400000000  0.3412698413  0.3313253012  0.3253012048  0.3328313253  0.3313253012  0.3428571429  11.900000000  80.395953445  0.0366358757  80.395953445  350           0.0176658869
0.0041128833  0.0001129863  0.3720000000  0.3730158730  0.3400000000  0.3412698413  0.3313253012  0.3253012048  0.3328313253  0.3313253012  0.3444444444  13.600000000  71.188846206  0.0366358757  71.188846206  400           0.0174533129
0.0035512211  -0.000030618  0.3640000000  0.3730158730  0.3400000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3412698413  15.300000000  59.139439125  0.0366358757  59.139439125  450           0.0182763767
0.0031017833  0.0000217827  0.3520000000  0.3650793651  0.3440000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3396825397  17.000000000  52.732328758  0.0366358757  52.732328758  500           0.0183342314
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f2e8d7fb048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2e8d7fb048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2e8d7fb048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 22
	normlizetype: 0-1
	output_dir: train_output/fa950ccfba073f8c674812cd274296b0
	save_model_every_checkpoint: False
	seed: 1867187742
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	class_balanced: False
	data_augmentation: True
	ib_lambda: 5.233627229422146
	ib_penalty_anneal_iters: 23
	irm_lambda: 1178.2213603891653
	irm_penalty_anneal_iters: 35
	lr: 0.00016412676305809594
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 5.166436845791644e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0185140297  0.0033387481  0.3400000000  0.3492063492  0.3380000000  0.3333333333  0.3102409639  0.3012048193  0.3584337349  0.3373493976  0.3523809524  0.0000000000  1.1211789846  0.0557985306  1.1211789846  0             0.4030392170
0.0264974728  0.0182225583  0.4120000000  0.4206349206  0.4560000000  0.4206349206  0.4894578313  0.5240963855  0.5150602410  0.4939759036  0.3968253968  3.3000000000  6.5432466125  0.0621170998  6.5432466125  50            0.0184282446
0.0061348941  0.0017791754  0.3400000000  0.3412698413  0.3300000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3285714286  6.6000000000  3.1731964737  0.0621170998  3.1731964737  100           0.0185762024
0.0045578783  0.0000253691  0.3380000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3190476190  9.9000000000  1.1170521186  0.0621170998  1.1170521186  150           0.0185004520
0.0046685576  0.0004358268  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3317460317  13.200000000  1.6036587077  0.0621170998  1.6036587077  200           0.0192201185
0.0049041587  0.0000452737  0.3420000000  0.3492063492  0.3580000000  0.3412698413  0.3509036145  0.3433734940  0.2590361446  0.2530120482  0.3349206349  16.500000000  1.1475869401  0.0621170998  1.1475869401  250           0.0187239790
0.0043073250  0.0001688169  0.5840000000  0.5952380952  0.5760000000  0.6031746032  0.4683734940  0.4277108434  0.5195783133  0.5120481928  0.5111111111  19.800000000  1.2923875587  0.0621170998  1.2923875587  300           0.0187078714
0.0034901595  0.0002916545  0.3340000000  0.3412698413  0.3540000000  0.3333333333  0.3388554217  0.3313253012  0.2364457831  0.2349397590  0.3333333333  23.100000000  1.4391726726  0.0621170998  1.4391726726  350           0.0190406322
0.0024868280  0.0001597492  0.3320000000  0.3253968254  0.3320000000  0.3333333333  0.3283132530  0.3132530120  0.2680722892  0.2771084337  0.3269841270  26.400000000  1.2882213898  0.0621170998  1.2882213898  400           0.0201343679
0.0020080878  0.0000870021  0.3320000000  0.3253968254  0.3300000000  0.3333333333  0.3222891566  0.3132530120  0.2500000000  0.2409638554  0.3269841270  29.700000000  1.2048580235  0.0621170998  1.2048580235  450           0.0188230467
0.0018324733  0.0000371438  0.3260000000  0.2936507937  0.3260000000  0.2777777778  0.3343373494  0.3373493976  0.2259036145  0.2289156627  0.2936507937  33.000000000  1.1461158478  0.0621170998  1.1461158478  500           0.0187708759
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc1515860b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc1515860b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc1515860b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 7
	normlizetype: 0-1
	output_dir: train_output/33a7f67109febf041abb270e9e7653df
	save_model_every_checkpoint: False
	seed: 522080222
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	class_balanced: False
	data_augmentation: True
	ib_lambda: 525.2213273864295
	ib_penalty_anneal_iters: 3539
	irm_lambda: 2045.0085633275876
	irm_penalty_anneal_iters: 3
	lr: 0.00010032967548752757
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.696474495087739e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0203307141  0.0036225985  0.4160000000  0.4365079365  0.3920000000  0.4047619048  0.3780120482  0.3072289157  0.3268072289  0.3313253012  0.4317460317  0.0000000000  1.1406060457  0.0226345062  1.1406060457  0             0.3753151894
0.0175174310  0.0009929009  0.3320000000  0.3492063492  0.3680000000  0.3333333333  0.3418674699  0.3433734940  0.5466867470  0.5361445783  0.3349206349  1.2000000000  3.2423107755  0.0302786827  3.2423107755  50            0.0184503794
0.0168061506  0.0004827692  0.3640000000  0.3650793651  0.3340000000  0.2619047619  0.3614457831  0.3012048193  0.2530120482  0.3253012048  0.2873015873  2.4000000000  2.0717234087  0.0302786827  2.0717234087  100           0.0181168699
0.0155873201  0.0010698271  0.4340000000  0.4841269841  0.4520000000  0.4365079365  0.3780120482  0.3554216867  0.5376506024  0.5722891566  0.4873015873  3.6000000000  3.2674044323  0.0302786827  3.2674044323  150           0.0183282471
0.0163472620  0.0005578763  0.3780000000  0.4047619048  0.3460000000  0.3412698413  0.3388554217  0.3433734940  0.4171686747  0.4036144578  0.4079365079  4.8000000000  2.2135643613  0.0302786827  2.2135643613  200           0.0182570362
0.0151144088  0.0004210532  0.4520000000  0.4444444444  0.4440000000  0.4365079365  0.3945783133  0.3855421687  0.3358433735  0.3433734940  0.4285714286  6.0000000000  1.9308104491  0.0302786827  1.9308104491  250           0.0180775261
0.0167162196  0.0005755468  0.4100000000  0.3650793651  0.4240000000  0.3888888889  0.6159638554  0.6325301205  0.4533132530  0.4518072289  0.3317460317  7.2000000000  2.2525971520  0.0302786827  2.2525971520  300           0.0178877306
0.0146467613  0.0009706410  0.3880000000  0.3095238095  0.4000000000  0.4047619048  0.5105421687  0.4759036145  0.2695783133  0.2951807229  0.2920634921  8.4000000000  3.0600150728  0.0302786827  3.0600150728  350           0.0180032682
0.0127663379  0.0005574862  0.3580000000  0.2619047619  0.3520000000  0.3412698413  0.3298192771  0.3192771084  0.2364457831  0.2469879518  0.2507936508  9.6000000000  2.2310138595  0.0302786827  2.2310138595  400           0.0182032251
0.0125709642  0.0003150909  0.4740000000  0.4920634921  0.5100000000  0.4365079365  0.4457831325  0.4578313253  0.4774096386  0.5481927711  0.4238095238  10.800000000  1.7325957882  0.0302786827  1.7325957882  450           0.0180802155
0.0126600238  -0.000193775  0.4860000000  0.4444444444  0.4920000000  0.4603174603  0.5030120482  0.4698795181  0.3403614458  0.3493975904  0.4476190476  12.000000000  0.6869730818  0.0302786827  0.6869730818  500           0.0178340340
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f798660d1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f798660d1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f798660d1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 33
	normlizetype: 0-1
	output_dir: train_output/71bd57e1d1275ffb3fb44c606000de3a
	save_model_every_checkpoint: False
	seed: 414546118
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 15
	class_balanced: False
	data_augmentation: True
	ib_lambda: 1489.7842258979108
	ib_penalty_anneal_iters: 5694
	irm_lambda: 70.15836400157255
	irm_penalty_anneal_iters: 2824
	lr: 1.5327155575590226e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008901835195953863
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0195545051  0.0002393502  0.3480000000  0.2936507937  0.3020000000  0.2936507937  0.3057228916  0.2951807229  0.2243975904  0.2108433735  0.3063492063  0.0000000000  1.0980882645  0.0272607803  1.0980882645  0             0.3573808670
0.0200591630  0.0004226198  0.5100000000  0.4523809524  0.4980000000  0.5158730159  0.6942771084  0.6445783133  0.7861445783  0.7951807229  0.4936507937  1.5000000000  1.0752114630  0.0332741737  1.0752114630  50            0.0167566729
0.0243078442  0.0074750601  0.5060000000  0.4761904762  0.5160000000  0.5158730159  0.7153614458  0.6807228916  0.8463855422  0.8915662651  0.5206349206  3.0000000000  0.9949423134  0.0332741737  0.9949423134  100           0.0166654730
0.0333355244  0.0128096742  0.5300000000  0.5000000000  0.5160000000  0.5238095238  0.7394578313  0.6927710843  0.8629518072  0.8855421687  0.5396825397  4.5000000000  0.9065998828  0.0332741737  0.9065998828  150           0.0181926203
0.0451593834  0.0217005564  0.5480000000  0.5317460317  0.5940000000  0.5634920635  0.7093373494  0.6807228916  0.8539156627  0.8975903614  0.5746031746  6.0000000000  0.8278098571  0.0332741737  0.8278098571  200           0.0180303335
0.0605328979  0.0209924306  0.6060000000  0.5634920635  0.6220000000  0.5952380952  0.7560240964  0.7228915663  0.8689759036  0.9096385542  0.6142857143  7.5000000000  0.7409306324  0.0332741737  0.7409306324  250           0.0182677650
0.0789739877  0.0205168056  0.6320000000  0.5714285714  0.6460000000  0.6190476190  0.8192771084  0.7590361446  0.8780120482  0.9096385542  0.6460317460  9.0000000000  0.6748580992  0.0332741737  0.6748580992  300           0.0172131443
0.0933470571  0.0158221922  0.6740000000  0.5714285714  0.6720000000  0.6587301587  0.8298192771  0.7530120482  0.8734939759  0.9036144578  0.6777777778  10.500000000  0.6365231562  0.0332741737  0.6365231562  350           0.0166779852
0.1147066274  0.0173990173  0.7020000000  0.6111111111  0.6900000000  0.6825396825  0.8569277108  0.7891566265  0.8780120482  0.9096385542  0.7079365079  12.000000000  0.5614858204  0.0332741737  0.5614858204  400           0.0178332901
0.1328005031  0.0148569511  0.7140000000  0.6269841270  0.7000000000  0.6587301587  0.8870481928  0.8012048193  0.8719879518  0.8975903614  0.6936507937  13.500000000  0.5279657310  0.0332741737  0.5279657310  450           0.0167298412
0.1470297861  0.0110403343  0.7800000000  0.6746031746  0.7180000000  0.6984126984  0.8930722892  0.8373493976  0.8659638554  0.9096385542  0.7047619048  15.000000000  0.5164151639  0.0332741737  0.5164151639  500           0.0168056202
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f2ca42f5048>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2ca42f5048>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f2ca42f5048>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 37
	normlizetype: 0-1
	output_dir: train_output/c22f43a750f9eaa31342840caaa73e5f
	save_model_every_checkpoint: False
	seed: 860397731
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 11
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 1.3421198227037237
	gda: True
	lr: 8.122386866890388e-05
	lr_d: 0.00036831217953875125
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 1.0478890484986003
	weight_decay: 0.00010895616253593228
	weight_decay_d: 1.5559214778613265e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3760000000  0.3571428571  0.3660000000  0.3650793651  0.3674698795  0.3975903614  0.4608433735  0.4216867470  0.3698412698  0.0000000000  0.0811592937  1.0535608530  0.0210790634  0             0.4242389202
0.3560000000  0.3888888889  0.3340000000  0.3253968254  0.4352409639  0.4518072289  0.4246987952  0.3855421687  0.3777777778  1.1000000000  0.1497578046  1.1084341693  0.0236740112  50            0.0483894253
0.3580000000  0.3968253968  0.3420000000  0.3253968254  0.4292168675  0.4518072289  0.4277108434  0.3855421687  0.3857142857  2.2000000000  0.1728973722  1.1156713939  0.0236740112  100           0.0488982105
0.3560000000  0.3650793651  0.3320000000  0.3412698413  0.4246987952  0.4457831325  0.4201807229  0.3795180723  0.3777777778  3.3000000000  0.1434842299  1.1093849397  0.0236740112  150           0.0495330667
0.3540000000  0.3809523810  0.3280000000  0.3333333333  0.4307228916  0.4337349398  0.4322289157  0.3795180723  0.3793650794  4.4000000000  0.1592235740  1.1161747694  0.0236740112  200           0.0499055433
0.3540000000  0.3730158730  0.3380000000  0.3412698413  0.4337349398  0.4337349398  0.4231927711  0.3915662651  0.3746031746  5.5000000000  0.1539004230  1.1158732367  0.0236740112  250           0.0512483788
0.3520000000  0.3730158730  0.3360000000  0.3412698413  0.4307228916  0.4337349398  0.4186746988  0.3855421687  0.3793650794  6.6000000000  0.1543115911  1.1137646604  0.0236740112  300           0.0501658106
0.3580000000  0.3888888889  0.3380000000  0.3492063492  0.4246987952  0.4337349398  0.4201807229  0.3795180723  0.3761904762  7.7000000000  0.1660732473  1.1124917674  0.0236740112  350           0.0498927546
0.3500000000  0.3571428571  0.3340000000  0.3253968254  0.4367469880  0.4337349398  0.4186746988  0.3855421687  0.3682539683  8.8000000000  0.1589779440  1.1116113496  0.0236740112  400           0.0501405525
0.3540000000  0.3888888889  0.3400000000  0.3253968254  0.4337349398  0.4457831325  0.4141566265  0.3795180723  0.3793650794  9.9000000000  0.1591647129  1.1063132024  0.0236740112  450           0.0501037073
0.3560000000  0.3650793651  0.3340000000  0.3412698413  0.4352409639  0.4397590361  0.4186746988  0.3855421687  0.3730158730  11.000000000  0.1771225253  1.1161586070  0.0236740112  500           0.0498930311
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f4286b880b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4286b880b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4286b880b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 27
	normlizetype: 0-1
	output_dir: train_output/3b501be8284b094c82ff35959a00fa03
	save_model_every_checkpoint: False
	seed: 1351242202
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 12
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 1.1118566056454284
	gda: True
	lr: 6.439485988956746e-05
	lr_d: 0.0009253528385794579
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.11213532334287517
	weight_decay: 4.594913877597109e-06
	weight_decay_d: 0.004758612521969378
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3380000000  0.3412698413  0.3080000000  0.3253968254  0.4563253012  0.3915662651  0.3930722892  0.3915662651  0.2746031746  0.0000000000  0.0141763501  1.0911031961  0.0226192474  0             0.3959910870
0.3180000000  0.3412698413  0.2960000000  0.3492063492  0.4337349398  0.4457831325  0.3855421687  0.4096385542  0.2571428571  1.2000000000  0.0164944409  1.1182917929  0.0244770050  50            0.0358347845
0.3160000000  0.3650793651  0.3040000000  0.3492063492  0.4337349398  0.4457831325  0.3870481928  0.3915662651  0.2555555556  2.4000000000  0.0160861101  1.1141240811  0.0244770050  100           0.0360383558
0.3180000000  0.3492063492  0.3040000000  0.3571428571  0.4322289157  0.4518072289  0.3810240964  0.3915662651  0.2587301587  3.6000000000  0.0142246287  1.1127811980  0.0244770050  150           0.0363489532
0.3140000000  0.3333333333  0.3080000000  0.3571428571  0.4231927711  0.4277108434  0.3719879518  0.3915662651  0.2539682540  4.8000000000  0.0156667423  1.1152823925  0.0244770050  200           0.0361879730
0.3080000000  0.3333333333  0.3040000000  0.3492063492  0.4442771084  0.4518072289  0.3825301205  0.4096385542  0.2619047619  6.0000000000  0.0171430017  1.1206882834  0.0244770050  250           0.0364691591
0.3200000000  0.3492063492  0.2960000000  0.3492063492  0.4292168675  0.4397590361  0.3825301205  0.3855421687  0.2587301587  7.2000000000  0.0150750412  1.1133600640  0.0244770050  300           0.0375268745
0.3160000000  0.3650793651  0.3020000000  0.3492063492  0.4216867470  0.4457831325  0.3825301205  0.3855421687  0.2507936508  8.4000000000  0.0172151644  1.1152100754  0.0244770050  350           0.0373278284
0.3180000000  0.3492063492  0.3040000000  0.3333333333  0.4262048193  0.4397590361  0.3734939759  0.3855421687  0.2555555556  9.6000000000  0.0154745033  1.1076079893  0.0244770050  400           0.0360039377
0.3080000000  0.3253968254  0.3000000000  0.3333333333  0.4292168675  0.4397590361  0.3780120482  0.3795180723  0.2571428571  10.800000000  0.0158429138  1.1193774986  0.0244770050  450           0.0347390413
0.3160000000  0.3333333333  0.2980000000  0.3492063492  0.4307228916  0.4578313253  0.3825301205  0.3855421687  0.2603174603  12.000000000  0.0153034955  1.1153156686  0.0244770050  500           0.0372861385
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcd86f241d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcd86f241d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcd86f241d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 12
	normlizetype: 0-1
	output_dir: train_output/14544a13b0b8e41988b310972ded7fdf
	save_model_every_checkpoint: False
	seed: 2011539606
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 37
	class_balanced: False
	data_augmentation: True
	lr: 0.0002779717688784654
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 0.0006183744461455339
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3160000000  0.3015873016  0.3480000000  0.3492063492  0.3358433735  0.3313253012  0.4457831325  0.4457831325  0.3206349206  0.0000000000  1.1035269499  0.0275869370  0             0.3894553185
0.6660000000  0.6587301587  0.6480000000  0.6746031746  0.8629518072  0.8493975904  0.7304216867  0.7168674699  0.7095238095  3.7000000000  0.7488431132  0.0344033241  50            0.0444064713
0.7520000000  0.7142857143  0.6860000000  0.6746031746  0.8795180723  0.8554216867  0.8734939759  0.8554216867  0.7365079365  7.4000000000  0.4423366046  0.0344033241  100           0.0430407429
0.8000000000  0.7460317460  0.7520000000  0.7539682540  0.8825301205  0.8795180723  0.9623493976  0.9578313253  0.7301587302  11.100000000  0.2844661060  0.0344033241  150           0.0457042265
0.8980000000  0.8015873016  0.8300000000  0.8095238095  0.8840361446  0.8734939759  0.9623493976  0.9457831325  0.7603174603  14.800000000  0.2036621906  0.0344033241  200           0.0439044809
0.9260000000  0.8095238095  0.8760000000  0.8333333333  0.8975903614  0.8795180723  0.9789156627  0.9638554217  0.7380952381  18.500000000  0.1375550696  0.0344033241  250           0.0504694653
0.9400000000  0.8253968254  0.9060000000  0.8492063492  0.9036144578  0.8795180723  0.9789156627  0.9638554217  0.7365079365  22.200000000  0.1131632327  0.0344033241  300           0.0477547455
0.9520000000  0.8571428571  0.9100000000  0.8650793651  0.9111445783  0.8975903614  0.9924698795  0.9819277108  0.7190476190  25.900000000  0.0905747689  0.0344033241  350           0.0437773132
0.9680000000  0.8571428571  0.9480000000  0.8968253968  0.9186746988  0.9156626506  0.9894578313  0.9819277108  0.7000000000  29.600000000  0.0761478611  0.0344033241  400           0.0439032888
0.9740000000  0.8571428571  0.9560000000  0.9365079365  0.9412650602  0.9337349398  0.9984939759  0.9819277108  0.7015873016  33.300000000  0.0768885107  0.0344033241  450           0.0435704708
0.9920000000  0.8968253968  0.9660000000  0.9126984127  0.9036144578  0.8795180723  0.9879518072  0.9759036145  0.6634920635  37.000000000  0.0507101909  0.0344033241  500           0.0443066883
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fd031e8e0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fd031e8e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fd031e8e0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 13
	normlizetype: 0-1
	output_dir: train_output/83ad9279b5b6342999e4a37fb83061f1
	save_model_every_checkpoint: False
	seed: 2103432925
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 40
	beta1: 0.0
	class_balanced: False
	d_steps_per_g: 1
	data_augmentation: True
	delta: 2.612523735585244
	gda: True
	lr: 0.0001332442845099019
	lr_d: 0.0003938562844865902
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	t_lambda: 0.19419872713354966
	weight_decay: 2.7643974709171963e-05
	weight_decay_d: 1.296916744727128e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3280000000  0.3333333333  0.3220000000  0.2936507937  0.3328313253  0.3192771084  0.4909638554  0.4457831325  0.3714285714  0.0000000000  0.0089095524  1.1100853682  0.0673885345  0             0.4433329105
0.3260000000  0.3492063492  0.3340000000  0.3730158730  0.3433734940  0.3373493976  0.4412650602  0.4518072289  0.4142857143  4.0000000000  0.0110933979  1.0980173779  0.0691547394  50            0.0366441536
0.3220000000  0.3492063492  0.3340000000  0.3650793651  0.3388554217  0.3313253012  0.4457831325  0.4698795181  0.4158730159  8.0000000000  0.0107712647  1.0963694668  0.0691547394  100           0.0374353981
0.3240000000  0.3492063492  0.3360000000  0.3650793651  0.3448795181  0.3433734940  0.4487951807  0.4698795181  0.4174603175  12.000000000  0.0104993915  1.0963046908  0.0691547394  150           0.0370730686
0.3200000000  0.3492063492  0.3320000000  0.3730158730  0.3478915663  0.3433734940  0.4442771084  0.4277108434  0.4190476190  16.000000000  0.0114254443  1.0997668195  0.0691547394  200           0.0367604256
0.3260000000  0.3492063492  0.3300000000  0.3650793651  0.3448795181  0.3433734940  0.4487951807  0.4698795181  0.4111111111  20.000000000  0.0121830335  1.1020609903  0.0691547394  250           0.0364664745
0.3260000000  0.3492063492  0.3340000000  0.3730158730  0.3448795181  0.3433734940  0.4412650602  0.4277108434  0.4158730159  24.000000000  0.0110565972  1.0994064856  0.0691547394  300           0.0369760418
0.3180000000  0.3492063492  0.3320000000  0.3650793651  0.3463855422  0.3373493976  0.4472891566  0.4638554217  0.4158730159  28.000000000  0.0104511305  1.0963502908  0.0691547394  350           0.0380899000
0.3280000000  0.3412698413  0.3300000000  0.3730158730  0.3463855422  0.3373493976  0.4457831325  0.4457831325  0.4095238095  32.000000000  0.0114715158  1.1002706981  0.0691547394  400           0.0359624147
0.3240000000  0.3492063492  0.3340000000  0.3650793651  0.3418674699  0.3313253012  0.4533132530  0.4638554217  0.4158730159  36.000000000  0.0106770296  1.0971109796  0.0691547394  450           0.0377830315
0.3240000000  0.3492063492  0.3340000000  0.3730158730  0.3418674699  0.3433734940  0.4442771084  0.4277108434  0.4190476190  40.000000000  0.0106755109  1.0969837570  0.0691547394  500           0.0385847998
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f78a51aa1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f78a51aa1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f78a51aa1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 48
	normlizetype: 0-1
	output_dir: train_output/013e0735caa9503d119bd23b8c6dd5cb
	save_model_every_checkpoint: False
	seed: 1899527632
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 9
	class_balanced: False
	data_augmentation: True
	lr: 3.359889134792047e-06
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.951688644028676e-06
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3300000000  0.3412698413  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.3158730159  0.0000000000  1.0578303337  0.0164437294  0             0.3839697838
0.3580000000  0.3412698413  0.3380000000  0.3412698413  0.3493975904  0.3855421687  0.2304216867  0.2349397590  0.3206349206  0.9000000000  1.1749348569  0.0227508545  50            0.0414494228
0.3680000000  0.3412698413  0.3620000000  0.3730158730  0.3960843373  0.4518072289  0.2243975904  0.2349397590  0.3476190476  1.8000000000  1.1645455074  0.0227508545  100           0.0413186312
0.3800000000  0.3730158730  0.3880000000  0.3412698413  0.4186746988  0.4337349398  0.2138554217  0.2289156627  0.3746031746  2.7000000000  1.1449615264  0.0227508545  150           0.0402245045
0.3720000000  0.3730158730  0.3920000000  0.3253968254  0.4367469880  0.4457831325  0.2243975904  0.2228915663  0.4158730159  3.6000000000  1.1333247828  0.0227508545  200           0.0446792412
0.3880000000  0.3412698413  0.4040000000  0.3650793651  0.4533132530  0.4638554217  0.2259036145  0.2168674699  0.4126984127  4.5000000000  1.1261495376  0.0227508545  250           0.0401838732
0.3900000000  0.3571428571  0.4080000000  0.3809523810  0.4759036145  0.4819277108  0.2364457831  0.2108433735  0.4285714286  5.4000000000  1.1382687211  0.0227508545  300           0.0403297377
0.3980000000  0.3809523810  0.4100000000  0.3730158730  0.5000000000  0.4939759036  0.2515060241  0.2108433735  0.4507936508  6.3000000000  1.1341409099  0.0227508545  350           0.0397785521
0.3980000000  0.3888888889  0.4180000000  0.3888888889  0.5120481928  0.5060240964  0.2665662651  0.2469879518  0.4619047619  7.2000000000  1.1175981128  0.0227508545  400           0.0398330116
0.4060000000  0.4047619048  0.4280000000  0.3888888889  0.5210843373  0.5180722892  0.2981927711  0.2530120482  0.4793650794  8.1000000000  1.1252556825  0.0227508545  450           0.0399925423
0.4040000000  0.4285714286  0.4220000000  0.4285714286  0.5376506024  0.5240963855  0.3253012048  0.2771084337  0.4809523810  9.0000000000  1.1270141757  0.0227508545  500           0.0392814684
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f9f2409e1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9f2409e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f9f2409e1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 31
	normlizetype: 0-1
	output_dir: train_output/b2e88aac88388cf0af59d6238602b1e5
	save_model_every_checkpoint: False
	seed: 1050827814
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 39
	class_balanced: False
	data_augmentation: True
	ib_lambda: 0.16249705542152518
	ib_penalty_anneal_iters: 2827
	irm_lambda: 2.3403583381249904
	irm_penalty_anneal_iters: 1
	lr: 0.00010792585688755117
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.001082552882210441
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0259482972  0.0154614635  0.4300000000  0.4206349206  0.4080000000  0.4285714286  0.3298192771  0.3192771084  0.3237951807  0.3554216867  0.5111111111  0.0000000000  1.1898183823  0.0650520325  1.1898183823  0             0.3577337265
0.0719314126  0.0076266197  0.5700000000  0.5238095238  0.5800000000  0.5396825397  0.7319277108  0.7108433735  0.8253012048  0.8192771084  0.6222222222  3.9000000000  0.8689662325  0.0705394745  0.8689662325  50            0.0176405907
0.2818359664  0.0073644657  0.8360000000  0.7857142857  0.7740000000  0.6984126984  0.8734939759  0.8433734940  0.8674698795  0.8554216867  0.6904761905  7.8000000000  0.5091560966  0.0705394745  0.5091560966  100           0.0171085548
0.4892033505  0.0058603915  0.8980000000  0.8253968254  0.8540000000  0.8174603175  0.9021084337  0.8734939759  0.9277108434  0.9156626506  0.6142857143  11.700000000  0.3556824952  0.0705394745  0.3556824952  150           0.0177687597
0.6613691831  0.0063973198  0.9500000000  0.8253968254  0.9140000000  0.8571428571  0.9563253012  0.9337349398  1.0000000000  0.9879518072  0.6222222222  15.600000000  0.2672888795  0.0705394745  0.2672888795  200           0.0173705482
0.8304514074  0.0052552178  0.9900000000  0.8968253968  0.9580000000  0.9047619048  0.9954819277  0.9939759036  0.9984939759  0.9698795181  0.5079365079  19.500000000  0.1896975672  0.0705394745  0.1896975672  250           0.0171007347
0.9980860078  0.0025399649  0.9900000000  0.9444444444  0.9820000000  0.9444444444  0.9969879518  1.0000000000  1.0000000000  0.9879518072  0.4904761905  23.400000000  0.1304221895  0.0705394745  0.1304221895  300           0.0174152422
1.1251410317  0.0027443213  0.9960000000  0.9523809524  0.9940000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  0.9879518072  0.4444444444  27.300000000  0.0928202244  0.0705394745  0.0928202244  350           0.0168700981
1.2218913317  0.0020838731  0.9960000000  0.9603174603  0.9980000000  0.9365079365  1.0000000000  1.0000000000  1.0000000000  0.9879518072  0.4317460317  31.200000000  0.0736244378  0.0705394745  0.0736244378  400           0.0171276617
1.3390387416  0.0012088025  1.0000000000  0.9603174603  1.0000000000  0.9365079365  1.0000000000  1.0000000000  0.9984939759  0.9819277108  0.4111111111  35.100000000  0.0587009402  0.0705394745  0.0587009402  450           0.0171156502
1.3922519302  0.0013685113  1.0000000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  0.9984939759  0.9819277108  0.3825396825  39.000000000  0.0411947582  0.0705394745  0.0411947582  500           0.0170728970
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fb2a441f1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb2a441f1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fb2a441f1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 38
	normlizetype: 0-1
	output_dir: train_output/0d89b9566c0639e360a28c9760ebdd0e
	save_model_every_checkpoint: False
	seed: 819981886
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	lr: 0.0003054141477566941
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 0.002589420292952896
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3300000000  0.3174603175  0.3360000000  0.3015873016  0.3328313253  0.3313253012  0.4307228916  0.4337349398  0.3650793651  0.0000000000  1.2125352621  0.0164361000  0             0.3967618942
0.6700000000  0.6269841270  0.6920000000  0.6349206349  0.8855421687  0.8674698795  0.9111445783  0.8734939759  0.6682539683  0.8000000000  0.6434749615  0.0227432251  50            0.0421310806
0.8040000000  0.8174603175  0.7760000000  0.7063492063  0.8840361446  0.8734939759  0.9713855422  0.9337349398  0.6507936508  1.6000000000  0.3178648756  0.0227432251  100           0.0406523705
0.8760000000  0.8333333333  0.8240000000  0.7222222222  0.9668674699  0.9518072289  0.9939759036  0.9759036145  0.7079365079  2.4000000000  0.1988733888  0.0227432251  150           0.0426938438
0.9460000000  0.8492063492  0.9540000000  0.8809523810  0.8569277108  0.8614457831  0.9759036145  0.9518072289  0.5793650794  3.2000000000  0.1202012255  0.0227432251  200           0.0406392860
0.9560000000  0.9365079365  0.9680000000  0.8968253968  0.9608433735  0.9156626506  0.9969879518  1.0000000000  0.4857142857  4.0000000000  0.1235762244  0.0227432251  250           0.0491320562
0.9620000000  0.9126984127  0.9300000000  0.8492063492  0.9774096386  0.9337349398  1.0000000000  1.0000000000  0.5206349206  4.8000000000  0.0856465952  0.0227432251  300           0.0409439135
0.9960000000  0.9603174603  0.9760000000  0.8968253968  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.5365079365  5.6000000000  0.0804397771  0.0227432251  350           0.0430444908
0.9980000000  0.9841269841  0.9900000000  0.9126984127  0.9819277108  0.9277108434  1.0000000000  1.0000000000  0.3984126984  6.4000000000  0.0493524132  0.0227432251  400           0.0427750969
0.9980000000  0.9523809524  0.9980000000  0.9682539683  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.4063492063  7.2000000000  0.0630167686  0.0227432251  450           0.0430153322
1.0000000000  0.9841269841  0.9880000000  0.9206349206  0.9246987952  0.8795180723  0.9713855422  0.9819277108  0.4015873016  8.0000000000  0.0466934069  0.0227432251  500           0.0429429579
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f57d98c61d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f57d98c61d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f57d98c61d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 18
	normlizetype: 0-1
	output_dir: train_output/95c42407a73c08463d12370081ea65b5
	save_model_every_checkpoint: False
	seed: 2084260181
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 43
	class_balanced: False
	data_augmentation: True
	lr: 3.872163578520407e-06
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008766809489187495
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3280000000  0.3333333333  0.3320000000  0.3253968254  0.3509036145  0.3433734940  0.5180722892  0.5301204819  0.3460317460  0.0000000000  1.1812782288  0.0297250748  0             0.3925061226
0.3840000000  0.3571428571  0.3360000000  0.2619047619  0.3448795181  0.3433734940  0.3810240964  0.4036144578  0.4126984127  4.3000000000  1.1048711777  0.0359859467  50            0.0419220352
0.3760000000  0.3888888889  0.3500000000  0.3095238095  0.4201807229  0.4277108434  0.4021084337  0.4518072289  0.4015873016  8.6000000000  1.0915496588  0.0359859467  100           0.0449133396
0.3680000000  0.4206349206  0.3640000000  0.3333333333  0.4503012048  0.4759036145  0.4292168675  0.4277108434  0.4190476190  12.900000000  1.0747023177  0.0359859467  150           0.0429585838
0.3860000000  0.4523809524  0.4160000000  0.3412698413  0.4909638554  0.5180722892  0.4578313253  0.4819277108  0.4285714286  17.200000000  1.0712685847  0.0359859467  200           0.0463279724
0.4280000000  0.4682539683  0.4440000000  0.3412698413  0.5256024096  0.5240963855  0.5060240964  0.5301204819  0.4444444444  21.500000000  1.0569265997  0.0359859467  250           0.0466980791
0.4360000000  0.4603174603  0.4520000000  0.3492063492  0.5572289157  0.5662650602  0.5572289157  0.6024096386  0.4507936508  25.800000000  1.0512637103  0.0359859467  300           0.0427866268
0.4500000000  0.4682539683  0.4540000000  0.3730158730  0.5813253012  0.5903614458  0.5903614458  0.6144578313  0.4857142857  30.100000000  1.0433028591  0.0359859467  350           0.0430576992
0.4800000000  0.4682539683  0.4740000000  0.4047619048  0.6129518072  0.6566265060  0.6144578313  0.6385542169  0.5063492063  34.400000000  1.0322519326  0.0359859467  400           0.0447757244
0.4880000000  0.4761904762  0.4680000000  0.3968253968  0.6340361446  0.6566265060  0.6265060241  0.6746987952  0.5206349206  38.700000000  1.0169387269  0.0359859467  450           0.0449879694
0.4820000000  0.5079365079  0.4840000000  0.3968253968  0.6686746988  0.6867469880  0.6430722892  0.7048192771  0.5333333333  43.000000000  1.0094099808  0.0359859467  500           0.0439628029
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f3ab2f6d1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f3ab2f6d1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f3ab2f6d1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 47
	normlizetype: 0-1
	output_dir: train_output/2b59773e204f0bcb5a2b04779152830b
	save_model_every_checkpoint: False
	seed: 1755329186
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 21
	class_balanced: False
	data_augmentation: True
	ib_lambda: 357.9696631911109
	ib_penalty_anneal_iters: 258
	irm_lambda: 583.461330024585
	irm_penalty_anneal_iters: 69
	lr: 0.00018728400841352565
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 1.227783669831511e-05
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0251813792  0.0055841412  0.3340000000  0.2857142857  0.3140000000  0.3253968254  0.3403614458  0.3493975904  0.2921686747  0.2891566265  0.3285714286  0.0000000000  1.1572021246  0.0365118980  1.1572021246  0             0.3575770855
0.0844427520  0.0152618340  0.7760000000  0.7222222222  0.7100000000  0.6507936508  0.8117469880  0.7650602410  0.8268072289  0.8373493976  0.6698412698  2.1000000000  0.7778730232  0.0435175896  0.7778730232  50            0.0175131607
0.2509195277  0.0130022113  0.8140000000  0.7142857143  0.7920000000  0.6666666667  0.9036144578  0.9156626506  0.8042168675  0.8072289157  0.6714285714  4.2000000000  5.4998720992  0.0435175896  5.4998720992  100           0.0200917673
0.2431101224  0.0043343595  0.7260000000  0.6507936508  0.7160000000  0.6904761905  0.7379518072  0.7590361446  0.7289156627  0.7108433735  0.5777777778  6.3000000000  3.0649932730  0.0435175896  3.0649932730  150           0.0187818670
0.1953516182  0.0031414728  0.7620000000  0.7142857143  0.7820000000  0.7619047619  0.8448795181  0.8253012048  0.7198795181  0.6385542169  0.4412698413  8.4000000000  2.4079279751  0.0435175896  2.4079279751  200           0.0187329245
0.2351728052  0.0017510884  0.7860000000  0.7539682540  0.7240000000  0.6349206349  0.7048192771  0.7228915663  0.6355421687  0.6385542169  0.6365079365  10.500000000  1.5965115601  0.0435175896  1.5965115601  250           0.0183085155
0.0752482013  0.0054069942  0.4040000000  0.3809523810  0.4340000000  0.4523809524  0.3629518072  0.3554216867  0.4397590361  0.4337349398  0.3349206349  12.600000000  19.816078811  0.0435175896  19.816078811  300           0.0183713913
0.0067372454  0.0010981796  0.5040000000  0.5476190476  0.5020000000  0.4523809524  0.3945783133  0.4337349398  0.3524096386  0.3493975904  0.4746031746  14.700000000  4.1170674777  0.0435175896  4.1170674777  350           0.0179309702
0.0025497896  0.0002160578  0.2860000000  0.3492063492  0.3060000000  0.3174603175  0.2891566265  0.3253012048  0.3750000000  0.3915662651  0.3555555556  16.800000000  2.1275066972  0.0435175896  2.1275066972  400           0.0187752247
0.0013770691  0.0000927107  0.2860000000  0.3412698413  0.3000000000  0.3095238095  0.3509036145  0.3313253012  0.4246987952  0.4337349398  0.3269841270  18.900000000  1.6420210767  0.0435175896  1.6420210767  450           0.0222844791
0.0009365840  -0.000001677  0.3000000000  0.3809523810  0.3440000000  0.3571428571  0.3253012048  0.3373493976  0.4201807229  0.4156626506  0.3619047619  21.000000000  1.4317644000  0.0435175896  1.4317644000  500           0.0200181341
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f0662abf1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0662abf1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0662abf1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 35
	normlizetype: 0-1
	output_dir: train_output/7ae2ad4212225fe643ac912686cdd7d9
	save_model_every_checkpoint: False
	seed: 511604929
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 8
	class_balanced: False
	data_augmentation: True
	ib_lambda: 465.4777854872734
	ib_penalty_anneal_iters: 2
	irm_lambda: 0.5936375984027611
	irm_penalty_anneal_iters: 4578
	lr: 4.048637909021825e-06
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0027187287407379923
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0263713896  0.0062659569  0.3100000000  0.3095238095  0.3060000000  0.3174603175  0.3087349398  0.2831325301  0.2650602410  0.2650602410  0.3047619048  0.0000000000  1.1466087103  0.0164666176  1.1466087103  0             0.4118719101
0.0214582000  0.0047471774  0.3000000000  0.3571428571  0.3300000000  0.2857142857  0.2906626506  0.2831325301  0.2138554217  0.2409638554  0.3079365079  0.8000000000  10.924088661  0.0225868225  10.924088661  50            0.0181177568
0.0149055712  0.0025836002  0.3000000000  0.3492063492  0.3400000000  0.2619047619  0.2936746988  0.2710843373  0.2394578313  0.2590361446  0.3063492063  1.6000000000  8.0713556671  0.0225868225  8.0713556671  100           0.0178021622
0.0103646812  0.0010161798  0.3040000000  0.3412698413  0.3480000000  0.2936507937  0.2951807229  0.2891566265  0.2394578313  0.2469879518  0.3000000000  2.4000000000  5.9456735706  0.0225868225  5.9456735706  150           0.0183360100
0.0075964277  0.0007283656  0.3120000000  0.3174603175  0.3500000000  0.3492063492  0.3147590361  0.3192771084  0.2319277108  0.2289156627  0.2904761905  3.2000000000  4.6494093704  0.0225868225  4.6494093704  200           0.0180034924
0.0056998176  0.0003976107  0.3160000000  0.3253968254  0.3500000000  0.3412698413  0.3268072289  0.3554216867  0.2243975904  0.2228915663  0.2873015873  4.0000000000  3.7649220753  0.0225868225  3.7649220753  250           0.0191507339
0.0044575263  0.0002861298  0.3160000000  0.3253968254  0.3520000000  0.3412698413  0.3268072289  0.3433734940  0.2243975904  0.2228915663  0.2904761905  4.8000000000  3.1854277802  0.0225868225  3.1854277802  300           0.0179881191
0.0035908495  0.0002463602  0.3240000000  0.3174603175  0.3400000000  0.3333333333  0.3313253012  0.3373493976  0.2243975904  0.2228915663  0.2888888889  5.6000000000  2.7791519451  0.0225868225  2.7791519451  350           0.0189086866
0.0030124969  0.0001723032  0.3280000000  0.3253968254  0.3400000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2936507937  6.4000000000  2.5095754814  0.0225868225  2.5095754814  400           0.0186120844
0.0025554568  0.0001480976  0.3280000000  0.3095238095  0.3380000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2936507937  7.2000000000  2.2929543996  0.0225868225  2.2929543996  450           0.0186118937
0.0021253605  -0.000044893  0.3280000000  0.3095238095  0.3360000000  0.3412698413  0.3343373494  0.3373493976  0.2243975904  0.2228915663  0.2968253968  8.0000000000  2.0927003264  0.0225868225  2.0927003264  500           0.0180825567
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f5b7d39c1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f5b7d39c1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f5b7d39c1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 24
	normlizetype: 0-1
	output_dir: train_output/8a130ff18d93291787b808d585b19181
	save_model_every_checkpoint: False
	seed: 303671988
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 36
	class_balanced: False
	data_augmentation: True
	lr: 4.2550345485619685e-06
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.5430730771167478e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time
0.3440000000  0.2777777778  0.3080000000  0.3492063492  0.4081325301  0.4397590361  0.4246987952  0.4337349398  0.3380952381  0.0000000000  1.1039961576  0.0263772011  0             0.4005310535
0.4180000000  0.3492063492  0.3860000000  0.3412698413  0.6731927711  0.6566265060  0.5858433735  0.6084337349  0.4158730159  3.6000000000  1.0700794744  0.0339241028  50            0.0489128351
0.4220000000  0.4206349206  0.3860000000  0.3650793651  0.7560240964  0.7469879518  0.6039156627  0.6566265060  0.4365079365  7.2000000000  1.0179785585  0.0339241028  100           0.0422249269
0.4420000000  0.4444444444  0.3920000000  0.4047619048  0.8072289157  0.8072289157  0.6626506024  0.6867469880  0.4571428571  10.800000000  0.9834755254  0.0339241028  150           0.0481523657
0.4720000000  0.4444444444  0.4020000000  0.4126984127  0.8283132530  0.8192771084  0.6852409639  0.6927710843  0.4825396825  14.400000000  0.9473404360  0.0339241028  200           0.0432181168
0.5040000000  0.4920634921  0.4140000000  0.4206349206  0.8433734940  0.8313253012  0.7048192771  0.6987951807  0.5238095238  18.000000000  0.8970009756  0.0339241028  250           0.0431302071
0.5240000000  0.5476190476  0.4280000000  0.4285714286  0.8388554217  0.8373493976  0.7304216867  0.7168674699  0.5841269841  21.600000000  0.8592696440  0.0339241028  300           0.0410935497
0.5360000000  0.5396825397  0.4440000000  0.4285714286  0.8539156627  0.8493975904  0.7364457831  0.7168674699  0.6079365079  25.200000000  0.8189613986  0.0339241028  350           0.0416103363
0.5660000000  0.5873015873  0.4700000000  0.4603174603  0.8569277108  0.8493975904  0.7289156627  0.6987951807  0.6492063492  28.800000000  0.7799195802  0.0339241028  400           0.0425496149
0.5740000000  0.5873015873  0.4860000000  0.4603174603  0.8584337349  0.8554216867  0.7319277108  0.6987951807  0.6746031746  32.400000000  0.7431937873  0.0339241028  450           0.0412717295
0.5820000000  0.5873015873  0.4880000000  0.4682539683  0.8644578313  0.8674698795  0.7349397590  0.6987951807  0.6904761905  36.000000000  0.7037412310  0.0339241028  500           0.0464011335
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7febb54ee1d0>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7febb54ee1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7febb54ee1d0>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 20
	normlizetype: 0-1
	output_dir: train_output/ffee510213665af5e9282d1c99f025a1
	save_model_every_checkpoint: False
	seed: 203957654
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	ib_lambda: 2962.981099723421
	ib_penalty_anneal_iters: 5
	irm_lambda: 159.08528336879607
	irm_penalty_anneal_iters: 560
	lr: 1.5755814713441232e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.5
	weight_decay: 1.09483935072662e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0266995952  0.0006874602  0.4180000000  0.4365079365  0.3940000000  0.4047619048  0.4804216867  0.4638554217  0.4066265060  0.4337349398  0.3317460317  0.0000000000  1.1180431843  0.0540137291  1.1180431843  0             0.3676440716
0.0133131897  0.0004888600  0.3420000000  0.4047619048  0.3400000000  0.3730158730  0.3478915663  0.3795180723  0.2243975904  0.2349397590  0.3063492063  3.2000000000  34.360536420  0.0604467392  34.360536420  50            0.0182676411
0.0025318920  -0.000004921  0.3340000000  0.2936507937  0.3740000000  0.3571428571  0.3629518072  0.3674698795  0.2725903614  0.2590361446  0.2587301587  6.4000000000  8.6007122421  0.0604467392  8.6007122421  100           0.0188223267
0.0008405769  0.0000094748  0.3180000000  0.3095238095  0.3340000000  0.3253968254  0.3403614458  0.3373493976  0.2243975904  0.2228915663  0.2825396825  9.6000000000  3.5925034618  0.0604467392  3.5925034618  150           0.0204543495
0.0004357659  0.0000087325  0.3140000000  0.3412698413  0.3000000000  0.3095238095  0.3177710843  0.3072289157  0.4111445783  0.4156626506  0.3507936508  12.800000000  2.3909180713  0.0604467392  2.3909180713  200           0.0191971016
0.0001300070  -0.000000154  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3365079365  16.000000000  1.4841706920  0.0604467392  1.4841706920  250           0.0198856735
0.0000572832  0.0000000739  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3365079365  19.200000000  1.2683655596  0.0604467392  1.2683655596  300           0.0189043522
0.0000412653  0.0000000841  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  22.400000000  1.2208246970  0.0604467392  1.2208246970  350           0.0186211681
0.0000292338  0.0000005010  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  25.600000000  1.1849946570  0.0604467392  1.1849946570  400           0.0182640696
0.0000212898  0.0000000614  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  28.800000000  1.1613639402  0.0604467392  1.1613639402  450           0.0195658112
0.0000150264  0.0000001445  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  32.000000000  1.1430642271  0.0604467392  1.1430642271  500           0.0187994289
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fc812dec0b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc812dec0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc812dec0b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 43
	normlizetype: 0-1
	output_dir: train_output/1074e26897e7b0e9cbb2b79450825c77
	save_model_every_checkpoint: False
	seed: 884751730
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 33
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 1.1028044803758075
	gda: True
	lr: 1.0731991123556439e-05
	lr_d: 3.2313874523450855e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.025250833697099285
	weight_decay: 6.356201338925228e-06
	weight_decay_d: 3.759995503039916e-05
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time
0.3460000000  0.2936507937  0.3360000000  0.3888888889  0.3509036145  0.3313253012  0.3885542169  0.3975903614  0.3380952381  0.0000000000  0.0028032626  1.1294362545  0.0557632446  0             0.3633220196
0.3360000000  0.2936507937  0.3200000000  0.3333333333  0.3659638554  0.3433734940  0.4216867470  0.4216867470  0.4031746032  3.3000000000  0.0032880427  1.1331821609  0.0578651428  50            0.0487301588
0.3380000000  0.2936507937  0.3180000000  0.3412698413  0.3644578313  0.3373493976  0.4216867470  0.4216867470  0.4000000000  6.6000000000  0.0027603412  1.1243691134  0.0578651428  100           0.0477776527
0.3380000000  0.3015873016  0.3180000000  0.3333333333  0.3644578313  0.3373493976  0.4231927711  0.4277108434  0.4063492063  9.9000000000  0.0028898668  1.1230882382  0.0578651428  150           0.0487809229
0.3400000000  0.3015873016  0.3160000000  0.3333333333  0.3599397590  0.3433734940  0.4216867470  0.4216867470  0.4047619048  13.200000000  0.0028809019  1.1248710585  0.0578651428  200           0.0480072021
0.3380000000  0.2857142857  0.3180000000  0.3412698413  0.3629518072  0.3433734940  0.4231927711  0.4156626506  0.4063492063  16.500000000  0.0031113318  1.1370249009  0.0578651428  250           0.0483802986
0.3280000000  0.3015873016  0.3180000000  0.3412698413  0.3659638554  0.3433734940  0.4292168675  0.4277108434  0.4031746032  19.800000000  0.0032346715  1.1259318423  0.0578651428  300           0.0484293079
0.3400000000  0.2936507937  0.3180000000  0.3333333333  0.3614457831  0.3373493976  0.4231927711  0.4156626506  0.4031746032  23.100000000  0.0032933886  1.1295103049  0.0578651428  350           0.0491054869
0.3380000000  0.3015873016  0.3200000000  0.3492063492  0.3644578313  0.3373493976  0.4246987952  0.4216867470  0.4063492063  26.400000000  0.0029564956  1.1212402940  0.0578651428  400           0.0500870609
0.3360000000  0.2857142857  0.3160000000  0.3412698413  0.3659638554  0.3433734940  0.4292168675  0.4277108434  0.4031746032  29.700000000  0.0031719037  1.1275300646  0.0578651428  450           0.0500582647
0.3400000000  0.3015873016  0.3200000000  0.3412698413  0.3659638554  0.3433734940  0.4246987952  0.4216867470  0.4079365079  33.000000000  0.0033454117  1.1327244234  0.0578651428  500           0.0511714315
Setting up a new session...
Exception in user code:
------------------------------------------------------------
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 710, in urlopen
    chunked=chunked,
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1287, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1333, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1282, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 1042, in _send_output
    self.send(msg)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/http/client.py", line 980, in send
    self.connect()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connection.py", line 187, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f543a5990b8>: Failed to establish a new connection: [Errno 111] Connection refused
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 450, in send
    timeout=timeout
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/connectionpool.py", line 786, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f543a5990b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 711, in _send
    data=json.dumps(msg),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/visdom/__init__.py", line 677, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 577, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 529, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/sessions.py", line 645, in send
    r = adapter.send(request, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/requests/adapters.py", line 519, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f543a5990b8>: Failed to establish a new connection: [Errno 111] Connection refused',))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
Args:
	algorithm: IB_IRM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 4
	normlizetype: 0-1
	output_dir: train_output/6ac3863e0305038642964794fa16dfa2
	save_model_every_checkpoint: False
	seed: 425608823
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 18
	class_balanced: False
	data_augmentation: True
	ib_lambda: 331.5350408966532
	ib_penalty_anneal_iters: 909
	irm_lambda: 3360.4934153418103
	irm_penalty_anneal_iters: 1
	lr: 1.4524944240203903e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 6.326696718610415e-06
difficult data
IB_penalty    IRM_penalty   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        nll           step          step_time
0.0235418938  0.0012099575  0.3180000000  0.3492063492  0.3560000000  0.3968253968  0.0903614458  0.0843373494  0.2921686747  0.2530120482  0.4063492063  0.0000000000  1.1092466116  0.0320873260  1.1092466116  0             0.3759934902
0.0220251656  0.0003893811  0.4260000000  0.3650793651  0.4260000000  0.3888888889  0.5000000000  0.4457831325  0.3493975904  0.3132530120  0.3904761905  1.8000000000  2.4077848494  0.0384402275  2.4077848494  50            0.0187911987
0.0214531889  0.0003202239  0.4480000000  0.3730158730  0.4260000000  0.4126984127  0.4713855422  0.4518072289  0.3614457831  0.3614457831  0.4444444444  3.6000000000  2.1674994230  0.0384402275  2.1674994230  100           0.0182007504
0.0211896101  0.0000174058  0.4300000000  0.3492063492  0.4260000000  0.4920634921  0.5346385542  0.4759036145  0.3945783133  0.4096385542  0.4126984127  5.4000000000  1.1440493619  0.0384402275  1.1440493619  150           0.0182782888
0.0210821706  0.0000702866  0.4480000000  0.3571428571  0.4220000000  0.4444444444  0.4819277108  0.4337349398  0.4096385542  0.4337349398  0.4365079365  7.2000000000  1.3230546737  0.0384402275  1.3230546737  200           0.0182607698
0.0215419292  -0.000167697  0.4560000000  0.3730158730  0.4620000000  0.4523809524  0.4849397590  0.4337349398  0.3719879518  0.3915662651  0.4460317460  9.0000000000  0.5225471961  0.0384402275  0.5225471961  250           0.0183823586
0.0217871735  0.0000103700  0.4180000000  0.3730158730  0.3860000000  0.3809523810  0.4879518072  0.4457831325  0.4126506024  0.4457831325  0.4015873016  10.800000000  1.1182234490  0.0384402275  1.1182234490  300           0.0177830887
0.0224555760  -0.000606449  0.4340000000  0.4126984127  0.4560000000  0.4285714286  0.4728915663  0.4819277108  0.3584337349  0.3493975904  0.3984126984  12.600000000  -0.957539362  0.0384402275  -0.957539362  350           0.0188772011
0.0226791991  0.0003549099  0.4400000000  0.4047619048  0.4680000000  0.5000000000  0.5045180723  0.5120481928  0.3780120482  0.3313253012  0.4603174603  14.400000000  2.2732367957  0.0384402275  2.2732367957  400           0.0188234091
0.0218086720  0.0001840940  0.4600000000  0.3888888889  0.5040000000  0.4920634921  0.4623493976  0.4518072289  0.4186746988  0.4216867470  0.4746031746  16.200000000  1.6997787225  0.0384402275  1.6997787225  450           0.0187479544
0.0215602804  0.0004195058  0.4540000000  0.3968253968  0.5020000000  0.4761904762  0.5075301205  0.4879518072  0.3780120482  0.4156626506  0.4730158730  18.000000000  2.4932433546  0.0384402275  2.4932433546  500           0.0191581297
Launched 150 jobs!
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 260, in <module>
    algorithm_class = algorithms.get_algorithm_class(args.algorithm)    # 
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             12.258948326 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 306, in <module>
    for key, val in step_vals.items():
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3500000000  0.3412698413  0.3500000000  0.3333333333  0.5903614458  0.6144578313  0.6310240964  0.6204819277  0.3682539683  0.0000000000  0.3941023350  1.1431634426  0.0539793968  0             0.4693994522 
0.7000000000  0.6428571429  0.6120000000  0.5952380952  0.8599397590  0.8493975904  0.7424698795  0.7650602410  0.5587301587  3.2000000000  0.2309466898  0.9411928284  0.0605678558  50            0.1711085320 
0.6120000000  0.5555555556  0.6620000000  0.6349206349  0.8448795181  0.8132530120  0.7168674699  0.7228915663  0.5523809524  6.4000000000  0.2601021987  0.7042915034  0.0605678558  100           0.1703785086 
0.6920000000  0.6269841270  0.6920000000  0.6904761905  0.9096385542  0.8433734940  0.9698795181  0.9518072289  0.6126984127  9.6000000000  0.2733849728  0.5952319562  0.0605678558  150           0.1700565100 
0.8140000000  0.8333333333  0.6780000000  0.6349206349  0.9804216867  0.9698795181  0.9021084337  0.9096385542  0.7047619048  12.800000000  0.2659965008  0.5243146867  0.0605678558  200           0.1705801344 
0.7420000000  0.7222222222  0.7700000000  0.7222222222  0.8795180723  0.8192771084  0.9277108434  0.9638554217  0.5380952381  16.000000000  0.2673136848  0.4928679395  0.0605678558  250           0.1713051653 
0.8160000000  0.7539682540  0.8100000000  0.6984126984  0.9849397590  0.9759036145  0.9954819277  0.9939759036  0.5777777778  19.200000000  0.2550329307  0.4211761206  0.0622081757  300           0.1803986692 
0.8960000000  0.9206349206  0.9020000000  0.8333333333  0.9698795181  0.9638554217  0.9216867470  0.9156626506  0.4523809524  22.400000000  0.2434412190  0.3826900375  0.0622081757  350           0.1809971142 
0.9680000000  0.9761904762  0.9480000000  0.9126984127  0.9412650602  0.8855421687  0.9834337349  0.9819277108  0.5301587302  25.600000000  0.2116211823  0.2815925270  0.0622081757  400           0.1806957388 
0.9700000000  0.9603174603  0.9660000000  0.9285714286  0.9728915663  0.9518072289  0.9759036145  0.9638554217  0.3825396825  28.800000000  0.2236219044  0.1826529957  0.0622081757  450           0.1773091412 
0.9820000000  0.9523809524  0.9740000000  0.9682539683  0.9834337349  0.9698795181  0.9894578313  0.9939759036  0.2904761905  32.000000000  0.2256721453  0.1586090989  0.0622081757  500           0.1688523102 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3620000000  0.3492063492  0.3460000000  0.3412698413  0.6219879518  0.5963855422  0.5722891566  0.5301204819  0.3777777778  0.0000000000  0.5290244818  1.1461868286  0.0539793968  0             0.4534895420 
0.4760000000  0.4682539683  0.5020000000  0.4206349206  0.6551204819  0.6325301205  0.8719879518  0.8253012048  0.5222222222  3.2000000000  0.1281432062  1.0608236408  0.0605168343  50            0.1701159954 
0.5320000000  0.4920634921  0.5840000000  0.5634920635  0.6656626506  0.6626506024  0.7740963855  0.7710843373  0.5047619048  6.4000000000  0.1529671460  0.8977745426  0.0605201721  100           0.1724489927 
0.6680000000  0.6587301587  0.6020000000  0.5793650794  0.8930722892  0.8253012048  0.8237951807  0.8132530120  0.6619047619  9.6000000000  0.2643938470  0.6685341227  0.0605201721  150           0.1718162155 
0.7600000000  0.7698412698  0.6520000000  0.6746031746  0.8253012048  0.7710843373  0.7153614458  0.6927710843  0.7619047619  12.800000000  0.2914970431  0.5768317813  0.0605649948  200           0.1752114582 
0.6760000000  0.6904761905  0.7040000000  0.6746031746  0.8177710843  0.8132530120  0.8960843373  0.8614457831  0.6555555556  16.000000000  0.2452293587  0.5294710362  0.0606236458  250           0.1684774446 
0.7240000000  0.7222222222  0.7120000000  0.7142857143  0.8463855422  0.8433734940  0.9382530120  0.9337349398  0.5587301587  19.200000000  0.2055755457  0.4880863678  0.0606236458  300           0.1775755548 
0.8060000000  0.8333333333  0.7560000000  0.6904761905  0.7891566265  0.7951807229  0.9894578313  0.9698795181  0.7746031746  22.400000000  0.1958700836  0.4825553852  0.0606236458  350           0.1827989006 
0.7960000000  0.8095238095  0.8020000000  0.7698412698  0.9518072289  0.9156626506  0.8930722892  0.9337349398  0.8349206349  25.600000000  0.2023838389  0.4664259881  0.0606236458  400           0.1833224869 
0.7800000000  0.7698412698  0.8420000000  0.7460317460  0.8072289157  0.7951807229  0.9216867470  0.9277108434  0.5888888889  28.800000000  0.2201164085  0.4525415981  0.0606374741  450           0.1805854273 
0.7940000000  0.8253968254  0.7520000000  0.6746031746  0.9774096386  0.9819277108  0.9352409639  0.9457831325  0.5746031746  32.000000000  0.2025970218  0.4138051534  0.0606718063  500           0.1780060196 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3620000000  0.3492063492  0.3460000000  0.3412698413  0.6219879518  0.5963855422  0.5722891566  0.5301204819  0.3777777778  0.0000000000  0.5290244818  1.1461868286  0.0539793968  0             0.4603583813 
0.4760000000  0.4682539683  0.5020000000  0.4206349206  0.6551204819  0.6325301205  0.8719879518  0.8253012048  0.5222222222  3.2000000000  0.1281432062  1.0608236408  0.0604581833  50            0.1696854162 
0.5320000000  0.4920634921  0.5840000000  0.5634920635  0.6656626506  0.6626506024  0.7740963855  0.7710843373  0.5047619048  6.4000000000  0.1529671460  0.8977745426  0.0617747307  100           0.1734036589 
0.6680000000  0.6587301587  0.6020000000  0.5793650794  0.8930722892  0.8253012048  0.8237951807  0.8132530120  0.6619047619  9.6000000000  0.2643938470  0.6685341227  0.0634832382  150           0.1786010695 
0.7600000000  0.7698412698  0.6520000000  0.6746031746  0.8253012048  0.7710843373  0.7153614458  0.6927710843  0.7619047619  12.800000000  0.2914970431  0.5768317813  0.0634832382  200           0.1782175922 
0.6760000000  0.6904761905  0.7040000000  0.6746031746  0.8177710843  0.8132530120  0.8960843373  0.8614457831  0.6555555556  16.000000000  0.2452293587  0.5294710362  0.0634832382  250           0.1807904482 
0.7240000000  0.7222222222  0.7120000000  0.7142857143  0.8463855422  0.8433734940  0.9382530120  0.9337349398  0.5587301587  19.200000000  0.2055755457  0.4880863678  0.0634832382  300           0.1786385202 
0.8060000000  0.8333333333  0.7560000000  0.6904761905  0.7891566265  0.7951807229  0.9894578313  0.9698795181  0.7746031746  22.400000000  0.1958700836  0.4825553852  0.0634832382  350           0.1793547678 
0.7960000000  0.8095238095  0.8020000000  0.7698412698  0.9518072289  0.9156626506  0.8930722892  0.9337349398  0.8349206349  25.600000000  0.2023838389  0.4664259881  0.0634832382  400           0.1774521589 
0.7800000000  0.7698412698  0.8420000000  0.7460317460  0.8072289157  0.7951807229  0.9216867470  0.9277108434  0.5888888889  28.800000000  0.2201164085  0.4525415981  0.0634832382  450           0.1823926735 
0.7940000000  0.8253968254  0.7520000000  0.6746031746  0.9774096386  0.9819277108  0.9352409639  0.9457831325  0.5746031746  32.000000000  0.2025970218  0.4138051534  0.0634832382  500           0.1728436422 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4730412960 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0605168343  50            0.1697547340 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0605168343  100           0.1742893505 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0605168343  150           0.1694549084 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0605740547  200           0.1697852039 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0606913567  250           0.1752439976 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0631923676  300           0.1827222967 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0631923676  350           0.1836072588 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0631923676  400           0.1884011602 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0631923676  450           0.1808709335 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0631923676  500           0.1838855743 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3500000000  0.3571428571  0.3440000000  0.3412698413  0.6295180723  0.6024096386  0.5527108434  0.5240963855  0.3761904762  0.0000000000  0.4409514368  1.1524250507  0.0539793968  0             0.4907522202 
0.6300000000  0.5952380952  0.6300000000  0.6349206349  0.5737951807  0.5361445783  0.5737951807  0.5361445783  0.5317460317  3.2000000000  0.2120929337  0.9822117865  0.0604581833  50            0.1727210903 
0.7400000000  0.7460317460  0.6560000000  0.6031746032  0.7876506024  0.7289156627  0.7786144578  0.7771084337  0.7396825397  6.4000000000  0.2521927053  0.7859988844  0.0605168343  100           0.1742791367 
0.7360000000  0.7539682540  0.6780000000  0.6666666667  0.8493975904  0.8674698795  0.9006024096  0.8674698795  0.8079365079  9.6000000000  0.3087766501  0.6109969974  0.0605168343  150           0.1920822144 
0.7760000000  0.7698412698  0.7120000000  0.6031746032  0.9156626506  0.8433734940  0.8825301205  0.8433734940  0.7380952381  12.800000000  0.2782547566  0.5244926387  0.0607280731  200           0.1902902937 
0.7060000000  0.7063492063  0.7620000000  0.6587301587  0.8810240964  0.8855421687  0.8840361446  0.8493975904  0.6412698413  16.000000000  0.2349730650  0.5078497642  0.0607395172  250           0.1825903082 
0.7920000000  0.7698412698  0.7080000000  0.6666666667  0.7756024096  0.7771084337  0.9653614458  0.9698795181  0.5968253968  19.200000000  0.2409996411  0.4877212512  0.0608320236  300           0.1788744068 
0.7480000000  0.7936507937  0.7900000000  0.7539682540  0.8539156627  0.8614457831  0.9518072289  0.9518072289  0.5317460317  22.400000000  0.2201571098  0.4557995409  0.0608320236  350           0.1794681025 
0.8020000000  0.7619047619  0.7860000000  0.6825396825  0.9156626506  0.8674698795  0.9322289157  0.9216867470  0.6349206349  25.600000000  0.2401633865  0.4430066526  0.0624408722  400           0.1808757305 
0.8260000000  0.8333333333  0.7700000000  0.6825396825  0.8840361446  0.8975903614  0.9156626506  0.9156626506  0.7730158730  28.800000000  0.2802878189  0.4406113780  0.0624408722  450           0.1787179279 
0.8480000000  0.8492063492  0.8180000000  0.6904761905  0.9548192771  0.9277108434  0.9231927711  0.8975903614  0.5650793651  32.000000000  0.2494355345  0.4086449522  0.0624408722  500           0.1805980206 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
difficult data
1
0 117
1 117
2 117


2
0 117
1 117
2 117


3
0 117
1 117
2 117


1
0 102
1 102
2 102


2
0 102
1 102
2 102


0
20
20
20
20
20
1
20
20
20
20
20
2
20
20
20
20
20
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3412698413  0.3400000000  0.3412698413  0.5301204819  0.5060240964  0.6340361446  0.6204819277  0.3507936508  0.0000000000  0.4018643498  1.1357507706  0.0539793968  0             0.4619753361 
0.5100000000  0.4920634921  0.5660000000  0.5634920635  0.6581325301  0.5963855422  0.3433734940  0.3734939759  0.5666666667  3.2000000000  0.1315161288  1.0727970576  0.0604572296  50            0.1775797510 
0.5140000000  0.4761904762  0.5820000000  0.6190476190  0.6611445783  0.6445783133  0.7048192771  0.7349397590  0.4269841270  6.4000000000  0.1040522397  0.9704733002  0.0629591942  100           0.1869187260 
0.6000000000  0.5476190476  0.6480000000  0.6349206349  0.8253012048  0.7710843373  0.8539156627  0.8373493976  0.6095238095  9.6000000000  0.2419642174  0.7612865019  0.0629591942  150           0.1820990038 
0.7400000000  0.6984126984  0.6560000000  0.6111111111  0.9006024096  0.8554216867  0.9909638554  0.9879518072  0.6809523810  12.800000000  0.2244849211  0.5999968302  0.0629591942  200           0.1818425655 
0.6920000000  0.6904761905  0.7220000000  0.6587301587  0.8237951807  0.7891566265  0.7801204819  0.7831325301  0.4444444444  16.000000000  0.2371425352  0.5171928257  0.0629591942  250           0.1836333847 
0.7400000000  0.7777777778  0.7120000000  0.6666666667  0.9397590361  0.9036144578  0.9141566265  0.8975903614  0.6603174603  19.200000000  0.2261114118  0.5013822317  0.0629591942  300           0.1740796661 
0.8500000000  0.8809523810  0.7720000000  0.6507936508  0.9442771084  0.8855421687  0.9713855422  0.9698795181  0.7063492063  22.400000000  0.2156831932  0.4870485091  0.0629591942  350           0.1813675117 
0.8840000000  0.8968253968  0.7960000000  0.6666666667  0.9156626506  0.8795180723  0.9864457831  0.9819277108  0.6857142857  25.600000000  0.2144039154  0.4610409337  0.0629591942  400           0.1721508646 
0.8660000000  0.8730158730  0.8980000000  0.8333333333  0.9352409639  0.9216867470  0.9879518072  0.9518072289  0.5682539683  28.800000000  0.2503474444  0.4294409490  0.0629591942  450           0.1796587992 
0.9360000000  0.9206349206  0.8780000000  0.7619047619  0.9216867470  0.9036144578  0.9804216867  0.9819277108  0.3952380952  32.000000000  0.2063018334  0.3573832738  0.0646486282  500           0.1807383251 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 39, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Fan End Bearing Fault Data/199.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 45, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Fan End Bearing Fault Data/199.mat'
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3560000000  0.3492063492  0.3560000000  0.3492063492  0.5647590361  0.5481927711  0.5888554217  0.5240963855  0.3507936508  0.0000000000  0.5268424749  1.1424957514  0.0539793968  0             0.4892625809 
0.5160000000  0.4841269841  0.5280000000  0.4841269841  0.7183734940  0.6807228916  0.7545180723  0.7168674699  0.4682539683  3.2000000000  0.1881633347  1.0034994197  0.0619773865  50            0.1762355995 
0.6700000000  0.6587301587  0.6540000000  0.6746031746  0.7710843373  0.7228915663  0.8870481928  0.8734939759  0.6412698413  6.4000000000  0.2078212976  0.8039064789  0.0619773865  100           0.1793981886 
0.6700000000  0.7301587302  0.6980000000  0.6825396825  0.8237951807  0.8132530120  0.9096385542  0.9036144578  0.7126984127  9.6000000000  0.2684667850  0.6474489212  0.0619773865  150           0.1782128000 
0.8060000000  0.8492063492  0.8000000000  0.8095238095  0.9006024096  0.8554216867  0.9006024096  0.8915662651  0.7555555556  12.800000000  0.2706793731  0.5396522212  0.0619773865  200           0.1827136755 
0.8260000000  0.8174603175  0.8360000000  0.8492063492  0.7394578313  0.7530120482  0.6566265060  0.6626506024  0.6507936508  16.000000000  0.2961597624  0.4673503214  0.0619773865  250           0.1709827137 
0.8660000000  0.8809523810  0.8940000000  0.8968253968  0.8599397590  0.8614457831  0.9894578313  0.9939759036  0.7000000000  19.200000000  0.2437042588  0.4037323260  0.0619773865  300           0.1749637985 
0.9440000000  0.9126984127  0.9520000000  0.9126984127  0.9804216867  0.9698795181  0.9593373494  0.9698795181  0.6412698413  22.400000000  0.2334239203  0.3315586305  0.0619773865  350           0.1860043955 
0.9440000000  0.9047619048  0.9320000000  0.9682539683  0.9563253012  0.9216867470  0.8765060241  0.8915662651  0.6936507937  25.600000000  0.2276024853  0.2766051921  0.0649237633  400           0.1885439873 
0.9580000000  0.9206349206  0.9640000000  0.9841269841  0.9759036145  0.9638554217  0.9849397590  1.0000000000  0.6936507937  28.800000000  0.2628165591  0.2134759614  0.0649237633  450           0.1851635504 
0.9200000000  0.9603174603  0.9620000000  0.9365079365  0.9548192771  0.9397590361  0.9909638554  0.9879518072  0.5698412698  32.000000000  0.2023154701  0.1544016294  0.0649237633  500           0.1818425035 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 191, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 484, in construct_domain
    Bx, By, numB = CWRU(self.dir, task='[cwru9, cwru10]', sub_root=3).get_files_agg()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 178, in __init__
    self.sub_root = datasetname[sub_root]
IndexError: list index out of range
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3640000000  0.3492063492  0.3927813163  0.3813559322  0.6054216867  0.5903614458  0.6295180723  0.5662650602  0.3714285714  0.0000000000  0.3891693056  1.1302690506  0.0539793968  0             0.4666748047 
0.5480000000  0.6190476190  0.6199575372  0.5847457627  0.8147590361  0.7650602410  0.7936746988  0.7168674699  0.5920634921  3.3970276008  0.2131606054  1.0389239228  0.0605525970  50            0.1780628872 
0.6940000000  0.6984126984  0.7027600849  0.7033898305  0.7078313253  0.6506024096  0.7259036145  0.7228915663  0.4603174603  6.7940552017  0.2366888726  0.8006118011  0.0605525970  100           0.1777660894 
0.7880000000  0.8174603175  0.7770700637  0.7627118644  0.8253012048  0.8433734940  0.7756024096  0.7530120482  0.7793650794  10.191082802  0.2694989496  0.6426624370  0.0605525970  150           0.1784748793 
0.7760000000  0.7698412698  0.7494692144  0.7881355932  0.7530120482  0.7108433735  0.8192771084  0.7831325301  0.6777777778  13.588110403  0.2778579313  0.5431610805  0.0623068810  200           0.1822577095 
0.7980000000  0.8095238095  0.8152866242  0.7966101695  0.8900602410  0.8975903614  0.9277108434  0.9156626506  0.6809523810  16.985138004  0.2512267214  0.4714800441  0.0623068810  250           0.1783938026 
0.7600000000  0.8015873016  0.7940552017  0.7881355932  0.7861445783  0.8072289157  0.9668674699  0.9518072289  0.8095238095  20.382165605  0.2173939407  0.4157640195  0.0623068810  300           0.1758947659 
0.9180000000  0.8650793651  0.9193205945  0.8728813559  0.9713855422  0.9578313253  0.7846385542  0.7771084337  0.5777777778  23.779193205  0.2423042491  0.3763807970  0.0623068810  350           0.1787746143 
0.8780000000  0.8333333333  0.9087048832  0.8728813559  0.9743975904  0.9578313253  0.9759036145  0.9759036145  0.3746031746  27.176220806  0.2409550104  0.3333828408  0.0623068810  400           0.1760664082 
0.8760000000  0.7857142857  0.8726114650  0.8305084746  0.8870481928  0.8855421687  0.9638554217  0.9518072289  0.3206349206  30.573248407  0.2453897648  0.2852223468  0.0623068810  450           0.1821970558 
0.9780000000  0.9444444444  0.9363057325  0.8983050847  0.9277108434  0.9277108434  0.9864457831  0.9819277108  0.4507936508  33.970276008  0.2296282516  0.2384155861  0.0623068810  500           0.1762454987 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4702055454 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0604534149  50            0.1800134468 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0604977608  100           0.1746175432 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0604977608  150           0.1736047649 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0605254173  200           0.1741992378 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0605254173  250           0.1728566885 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0620260239  300           0.1744761801 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0620260239  350           0.1720244741 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0620260239  400           0.1711353016 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0620260239  450           0.1723193264 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0620260239  500           0.1698202658 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3529367447 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.4533333333  3.2000000000  0.5294519615  0.0585384369  50            0.0289560556 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.6733333333  6.4000000000  0.2354695666  0.0587725639  100           0.0296244192 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.6466666667  9.6000000000  0.0897018895  0.0587725639  150           0.0294076824 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.5600000000  12.800000000  0.0471370297  0.0587954521  200           0.0291978550 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.6433333333  16.000000000  0.0281241818  0.0589504242  250           0.0297417641 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  0.9246987952  0.8915662651  0.9698795181  0.9638554217  0.4033333333  19.200000000  0.0178615930  0.0589756966  300           0.0290349960 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9789156627  0.9397590361  0.9909638554  0.9879518072  0.6200000000  22.400000000  0.0163820754  0.0589895248  350           0.0298029757 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9698795181  0.9277108434  0.9984939759  0.9939759036  0.5500000000  25.600000000  0.0141548238  0.0614767075  400           0.0297434044 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5566666667  28.800000000  0.0116662318  0.0614767075  450           0.0290563536 
1.0000000000  0.9682539683  0.9960000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5700000000  32.000000000  0.0093445297  0.0614767075  500           0.0295793009 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3333333333  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.5083954334 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.3366666667  3.2000000000  0.1724725336  1.0238350058  0.0604529381  50            0.1801091623 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.7100000000  6.4000000000  0.2133689201  0.7992190742  0.0638594627  100           0.1753180695 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7033333333  9.6000000000  0.2937957740  0.6140127623  0.0638594627  150           0.1816606379 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7233333333  12.800000000  0.2993899462  0.5418152189  0.0638594627  200           0.1796623373 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.6500000000  16.000000000  0.2975358251  0.4993305999  0.0638594627  250           0.1796274900 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.4133333333  19.200000000  0.2305131897  0.4693784475  0.0638594627  300           0.1804812860 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.3466666667  22.400000000  0.2278430471  0.4321727586  0.0638594627  350           0.1745052719 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.2333333333  25.600000000  0.2315711018  0.4154955357  0.0638594627  400           0.1759191132 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.3833333333  28.800000000  0.2738550451  0.3907812816  0.0638594627  450           0.1790467024 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.2633333333  32.000000000  0.2264085618  0.3474361616  0.0638594627  500           0.1777941322 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.1524477005  0.0539798737  0.2110469639  0             0.3095481396 
0.8560000000  0.8253968254  0.8500000000  0.6666666667  0.9638554217  0.9518072289  1.0000000000  1.0000000000  0.6366666667  3.2000000000  0.6267833030  0.0605721474  0.9324540059  50            0.0133763695 
0.9780000000  0.9682539683  0.9580000000  0.8333333333  0.9668674699  0.9518072289  1.0000000000  1.0000000000  0.4933333333  6.4000000000  0.3476204589  0.0605721474  1.3414526320  100           0.0131410742 
1.0000000000  0.9761904762  0.9960000000  0.9444444444  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.4766666667  9.6000000000  0.2189122429  0.0605721474  1.5281972241  150           0.0132479286 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.4166666667  12.800000000  0.1780410495  0.0605721474  1.6001168370  200           0.0135109901 
1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4466666667  16.000000000  0.1591288146  0.0605721474  1.6257793808  250           0.0136466265 
1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4233333333  19.200000000  0.1511535066  0.0605721474  1.6137769079  300           0.0131355333 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3733333333  22.400000000  0.1449973294  0.0605721474  1.6225326991  350           0.0133581257 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3400000000  25.600000000  0.1433196640  0.0605721474  1.6142144537  400           0.0131329584 
1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3733333333  28.800000000  0.1410796562  0.0605721474  1.6116420960  450           0.0132389307 
1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3400000000  32.000000000  0.1389535984  0.0605721474  1.6124257207  500           0.0133410263 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
difficult data
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3418889046 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.3333333333  3.2000000000  0.5294519615  0.0587019920  50            0.0297775316 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.3532763533  6.4000000000  0.2354695666  0.0587019920  100           0.0287090826 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.4102564103  9.6000000000  0.0897018895  0.0587019920  150           0.0285414982 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.3874643875  12.800000000  0.0471370297  0.0587019920  200           0.0295801401 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.4301994302  16.000000000  0.0281241818  0.0587019920  250           0.0293045282 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  0.9246987952  0.8915662651  0.9698795181  0.9638554217  0.3418803419  19.200000000  0.0178615930  0.0587019920  300           0.0298831463 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9789156627  0.9397590361  0.9909638554  0.9879518072  0.4757834758  22.400000000  0.0163820754  0.0588212013  350           0.0308580446 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9698795181  0.9277108434  0.9984939759  0.9939759036  0.3874643875  25.600000000  0.0141548238  0.0588212013  400           0.0286636639 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4188034188  28.800000000  0.0116662318  0.0588212013  450           0.0296919537 
1.0000000000  0.9682539683  0.9960000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.3903133903  32.000000000  0.0093445297  0.0588212013  500           0.0289845562 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.2816265060  0.2710843373  0.4277108434  0.3855421687  0.3333333333  0.0000000000  1.1174415350  0.0521492958  0             0.3252375126 
0.7920000000  0.7142857143  0.6660000000  0.6507936508  0.8870481928  0.8975903614  0.9774096386  0.9819277108  0.3333333333  3.2000000000  0.5190082937  0.0585665703  50            0.0287071609 
0.9700000000  0.9285714286  0.9340000000  0.8412698413  0.9216867470  0.8795180723  0.9743975904  0.9819277108  0.4131054131  6.4000000000  0.1985903794  0.0585665703  100           0.0298820496 
0.9940000000  0.9444444444  0.9760000000  0.8809523810  0.9307228916  0.8795180723  0.9201807229  0.9457831325  0.5099715100  9.6000000000  0.0868558320  0.0585665703  150           0.0290326023 
0.9840000000  0.9206349206  0.9800000000  0.9206349206  0.9864457831  0.9578313253  0.9984939759  0.9939759036  0.3532763533  12.800000000  0.0429646813  0.0586142540  200           0.0290178823 
0.9980000000  0.9603174603  0.9880000000  0.9126984127  0.9533132530  0.9096385542  0.9909638554  0.9879518072  0.4245014245  16.000000000  0.0227865087  0.0586142540  250           0.0290704775 
0.9900000000  0.9365079365  0.9880000000  0.9126984127  0.9864457831  0.9698795181  0.9969879518  1.0000000000  0.3504273504  19.200000000  0.0169221223  0.0586142540  300           0.0289636850 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  0.9969879518  1.0000000000  0.5185185185  22.400000000  0.0119245973  0.0615291595  350           0.0296286535 
0.9980000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4900284900  25.600000000  0.0107412871  0.0615291595  400           0.0287616158 
1.0000000000  0.9761904762  0.9980000000  0.9603174603  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4558404558  28.800000000  0.0082620217  0.0615291595  450           0.0292769670 
1.0000000000  0.9761904762  1.0000000000  0.9285714286  0.9638554217  0.9518072289  0.9924698795  0.9939759036  0.3646723647  32.000000000  0.0064816466  0.0615291595  500           0.0284714937 
Python 3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
Type 'copyright', 'credits' or 'license' for more information
IPython 7.16.1 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.16.1

Out[2]: array([1, 3, 5, 2, 4, 6])
Out[4]: array([1, 2, 3, 4, 5, 6])
Out[6]: array([0, 3, 1, 4, 2, 5])
Out[8]: array([0, 1, 6, 7, 2, 3, 8, 9, 4, 5])
Out[9]: 
array([[7.33413462e-06, 2.89290865e-05, 3.70781250e-05, 1.26310096e-05,
        3.87079327e-06, 1.34459135e-05, 2.75030048e-05, 2.13912260e-05,
        2.40396635e-05, 8.35276442e-05, 1.03289062e-04, 7.61935096e-05,
        2.66881010e-05, 8.35276442e-06, 1.93539663e-05, 4.48197115e-06,
        6.92668269e-06, 1.18161058e-05, 2.42433894e-05, 8.96394231e-06,
        3.93191106e-05, 8.92319712e-05, 8.76021635e-05, 5.84693510e-05,
        3.03551683e-05, 2.66881010e-05, 3.36147837e-05, 1.79278846e-05,
        1.32421875e-05, 4.70606971e-05, 4.50234375e-05, 6.72295673e-06,
        7.94531250e-05, 1.25291466e-04, 1.17957332e-04, 8.04717548e-05,
        5.68395433e-05, 6.33587740e-05, 5.92842548e-05, 3.50408654e-05,
        8.35276442e-06, 5.70432692e-06, 4.07451923e-05, 8.21015625e-05,
        1.01251803e-04, 7.41562500e-05, 1.91502404e-05, 1.46682692e-05,
        1.32421875e-05, 3.25961538e-06, 5.90805288e-06, 3.60594952e-05,
        4.93016827e-05, 3.64669471e-05, 5.90805288e-06, 1.75204327e-05,
        8.55649038e-06, 3.23924279e-05, 6.96742788e-05, 8.29164663e-05,
        6.33587740e-05, 4.33936298e-05, 7.39525240e-05, 1.13067909e-04,
        1.37922476e-04, 1.27328726e-04, 8.69909856e-05, 6.72295673e-05,
        8.29164663e-05, 1.33033053e-04, 1.64406851e-04, 1.52387019e-04,
        1.29773438e-04, 1.16531250e-04, 1.26310096e-04, 1.30180889e-04,
        9.37139423e-05, 5.58209135e-05, 3.30036058e-05, 3.46334135e-05,
        6.84519231e-05, 1.03289062e-04, 1.17549880e-04, 1.14697716e-04,
        1.24476562e-04, 1.55035457e-04, 1.78667668e-04, 1.61147236e-04,
        1.08585937e-04, 5.25612981e-05, 1.36496394e-05, 1.24272837e-05,
        5.19501202e-05, 6.88593750e-05, 3.62632212e-05, 1.01862981e-06,
        2.01688702e-05, 5.90805288e-06, 2.24098558e-06, 1.16123798e-05,
        1.28347356e-05, 1.26310096e-05, 2.48545673e-05, 7.08966346e-05,
        8.88245192e-05, 5.50060096e-05, 1.62980769e-06, 2.58731971e-05,
        3.46334135e-05, 2.50582933e-05, 2.89290865e-05, 6.15252404e-05,
        8.57686298e-05, 8.14903846e-05, 3.54483173e-05, 1.87427885e-05,
        3.95228365e-05, 3.56520433e-05, 2.70955529e-05, 2.89290865e-05,
        6.15252404e-05, 8.55649038e-05, 6.45811298e-05, 1.40570913e-05,
        2.83179087e-05, 2.87253606e-05, 1.69092548e-05, 1.05937500e-05,
        3.17812500e-05, 7.25264423e-05, 8.02680288e-05, 6.62109375e-05,
        4.52271635e-05, 3.72818510e-05, 4.64495192e-05, 5.41911058e-05,
        4.84867788e-05, 1.56868990e-05, 1.22235577e-05, 6.11177885e-07,
        3.76893029e-05, 6.13215144e-05, 6.47848558e-05, 6.86556490e-05,
        7.92493990e-05, 1.08382212e-04, 1.36903846e-04, 1.36496394e-04,
        9.24915865e-05, 1.40570913e-05, 2.44471154e-05, 4.68569712e-06,
        2.93365385e-05, 4.70606971e-05, 2.44471154e-05, 5.09314904e-06,
        2.50582933e-05, 3.05588942e-05, 1.89465144e-05, 3.38185096e-05,
        5.43948317e-05, 5.86730769e-05, 3.56520433e-05, 2.03725962e-07,
        2.44471154e-06, 2.13912260e-05, 6.51923077e-05, 8.71947115e-05,
        5.54134615e-05, 2.15949519e-05, 3.87079327e-06, 3.17812500e-05,
        4.95054087e-05, 3.80967548e-05, 3.46334135e-06, 5.52097356e-05,
        6.84519231e-05, 5.01165865e-05, 2.34284856e-05, 1.42608173e-05,
        2.75030048e-05, 3.62632212e-05, 4.72644231e-05, 3.97265625e-05,
        4.50234375e-05, 8.69909856e-05, 1.20809495e-04, 1.23254207e-04,
        8.80096154e-05, 3.30036058e-05, 1.95576923e-05, 3.72818510e-05,
        7.94531250e-06, 1.79278846e-05, 2.32247596e-05, 1.67055288e-05,
        4.78756010e-05, 9.96219952e-05, 1.04918870e-04, 9.24915865e-05,
        4.66532452e-05, 9.98257212e-06, 4.66532452e-05, 5.41911058e-05,
        3.23924279e-05, 4.58383413e-05, 7.59897837e-05, 6.66183894e-05,
        1.85390625e-05, 3.27998798e-05, 5.70432692e-05, 3.25961538e-05,
        3.01514423e-05, 8.14903846e-05, 9.14729567e-05, 9.10655048e-05,
        1.02677885e-04, 1.12049279e-04, 9.18804087e-05, 2.50582933e-05,
        4.17638221e-05, 7.21189904e-05, 4.35973558e-05, 2.28173077e-05,
        7.84344952e-05, 1.05530048e-04, 8.82133413e-05, 7.29338942e-05,
        8.39350962e-05, 9.69735577e-05, 8.59723558e-05, 4.25787260e-05,
        5.29687500e-06, 3.66706731e-06, 3.38185096e-05, 8.80096154e-05,
        1.10419471e-04, 1.06548678e-04, 8.06754808e-05, 5.37836538e-05,
        3.54483173e-05, 6.11177885e-06, 6.88593750e-05, 1.27532452e-04,
        1.45052885e-04, 8.84170673e-05, 2.64843750e-06, 7.25264423e-05,
        1.01862981e-04, 9.53437500e-05, 8.61760817e-05, 9.14729567e-05,
        8.12866587e-05, 2.85216346e-05, 4.90979567e-05, 1.01048077e-04,
        9.83996394e-05, 4.60420673e-05, 3.15775240e-05, 6.76370192e-05,
        5.43948317e-05, 3.58557692e-05, 2.75030048e-05, 2.91328125e-05,
        1.62980769e-06, 5.70432692e-05, 1.12253005e-04, 1.34459135e-04,
        9.77884615e-05, 3.64669471e-05, 2.03725962e-06, 6.51923077e-06,
        3.34110577e-05, 3.32073317e-05, 3.17812500e-05, 5.52097356e-05,
        1.04307692e-04, 1.63591947e-04, 1.91909856e-04, 1.66240385e-04,
        9.04543269e-05, 1.77241587e-05, 2.03725962e-07, 2.56694712e-05,
        4.42085337e-05, 4.27824519e-05, 4.09489183e-05, 5.07277644e-05,
        9.06580529e-05, 1.28551082e-04, 1.17549880e-04, 5.96917067e-05,
        1.71129808e-05, 6.51923077e-05, 6.23401442e-05, 4.64495192e-05,
        4.58383413e-05, 4.72644231e-05, 3.74855769e-05, 1.60943510e-05,
        8.00643029e-05, 8.59723558e-05, 3.21887019e-05, 5.07277644e-05,
        1.12864183e-04, 1.23254207e-04, 1.00233173e-04, 8.51574519e-05,
        8.63798077e-05, 8.88245192e-05, 6.35625000e-05, 1.62980769e-06,
        4.52271635e-05, 3.11700721e-05, 2.89290865e-05, 9.39176683e-05,
        1.16123798e-04, 1.00029447e-04, 7.37487981e-05, 6.58034856e-05,
        6.72295673e-05, 5.15426683e-05, 4.07451923e-06, 5.74507212e-05,
        6.53960337e-05, 1.67055288e-05, 5.92842548e-05, 1.14493990e-04,
        1.07771034e-04, 8.63798077e-05, 7.88419471e-05, 9.33064904e-05,
        1.09604567e-04, 8.04717548e-05, 1.89465144e-05, 3.46334135e-05,
        2.97439904e-05, 2.01688702e-05, 7.21189904e-05, 8.88245192e-05,
        6.09140625e-05, 5.15426683e-05, 6.84519231e-05, 1.00436899e-04,
        1.07974760e-04, 7.23227163e-05, 4.11526442e-05, 4.29861779e-05,
        9.39176683e-05, 1.39144832e-04, 1.53405649e-04, 1.43423077e-04,
        1.19587139e-04, 1.28347356e-04, 1.52387019e-04, 1.53813101e-04,
        1.20402043e-04, 5.64320913e-05, 1.62980769e-05, 4.25787260e-05,
        9.88070913e-05, 1.37922476e-04, 1.36700120e-04, 1.03289062e-04,
        8.49537260e-05, 9.00468750e-05, 1.01455529e-04, 9.86033654e-05,
        5.56171875e-05, 1.77241587e-05, 2.64843750e-05, 6.64146635e-05,
        9.96219952e-05, 7.98605769e-05, 2.89290865e-05, 2.28173077e-05,
        5.01165865e-05, 4.80793269e-05, 6.62109375e-05, 9.08617788e-05,
        1.16938702e-04, 1.09604567e-04, 4.56346154e-05, 1.75204327e-05,
        4.52271635e-05, 1.30384615e-05, 2.79104567e-05, 3.93191106e-05,
        2.70955529e-05, 2.24098558e-06, 2.22061298e-05, 7.96568510e-05,
        1.33033053e-04, 1.45460337e-04, 9.98257212e-05, 6.33587740e-05,
        5.90805288e-05, 7.72121394e-05, 8.47500000e-05, 4.52271635e-05,
        6.72295673e-06, 3.46334135e-06, 2.50582933e-05, 6.88593750e-05,
        7.55823317e-05, 3.07626202e-05, 2.60769231e-05, 3.23924279e-05,
        8.14903846e-06, 5.74507212e-05, 7.70084135e-05, 6.07103365e-05,
        4.33936298e-05, 4.74681490e-05, 7.25264423e-05, 8.14903846e-05,
        5.09314904e-05, 1.83353365e-06, 3.78930288e-05, 3.87079327e-05,
        1.81316106e-05, 3.87079327e-06, 2.46508413e-05, 4.93016827e-05,
        4.17638221e-05, 6.31550481e-06, 3.03551683e-05, 3.93191106e-05,
        2.34284856e-05, 8.76021635e-06, 1.89465144e-05, 4.07451923e-05,
        4.17638221e-05, 7.13040865e-06, 7.51748798e-05, 1.11641827e-04,
        9.22878606e-05, 3.64669471e-05, 6.11177885e-06, 3.87079327e-06,
        1.83353365e-05, 1.48719952e-05, 1.26310096e-05, 4.07451923e-05,
        5.96917067e-05, 3.80967548e-05, 1.83353365e-06, 5.90805288e-06,
        1.77241587e-05, 3.32073317e-05, 1.52794471e-05, 2.62806490e-05,
        5.70432692e-05, 5.13389423e-05, 3.17812500e-05, 7.94531250e-06,
        3.46334135e-06, 1.03900240e-05, 3.66706731e-06, 3.87079327e-05,
        8.39350962e-05, 8.47500000e-05, 3.66706731e-05, 1.46682692e-05,
        4.07451923e-05, 3.07626202e-05, 2.60769231e-05, 3.50408654e-05,
        5.33762019e-05, 9.65661058e-05, 1.00233173e-04, 4.38010817e-05,
        1.52794471e-05, 3.25961538e-05, 1.58906250e-05, 2.75030048e-05,
        5.50060096e-05, 7.29338942e-05, 6.72295673e-05, 3.15775240e-05,
        2.03725962e-07, 9.98257212e-06, 2.01688702e-05, 5.25612981e-05,
        5.23575721e-05, 2.46508413e-05, 1.62980769e-05, 3.48371394e-05,
        1.85390625e-05, 8.14903846e-06, 7.33413462e-06, 1.10012019e-05,
        1.83353365e-05, 5.29687500e-06, 4.78756010e-05, 5.84693510e-05,
        2.60769231e-05, 3.11700721e-05, 8.84170673e-05, 1.02270433e-04,
        9.69735577e-05, 1.05937500e-04, 1.18568510e-04, 1.30792067e-04,
        1.04307692e-04, 5.74507212e-05, 2.89290865e-05, 2.22061298e-05,
        4.05414663e-05, 6.00991587e-05, 5.58209135e-05, 2.15949519e-05]])
Out[10]: 0
Out[11]: 2
Out[12]: array([0, 1, 0, 2, 1, 2])
Out[13]: array([0, 0, 1, 1, 2, 2, 0, 0, 1, 1])
Out[14]: array([0, 3, 1, 4, 2, 5])
Out[15]: array([0, 0, 1, 1, 2, 2, 0, 0, 1, 1])
Out[17]: array([0, 0, 0, 0, 1, 1, 1, 1, 2, 2])
Out[18]: 1
Out[19]: 1
Out[20]: 
[0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 0,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 1,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2,
 2]
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
1
0 117
1 117
2 117


2
0 117
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 191, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 487, in construct_domain
    Fx, Fy, numF = JNU(dir=self.dir, condition=None, num_class=3).get_files()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 487, in get_files
    data1, lab1 = self.data_load(path1, label=i)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 514, in data_load
    fl = np.loadtxt(filename)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/lib/npyio.py", line 1139, in loadtxt
    for x in read_data(_loadtxt_chunksize):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/lib/npyio.py", line 1070, in read_data
    items = pack_items(items, packing)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/core/_internal.py", line 872, in __call__
    def __call__(self, *args, **kwargs):
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 194, in <module>
    rate = args.holdout_fraction
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4758832455 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0606265068  50            0.1706764698 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0606265068  100           0.1741998482 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0606265068  150           0.1715819407 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0606265068  200           0.1697737598 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0606265068  250           0.1728539515 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0606265068  300           0.1704285336 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0606265068  350           0.1733607101 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0606265068  400           0.1720847464 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0606265068  450           0.1693285036 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0606546402  500           0.1704075336 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3620000000  0.3492063492  0.3460000000  0.3412698413  0.6219879518  0.5963855422  0.5722891566  0.5301204819  0.3777777778  0.0000000000  0.5290244818  1.1461868286  0.0539793968  0             0.4710001945 
0.4760000000  0.4682539683  0.5020000000  0.4206349206  0.6551204819  0.6325301205  0.8719879518  0.8253012048  0.5222222222  3.2000000000  0.1281432062  1.0608236408  0.0605969429  50            0.1703186131 
0.5320000000  0.4920634921  0.5840000000  0.5634920635  0.6656626506  0.6626506024  0.7740963855  0.7710843373  0.5047619048  6.4000000000  0.1529671460  0.8977745426  0.0605969429  100           0.1738015652 
0.6680000000  0.6587301587  0.6020000000  0.5793650794  0.8930722892  0.8253012048  0.8237951807  0.8132530120  0.6619047619  9.6000000000  0.2643938470  0.6685341227  0.0605969429  150           0.1718282747 
0.7600000000  0.7698412698  0.6520000000  0.6746031746  0.8253012048  0.7710843373  0.7153614458  0.6927710843  0.7619047619  12.800000000  0.2914970431  0.5768317813  0.0605969429  200           0.1708598232 
0.6760000000  0.6904761905  0.7040000000  0.6746031746  0.8177710843  0.8132530120  0.8960843373  0.8614457831  0.6555555556  16.000000000  0.2452293587  0.5294710362  0.0605969429  250           0.1690683031 
0.7240000000  0.7222222222  0.7120000000  0.7142857143  0.8463855422  0.8433734940  0.9382530120  0.9337349398  0.5587301587  19.200000000  0.2055755457  0.4880863678  0.0605969429  300           0.1686919498 
0.8060000000  0.8333333333  0.7560000000  0.6904761905  0.7891566265  0.7951807229  0.9894578313  0.9698795181  0.7746031746  22.400000000  0.1958700836  0.4825553852  0.0606107712  350           0.1696772146 
0.7960000000  0.8095238095  0.8020000000  0.7698412698  0.9518072289  0.9156626506  0.8930722892  0.9337349398  0.8349206349  25.600000000  0.2023838389  0.4664259881  0.0606107712  400           0.1680925560 
0.7800000000  0.7698412698  0.8420000000  0.7460317460  0.8072289157  0.7951807229  0.9216867470  0.9277108434  0.5888888889  28.800000000  0.2201164085  0.4525415981  0.0620665550  450           0.1706432056 
0.7940000000  0.8253968254  0.7520000000  0.6746031746  0.9774096386  0.9819277108  0.9352409639  0.9457831325  0.5746031746  32.000000000  0.2025970218  0.4138051534  0.0634355545  500           0.1685669470 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3734939759  0.3614457831  0.3349206349  0.0000000000  1.1295855045  0.0521492958  0             0.3303265572 
0.7180000000  0.6428571429  0.7240000000  0.6428571429  0.8930722892  0.8975903614  0.9894578313  0.9939759036  0.5333333333  3.2000000000  0.5327997974  0.0584988594  50            0.0289284992 
0.9680000000  0.9365079365  0.9300000000  0.8253968254  0.9096385542  0.8915662651  0.9864457831  0.9819277108  0.7095238095  6.4000000000  0.2207591648  0.0584988594  100           0.0304533243 
0.9960000000  0.9523809524  0.9900000000  0.8888888889  0.8810240964  0.8614457831  0.9126506024  0.9277108434  0.6492063492  9.6000000000  0.0879942466  0.0584988594  150           0.0312925148 
0.9840000000  0.8968253968  0.9260000000  0.8412698413  0.9834337349  0.9578313253  1.0000000000  1.0000000000  0.6428571429  12.800000000  0.0537471180  0.0609998703  200           0.0299770498 
0.9980000000  0.9603174603  0.9980000000  0.9047619048  0.8042168675  0.7590361446  0.9322289157  0.9216867470  0.4412698413  16.000000000  0.0304131766  0.0609998703  250           0.0294707346 
0.9980000000  0.9682539683  0.9900000000  0.8888888889  0.9051204819  0.8614457831  0.9713855422  0.9578313253  0.5253968254  19.200000000  0.0226583727  0.0609998703  300           0.0300424671 
0.9980000000  0.9603174603  1.0000000000  0.9444444444  0.9864457831  0.9698795181  0.9954819277  0.9939759036  0.6111111111  22.400000000  0.0153858429  0.0609998703  350           0.0293631029 
0.9980000000  0.9841269841  1.0000000000  0.9206349206  0.9774096386  0.9337349398  1.0000000000  1.0000000000  0.5777777778  25.600000000  0.0168765187  0.0609998703  400           0.0293658733 
0.9980000000  0.9523809524  1.0000000000  0.9365079365  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.6253968254  28.800000000  0.0147549050  0.0609998703  450           0.0292435980 
1.0000000000  0.9841269841  1.0000000000  0.8968253968  0.9939759036  0.9759036145  1.0000000000  1.0000000000  0.5825396825  32.000000000  0.0093070120  0.0609998703  500           0.0279680157 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3960843373  0.3674698795  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3338227272 
0.8340000000  0.8015873016  0.6940000000  0.7142857143  0.8328313253  0.8373493976  0.9789156627  0.9759036145  0.1927825261  3.2000000000  0.5151218218  0.0584940910  50            0.0296042252 
0.9500000000  0.8888888889  0.9080000000  0.8333333333  0.9728915663  0.9277108434  0.9969879518  0.9879518072  0.3380816714  6.4000000000  0.2053392652  0.0611114502  100           0.0293265533 
0.9800000000  0.9285714286  0.9840000000  0.9523809524  0.9668674699  0.9397590361  0.9834337349  0.9819277108  0.4491927825  9.6000000000  0.1038684525  0.0611114502  150           0.0293204260 
0.9800000000  0.9126984127  0.9720000000  0.9047619048  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.4881291548  12.800000000  0.0394192308  0.0611114502  200           0.0288829279 
1.0000000000  0.9841269841  0.9960000000  0.9444444444  0.9186746988  0.8915662651  0.9593373494  0.9819277108  0.5498575499  16.000000000  0.0268516193  0.0611114502  250           0.0302911472 
1.0000000000  0.9920634921  0.9980000000  0.9682539683  0.9548192771  0.9156626506  0.9849397590  0.9879518072  0.5204178538  19.200000000  0.0219132745  0.0611114502  300           0.0290573168 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.9894578313  0.9819277108  0.9984939759  0.9939759036  0.5308641975  22.400000000  0.0101959666  0.0611114502  350           0.0287638807 
0.9960000000  0.9841269841  0.9920000000  0.9841269841  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.5470085470  25.600000000  0.0123701479  0.0611114502  400           0.0286220121 
1.0000000000  0.9603174603  0.9960000000  0.9444444444  0.9533132530  0.9216867470  0.9924698795  0.9939759036  0.4301994302  28.800000000  0.0107058332  0.0611114502  450           0.0288064575 
1.0000000000  0.9841269841  0.9980000000  0.9761904762  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5156695157  32.000000000  0.0134816373  0.0611114502  500           0.0296525431 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3960843373  0.3674698795  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3458817005 
0.8340000000  0.8015873016  0.6940000000  0.7142857143  0.8328313253  0.8373493976  0.9789156627  0.9759036145  0.6433333333  3.2000000000  0.5151218218  0.0584797859  50            0.0302765703 
0.9500000000  0.8888888889  0.9080000000  0.8333333333  0.9728915663  0.9277108434  0.9969879518  0.9879518072  0.5700000000  6.4000000000  0.2053392652  0.0585279465  100           0.0302843714 
0.9800000000  0.9285714286  0.9840000000  0.9523809524  0.9668674699  0.9397590361  0.9834337349  0.9819277108  0.4866666667  9.6000000000  0.1038684525  0.0585279465  150           0.0286599493 
0.9800000000  0.9126984127  0.9720000000  0.9047619048  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.5100000000  12.800000000  0.0394192308  0.0588717461  200           0.0285704231 
1.0000000000  0.9841269841  0.9960000000  0.9444444444  0.9186746988  0.8915662651  0.9593373494  0.9819277108  0.4200000000  16.000000000  0.0268516193  0.0588717461  250           0.0287197971 
1.0000000000  0.9920634921  0.9980000000  0.9682539683  0.9548192771  0.9156626506  0.9849397590  0.9879518072  0.4033333333  19.200000000  0.0219132745  0.0588717461  300           0.0287078047 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.9894578313  0.9819277108  0.9984939759  0.9939759036  0.4000000000  22.400000000  0.0101959666  0.0588717461  350           0.0291773462 
0.9960000000  0.9841269841  0.9920000000  0.9841269841  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.4466666667  25.600000000  0.0123701479  0.0588717461  400           0.0282593870 
1.0000000000  0.9603174603  0.9960000000  0.9444444444  0.9533132530  0.9216867470  0.9924698795  0.9939759036  0.3800000000  28.800000000  0.0107058332  0.0588717461  450           0.0296240759 
1.0000000000  0.9841269841  0.9980000000  0.9761904762  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.4566666667  32.000000000  0.0134816373  0.0588717461  500           0.0302152824 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3380000000  0.3333333333  0.3360000000  0.3333333333  0.2846385542  0.2951807229  0.4246987952  0.3855421687  0.3333333333  0.0000000000  1.1218466759  0.0521492958  0             0.3488564491 
0.7840000000  0.7063492063  0.6700000000  0.7063492063  0.9171686747  0.9096385542  0.9924698795  0.9939759036  0.6033333333  3.2000000000  0.5278496534  0.0585131645  50            0.0292997694 
0.9440000000  0.8888888889  0.9080000000  0.8571428571  0.9201807229  0.8975903614  0.9864457831  0.9939759036  0.6866666667  6.4000000000  0.2012992135  0.0585279465  100           0.0291901875 
0.9960000000  0.9682539683  0.9680000000  0.8888888889  0.9503012048  0.9096385542  0.9804216867  0.9819277108  0.4533333333  9.6000000000  0.0706708541  0.0585279465  150           0.0294165850 
0.9940000000  0.9682539683  0.9580000000  0.8809523810  0.9879518072  0.9518072289  0.9984939759  0.9939759036  0.5233333333  12.800000000  0.0373777868  0.0621724129  200           0.0283386135 
0.9960000000  0.9841269841  0.9900000000  0.8888888889  0.9111445783  0.8855421687  0.9834337349  0.9819277108  0.4400000000  16.000000000  0.0246095708  0.0621724129  250           0.0290972376 
1.0000000000  0.9841269841  1.0000000000  0.9206349206  0.9789156627  0.9638554217  0.9969879518  1.0000000000  0.4500000000  19.200000000  0.0209953443  0.0621724129  300           0.0292182016 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9849397590  0.9397590361  0.9894578313  0.9819277108  0.5000000000  22.400000000  0.0137133208  0.0621724129  350           0.0288183451 
1.0000000000  0.9920634921  0.9980000000  0.9285714286  0.9939759036  0.9638554217  0.9984939759  0.9939759036  0.4766666667  25.600000000  0.0097389088  0.0621724129  400           0.0288477898 
1.0000000000  0.9841269841  0.9940000000  0.9444444444  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.5500000000  28.800000000  0.0114507910  0.0621724129  450           0.0288667870 
1.0000000000  0.9761904762  0.9960000000  0.9126984127  0.9909638554  0.9638554217  1.0000000000  1.0000000000  0.4333333333  32.000000000  0.0093782324  0.0621724129  500           0.0291359949 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3870481928  0.3674698795  0.3333333333  0.0000000000  1.1273189783  0.0521492958  0             0.3281588554 
0.8100000000  0.7539682540  0.7700000000  0.7142857143  0.8900602410  0.8855421687  0.9638554217  0.9759036145  0.5933333333  3.2000000000  0.5333699006  0.0584797859  50            0.0289343119 
0.8940000000  0.8095238095  0.8980000000  0.8253968254  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.4766666667  6.4000000000  0.1754185851  0.0584797859  100           0.0286771822 
0.9800000000  0.8968253968  0.9640000000  0.8809523810  0.9397590361  0.9156626506  0.9804216867  0.9698795181  0.5933333333  9.6000000000  0.0649355419  0.0584797859  150           0.0291225576 
0.9920000000  0.8968253968  0.9440000000  0.8571428571  0.9924698795  0.9698795181  0.9984939759  0.9939759036  0.5733333333  12.800000000  0.0431782932  0.0584797859  200           0.0298495388 
0.9900000000  0.9126984127  0.9900000000  0.9206349206  0.9246987952  0.9036144578  0.9849397590  0.9638554217  0.5733333333  16.000000000  0.0292584935  0.0584797859  250           0.0291969919 
1.0000000000  0.9841269841  0.9960000000  0.9047619048  0.9246987952  0.9156626506  0.9668674699  0.9518072289  0.3866666667  19.200000000  0.0179879414  0.0584797859  300           0.0283170891 
1.0000000000  0.9603174603  0.9960000000  0.9603174603  0.9954819277  0.9819277108  0.9984939759  0.9939759036  0.6100000000  22.400000000  0.0104220406  0.0585384369  350           0.0284209490 
1.0000000000  0.9682539683  0.9900000000  0.9126984127  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4733333333  25.600000000  0.0093942945  0.0587930679  400           0.0283958864 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.5700000000  28.800000000  0.0171807452  0.0587930679  450           0.0280481482 
1.0000000000  0.9444444444  0.9980000000  0.9285714286  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5400000000  32.000000000  0.0061185914  0.0587930679  500           0.0297986603 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3192771084  0.3253012048  0.3885542169  0.3855421687  0.3333333333  0.0000000000  1.1340422630  0.0521492958  0             0.3246195316 
0.8260000000  0.7857142857  0.7460000000  0.6666666667  0.9984939759  0.9819277108  0.9397590361  0.9397590361  0.6066666667  3.2000000000  0.4900253528  0.0584797859  50            0.0294991541 
0.9340000000  0.8253968254  0.9060000000  0.8174603175  0.9804216867  0.9698795181  0.9111445783  0.9337349398  0.5900000000  6.4000000000  0.1338931439  0.0584797859  100           0.0294173717 
0.9920000000  0.9444444444  0.9700000000  0.9365079365  0.9683734940  0.9578313253  0.8599397590  0.8855421687  0.4566666667  9.6000000000  0.0490906300  0.0604810715  150           0.0273723125 
0.9940000000  0.9444444444  0.9120000000  0.8492063492  0.9864457831  0.9819277108  0.9653614458  0.9457831325  0.4933333333  12.800000000  0.0367279517  0.0604810715  200           0.0291402054 
1.0000000000  0.9682539683  0.9960000000  0.9444444444  0.7545180723  0.7168674699  0.6852409639  0.6807228916  0.3333333333  16.000000000  0.0410535013  0.0604810715  250           0.0293113899 
1.0000000000  0.9523809524  0.9960000000  0.9682539683  0.9804216867  0.9578313253  0.8328313253  0.8855421687  0.4266666667  19.200000000  0.0245352650  0.0604810715  300           0.0288144302 
1.0000000000  0.9365079365  0.9920000000  0.9365079365  0.9849397590  0.9638554217  0.8900602410  0.9096385542  0.4800000000  22.400000000  0.0120426783  0.0604810715  350           0.0283587885 
1.0000000000  0.9523809524  0.9960000000  0.9682539683  0.9864457831  0.9698795181  0.9006024096  0.9277108434  0.4433333333  25.600000000  0.0104133017  0.0604810715  400           0.0281759453 
1.0000000000  0.9603174603  0.9960000000  0.9126984127  0.9954819277  0.9939759036  0.9819277108  0.9879518072  0.4100000000  28.800000000  0.0061248911  0.0604810715  450           0.0289090872 
1.0000000000  0.9761904762  0.9980000000  0.9444444444  0.9548192771  0.9277108434  0.9051204819  0.9216867470  0.3333333333  32.000000000  0.0053979149  0.0604810715  500           0.0292369556 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3870481928  0.3674698795  0.3333333333  0.0000000000  1.1273189783  0.0521492958  0             0.3506913185 
0.8100000000  0.7539682540  0.7700000000  0.7142857143  0.8900602410  0.8855421687  0.9638554217  0.9759036145  0.5933333333  3.2000000000  0.5333699006  0.0585551262  50            0.0277557850 
0.8940000000  0.8095238095  0.8980000000  0.8253968254  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.4766666667  6.4000000000  0.1754185851  0.0585551262  100           0.0285489511 
0.9800000000  0.8968253968  0.9640000000  0.8809523810  0.9397590361  0.9156626506  0.9804216867  0.9698795181  0.5933333333  9.6000000000  0.0649355419  0.0585565567  150           0.0291364956 
0.9920000000  0.8968253968  0.9440000000  0.8571428571  0.9924698795  0.9698795181  0.9984939759  0.9939759036  0.5733333333  12.800000000  0.0431782932  0.0585565567  200           0.0299586821 
0.9900000000  0.9126984127  0.9900000000  0.9206349206  0.9246987952  0.9036144578  0.9849397590  0.9638554217  0.5733333333  16.000000000  0.0292584935  0.0585565567  250           0.0301424074 
1.0000000000  0.9841269841  0.9960000000  0.9047619048  0.9246987952  0.9156626506  0.9668674699  0.9518072289  0.3866666667  19.200000000  0.0179879414  0.0585565567  300           0.0296292067 
1.0000000000  0.9603174603  0.9960000000  0.9603174603  0.9954819277  0.9819277108  0.9984939759  0.9939759036  0.6100000000  22.400000000  0.0104220406  0.0585565567  350           0.0299822998 
1.0000000000  0.9682539683  0.9900000000  0.9126984127  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4733333333  25.600000000  0.0093942945  0.0585565567  400           0.0286866713 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.5700000000  28.800000000  0.0171807452  0.0585565567  450           0.0297278357 
1.0000000000  0.9444444444  0.9980000000  0.9285714286  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5400000000  32.000000000  0.0061185914  0.0585565567  500           0.0288126516 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3870481928  0.3674698795  0.3333333333  0.0000000000  1.1273189783  0.0521492958  0             0.3365650177 
0.8100000000  0.7539682540  0.7700000000  0.7142857143  0.8900602410  0.8855421687  0.9638554217  0.9759036145  0.5933333333  3.2000000000  0.5333699006  0.0584936142  50            0.0284309101 
0.8940000000  0.8095238095  0.8980000000  0.8253968254  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.4766666667  6.4000000000  0.1754185851  0.0584936142  100           0.0292925453 
0.9800000000  0.8968253968  0.9640000000  0.8809523810  0.9397590361  0.9156626506  0.9804216867  0.9698795181  0.5933333333  9.6000000000  0.0649355419  0.0584936142  150           0.0290572977 
0.9920000000  0.8968253968  0.9440000000  0.8571428571  0.9924698795  0.9698795181  0.9984939759  0.9939759036  0.5733333333  12.800000000  0.0431782932  0.0584936142  200           0.0284171915 
0.9900000000  0.9126984127  0.9900000000  0.9206349206  0.9246987952  0.9036144578  0.9849397590  0.9638554217  0.5733333333  16.000000000  0.0292584935  0.0586452484  250           0.0290677452 
1.0000000000  0.9841269841  0.9960000000  0.9047619048  0.9246987952  0.9156626506  0.9668674699  0.9518072289  0.3866666667  19.200000000  0.0179879414  0.0587186813  300           0.0287290001 
1.0000000000  0.9603174603  0.9960000000  0.9603174603  0.9954819277  0.9819277108  0.9984939759  0.9939759036  0.6100000000  22.400000000  0.0104220406  0.0616006851  350           0.0298625803 
1.0000000000  0.9682539683  0.9900000000  0.9126984127  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4733333333  25.600000000  0.0093942945  0.0616006851  400           0.0291873980 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.5700000000  28.800000000  0.0171807452  0.0616006851  450           0.0286228466 
1.0000000000  0.9444444444  0.9980000000  0.9285714286  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5400000000  32.000000000  0.0061185914  0.0616006851  500           0.0288670111 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3343373494  0.3373493976  0.3338368580  0.3313253012  0.3333333333  0.0000000000  1.1133959293  0.0521492958  0             0.3300032616 
0.8500000000  0.8174603175  0.7920000000  0.7380952381  0.7379518072  0.7228915663  0.8851963746  0.8915662651  0.5400000000  3.2000000000  0.6577697027  0.0584797859  50            0.0292159224 
0.9280000000  0.8333333333  0.9300000000  0.8571428571  0.9728915663  0.8795180723  0.9788519637  0.9518072289  0.5633333333  6.4000000000  0.2866404101  0.0585241318  100           0.0275598526 
0.9940000000  0.8968253968  0.9840000000  0.9682539683  0.9834337349  0.8975903614  0.9969788520  0.9638554217  0.5533333333  9.6000000000  0.1295269145  0.0585241318  150           0.0273616886 
1.0000000000  0.9365079365  0.9980000000  0.9206349206  0.9819277108  0.8674698795  0.9954682779  0.9698795181  0.5433333333  12.800000000  0.0742495145  0.0598077774  200           0.0285598135 
0.9980000000  0.9206349206  0.9980000000  0.9444444444  0.9834337349  0.8855421687  0.9984894260  0.9698795181  0.5000000000  16.000000000  0.0547256445  0.0598077774  250           0.0294543982 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.9337349398  0.8072289157  1.0000000000  0.9638554217  0.4800000000  19.200000000  0.0311561545  0.0598077774  300           0.0296297455 
1.0000000000  0.9285714286  1.0000000000  0.9603174603  0.9969879518  0.9156626506  1.0000000000  0.9759036145  0.5033333333  22.400000000  0.0216611409  0.0598077774  350           0.0288789988 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9186746988  0.8072289157  0.9924471299  0.9457831325  0.4400000000  25.600000000  0.0196734920  0.0598077774  400           0.0292852926 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9698795181  0.8795180723  1.0000000000  0.9518072289  0.4666666667  28.800000000  0.0190871946  0.0598077774  450           0.0290635872 
1.0000000000  0.9682539683  1.0000000000  0.9603174603  0.8734939759  0.7831325301  0.9773413897  0.9216867470  0.3700000000  32.000000000  0.0275225473  0.0598077774  500           0.0289896250 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3343373494  0.3373493976  0.3338368580  0.3313253012  0.3333333333  0.0000000000  1.1133959293  0.0521492958  0             0.3286030293 
0.8500000000  0.8174603175  0.7920000000  0.7380952381  0.7379518072  0.7228915663  0.8851963746  0.8915662651  0.5400000000  3.2000000000  0.6577697027  0.0584797859  50            0.0285243225 
0.9280000000  0.8333333333  0.9300000000  0.8571428571  0.9728915663  0.8795180723  0.9788519637  0.9518072289  0.5633333333  6.4000000000  0.2866404101  0.0584797859  100           0.0287571907 
0.9940000000  0.8968253968  0.9840000000  0.9682539683  0.9834337349  0.8975903614  0.9969788520  0.9638554217  0.5533333333  9.6000000000  0.1295269145  0.0584936142  150           0.0291172552 
1.0000000000  0.9365079365  0.9980000000  0.9206349206  0.9819277108  0.8674698795  0.9954682779  0.9698795181  0.5433333333  12.800000000  0.0742495145  0.0584936142  200           0.0288689756 
0.9980000000  0.9206349206  0.9980000000  0.9444444444  0.9834337349  0.8855421687  0.9984894260  0.9698795181  0.5000000000  16.000000000  0.0547256445  0.0584936142  250           0.0284517908 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.9337349398  0.8072289157  1.0000000000  0.9638554217  0.4800000000  19.200000000  0.0311561545  0.0585722923  300           0.0296636963 
1.0000000000  0.9285714286  1.0000000000  0.9603174603  0.9969879518  0.9156626506  1.0000000000  0.9759036145  0.5033333333  22.400000000  0.0216611409  0.0585722923  350           0.0294445992 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9186746988  0.8072289157  0.9924471299  0.9457831325  0.4400000000  25.600000000  0.0196734920  0.0585722923  400           0.0284245253 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9698795181  0.8795180723  1.0000000000  0.9518072289  0.4666666667  28.800000000  0.0190871946  0.0585722923  450           0.0298935986 
1.0000000000  0.9682539683  1.0000000000  0.9603174603  0.8734939759  0.7831325301  0.9773413897  0.9216867470  0.3700000000  32.000000000  0.0275225473  0.0585722923  500           0.0289464140 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3368263473  0.3392857143  0.3338368580  0.3313253012  0.3333333333  0.0000000000  1.1336176395  0.0521492958  0             0.3652391434 
0.8200000000  0.7460317460  0.7640000000  0.7063492063  0.9730538922  0.9523809524  0.9924471299  0.9939759036  0.6000000000  3.2000000000  0.5793799746  0.0585536957  50            0.0321342278 
0.9700000000  0.8888888889  0.9200000000  0.9047619048  0.9416167665  0.9107142857  0.9607250755  0.9518072289  0.5400000000  6.4000000000  0.1760341139  0.0585646629  100           0.0280796099 
0.9980000000  0.9603174603  0.9620000000  0.9047619048  0.9955089820  0.9702380952  0.9984894260  0.9939759036  0.4400000000  9.6000000000  0.0593250633  0.0585646629  150           0.0289692259 
0.9780000000  0.8730158730  0.9780000000  0.8650793651  0.9985029940  0.9940476190  1.0000000000  1.0000000000  0.6633333333  12.800000000  0.0402008394  0.0585646629  200           0.0287970114 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  0.9940119760  0.9880952381  0.9969788520  1.0000000000  0.4933333333  16.000000000  0.0221243087  0.0586261749  250           0.0299663591 
1.0000000000  0.9761904762  0.9880000000  0.9285714286  0.9805389222  0.9464285714  0.9969788520  0.9759036145  0.4100000000  19.200000000  0.0128173724  0.0586676598  300           0.0290688276 
1.0000000000  0.9126984127  0.9960000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6000000000  22.400000000  0.0140059764  0.0586676598  350           0.0292528677 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9880239521  0.9761904762  1.0000000000  1.0000000000  0.4866666667  25.600000000  0.0153758480  0.0586676598  400           0.0286374378 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  0.9955089820  0.9940476190  1.0000000000  1.0000000000  0.4900000000  28.800000000  0.0092189072  0.0586676598  450           0.0292452574 
1.0000000000  0.9761904762  0.9860000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4233333333  32.000000000  0.0052913704  0.0586676598  500           0.0298327971 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3870481928  0.3674698795  0.3333333333  0.0000000000  1.1273189783  0.0521492958  0             0.3227117062 
0.8100000000  0.7539682540  0.7700000000  0.7142857143  0.8900602410  0.8855421687  0.9638554217  0.9759036145  0.5933333333  3.2000000000  0.5333699006  0.0589838028  50            0.0286165667 
0.8940000000  0.8095238095  0.8980000000  0.8253968254  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.4766666667  6.4000000000  0.1754185851  0.0589838028  100           0.0293560696 
0.9800000000  0.8968253968  0.9640000000  0.8809523810  0.9397590361  0.9156626506  0.9804216867  0.9698795181  0.5933333333  9.6000000000  0.0649355419  0.0589838028  150           0.0292766428 
0.9920000000  0.8968253968  0.9440000000  0.8571428571  0.9924698795  0.9698795181  0.9984939759  0.9939759036  0.5733333333  12.800000000  0.0431782932  0.0601644516  200           0.0293902063 
0.9900000000  0.9126984127  0.9900000000  0.9206349206  0.9246987952  0.9036144578  0.9849397590  0.9638554217  0.5733333333  16.000000000  0.0292584935  0.0601644516  250           0.0301055384 
1.0000000000  0.9841269841  0.9960000000  0.9047619048  0.9246987952  0.9156626506  0.9668674699  0.9518072289  0.3866666667  19.200000000  0.0179879414  0.0614929199  300           0.0303925228 
1.0000000000  0.9603174603  0.9960000000  0.9603174603  0.9954819277  0.9819277108  0.9984939759  0.9939759036  0.6100000000  22.400000000  0.0104220406  0.0614929199  350           0.0289626169 
1.0000000000  0.9682539683  0.9900000000  0.9126984127  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4733333333  25.600000000  0.0093942945  0.0614929199  400           0.0293693209 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.5700000000  28.800000000  0.0171807452  0.0614929199  450           0.0286111784 
1.0000000000  0.9444444444  0.9980000000  0.9285714286  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5400000000  32.000000000  0.0061185914  0.0614929199  500           0.0286556149 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 191, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 496, in construct_domain
    Bx,
UnboundLocalError: local variable 'Bx' referenced before assignment
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3870481928  0.3674698795  0.3333333333  0.0000000000  1.1273189783  0.0521492958  0             0.3331484795 
0.8100000000  0.7539682540  0.7700000000  0.7142857143  0.8900602410  0.8855421687  0.9638554217  0.9759036145  0.5933333333  3.2000000000  0.5333699006  0.0585026741  50            0.0291806936 
0.8940000000  0.8095238095  0.8980000000  0.8253968254  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.4766666667  6.4000000000  0.1754185851  0.0585131645  100           0.0284462023 
0.9800000000  0.8968253968  0.9640000000  0.8809523810  0.9397590361  0.9156626506  0.9804216867  0.9698795181  0.5933333333  9.6000000000  0.0649355419  0.0585384369  150           0.0294042301 
0.9920000000  0.8968253968  0.9440000000  0.8571428571  0.9924698795  0.9698795181  0.9984939759  0.9939759036  0.5733333333  12.800000000  0.0431782932  0.0586514473  200           0.0300121021 
0.9900000000  0.9126984127  0.9900000000  0.9206349206  0.9246987952  0.9036144578  0.9849397590  0.9638554217  0.5733333333  16.000000000  0.0292584935  0.0586514473  250           0.0283341312 
1.0000000000  0.9841269841  0.9960000000  0.9047619048  0.9246987952  0.9156626506  0.9668674699  0.9518072289  0.3866666667  19.200000000  0.0179879414  0.0586514473  300           0.0287286758 
1.0000000000  0.9603174603  0.9960000000  0.9603174603  0.9954819277  0.9819277108  0.9984939759  0.9939759036  0.6100000000  22.400000000  0.0104220406  0.0586514473  350           0.0299745035 
1.0000000000  0.9682539683  0.9900000000  0.9126984127  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4733333333  25.600000000  0.0093942945  0.0586514473  400           0.0292062759 
1.0000000000  0.9603174603  1.0000000000  0.9523809524  0.9954819277  0.9819277108  0.9969879518  0.9879518072  0.5700000000  28.800000000  0.0171807452  0.0600667000  450           0.0292570066 
1.0000000000  0.9444444444  0.9980000000  0.9285714286  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5400000000  32.000000000  0.0061185914  0.0600667000  500           0.0291598129 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3420000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3333333333  0.3333333333  0.3333333333  0.0000000000  1.1207072735  0.0521492958  0             0.3217189312 
0.8580000000  0.8253968254  0.8020000000  0.7460317460  0.8629518072  0.8734939759  0.9623015873  0.9603174603  0.2966666667  3.2000000000  0.5392237830  0.0585384369  50            0.0291458273 
0.8880000000  0.8333333333  0.8860000000  0.7777777778  0.8599397590  0.8373493976  0.9980158730  1.0000000000  0.2866666667  6.4000000000  0.1954514623  0.0586142540  100           0.0289522362 
0.9600000000  0.8968253968  0.9720000000  0.8968253968  0.8629518072  0.8614457831  1.0000000000  0.9920634921  0.2633333333  9.6000000000  0.1041608866  0.0604486465  150           0.0279942465 
0.9980000000  0.9682539683  0.9980000000  0.9682539683  0.8253012048  0.8433734940  1.0000000000  1.0000000000  0.1566666667  12.800000000  0.0421949410  0.0604486465  200           0.0287152958 
0.9960000000  0.9603174603  0.9900000000  0.8968253968  0.7981927711  0.8192771084  0.9960317460  0.9761904762  0.2100000000  16.000000000  0.0309889110  0.0604486465  250           0.0295858669 
0.9960000000  0.9126984127  0.9980000000  0.9126984127  0.7846385542  0.7771084337  1.0000000000  1.0000000000  0.2266666667  19.200000000  0.0196007258  0.0604486465  300           0.0295707178 
1.0000000000  0.9603174603  1.0000000000  0.9603174603  0.7951807229  0.7951807229  1.0000000000  0.9920634921  0.2600000000  22.400000000  0.0107916094  0.0604486465  350           0.0287922812 
0.9800000000  0.8968253968  0.9940000000  0.9206349206  0.9578313253  0.9277108434  1.0000000000  0.9920634921  0.1166666667  25.600000000  0.0194777915  0.0604486465  400           0.0291194153 
0.9880000000  0.8888888889  1.0000000000  0.9603174603  0.9216867470  0.9156626506  1.0000000000  0.9920634921  0.2100000000  28.800000000  0.0115290056  0.0604486465  450           0.0292831087 
0.9980000000  0.9365079365  0.9980000000  0.9444444444  0.9066265060  0.8674698795  1.0000000000  1.0000000000  0.1733333333  32.000000000  0.0166741153  0.0604486465  500           0.0289351749 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3680000000  0.3412698413  0.3520000000  0.3333333333  0.5150602410  0.5180722892  0.3333333333  0.0000000000  1.1453719139  0.0402302742  0             0.3160901070 
0.9300000000  0.8809523810  0.8840000000  0.7777777778  0.9698795181  0.9518072289  0.3433333333  3.2000000000  0.4437404297  0.0465607643  50            0.0231460762 
0.9780000000  0.9365079365  0.9800000000  0.9206349206  0.9081325301  0.8614457831  0.3733333333  6.4000000000  0.1129798270  0.0465607643  100           0.0220481253 
0.9880000000  0.9523809524  0.9840000000  0.9285714286  0.9864457831  0.9819277108  0.4466666667  9.6000000000  0.0426609986  0.0465607643  150           0.0229796934 
1.0000000000  0.9761904762  0.9960000000  0.9603174603  0.8388554217  0.8012048193  0.3966666667  12.800000000  0.0284347322  0.0466780663  200           0.0221721315 
0.8240000000  0.7619047619  0.8680000000  0.7380952381  1.0000000000  1.0000000000  0.7033333333  16.000000000  0.0213459757  0.0466780663  250           0.0231794214 
0.9980000000  0.9920634921  1.0000000000  0.9603174603  0.9201807229  0.9216867470  0.3900000000  19.200000000  0.0230135804  0.0466780663  300           0.0232689762 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  0.9518072289  0.9397590361  0.4900000000  22.400000000  0.0102377264  0.0466780663  350           0.0227123213 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  0.9804216867  0.9698795181  0.4733333333  25.600000000  0.0078859125  0.0466780663  400           0.0235218048 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.8463855422  0.8072289157  0.3533333333  28.800000000  0.0140904336  0.0466780663  450           0.0238706303 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  0.8855421687  0.8674698795  0.3766666667  32.000000000  0.0070487410  0.0466780663  500           0.0234996033 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3540000000  0.3412698413  0.3420000000  0.3333333333  0.4879518072  0.4939759036  0.3333333333  0.0000000000  1.1378018856  0.0402302742  0             0.3208143711 
0.9740000000  0.9126984127  0.9340000000  0.8650793651  0.8448795181  0.8373493976  0.6233333333  3.2000000000  0.4690897769  0.0466194153  50            0.0223221588 
0.9900000000  0.9523809524  0.9840000000  0.8968253968  0.7861445783  0.7710843373  0.6166666667  6.4000000000  0.1162017824  0.0467171669  100           0.0220199060 
0.9780000000  0.9126984127  0.9780000000  0.8888888889  0.9969879518  0.9879518072  0.7466666667  9.6000000000  0.0543780499  0.0467171669  150           0.0222777224 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9578313253  0.9397590361  0.7033333333  12.800000000  0.0320437416  0.0467171669  200           0.0233714056 
1.0000000000  0.9603174603  0.9960000000  0.9365079365  0.9984939759  0.9939759036  0.7566666667  16.000000000  0.0132849790  0.0467171669  250           0.0226097727 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.9307228916  0.9277108434  0.7333333333  19.200000000  0.0197228403  0.0467171669  300           0.0235755634 
1.0000000000  0.9920634921  1.0000000000  0.9365079365  0.9939759036  0.9638554217  0.7633333333  22.400000000  0.0103743634  0.0467171669  350           0.0232350683 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.7168674699  0.7349397590  0.6733333333  25.600000000  0.0104701775  0.0467171669  400           0.0222429466 
0.9820000000  0.8968253968  0.9920000000  0.9444444444  0.8102409639  0.7951807229  0.6966666667  28.800000000  0.0319177939  0.0467171669  450           0.0224745321 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.9277108434  0.9036144578  0.5833333333  32.000000000  0.0239576482  0.0467171669  500           0.0227090454 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3257484436 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.5566666667  3.2000000000  0.4268348470  0.0466332436  50            0.0223326921 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.3766666667  6.4000000000  0.1205254655  0.0466332436  100           0.0228158236 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.7733333333  9.6000000000  0.0529191596  0.0467262268  150           0.0220250082 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.5700000000  12.800000000  0.0554661920  0.0468506813  200           0.0227378798 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.7033333333  16.000000000  0.0174377707  0.0468506813  250           0.0229741621 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.6766666667  19.200000000  0.0157823142  0.0468506813  300           0.0220661211 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.7366666667  22.400000000  0.0116568643  0.0468506813  350           0.0225053740 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.7833333333  25.600000000  0.0090472945  0.0468506813  400           0.0233769321 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.3833333333  28.800000000  0.0150124786  0.0468506813  450           0.0220667219 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.7133333333  32.000000000  0.0065325802  0.0468506813  500           0.0224059343 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 39, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Fan End Bearing Fault Data/198.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 45, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Fan End Bearing Fault Data/198.mat'
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.4220000000  0.3650793651  0.4140000000  0.3888888889  0.5647590361  0.5963855422  0.3333333333  0.0000000000  1.0976264477  0.0402302742  0             0.3168110847 
0.9360000000  0.9444444444  0.9600000000  0.9285714286  0.9006024096  0.9156626506  0.4000000000  3.2000000000  0.3815496787  0.0469045639  50            0.0224511051 
0.9900000000  0.9761904762  0.9900000000  0.9761904762  0.9216867470  0.9156626506  0.4766666667  6.4000000000  0.0559008593  0.0469045639  100           0.0224910641 
1.0000000000  0.9761904762  0.9980000000  0.9920634921  0.9728915663  0.9277108434  0.4800000000  9.6000000000  0.0285126631  0.0469045639  150           0.0222125483 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  0.9367469880  0.9036144578  0.5800000000  12.800000000  0.0066388285  0.0469045639  200           0.0226687670 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9849397590  0.9759036145  0.5766666667  16.000000000  0.0037850518  0.0469045639  250           0.0225466394 
0.9960000000  0.9682539683  0.9980000000  0.9761904762  0.9231927711  0.9096385542  0.5100000000  19.200000000  0.0075776070  0.0469045639  300           0.0217289495 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9578313253  0.9277108434  0.6066666667  22.400000000  0.0042073146  0.0469045639  350           0.0229480553 
0.9940000000  0.9603174603  0.9940000000  0.9761904762  1.0000000000  1.0000000000  0.6000000000  25.600000000  0.0048218603  0.0469045639  400           0.0227288055 
0.7160000000  0.7063492063  0.7360000000  0.6904761905  0.9984939759  0.9939759036  0.3333333333  28.800000000  0.0214283109  0.0469045639  450           0.0226281214 
0.9980000000  0.9761904762  0.9940000000  0.9206349206  0.7605421687  0.7530120482  0.6633333333  32.000000000  0.0198818526  0.0469045639  500           0.0222158337 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3880000000  0.3730158730  0.3400000000  0.3333333333  0.5707831325  0.6084337349  0.3333333333  0.0000000000  1.1067858934  0.0402302742  0             0.3280165195 
0.9180000000  0.8253968254  0.7600000000  0.6746031746  0.9352409639  0.9457831325  0.5100000000  3.2000000000  0.4335313842  0.0465607643  50            0.0229855490 
0.9900000000  0.9444444444  0.9700000000  0.8650793651  0.8629518072  0.8493975904  0.5033333333  6.4000000000  0.1445657624  0.0465607643  100           0.0225823593 
0.9960000000  0.9682539683  0.9600000000  0.8015873016  0.9382530120  0.9096385542  0.6833333333  9.6000000000  0.0468140938  0.0465745926  150           0.0219603729 
1.0000000000  0.9841269841  0.9960000000  0.8730158730  0.7259036145  0.7349397590  0.5300000000  12.800000000  0.0398461694  0.0466227531  200           0.0220129013 
1.0000000000  0.9761904762  1.0000000000  0.9206349206  0.7590361446  0.7349397590  0.3733333333  16.000000000  0.0202357373  0.0490617752  250           0.0225326490 
1.0000000000  0.9920634921  0.9880000000  0.8650793651  0.8930722892  0.8975903614  0.6700000000  19.200000000  0.0099256911  0.0490617752  300           0.0218306589 
1.0000000000  0.9761904762  0.9760000000  0.7857142857  0.8795180723  0.8674698795  0.7933333333  22.400000000  0.0093593636  0.0490617752  350           0.0222705460 
1.0000000000  0.9920634921  0.9980000000  0.8571428571  0.8885542169  0.8674698795  0.6133333333  25.600000000  0.0104659404  0.0490617752  400           0.0228312969 
1.0000000000  0.9841269841  1.0000000000  0.9206349206  0.8433734940  0.7951807229  0.5000000000  28.800000000  0.0106920603  0.0490617752  450           0.0222221327 
1.0000000000  0.9920634921  0.9960000000  0.8174603175  0.9653614458  0.9457831325  0.5700000000  32.000000000  0.0054759910  0.0490617752  500           0.0222774410 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3760000000  0.3650793651  0.3400000000  0.3650793651  0.6219879518  0.6084337349  0.3333333333  0.0000000000  1.1241312027  0.0402302742  0             0.3166749477 
0.9060000000  0.9047619048  0.7780000000  0.6746031746  0.9081325301  0.8975903614  0.5600000000  3.2000000000  0.4252661055  0.0465607643  50            0.0232219696 
0.8360000000  0.7936507937  0.7840000000  0.7936507937  0.9939759036  0.9759036145  0.6766666667  6.4000000000  0.1095114724  0.0465607643  100           0.0241213894 
0.9840000000  0.9682539683  0.9740000000  0.9206349206  0.8539156627  0.8373493976  0.6566666667  9.6000000000  0.0485429645  0.0465607643  150           0.0221781063 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  0.7304216867  0.7168674699  0.4866666667  12.800000000  0.0335363828  0.0466012955  200           0.0221945429 
0.9740000000  0.9047619048  0.9820000000  0.8968253968  0.9834337349  0.9819277108  0.8133333333  16.000000000  0.0169560779  0.0466012955  250           0.0220993519 
1.0000000000  0.9841269841  1.0000000000  0.9444444444  0.8689759036  0.8493975904  0.7100000000  19.200000000  0.0098344390  0.0466012955  300           0.0213773918 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.8072289157  0.7831325301  0.5866666667  22.400000000  0.0133857772  0.0466012955  350           0.0218294859 
1.0000000000  0.9682539683  1.0000000000  0.9603174603  0.8734939759  0.8433734940  0.6766666667  25.600000000  0.0112024710  0.0466227531  400           0.0223392868 
1.0000000000  1.0000000000  1.0000000000  0.9841269841  0.8117469880  0.8012048193  0.3900000000  28.800000000  0.0088449518  0.0466227531  450           0.0218423748 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.8268072289  0.7891566265  0.5866666667  32.000000000  0.0171483619  0.0466227531  500           0.0218134165 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3461816311 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.5566666667  3.2000000000  0.4268348470  0.0465607643  50            0.0228717899 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.3766666667  6.4000000000  0.1205254655  0.0465745926  100           0.0222936821 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.7733333333  9.6000000000  0.0529191596  0.0465745926  150           0.0224723434 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.5700000000  12.800000000  0.0554661920  0.0465745926  200           0.0224019194 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.7033333333  16.000000000  0.0174377707  0.0465745926  250           0.0223290586 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.6766666667  19.200000000  0.0157823142  0.0465745926  300           0.0227548647 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.7366666667  22.400000000  0.0116568643  0.0465745926  350           0.0222900295 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.7833333333  25.600000000  0.0090472945  0.0466332436  400           0.0226675558 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.3833333333  28.800000000  0.0150124786  0.0466332436  450           0.0219275570 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.7133333333  32.000000000  0.0065325802  0.0466403961  500           0.0217634249 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3380000000  0.3492063492  0.3620000000  0.3095238095  0.3433734940  0.3373493976  0.7208333333  0.7333333333  0.2968253968  0.0000000000  1.1654744148  0.0521492958  0             0.3402040005 
0.8280000000  0.7460317460  0.7340000000  0.6904761905  0.9081325301  0.9216867470  1.0000000000  0.9833333333  0.4888888889  6.6666666667  0.4400383577  0.0585460663  50            0.0293338585 
0.9700000000  0.8888888889  0.9040000000  0.8492063492  0.9397590361  0.9156626506  0.9416666667  0.9166666667  0.4317460317  13.333333333  0.1357841376  0.0609998703  100           0.0262673426 
0.9120000000  0.8571428571  0.9100000000  0.8253968254  0.9337349398  0.9156626506  0.9875000000  0.9666666667  0.4063492063  20.000000000  0.0597186213  0.0609998703  150           0.0279634047 
0.9960000000  0.9365079365  0.9960000000  0.9206349206  0.8463855422  0.8795180723  0.9250000000  0.8833333333  0.2809523810  26.666666666  0.0285977680  0.0609998703  200           0.0246701336 
0.9680000000  0.9126984127  0.9680000000  0.8968253968  0.9819277108  0.9397590361  0.8583333333  0.8333333333  0.3349206349  33.333333333  0.0314694820  0.0609998703  250           0.0281448984 
0.9980000000  0.9523809524  0.9980000000  0.9365079365  0.8268072289  0.8253012048  0.8458333333  0.7833333333  0.2063492063  40.000000000  0.0166690778  0.0609998703  300           0.0296686411 
0.9820000000  0.9047619048  0.9800000000  0.8888888889  0.9894578313  0.9698795181  0.9916666667  0.9500000000  0.3587301587  46.666666666  0.0123977641  0.0609998703  350           0.0290952110 
0.9920000000  0.9444444444  0.9960000000  0.9047619048  0.9412650602  0.9337349398  0.9250000000  0.8833333333  0.2793650794  53.333333333  0.0084523950  0.0609998703  400           0.0281520557 
0.9820000000  0.8730158730  0.9780000000  0.8650793651  0.9533132530  0.9457831325  0.9833333333  0.9666666667  0.3650793651  60.000000000  0.0146873808  0.0609998703  450           0.0286959124 
1.0000000000  0.9682539683  0.9960000000  0.9126984127  0.9849397590  0.9638554217  0.9625000000  0.9333333333  0.2714285714  66.666666666  0.0102147842  0.0609998703  500           0.0284188890 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3420000000  0.3412698413  0.3620000000  0.3571428571  0.5918674699  0.5602409639  0.3366666667  0.0000000000  0.3443744779  1.1075783968  0.0449552536  0             0.4319341183 
0.5840000000  0.5396825397  0.6260000000  0.6031746032  0.5060240964  0.5060240964  0.7133333333  3.2000000000  0.1500620157  0.9358667517  0.0481333733  50            0.1417661428 
0.6580000000  0.6349206349  0.6980000000  0.7460317460  0.6701807229  0.6807228916  0.4066666667  6.4000000000  0.2614705414  0.7281510282  0.0483193398  100           0.1478662157 
0.7040000000  0.6746031746  0.6840000000  0.6587301587  0.8750000000  0.8734939759  0.4733333333  9.6000000000  0.2245205140  0.5606014323  0.0483193398  150           0.1416728449 
0.7980000000  0.8253968254  0.7440000000  0.7460317460  0.8855421687  0.8674698795  0.3266666667  12.800000000  0.1874714586  0.5076782006  0.0483193398  200           0.1445685482 
0.7920000000  0.7380952381  0.8140000000  0.8015873016  0.9683734940  0.9457831325  0.4533333333  16.000000000  0.2089816785  0.4856705534  0.0483193398  250           0.1450784302 
0.8560000000  0.8571428571  0.7940000000  0.7698412698  0.9623493976  0.9457831325  0.6333333333  19.200000000  0.2321965677  0.4203538251  0.0483193398  300           0.1467840624 
0.9540000000  0.9444444444  0.9260000000  0.8888888889  0.9698795181  0.9638554217  0.6733333333  22.400000000  0.2100189686  0.3372156608  0.0483193398  350           0.1420156145 
0.9380000000  0.9285714286  0.9360000000  0.8730158730  0.9683734940  0.9578313253  0.4400000000  25.600000000  0.2376122090  0.2406063664  0.0510044098  400           0.1459787989 
0.9800000000  0.9841269841  0.9740000000  0.9603174603  0.9698795181  0.9518072289  0.7266666667  28.800000000  0.1938832774  0.1386141676  0.0510044098  450           0.1447710657 
0.9780000000  0.9841269841  0.9880000000  0.9444444444  1.0000000000  1.0000000000  0.6433333333  32.000000000  0.1726432424  0.0996975715  0.0510044098  500           0.1447092772 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3333333333  0.3333333333  0.3333333333  0.0000000000  1.1145968437  0.0521492958  0             0.3180561066 
0.8660000000  0.8492063492  0.7820000000  0.7301587302  0.7545180723  0.7891566265  0.9345238095  0.9126984127  0.2700000000  3.2000000000  0.5245648581  0.0584797859  50            0.0287769699 
0.9360000000  0.9285714286  0.8900000000  0.8095238095  0.6807228916  0.6626506024  0.9880952381  0.9761904762  0.3366666667  6.4000000000  0.1946105603  0.0585384369  100           0.0293404388 
0.9060000000  0.8015873016  0.9720000000  0.8888888889  0.8569277108  0.8373493976  0.9920634921  0.9841269841  0.3800000000  9.6000000000  0.1077553987  0.0586590767  150           0.0284528160 
0.9880000000  0.9365079365  0.9860000000  0.9285714286  0.7680722892  0.7710843373  0.9980158730  0.9920634921  0.1866666667  12.800000000  0.0418856466  0.0586590767  200           0.0285066128 
0.9980000000  0.9682539683  0.9780000000  0.9285714286  0.7168674699  0.7108433735  1.0000000000  0.9523809524  0.2700000000  16.000000000  0.0318348629  0.0597825050  250           0.0288531590 
1.0000000000  0.9682539683  0.9920000000  0.9285714286  0.7274096386  0.7048192771  0.9880952381  0.9206349206  0.3266666667  19.200000000  0.0148989510  0.0597825050  300           0.0289134598 
0.9960000000  0.9285714286  0.9980000000  0.9682539683  0.7108433735  0.7228915663  1.0000000000  0.9761904762  0.2466666667  22.400000000  0.0159126872  0.0597825050  350           0.0289381742 
1.0000000000  0.9603174603  0.9800000000  0.9047619048  0.8795180723  0.8554216867  1.0000000000  0.9523809524  0.3500000000  25.600000000  0.0100007988  0.0615711212  400           0.0296505451 
0.9640000000  0.8571428571  0.9940000000  0.9206349206  0.9111445783  0.9216867470  1.0000000000  1.0000000000  0.3833333333  28.800000000  0.0126088745  0.0615711212  450           0.0288926935 
0.9660000000  0.8888888889  0.9940000000  0.9365079365  0.9081325301  0.9216867470  1.0000000000  1.0000000000  0.3700000000  32.000000000  0.0148411911  0.0615711212  500           0.0287837839 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3644578313  0.3614457831  0.3975903614  0.3734939759  0.3333333333  0.0000000000  1.1128330231  0.0521492958  0             0.3329000473 
0.8080000000  0.7380952381  0.7280000000  0.6746031746  0.9879518072  0.9879518072  0.9909638554  0.9879518072  0.5266666667  3.2000000000  0.5068087900  0.0614867210  50            0.0294975901 
0.9780000000  0.9126984127  0.9480000000  0.8968253968  1.0000000000  1.0000000000  0.9849397590  0.9879518072  0.7266666667  6.4000000000  0.1514504930  0.0614867210  100           0.0290652657 
1.0000000000  0.9603174603  0.9840000000  0.9444444444  0.9984939759  0.9819277108  0.9894578313  0.9698795181  0.6900000000  9.6000000000  0.0455875985  0.0614867210  150           0.0286753416 
0.9980000000  0.9761904762  0.9780000000  0.9047619048  1.0000000000  0.9879518072  0.9984939759  0.9819277108  0.7200000000  12.800000000  0.0315699961  0.0614867210  200           0.0285653305 
0.9940000000  0.9126984127  0.9860000000  0.9285714286  1.0000000000  1.0000000000  0.9969879518  0.9879518072  0.7466666667  16.000000000  0.0258140555  0.0614867210  250           0.0288666248 
1.0000000000  0.9841269841  0.9920000000  0.9285714286  0.9246987952  0.8915662651  0.9216867470  0.8795180723  0.4933333333  19.200000000  0.0092441512  0.0614867210  300           0.0283627939 
1.0000000000  0.9761904762  0.9960000000  0.9285714286  0.9939759036  0.9638554217  0.9939759036  0.9638554217  0.6100000000  22.400000000  0.0101810525  0.0614867210  350           0.0286401844 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.9894578313  0.9457831325  0.9879518072  0.9397590361  0.6366666667  25.600000000  0.0099516341  0.0614867210  400           0.0289720392 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9954819277  0.9698795181  0.9939759036  0.9638554217  0.6200000000  28.800000000  0.0134271735  0.0614867210  450           0.0296329737 
1.0000000000  0.9841269841  0.9980000000  0.9523809524  0.9894578313  0.9457831325  0.9834337349  0.9337349398  0.7166666667  32.000000000  0.0135729245  0.0614867210  500           0.0289408112 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3065400124 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.5566666667  3.2000000000  0.4268348470  0.0465607643  50            0.0220029736 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.3766666667  6.4000000000  0.1205254655  0.0465745926  100           0.0233814240 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.7733333333  9.6000000000  0.0529191596  0.0465745926  150           0.0230075359 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.5700000000  12.800000000  0.0554661920  0.0465745926  200           0.0225815868 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.7033333333  16.000000000  0.0174377707  0.0465745926  250           0.0222157764 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.6766666667  19.200000000  0.0157823142  0.0465745926  300           0.0235459948 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.7366666667  22.400000000  0.0116568643  0.0465745926  350           0.0219038057 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.7833333333  25.600000000  0.0090472945  0.0466194153  400           0.0226084471 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.3833333333  28.800000000  0.0150124786  0.0466194153  450           0.0227416468 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.7133333333  32.000000000  0.0065325802  0.0466194153  500           0.0225462341 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.5375118708  0.0000000000  1.1289460659  0.0402302742  0             0.3088862896 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.4567901235  3.2000000000  0.4268348470  0.0465931892  50            0.0221608543 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.4529914530  6.4000000000  0.1205254655  0.0467090607  100           0.0225212240 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.5327635328  9.6000000000  0.0529191596  0.0467090607  150           0.0225496864 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.4947768281  12.800000000  0.0554661920  0.0467090607  200           0.0219338560 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.5346628680  16.000000000  0.0174377707  0.0467090607  250           0.0217032909 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.5337132004  19.200000000  0.0157823142  0.0467090607  300           0.0221996403 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.5242165242  22.400000000  0.0116568643  0.0467090607  350           0.0223589039 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.5470085470  25.600000000  0.0090472945  0.0467090607  400           0.0225903654 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.4634377968  28.800000000  0.0150124786  0.0467090607  450           0.0224163675 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.5261158594  32.000000000  0.0065325802  0.0486426353  500           0.0229892874 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3440000000  0.3412698413  0.3360000000  0.3333333333  0.4096385542  0.3855421687  0.3467933492  0.3554502370  0.3333333333  0.0000000000  1.1365700960  0.0521492958  0             0.3348536491 
0.8420000000  0.8095238095  0.7180000000  0.6666666667  0.9789156627  0.9759036145  0.9275534442  0.9336492891  0.4933333333  3.2000000000  0.4873389822  0.0585384369  50            0.0297472286 
0.9900000000  0.9603174603  0.9300000000  0.8968253968  0.9894578313  0.9819277108  0.8812351544  0.8767772512  0.3900000000  6.4000000000  0.1134187493  0.0585384369  100           0.0275470734 
0.9900000000  0.9682539683  0.9340000000  0.8492063492  1.0000000000  1.0000000000  0.9572446556  0.9478672986  0.3900000000  9.6000000000  0.0471088276  0.0610446930  150           0.0301976824 
0.9920000000  0.9682539683  0.9900000000  0.9206349206  0.9819277108  0.9277108434  0.9619952494  0.9668246445  0.3533333333  12.800000000  0.0224240090  0.0610446930  200           0.0290151215 
0.9940000000  0.9841269841  0.9420000000  0.8809523810  0.9262048193  0.8855421687  0.9014251781  0.9052132701  0.3333333333  16.000000000  0.0230737408  0.0610446930  250           0.0295434809 
1.0000000000  0.9761904762  0.9980000000  0.9682539683  0.9969879518  1.0000000000  0.9049881235  0.9146919431  0.3866666667  19.200000000  0.0132895607  0.0610446930  300           0.0289574099 
0.9980000000  0.9682539683  0.9800000000  0.8968253968  1.0000000000  1.0000000000  0.9038004751  0.9052132701  0.4200000000  22.400000000  0.0112262690  0.0610446930  350           0.0284300089 
0.9980000000  0.9603174603  0.9940000000  0.9365079365  0.9954819277  0.9939759036  0.9928741093  1.0000000000  0.4000000000  25.600000000  0.0114216428  0.0610446930  400           0.0287100315 
1.0000000000  0.9444444444  0.9940000000  0.9206349206  1.0000000000  1.0000000000  0.9988123515  0.9952606635  0.6200000000  28.800000000  0.0095774474  0.0610446930  450           0.0283179760 
1.0000000000  0.9682539683  0.9960000000  0.9126984127  1.0000000000  0.9879518072  0.9121140143  0.8862559242  0.3533333333  32.000000000  0.0140996143  0.0610446930  500           0.0293235254 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3644578313  0.3614457831  0.3975903614  0.3734939759  0.3722697056  0.0000000000  1.1128330231  0.0521492958  0             0.3207128048 
0.8080000000  0.7380952381  0.7280000000  0.6746031746  0.9879518072  0.9879518072  0.9909638554  0.9879518072  0.5707502374  3.2000000000  0.5068087900  0.0585260391  50            0.0290385628 
0.9780000000  0.9126984127  0.9480000000  0.8968253968  1.0000000000  1.0000000000  0.9849397590  0.9879518072  0.5859449193  6.4000000000  0.1514504930  0.0605273247  100           0.0290082788 
1.0000000000  0.9603174603  0.9840000000  0.9444444444  0.9984939759  0.9819277108  0.9894578313  0.9698795181  0.5565052232  9.6000000000  0.0455875985  0.0605273247  150           0.0289159107 
0.9980000000  0.9761904762  0.9780000000  0.9047619048  1.0000000000  0.9879518072  0.9984939759  0.9819277108  0.6096866097  12.800000000  0.0315699961  0.0605273247  200           0.0285047102 
0.9940000000  0.9126984127  0.9860000000  0.9285714286  1.0000000000  1.0000000000  0.9969879518  0.9879518072  0.6201329535  16.000000000  0.0258140555  0.0605273247  250           0.0290421152 
1.0000000000  0.9841269841  0.9920000000  0.9285714286  0.9246987952  0.8915662651  0.9216867470  0.8795180723  0.6087369421  19.200000000  0.0092441512  0.0605273247  300           0.0291424751 
1.0000000000  0.9761904762  0.9960000000  0.9285714286  0.9939759036  0.9638554217  0.9939759036  0.9638554217  0.6229819563  22.400000000  0.0101810525  0.0605273247  350           0.0284442568 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.9894578313  0.9457831325  0.9879518072  0.9397590361  0.5821462488  25.600000000  0.0099516341  0.0605273247  400           0.0291910982 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9954819277  0.9698795181  0.9939759036  0.9638554217  0.5707502374  28.800000000  0.0134271735  0.0605273247  450           0.0285090876 
1.0000000000  0.9841269841  0.9980000000  0.9523809524  0.9894578313  0.9457831325  0.9834337349  0.9337349398  0.5868945869  32.000000000  0.0135729245  0.0605273247  500           0.0291689920 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 191, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 509, in construct_domain
    Dy,
UnboundLocalError: local variable 'Dy' referenced before assignment
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3418674699  0.3433734940  0.3432539683  0.3412698413  0.3325415677  0.3364928910  0.3333333333  0.0000000000  1.1802811623  0.0521492958  0             0.3289747238 
0.7620000000  0.6269841270  0.9804216867  0.9939759036  0.8789682540  0.8492063492  0.8729216152  0.8767772512  0.6566666667  3.2000000000  0.5562981334  0.0587291718  50            0.0287686825 
0.8880000000  0.8174603175  0.9789156627  0.9638554217  0.9940476190  0.9841269841  0.9073634204  0.8957345972  0.5933333333  6.4000000000  0.1381120137  0.0619587898  100           0.0295817566 
0.8900000000  0.7857142857  1.0000000000  1.0000000000  0.9960317460  0.9761904762  0.9833729216  0.9763033175  0.6266666667  9.6000000000  0.0455096742  0.0619587898  150           0.0288955116 
0.9520000000  0.8888888889  0.9909638554  0.9879518072  0.9960317460  1.0000000000  0.9976247031  0.9905213270  0.6133333333  12.800000000  0.0241495336  0.0619587898  200           0.0288783836 
0.9780000000  0.9126984127  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5933333333  16.000000000  0.0171720727  0.0619587898  250           0.0291135359 
0.9980000000  0.9444444444  0.9909638554  0.9759036145  1.0000000000  1.0000000000  0.9976247031  0.9857819905  0.5800000000  19.200000000  0.0113168790  0.0619587898  300           0.0299327326 
0.9620000000  0.8809523810  1.0000000000  1.0000000000  1.0000000000  0.9920634921  0.9988123515  0.9952606635  0.6500000000  22.400000000  0.0054022711  0.0619587898  350           0.0290532970 
0.9820000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.9988123515  1.0000000000  0.5833333333  25.600000000  0.0043537393  0.0619587898  400           0.0295917940 
0.9660000000  0.8730158730  1.0000000000  1.0000000000  1.0000000000  0.9920634921  1.0000000000  0.9905213270  0.6000000000  28.800000000  0.0078056298  0.0619587898  450           0.0278885984 
0.9760000000  0.8968253968  1.0000000000  1.0000000000  1.0000000000  0.9920634921  0.9774346793  0.9715639810  0.6300000000  32.000000000  0.0029553957  0.0619587898  500           0.0301259613 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3440000000  0.3412698413  0.3360000000  0.3333333333  0.4096385542  0.3855421687  0.3467933492  0.3554502370  0.3333333333  0.0000000000  1.1365700960  0.0521492958  0             0.3305830956 
0.8420000000  0.8095238095  0.7180000000  0.6666666667  0.9789156627  0.9759036145  0.9275534442  0.9336492891  0.4933333333  3.2000000000  0.4873389822  0.0585484505  50            0.0277127266 
0.9900000000  0.9603174603  0.9300000000  0.8968253968  0.9894578313  0.9819277108  0.8812351544  0.8767772512  0.3900000000  6.4000000000  0.1134187493  0.0585484505  100           0.0296960783 
0.9900000000  0.9682539683  0.9340000000  0.8492063492  1.0000000000  1.0000000000  0.9572446556  0.9478672986  0.3900000000  9.6000000000  0.0471088276  0.0585737228  150           0.0291893864 
0.9920000000  0.9682539683  0.9900000000  0.9206349206  0.9819277108  0.9277108434  0.9619952494  0.9668246445  0.3533333333  12.800000000  0.0224240090  0.0585985184  200           0.0290088224 
0.9940000000  0.9841269841  0.9420000000  0.8809523810  0.9262048193  0.8855421687  0.9014251781  0.9052132701  0.3333333333  16.000000000  0.0230737408  0.0610609055  250           0.0283013010 
1.0000000000  0.9761904762  0.9980000000  0.9682539683  0.9969879518  1.0000000000  0.9049881235  0.9146919431  0.3866666667  19.200000000  0.0132895607  0.0610609055  300           0.0294857168 
0.9980000000  0.9682539683  0.9800000000  0.8968253968  1.0000000000  1.0000000000  0.9038004751  0.9052132701  0.4200000000  22.400000000  0.0112262690  0.0610609055  350           0.0287016392 
0.9980000000  0.9603174603  0.9940000000  0.9365079365  0.9954819277  0.9939759036  0.9928741093  1.0000000000  0.4000000000  25.600000000  0.0114216428  0.0610609055  400           0.0288980722 
1.0000000000  0.9444444444  0.9940000000  0.9206349206  1.0000000000  1.0000000000  0.9988123515  0.9952606635  0.6200000000  28.800000000  0.0095774474  0.0615849495  450           0.0290096188 
1.0000000000  0.9682539683  0.9960000000  0.9126984127  1.0000000000  0.9879518072  0.9121140143  0.8862559242  0.3533333333  32.000000000  0.0140996143  0.0615849495  500           0.0282557487 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3689759036  0.3795180723  0.4857482185  0.4786729858  0.3333333333  0.0000000000  1.1252677441  0.0402302742  0             0.3096082211 
0.8720000000  0.7142857143  0.9879518072  0.9759036145  0.9002375297  0.8909952607  0.4500000000  3.2000000000  0.4083672789  0.0465607643  50            0.0227969933 
0.8300000000  0.6746031746  0.9984939759  0.9939759036  0.9904988124  0.9905213270  0.6433333333  6.4000000000  0.1041899847  0.0466184616  100           0.0237873077 
0.9660000000  0.8650793651  1.0000000000  1.0000000000  0.9726840855  0.9763033175  0.4933333333  9.6000000000  0.0398609251  0.0469508171  150           0.0226677370 
0.8560000000  0.7063492063  1.0000000000  1.0000000000  0.9940617577  0.9952606635  0.6466666667  12.800000000  0.0233793729  0.0469508171  200           0.0220405149 
0.8620000000  0.7460317460  1.0000000000  1.0000000000  0.9988123515  1.0000000000  0.6300000000  16.000000000  0.0186580315  0.0469508171  250           0.0222089100 
0.9040000000  0.7539682540  1.0000000000  1.0000000000  1.0000000000  0.9952606635  0.6733333333  19.200000000  0.0061448102  0.0469508171  300           0.0223297787 
0.9180000000  0.8333333333  1.0000000000  1.0000000000  0.9952494062  0.9952606635  0.5933333333  22.400000000  0.0043681145  0.0469508171  350           0.0227049637 
0.9620000000  0.8174603175  1.0000000000  1.0000000000  1.0000000000  0.9952606635  0.5966666667  25.600000000  0.0068330134  0.0469508171  400           0.0221596527 
0.9840000000  0.8492063492  1.0000000000  1.0000000000  0.9964370546  1.0000000000  0.6466666667  28.800000000  0.0058849390  0.0469508171  450           0.0219479704 
0.9480000000  0.8174603175  1.0000000000  1.0000000000  0.9857482185  0.9715639810  0.5633333333  32.000000000  0.0153690854  0.0469508171  500           0.0222035074 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3520000000  0.3412698413  0.3539156627  0.3674698795  0.5166270784  0.5308056872  0.3333333333  0.0000000000  1.1020581722  0.0402302742  0             0.3518369198 
0.9500000000  0.9365079365  0.9698795181  0.9518072289  0.9156769596  0.9052132701  0.3500000000  3.2000000000  0.4336622755  0.0490617752  50            0.0232483530 
0.9660000000  0.8730158730  0.9984939759  0.9939759036  0.9726840855  0.9620853081  0.6200000000  6.4000000000  0.0747681380  0.0490617752  100           0.0231160164 
0.9940000000  0.9761904762  0.9954819277  0.9939759036  0.9631828979  0.9668246445  0.3633333333  9.6000000000  0.0280774337  0.0490617752  150           0.0233622599 
0.9940000000  0.9206349206  1.0000000000  1.0000000000  0.9453681710  0.9383886256  0.5733333333  12.800000000  0.0109627793  0.0490617752  200           0.0214630795 
0.9280000000  0.8492063492  1.0000000000  1.0000000000  0.9881235154  0.9763033175  0.6033333333  16.000000000  0.0278381577  0.0490617752  250           0.0224842882 
0.9820000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  0.9952606635  0.6066666667  19.200000000  0.0060041901  0.0490617752  300           0.0225579786 
0.9940000000  0.9126984127  1.0000000000  1.0000000000  0.9928741093  0.9810426540  0.5833333333  22.400000000  0.0073235730  0.0490617752  350           0.0220196056 
0.8640000000  0.7619047619  1.0000000000  1.0000000000  0.9964370546  0.9810426540  0.4500000000  25.600000000  0.0028565856  0.0490617752  400           0.0236140108 
0.9820000000  0.9206349206  1.0000000000  1.0000000000  0.9952494062  0.9905213270  0.5800000000  28.800000000  0.0059316517  0.0490617752  450           0.0221298122 
0.9280000000  0.8492063492  0.9864457831  0.9457831325  0.9061757720  0.8625592417  0.4900000000  32.000000000  0.0372868732  0.0490617752  500           0.0224583960 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 39, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Drive End Bearing Fault Data/309.mat'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/contextlib.py", line 81, in __enter__
    return next(self.gen)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 17, in _open_file_context
    f, opened = _open_file(file_like, appendmat, mode)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 45, in _open_file
    return open(file_like, mode), True
FileNotFoundError: [Errno 2] No such file or directory: '/home/yfy/Desktop/Dataset/CWRU/12k Drive End Bearing Fault Data/309.mat'
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3460000000  0.3333333333  0.3600000000  0.3730158730  0.3373493976  0.3373493976  0.7000000000  0.7333333333  0.3333333333  0.0000000000  1.1883349419  0.0521492958  0             0.3337478638 
0.8160000000  0.7619047619  0.8560000000  0.8412698413  0.8990963855  0.8975903614  1.0000000000  0.9833333333  0.4064577398  6.6666666667  0.4221501598  0.0585122108  50            0.0296175528 
0.8760000000  0.8492063492  0.9380000000  0.9206349206  0.9759036145  0.9759036145  1.0000000000  0.9666666667  0.4700854701  13.333333333  0.1011742516  0.0600404739  100           0.0284187508 
0.9720000000  0.8730158730  0.9980000000  0.9920634921  0.8810240964  0.8734939759  0.9333333333  0.8833333333  0.4919278253  20.000000000  0.0283979554  0.0600404739  150           0.0276420546 
0.9800000000  0.8571428571  1.0000000000  1.0000000000  0.8734939759  0.8554216867  0.9416666667  0.8666666667  0.5232668566  26.666666666  0.0139625888  0.0600404739  200           0.0288551044 
0.9520000000  0.9047619048  0.9880000000  0.9682539683  0.9789156627  0.9518072289  0.9875000000  0.9666666667  0.5346628680  33.333333333  0.0091669709  0.0600404739  250           0.0300353336 
0.9960000000  0.8809523810  1.0000000000  1.0000000000  0.8192771084  0.8072289157  0.8416666667  0.8000000000  0.5327635328  40.000000000  0.0052156364  0.0606307983  300           0.0283498716 
0.9640000000  0.8730158730  1.0000000000  0.9841269841  0.9277108434  0.9036144578  0.9875000000  0.9666666667  0.5156695157  46.666666666  0.0028419164  0.0606307983  350           0.0284366083 
0.9680000000  0.8888888889  1.0000000000  0.9920634921  0.9397590361  0.9277108434  0.9916666667  0.9500000000  0.4805318139  53.333333333  0.0034585581  0.0606307983  400           0.0293566942 
0.9560000000  0.8888888889  1.0000000000  0.9761904762  0.9698795181  0.9759036145  0.9875000000  0.9333333333  0.4757834758  60.000000000  0.0018942883  0.0606307983  450           0.0294467402 
0.9920000000  0.9523809524  1.0000000000  0.9761904762  0.9894578313  0.9578313253  0.8666666667  0.8333333333  0.5185185185  66.666666666  0.0037683706  0.0606307983  500           0.0285828066 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3440000000  0.3412698413  0.3600000000  0.2857142857  0.3328313253  0.3313253012  0.7208333333  0.7000000000  0.4433734940  0.0000000000  1.1539962292  0.0521492958  0             0.3198022842 
0.8140000000  0.7698412698  0.7940000000  0.6269841270  0.9578313253  0.9036144578  1.0000000000  1.0000000000  0.4024096386  6.6666666667  0.4743618166  0.0585141182  50            0.0293335676 
0.9640000000  0.9206349206  0.9020000000  0.7539682540  0.9653614458  0.9216867470  0.9916666667  0.9666666667  0.3108433735  13.333333333  0.1797151232  0.0585689545  100           0.0287400961 
0.9860000000  0.9444444444  0.9640000000  0.7936507937  0.9337349398  0.8915662651  0.8208333333  0.8000000000  0.3831325301  20.000000000  0.0764739625  0.0586276054  150           0.0292183876 
1.0000000000  0.9761904762  0.9780000000  0.8015873016  0.9457831325  0.9036144578  0.8125000000  0.7500000000  0.2674698795  26.666666666  0.0293338125  0.0586276054  200           0.0294732666 
0.9960000000  0.9444444444  0.9820000000  0.8730158730  0.9819277108  0.9638554217  0.9583333333  0.9166666667  0.3228915663  33.333333333  0.0208634738  0.0586276054  250           0.0297430706 
1.0000000000  0.9920634921  0.9880000000  0.8650793651  0.9668674699  0.9518072289  0.6291666667  0.5833333333  0.3253012048  40.000000000  0.0289603216  0.0586719513  300           0.0300288105 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1171, in _next_data
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1297, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 47, in wait
    if not wait([self.sentinel], timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3406808376 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.4533333333  3.2000000000  0.5294519615  0.0585551262  50            0.0285689211 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.6733333333  6.4000000000  0.2354695666  0.0585551262  100           0.0307922125 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.6466666667  9.6000000000  0.0897018895  0.0597238541  150           0.0298232031 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.5600000000  12.800000000  0.0471370297  0.0597238541  200           0.0293536091 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.6433333333  16.000000000  0.0281241818  0.0600218773  250           0.0292180347 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  0.9246987952  0.8915662651  0.9698795181  0.9638554217  0.4033333333  19.200000000  0.0178615930  0.0600218773  300           0.0296859932 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9789156627  0.9397590361  0.9909638554  0.9879518072  0.6200000000  22.400000000  0.0163820754  0.0600218773  350           0.0295559549 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9698795181  0.9277108434  0.9984939759  0.9939759036  0.5500000000  25.600000000  0.0141548238  0.0600218773  400           0.0281899357 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5566666667  28.800000000  0.0116662318  0.0600218773  450           0.0282102919 
1.0000000000  0.9682539683  0.9960000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5700000000  32.000000000  0.0093445297  0.0600218773  500           0.0285088491 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3340000000  0.3333333333  0.3320000000  0.3412698413  0.3328313253  0.3313253012  0.4442771084  0.4518072289  0.3033333333  0.0000000000  1.1192054749  0.0521492958  0             0.3248226643 
0.5760000000  0.5238095238  0.5860000000  0.5238095238  0.8689759036  0.8012048193  0.8253012048  0.7951807229  0.4100000000  3.2000000000  0.8376883101  0.0584797859  50            0.0295927954 
0.8080000000  0.7063492063  0.7780000000  0.6349206349  0.8825301205  0.8554216867  0.9412650602  0.9457831325  0.8066666667  6.4000000000  0.4585991061  0.0584936142  100           0.0291026592 
0.9260000000  0.8571428571  0.8880000000  0.7222222222  0.8704819277  0.8674698795  0.9246987952  0.9518072289  0.7333333333  9.6000000000  0.3265224487  0.0584936142  150           0.0293459463 
0.9440000000  0.8095238095  0.9460000000  0.8174603175  0.9337349398  0.9156626506  0.9909638554  0.9759036145  0.6900000000  12.800000000  0.2447999230  0.0585131645  200           0.0287953043 
0.9900000000  0.9047619048  0.9580000000  0.8253968254  0.9262048193  0.8855421687  0.9743975904  0.9819277108  0.6166666667  16.000000000  0.1796580122  0.0589790344  250           0.0292869949 
0.9940000000  0.9444444444  0.9820000000  0.8730158730  0.8840361446  0.8614457831  0.9668674699  0.9759036145  0.5900000000  19.200000000  0.1206002803  0.0589852333  300           0.0282361078 
0.9960000000  0.9444444444  0.9920000000  0.8571428571  0.9307228916  0.9036144578  0.9728915663  0.9759036145  0.7000000000  22.400000000  0.0995744677  0.0589852333  350           0.0286976147 
0.9980000000  0.9365079365  0.9980000000  0.9285714286  0.9337349398  0.9036144578  0.9864457831  0.9819277108  0.6500000000  25.600000000  0.0842019942  0.0589852333  400           0.0289457083 
0.9980000000  0.9444444444  0.9960000000  0.9126984127  0.9608433735  0.9397590361  0.9969879518  0.9879518072  0.6266666667  28.800000000  0.0681467099  0.0589852333  450           0.0298580790 
0.9940000000  0.9206349206  0.9920000000  0.9047619048  0.9804216867  0.9578313253  1.0000000000  1.0000000000  0.6400000000  32.000000000  0.0498585002  0.0589852333  500           0.0302820539 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3210904598 
0.4180000000  0.4126984127  0.3700000000  0.3492063492  0.6430722892  0.6204819277  0.6280120482  0.6084337349  0.3333333333  3.2000000000  1.0860051012  0.0585527420  50            0.0297028494 
0.4300000000  0.4365079365  0.4180000000  0.4047619048  0.7228915663  0.6987951807  0.8087349398  0.7771084337  0.3400000000  6.4000000000  1.0142786288  0.0586366653  100           0.0291019392 
0.4860000000  0.4603174603  0.4560000000  0.4444444444  0.7409638554  0.7349397590  0.8509036145  0.8012048193  0.3400000000  9.6000000000  0.9622762585  0.0586366653  150           0.0287118387 
0.5760000000  0.5476190476  0.5600000000  0.5000000000  0.7620481928  0.7349397590  0.8222891566  0.7831325301  0.3600000000  12.800000000  0.9065694642  0.0586533546  200           0.0283452082 
0.6040000000  0.5476190476  0.6040000000  0.5238095238  0.7545180723  0.7409638554  0.8283132530  0.7951807229  0.4033333333  16.000000000  0.8232035172  0.0586533546  250           0.0291669416 
0.6360000000  0.5793650794  0.6360000000  0.5317460317  0.7695783133  0.7530120482  0.8418674699  0.8012048193  0.4566666667  19.200000000  0.7381360531  0.0586533546  300           0.0286763525 
0.6600000000  0.5714285714  0.7160000000  0.5793650794  0.7635542169  0.7289156627  0.8042168675  0.7710843373  0.8066666667  22.400000000  0.6673769927  0.0586533546  350           0.0301124954 
0.6960000000  0.6269841270  0.7120000000  0.5952380952  0.8057228916  0.8012048193  0.8072289157  0.7831325301  0.8700000000  25.600000000  0.6159817457  0.0586533546  400           0.0301544142 
0.7040000000  0.6349206349  0.7340000000  0.5555555556  0.7740963855  0.7469879518  0.8493975904  0.8192771084  0.8666666667  28.800000000  0.5819783127  0.0586533546  450           0.0291397190 
0.7180000000  0.6349206349  0.7320000000  0.5793650794  0.8042168675  0.7951807229  0.8719879518  0.8614457831  0.8433333333  32.000000000  0.5338367498  0.0586771965  500           0.0297935724 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 312, in _exit_function
    for p in active_children():
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 45, in active_children
    _cleanup()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 55, in _cleanup
    if p._popen.poll() is not None:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 35, in poll
    if pid == self.pid:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 259626) is killed by signal: Terminated. 
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1524477005  0.0539798737  0.2110469639  0             0.3283753395 
0.4220000000  0.4126984127  0.3880000000  0.3571428571  0.6611445783  0.6204819277  0.6219879518  0.6204819277  0.3333333333  3.2000000000  1.0876426578  0.0604510307  0.0848252965  50            0.0131973219 
0.4380000000  0.4206349206  0.4120000000  0.3888888889  0.6987951807  0.6506024096  0.8237951807  0.7771084337  0.3366666667  6.4000000000  1.0128150296  0.0604519844  0.0793189414  100           0.0132468843 
0.4560000000  0.4523809524  0.4420000000  0.4206349206  0.7213855422  0.7048192771  0.8734939759  0.8313253012  0.3366666667  9.6000000000  0.9514655769  0.0604519844  0.1197353540  150           0.0136496735 
0.5200000000  0.4682539683  0.5060000000  0.4761904762  0.7560240964  0.7349397590  0.8795180723  0.8554216867  0.3433333333  12.800000000  0.8958815205  0.0605106354  0.1821986547  200           0.0136069822 
0.5620000000  0.5000000000  0.5380000000  0.4761904762  0.7786144578  0.7530120482  0.8840361446  0.8493975904  0.3500000000  16.000000000  0.8218774366  0.0605106354  0.2651867965  250           0.0135127497 
0.5880000000  0.5158730159  0.5760000000  0.5158730159  0.8524096386  0.7590361446  0.8674698795  0.8433734940  0.3566666667  19.200000000  0.7635530806  0.0605502129  0.3599688011  300           0.0134277821 
0.6420000000  0.5396825397  0.6500000000  0.5873015873  0.8524096386  0.7710843373  0.8765060241  0.8433734940  0.4766666667  22.400000000  0.7062480283  0.0605502129  0.4692000014  350           0.0135818481 
0.6700000000  0.6190476190  0.6940000000  0.5793650794  0.8765060241  0.7951807229  0.8825301205  0.8554216867  0.6266666667  25.600000000  0.6624762392  0.0605502129  0.6004446644  400           0.0133896685 
0.6800000000  0.6349206349  0.6940000000  0.5714285714  0.8915662651  0.7951807229  0.8795180723  0.8674698795  0.6833333333  28.800000000  0.6268118942  0.0605502129  0.6926501572  450           0.0131792498 
0.7220000000  0.6507936508  0.7120000000  0.6031746032  0.8795180723  0.7951807229  0.9096385542  0.9036144578  0.7266666667  32.000000000  0.5886018217  0.0605502129  0.8092807388  500           0.0130524635 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 278116) is killed by signal: Terminated. 
Args:
	algorithm: ERM
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1524477005  0.0539774895  0             0.3183116913 
0.4240000000  0.4126984127  0.3860000000  0.3571428571  0.6385542169  0.6024096386  0.6460843373  0.6204819277  0.3333333333  3.2000000000  1.0861609411  0.0604586601  50            0.0134368372 
0.4260000000  0.4126984127  0.4120000000  0.3888888889  0.6957831325  0.6626506024  0.8253012048  0.7831325301  0.3400000000  6.4000000000  1.0077109647  0.0604586601  100           0.0130449677 
0.4500000000  0.4365079365  0.4420000000  0.4285714286  0.7108433735  0.6867469880  0.8765060241  0.8313253012  0.3400000000  9.6000000000  0.9415534747  0.0604586601  150           0.0134236097 
0.5160000000  0.4682539683  0.4940000000  0.4761904762  0.7274096386  0.7289156627  0.8840361446  0.8614457831  0.3433333333  12.800000000  0.8813401151  0.0604586601  200           0.0132228279 
0.5480000000  0.5000000000  0.5420000000  0.4761904762  0.7725903614  0.7650602410  0.8900602410  0.8493975904  0.3500000000  16.000000000  0.8007015646  0.0604586601  250           0.0133157730 
0.5880000000  0.5317460317  0.5720000000  0.5079365079  0.8388554217  0.7530120482  0.8719879518  0.8493975904  0.3700000000  19.200000000  0.7351819706  0.0604586601  300           0.0132016802 
0.6340000000  0.5555555556  0.6460000000  0.5873015873  0.8388554217  0.7650602410  0.8765060241  0.8433734940  0.5100000000  22.400000000  0.6683889937  0.0604586601  350           0.0130187654 
0.6620000000  0.6111111111  0.6900000000  0.5952380952  0.8614457831  0.8072289157  0.8840361446  0.8493975904  0.6966666667  25.600000000  0.6149667943  0.0604586601  400           0.0130791473 
0.6880000000  0.6269841270  0.6920000000  0.5952380952  0.8885542169  0.7951807229  0.8795180723  0.8554216867  0.7800000000  28.800000000  0.5684294683  0.0604586601  450           0.0134863949 
0.7320000000  0.6587301587  0.7040000000  0.6111111111  0.8825301205  0.7951807229  0.8960843373  0.8855421687  0.8033333333  32.000000000  0.5219905645  0.0609083176  500           0.0137218475 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3370244503 
0.4180000000  0.4126984127  0.3700000000  0.3492063492  0.6430722892  0.6204819277  0.6280120482  0.6084337349  0.3333333333  3.2000000000  1.0860051012  0.0584936142  50            0.0288071346 
0.4300000000  0.4365079365  0.4180000000  0.4047619048  0.7228915663  0.6987951807  0.8087349398  0.7771084337  0.3400000000  6.4000000000  1.0142786288  0.0585970879  100           0.0293685484 
0.4860000000  0.4603174603  0.4560000000  0.4444444444  0.7409638554  0.7349397590  0.8509036145  0.8012048193  0.3400000000  9.6000000000  0.9622762585  0.0585970879  150           0.0293034077 
0.5760000000  0.5476190476  0.5600000000  0.5000000000  0.7620481928  0.7349397590  0.8222891566  0.7831325301  0.3600000000  12.800000000  0.9065694642  0.0586390495  200           0.0296076536 
0.6040000000  0.5476190476  0.6040000000  0.5238095238  0.7545180723  0.7409638554  0.8283132530  0.7951807229  0.4033333333  16.000000000  0.8232035172  0.0586390495  250           0.0295121956 
0.6360000000  0.5793650794  0.6360000000  0.5317460317  0.7695783133  0.7530120482  0.8418674699  0.8012048193  0.4566666667  19.200000000  0.7381360531  0.0586390495  300           0.0294915724 
0.6600000000  0.5714285714  0.7160000000  0.5793650794  0.7635542169  0.7289156627  0.8042168675  0.7710843373  0.8066666667  22.400000000  0.6673769927  0.0586390495  350           0.0295341778 
0.6960000000  0.6269841270  0.7120000000  0.5952380952  0.8057228916  0.8012048193  0.8072289157  0.7831325301  0.8700000000  25.600000000  0.6159817457  0.0586390495  400           0.0287791395 
0.7040000000  0.6349206349  0.7340000000  0.5555555556  0.7740963855  0.7469879518  0.8493975904  0.8192771084  0.8666666667  28.800000000  0.5819783127  0.0586390495  450           0.0299108791 
0.7180000000  0.6349206349  0.7320000000  0.5793650794  0.8042168675  0.7951807229  0.8719879518  0.8614457831  0.8433333333  32.000000000  0.5338367498  0.0586390495  500           0.0296387243 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3555984497 
0.3860000000  0.3809523810  0.3540000000  0.3492063492  0.5918674699  0.5602409639  0.5978915663  0.5602409639  0.3333333333  3.2000000000  1.0387667513  0.0311059952  50            0.0565841627 
0.4360000000  0.4285714286  0.4260000000  0.3968253968  0.7063253012  0.6807228916  0.8418674699  0.8012048193  0.3400000000  6.4000000000  0.9455389178  0.0311899185  100           0.0543085957 
0.4620000000  0.4365079365  0.4380000000  0.4285714286  0.7183734940  0.7168674699  0.8765060241  0.8433734940  0.3400000000  9.6000000000  0.8397587419  0.0311899185  150           0.0567059183 
0.5140000000  0.4841269841  0.4920000000  0.4682539683  0.7274096386  0.7168674699  0.8810240964  0.8614457831  0.3433333333  12.800000000  0.7656308603  0.0311899185  200           0.0545920944 
0.5700000000  0.5317460317  0.5700000000  0.4841269841  0.7725903614  0.7771084337  0.8765060241  0.8433734940  0.3733333333  16.000000000  0.6944774032  0.0313081741  250           0.0563682413 
0.5920000000  0.5634920635  0.5960000000  0.5079365079  0.8268072289  0.8132530120  0.8810240964  0.8493975904  0.3833333333  19.200000000  0.6195647585  0.0314059258  300           0.0565820408 
0.6120000000  0.5634920635  0.6300000000  0.5793650794  0.8298192771  0.8132530120  0.8915662651  0.8554216867  0.4166666667  22.400000000  0.5737134933  0.0314059258  350           0.0572875023 
0.6480000000  0.5873015873  0.6660000000  0.5793650794  0.8463855422  0.8313253012  0.8840361446  0.8493975904  0.5200000000  25.600000000  0.5077224684  0.0317358971  400           0.0542445469 
0.6700000000  0.6190476190  0.6720000000  0.5714285714  0.8509036145  0.8373493976  0.8840361446  0.8493975904  0.6166666667  28.800000000  0.4665396005  0.0317358971  450           0.0538144350 
0.6900000000  0.6349206349  0.6840000000  0.5793650794  0.8614457831  0.8674698795  0.8915662651  0.8915662651  0.6433333333  32.000000000  0.4429908621  0.0317358971  500           0.0537657642 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3522765636 
0.3200000000  0.3253968254  0.3220000000  0.3412698413  0.3358433735  0.3313253012  0.4412650602  0.4397590361  0.3300000000  3.2000000000  1.0980598557  0.0311059952  50            0.0542514277 
0.3620000000  0.3888888889  0.3580000000  0.3571428571  0.3584337349  0.3493975904  0.4728915663  0.4457831325  0.2566666667  6.4000000000  1.0771691358  0.0311312675  100           0.0550669718 
0.4060000000  0.3730158730  0.3900000000  0.3650793651  0.4352409639  0.4397590361  0.5000000000  0.4578313253  0.3000000000  9.6000000000  1.0491154623  0.0311312675  150           0.0548860168 
0.4280000000  0.4603174603  0.3980000000  0.3730158730  0.5286144578  0.5000000000  0.5225903614  0.5240963855  0.3033333333  12.800000000  1.0491222596  0.0311312675  200           0.0540749598 
0.4320000000  0.4365079365  0.4040000000  0.3571428571  0.5632530120  0.5301204819  0.5436746988  0.5602409639  0.3100000000  16.000000000  1.0521596360  0.0311312675  250           0.0537550068 
0.4300000000  0.4285714286  0.3820000000  0.3571428571  0.6009036145  0.5602409639  0.5753012048  0.5783132530  0.3300000000  19.200000000  1.0349224019  0.0328330994  300           0.0558350706 
0.4220000000  0.4047619048  0.3720000000  0.3571428571  0.5948795181  0.5722891566  0.5753012048  0.5542168675  0.3333333333  22.400000000  1.0279160500  0.0328330994  350           0.0547497225 
0.4200000000  0.3888888889  0.3660000000  0.3492063492  0.6174698795  0.5903614458  0.6024096386  0.5783132530  0.3333333333  25.600000000  1.0232825530  0.0328330994  400           0.0541375923 
0.4180000000  0.3968253968  0.3740000000  0.3492063492  0.6204819277  0.5903614458  0.6415662651  0.6265060241  0.3333333333  28.800000000  1.0134156048  0.0328330994  450           0.0540258074 
0.4100000000  0.3968253968  0.3740000000  0.3650793651  0.6295180723  0.6024096386  0.6596385542  0.6265060241  0.3333333333  32.000000000  1.0131371045  0.0328330994  500           0.0574172592 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3582057953 
0.3760000000  0.3968253968  0.3620000000  0.3968253968  0.3689759036  0.3554216867  0.4849397590  0.4698795181  0.2566666667  3.2000000000  1.0875370407  0.0311059952  50            0.0538203859 
0.4280000000  0.4603174603  0.4000000000  0.3968253968  0.5256024096  0.4879518072  0.5240963855  0.5301204819  0.3000000000  6.4000000000  1.0623408020  0.0311441422  100           0.0544291878 
0.4280000000  0.4285714286  0.3900000000  0.3571428571  0.6009036145  0.5602409639  0.5813253012  0.6024096386  0.3300000000  9.6000000000  1.0307626891  0.0311441422  150           0.0544523191 
0.4160000000  0.4047619048  0.3720000000  0.3492063492  0.6099397590  0.5843373494  0.6219879518  0.5963855422  0.3333333333  12.800000000  1.0183645844  0.0311441422  200           0.0542242908 
0.4100000000  0.3968253968  0.3740000000  0.3650793651  0.6445783133  0.6024096386  0.6686746988  0.6385542169  0.3333333333  16.000000000  1.0092629218  0.0312066078  250           0.0550129652 
0.4000000000  0.4047619048  0.3780000000  0.3730158730  0.6671686747  0.6325301205  0.7123493976  0.6927710843  0.3333333333  19.200000000  0.9825973701  0.0312066078  300           0.0535767031 
0.4100000000  0.4047619048  0.3780000000  0.3730158730  0.6762048193  0.6445783133  0.7424698795  0.7289156627  0.3333333333  22.400000000  0.9663945007  0.0312066078  350           0.0557177639 
0.4160000000  0.4126984127  0.3880000000  0.3730158730  0.7063253012  0.6686746988  0.7846385542  0.7650602410  0.3333333333  25.600000000  0.9470072377  0.0312066078  400           0.0551299477 
0.4200000000  0.4126984127  0.3960000000  0.3809523810  0.7168674699  0.6987951807  0.8207831325  0.7771084337  0.3333333333  28.800000000  0.9275425720  0.0312066078  450           0.0568433189 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Exception ignored in: <bound method _MultiProcessingDataLoaderIter.__del__ of <torch.utils.data.dataloader._MultiProcessingDataLoaderIter object at 0x7f8e47d5c400>>
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1324, in __del__
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1321, in _shutdown_workers
    w.terminate()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 116, in terminate
    self._popen.terminate()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 56, in terminate
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
RuntimeError: DataLoader worker (pid 342963) is killed by signal: Terminated. 
Exception ignored in: <function WeakValueDictionary.__init__.<locals>.remove at 0x7f8f505e3ae8>
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/weakref.py", line 109, in remove
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 342857) is killed by signal: Terminated. 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 174, in accuracy
    p = network.predict(x)   # ARMpredict
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 193, in predict
    return self.network(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 345, in forward
    return self.net(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 289, in forward
    x = self.layer5(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
    return torch._C._nn.linear(input, weight, bias)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 2173, in <module>
    main()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 2164, in main
    globals = debugger.run(setup['file'], None, None, is_module)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1476, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 174, in accuracy
    p = network.predict(x)   # ARMpredict
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 342666) is killed by signal: Terminated. 
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3632085323 
0.3980000000  0.3968253968  0.3720000000  0.3730158730  0.6897590361  0.6626506024  0.7786144578  0.7289156627  0.3333333333  3.2000000000  0.9879120386  0.0311198235  50            0.0538859320 
0.5440000000  0.5158730159  0.5320000000  0.4761904762  0.7319277108  0.7108433735  0.8674698795  0.8313253012  0.3733333333  6.4000000000  0.8076888835  0.0311198235  100           0.0547909164 
0.5840000000  0.5396825397  0.5860000000  0.4841269841  0.8117469880  0.7771084337  0.8915662651  0.8554216867  0.4000000000  9.6000000000  0.6540856147  0.0311198235  150           0.0547264910 
0.6340000000  0.5793650794  0.6680000000  0.5396825397  0.8222891566  0.7951807229  0.8734939759  0.8433734940  0.6233333333  12.800000000  0.5385701925  0.0311923027  200           0.0545516205 
0.7040000000  0.6428571429  0.7040000000  0.6111111111  0.8734939759  0.8674698795  0.8795180723  0.8795180723  0.7533333333  16.000000000  0.4495093673  0.0311923027  250           0.0535990572 
0.7300000000  0.6428571429  0.6960000000  0.5793650794  0.8719879518  0.8734939759  0.9472891566  0.9578313253  0.7033333333  19.200000000  0.3678458211  0.0311923027  300           0.0537388277 
0.7860000000  0.6587301587  0.7320000000  0.6190476190  0.8795180723  0.8674698795  0.9548192771  0.9638554217  0.7533333333  22.400000000  0.3255561003  0.0311923027  350           0.0542445564 
0.8260000000  0.7301587302  0.7780000000  0.6349206349  0.8750000000  0.8734939759  0.9713855422  0.9819277108  0.8000000000  25.600000000  0.2776627064  0.0311923027  400           0.0541643906 
0.8360000000  0.7142857143  0.7700000000  0.6111111111  0.8990963855  0.8855421687  0.9819277108  0.9879518072  0.7866666667  28.800000000  0.2441197792  0.0311923027  450           0.0544863510 
0.8640000000  0.7619047619  0.8160000000  0.6269841270  0.8870481928  0.8855421687  0.9909638554  0.9879518072  0.7433333333  32.000000000  0.2197541803  0.0312199593  500           0.0538321733 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3556356430 
0.3860000000  0.3809523810  0.3540000000  0.3492063492  0.5918674699  0.5602409639  0.5978915663  0.5602409639  0.3333333333  3.2000000000  1.0387667513  0.0312128067  50            0.0544918346 
0.4360000000  0.4285714286  0.4260000000  0.3968253968  0.7063253012  0.6807228916  0.8418674699  0.8012048193  0.3400000000  6.4000000000  0.9455389178  0.0312128067  100           0.0538570452 
0.4620000000  0.4365079365  0.4380000000  0.4285714286  0.7183734940  0.7168674699  0.8765060241  0.8433734940  0.3400000000  9.6000000000  0.8397587419  0.0312128067  150           0.0544968557 
0.5140000000  0.4841269841  0.4920000000  0.4682539683  0.7274096386  0.7168674699  0.8810240964  0.8614457831  0.3433333333  12.800000000  0.7656308603  0.0312128067  200           0.0541191530 
0.5700000000  0.5317460317  0.5700000000  0.4841269841  0.7725903614  0.7771084337  0.8765060241  0.8433734940  0.3733333333  16.000000000  0.6944774032  0.0312128067  250           0.0618225861 
0.5920000000  0.5634920635  0.5960000000  0.5079365079  0.8268072289  0.8132530120  0.8810240964  0.8493975904  0.3833333333  19.200000000  0.6195647585  0.0312128067  300           0.0546835566 
0.6120000000  0.5634920635  0.6300000000  0.5793650794  0.8298192771  0.8132530120  0.8915662651  0.8554216867  0.4166666667  22.400000000  0.5737134933  0.0312128067  350           0.0540342665 
0.6480000000  0.5873015873  0.6660000000  0.5793650794  0.8463855422  0.8313253012  0.8840361446  0.8493975904  0.5200000000  25.600000000  0.5077224684  0.0312128067  400           0.0562615967 
0.6700000000  0.6190476190  0.6720000000  0.5714285714  0.8509036145  0.8373493976  0.8840361446  0.8493975904  0.6166666667  28.800000000  0.4665396005  0.0312128067  450           0.0585946321 
0.6900000000  0.6349206349  0.6840000000  0.5793650794  0.8614457831  0.8674698795  0.8915662651  0.8915662651  0.6433333333  32.000000000  0.4429908621  0.0312128067  500           0.0580423355 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3260000000  0.3412698413  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3653347492 
0.4340000000  0.4206349206  0.4040000000  0.3968253968  0.7183734940  0.7048192771  0.8644578313  0.8192771084  0.3333333333  3.2000000000  0.9412888443  0.0311059952  50            0.0558456516 
0.6000000000  0.5476190476  0.6320000000  0.5634920635  0.7891566265  0.7951807229  0.8674698795  0.8313253012  0.4700000000  6.4000000000  0.6933934462  0.0341053009  100           0.0553233004 
0.6480000000  0.6190476190  0.6820000000  0.5873015873  0.8780120482  0.8493975904  0.8885542169  0.8674698795  0.6900000000  9.6000000000  0.5154328978  0.0341053009  150           0.0544684505 
0.7280000000  0.6269841270  0.7100000000  0.5476190476  0.8689759036  0.8614457831  0.8990963855  0.8975903614  0.7833333333  12.800000000  0.3918990481  0.0341053009  200           0.0556897879 
0.8180000000  0.7460317460  0.7640000000  0.6111111111  0.8734939759  0.8554216867  0.9231927711  0.9578313253  0.8100000000  16.000000000  0.3153768599  0.0341053009  250           0.0544441938 
0.8200000000  0.7222222222  0.7900000000  0.6269841270  0.8780120482  0.8734939759  0.9879518072  0.9879518072  0.7300000000  19.200000000  0.2469034687  0.0341053009  300           0.0549165201 
0.8560000000  0.7222222222  0.7920000000  0.6349206349  0.9096385542  0.8915662651  0.9954819277  0.9939759036  0.7100000000  22.400000000  0.2179047567  0.0341053009  350           0.0532272768 
0.9040000000  0.8253968254  0.8600000000  0.6666666667  0.8765060241  0.8795180723  0.9864457831  0.9819277108  0.7600000000  25.600000000  0.1829380912  0.0341053009  400           0.0540558338 
0.9000000000  0.7619047619  0.8680000000  0.6666666667  0.9307228916  0.9156626506  1.0000000000  1.0000000000  0.6666666667  28.800000000  0.1558879250  0.0341053009  450           0.0537024832 
0.9360000000  0.8333333333  0.9060000000  0.6904761905  0.8975903614  0.8915662651  0.9894578313  0.9819277108  0.6966666667  32.000000000  0.1348496586  0.0341053009  500           0.0540347147 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3220000000  0.3015873016  0.3200000000  0.3333333333  0.3358433735  0.3313253012  0.4412650602  0.4397590361  0.3366666667  0.0000000000  1.0889298916  0.0247988701  0             0.3518714905 
0.5060000000  0.4523809524  0.4300000000  0.4206349206  0.7349397590  0.7108433735  0.8765060241  0.8433734940  0.3366666667  3.2000000000  0.8997136641  0.0312180519  50            0.0532410049 
0.6440000000  0.5873015873  0.6660000000  0.5873015873  0.8343373494  0.8192771084  0.8765060241  0.8433734940  0.6266666667  6.4000000000  0.6000748408  0.0312318802  100           0.0538554621 
0.7220000000  0.6269841270  0.7260000000  0.5873015873  0.8840361446  0.8855421687  0.9337349398  0.9277108434  0.8166666667  9.6000000000  0.4153340042  0.0312552452  150           0.0536226988 
0.7920000000  0.6825396825  0.7540000000  0.5952380952  0.8825301205  0.8554216867  0.9533132530  0.9819277108  0.7766666667  12.800000000  0.3023686668  0.0312552452  200           0.0534078932 
0.8700000000  0.8253968254  0.8280000000  0.6349206349  0.8584337349  0.8674698795  0.9307228916  0.9277108434  0.8133333333  16.000000000  0.2392738104  0.0312628746  250           0.0535796356 
0.8700000000  0.7460317460  0.8440000000  0.6507936508  0.8960843373  0.8975903614  0.9924698795  0.9939759036  0.6600000000  19.200000000  0.1810431896  0.0312628746  300           0.0539056063 
0.9020000000  0.7539682540  0.8620000000  0.6349206349  0.9472891566  0.9216867470  1.0000000000  1.0000000000  0.6466666667  22.400000000  0.1610187699  0.0312881470  350           0.0542265368 
0.9560000000  0.8809523810  0.9180000000  0.7142857143  0.8810240964  0.8734939759  0.9849397590  0.9879518072  0.6800000000  25.600000000  0.1348389059  0.0312881470  400           0.0529368067 
0.9560000000  0.8015873016  0.9200000000  0.7142857143  0.9472891566  0.9216867470  1.0000000000  1.0000000000  0.6233333333  28.800000000  0.1136557711  0.0314564705  450           0.0543282175 
0.9820000000  0.8809523810  0.9520000000  0.7619047619  0.9186746988  0.8915662651  0.9939759036  0.9879518072  0.6466666667  32.000000000  0.0945481537  0.0314564705  500           0.0533879375 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 1.2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3589692116 
0.4100000000  0.4047619048  0.3780000000  0.3730158730  0.7003012048  0.6686746988  0.8328313253  0.7891566265  0.3333333333  3.2000000000  0.9686521065  0.0314521790  50            0.0540830326 
0.5760000000  0.5238095238  0.5740000000  0.5079365079  0.7590361446  0.7590361446  0.8674698795  0.8313253012  0.3900000000  6.4000000000  0.7589585340  0.0314521790  100           0.0545570183 
0.6140000000  0.5793650794  0.6440000000  0.5476190476  0.8418674699  0.8253012048  0.8885542169  0.8554216867  0.5100000000  9.6000000000  0.5930359089  0.0314521790  150           0.0537841177 
0.6600000000  0.5952380952  0.6880000000  0.5555555556  0.8433734940  0.8313253012  0.8719879518  0.8373493976  0.7266666667  12.800000000  0.4729273784  0.0314521790  200           0.0536059189 
0.7560000000  0.6904761905  0.7320000000  0.6031746032  0.8719879518  0.8614457831  0.9036144578  0.9277108434  0.8066666667  16.000000000  0.3879424602  0.0314521790  250           0.0536022520 
0.7720000000  0.6904761905  0.7400000000  0.6031746032  0.8734939759  0.8795180723  0.9713855422  0.9819277108  0.7133333333  19.200000000  0.3108235750  0.0314521790  300           0.0536577225 
0.8220000000  0.6984126984  0.7560000000  0.6111111111  0.8945783133  0.8795180723  0.9759036145  0.9879518072  0.7600000000  22.400000000  0.2734132442  0.0314521790  350           0.0538585949 
0.8660000000  0.7857142857  0.8300000000  0.6269841270  0.8810240964  0.8855421687  0.9834337349  0.9819277108  0.8000000000  25.600000000  0.2313560793  0.0314521790  400           0.0546439505 
0.8740000000  0.7380952381  0.8060000000  0.6269841270  0.9111445783  0.8975903614  0.9939759036  0.9879518072  0.7100000000  28.800000000  0.2011803958  0.0314521790  450           0.0543686581 
0.9040000000  0.8095238095  0.8640000000  0.6666666667  0.8870481928  0.8855421687  0.9909638554  0.9879518072  0.7133333333  32.000000000  0.1777555995  0.0314521790  500           0.0542046022 
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3260000000  0.3412698413  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.4131238461 
0.4340000000  0.4206349206  0.4040000000  0.3968253968  0.7183734940  0.7048192771  0.8644578313  0.8192771084  0.3333333333  3.2000000000  0.9412888443  0.0311937332  50            0.0578903437 
0.6000000000  0.5476190476  0.6320000000  0.5634920635  0.7891566265  0.7951807229  0.8674698795  0.8313253012  0.4700000000  6.4000000000  0.6933934462  0.0311937332  100           0.0571840048 
0.6480000000  0.6190476190  0.6820000000  0.5873015873  0.8780120482  0.8493975904  0.8885542169  0.8674698795  0.6900000000  9.6000000000  0.5154328978  0.0311937332  150           0.0580926228 
0.7280000000  0.6269841270  0.7100000000  0.5476190476  0.8689759036  0.8614457831  0.8990963855  0.8975903614  0.7833333333  12.800000000  0.3918990481  0.0312881470  200           0.0548033237 
0.8180000000  0.7460317460  0.7640000000  0.6111111111  0.8734939759  0.8554216867  0.9231927711  0.9578313253  0.8100000000  16.000000000  0.3153768599  0.0312881470  250           0.0556898451 
0.8200000000  0.7222222222  0.7900000000  0.6269841270  0.8780120482  0.8734939759  0.9879518072  0.9879518072  0.7300000000  19.200000000  0.2469034687  0.0312881470  300           0.0563806343 
0.8560000000  0.7222222222  0.7920000000  0.6349206349  0.9096385542  0.8915662651  0.9954819277  0.9939759036  0.7100000000  22.400000000  0.2179047567  0.0312881470  350           0.0569217777 
0.9040000000  0.8253968254  0.8600000000  0.6666666667  0.8765060241  0.8795180723  0.9864457831  0.9819277108  0.7600000000  25.600000000  0.1829380912  0.0315146446  400           0.0540155125 
0.9000000000  0.7619047619  0.8680000000  0.6666666667  0.9307228916  0.9156626506  1.0000000000  1.0000000000  0.6666666667  28.800000000  0.1558879250  0.0341372490  450           0.0544299126 
0.9360000000  0.8333333333  0.9060000000  0.6904761905  0.8975903614  0.8915662651  0.9894578313  0.9819277108  0.6966666667  32.000000000  0.1348496586  0.0341372490  500           0.0540575123 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3485584259 
0.3980000000  0.3968253968  0.3720000000  0.3730158730  0.6897590361  0.6626506024  0.7786144578  0.7289156627  0.3333333333  3.2000000000  0.9879120386  0.0324640274  50            0.0537480450 
0.5440000000  0.5158730159  0.5320000000  0.4761904762  0.7319277108  0.7108433735  0.8674698795  0.8313253012  0.3733333333  6.4000000000  0.8076888835  0.0325841904  100           0.0551145220 
0.5840000000  0.5396825397  0.5860000000  0.4841269841  0.8117469880  0.7771084337  0.8915662651  0.8554216867  0.4000000000  9.6000000000  0.6540856147  0.0325841904  150           0.0544209099 
0.6340000000  0.5793650794  0.6680000000  0.5396825397  0.8222891566  0.7951807229  0.8734939759  0.8433734940  0.6233333333  12.800000000  0.5385701925  0.0325841904  200           0.0547894287 
0.7040000000  0.6428571429  0.7040000000  0.6111111111  0.8734939759  0.8674698795  0.8795180723  0.8795180723  0.7533333333  16.000000000  0.4495093673  0.0325841904  250           0.0563910294 
0.7300000000  0.6428571429  0.6960000000  0.5793650794  0.8719879518  0.8734939759  0.9472891566  0.9578313253  0.7033333333  19.200000000  0.3678458211  0.0325841904  300           0.0542067575 
0.7860000000  0.6587301587  0.7320000000  0.6190476190  0.8795180723  0.8674698795  0.9548192771  0.9638554217  0.7533333333  22.400000000  0.3255561003  0.0325841904  350           0.0546982098 
0.8260000000  0.7301587302  0.7780000000  0.6349206349  0.8750000000  0.8734939759  0.9713855422  0.9819277108  0.8000000000  25.600000000  0.2776627064  0.0325841904  400           0.0546207333 
0.8360000000  0.7142857143  0.7700000000  0.6111111111  0.8990963855  0.8855421687  0.9819277108  0.9879518072  0.7866666667  28.800000000  0.2441197792  0.0325841904  450           0.0550606108 
0.8640000000  0.7619047619  0.8160000000  0.6269841270  0.8870481928  0.8855421687  0.9909638554  0.9879518072  0.7433333333  32.000000000  0.2197541803  0.0325841904  500           0.0543549824 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.8
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3719947338 
0.3860000000  0.3968253968  0.3700000000  0.3650793651  0.6686746988  0.6265060241  0.7228915663  0.6626506024  0.3333333333  3.2000000000  1.0077456534  0.0312461853  50            0.0539717150 
0.4980000000  0.4682539683  0.4860000000  0.4523809524  0.7289156627  0.7108433735  0.8569277108  0.8012048193  0.3433333333  6.4000000000  0.8604383194  0.0315284729  100           0.0545371914 
0.5420000000  0.5158730159  0.5260000000  0.4682539683  0.7695783133  0.7530120482  0.8855421687  0.8554216867  0.3600000000  9.6000000000  0.7222600234  0.0315284729  150           0.0568092680 
0.5920000000  0.5476190476  0.6260000000  0.5476190476  0.7921686747  0.7590361446  0.8795180723  0.8433734940  0.4533333333  12.800000000  0.6191172123  0.0315284729  200           0.0545067501 
0.6440000000  0.6031746032  0.6800000000  0.5793650794  0.8554216867  0.8554216867  0.8554216867  0.8313253012  0.6233333333  16.000000000  0.5308721554  0.0315284729  250           0.0540314198 
0.6760000000  0.6349206349  0.6700000000  0.5873015873  0.8704819277  0.8674698795  0.9081325301  0.8975903614  0.6266666667  19.200000000  0.4482620305  0.0315284729  300           0.0537877893 
0.7220000000  0.6111111111  0.6900000000  0.5952380952  0.8644578313  0.8554216867  0.9216867470  0.9156626506  0.7200000000  22.400000000  0.4005281228  0.0315284729  350           0.0529067659 
0.7680000000  0.6825396825  0.7300000000  0.6111111111  0.8719879518  0.8734939759  0.9487951807  0.9638554217  0.7733333333  25.600000000  0.3432038215  0.0315284729  400           0.0533475304 
0.7860000000  0.6825396825  0.7460000000  0.6111111111  0.8810240964  0.8855421687  0.9518072289  0.9638554217  0.7700000000  28.800000000  0.3034789300  0.0315284729  450           0.0538904428 
0.8060000000  0.7142857143  0.7700000000  0.6190476190  0.8795180723  0.8795180723  0.9728915663  0.9879518072  0.7666666667  32.000000000  0.2798197758  0.0315284729  500           0.0538408756 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3519034386 
0.3860000000  0.3809523810  0.3540000000  0.3492063492  0.5918674699  0.5602409639  0.5978915663  0.5602409639  0.3333333333  3.2000000000  1.0387667513  0.0311059952  50            0.0545266151 
0.4360000000  0.4285714286  0.4260000000  0.3968253968  0.7063253012  0.6807228916  0.8418674699  0.8012048193  0.3400000000  6.4000000000  0.9455389178  0.0311312675  100           0.0532965660 
0.4620000000  0.4365079365  0.4380000000  0.4285714286  0.7183734940  0.7168674699  0.8765060241  0.8433734940  0.3400000000  9.6000000000  0.8397587419  0.0311312675  150           0.0546684504 
0.5140000000  0.4841269841  0.4920000000  0.4682539683  0.7274096386  0.7168674699  0.8810240964  0.8614457831  0.3433333333  12.800000000  0.7656308603  0.0311312675  200           0.0555431890 
0.5700000000  0.5317460317  0.5700000000  0.4841269841  0.7725903614  0.7771084337  0.8765060241  0.8433734940  0.3733333333  16.000000000  0.6944774032  0.0331892967  250           0.0562279177 
0.5920000000  0.5634920635  0.5960000000  0.5079365079  0.8268072289  0.8132530120  0.8810240964  0.8493975904  0.3833333333  19.200000000  0.6195647585  0.0331892967  300           0.0552079916 
0.6120000000  0.5634920635  0.6300000000  0.5793650794  0.8298192771  0.8132530120  0.8915662651  0.8554216867  0.4166666667  22.400000000  0.5737134933  0.0331892967  350           0.0561012268 
0.6480000000  0.5873015873  0.6660000000  0.5793650794  0.8463855422  0.8313253012  0.8840361446  0.8493975904  0.5200000000  25.600000000  0.5077224684  0.0331892967  400           0.0557611561 
0.6700000000  0.6190476190  0.6720000000  0.5714285714  0.8509036145  0.8373493976  0.8840361446  0.8493975904  0.6166666667  28.800000000  0.4665396005  0.0331892967  450           0.0542005014 
0.6900000000  0.6349206349  0.6840000000  0.5793650794  0.8614457831  0.8674698795  0.8915662651  0.8915662651  0.6433333333  32.000000000  0.4429908621  0.0336322784  500           0.0547719240 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.7
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3678567410 
0.3880000000  0.3888888889  0.3660000000  0.3650793651  0.6536144578  0.6144578313  0.6777108434  0.6385542169  0.3333333333  3.2000000000  1.0178841960  0.0311059952  50            0.0536538029 
0.4720000000  0.4603174603  0.4720000000  0.4444444444  0.7289156627  0.7108433735  0.8433734940  0.8072289157  0.3433333333  6.4000000000  0.8876957595  0.0312023163  100           0.0544660521 
0.5180000000  0.4841269841  0.4940000000  0.4603174603  0.7590361446  0.7469879518  0.8840361446  0.8493975904  0.3466666667  9.6000000000  0.7593098187  0.0312023163  150           0.0594670296 
0.5780000000  0.5476190476  0.5940000000  0.5000000000  0.7590361446  0.7469879518  0.8840361446  0.8493975904  0.3933333333  12.800000000  0.6653614575  0.0312023163  200           0.0549108362 
0.6140000000  0.5793650794  0.6500000000  0.5952380952  0.8237951807  0.8253012048  0.8644578313  0.8313253012  0.5233333333  16.000000000  0.5812994331  0.0312023163  250           0.0548147249 
0.6520000000  0.6031746032  0.6760000000  0.5793650794  0.8674698795  0.8554216867  0.8750000000  0.8614457831  0.5200000000  19.200000000  0.4990908617  0.0312037468  300           0.0578211212 
0.6740000000  0.5952380952  0.6840000000  0.5634920635  0.8629518072  0.8493975904  0.8870481928  0.8734939759  0.6500000000  22.400000000  0.4506915188  0.0341114998  350           0.0575151110 
0.7260000000  0.6428571429  0.6940000000  0.6031746032  0.8734939759  0.8674698795  0.9141566265  0.9216867470  0.7166666667  25.600000000  0.3890242296  0.0341114998  400           0.0552027988 
0.7500000000  0.6507936508  0.7300000000  0.5952380952  0.8734939759  0.8674698795  0.9262048193  0.9337349398  0.7633333333  28.800000000  0.3487302306  0.0341114998  450           0.0536895037 
0.7740000000  0.6746031746  0.7340000000  0.6111111111  0.8734939759  0.8674698795  0.9503012048  0.9698795181  0.7566666667  32.000000000  0.3243011835  0.0341114998  500           0.0546328831 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.6
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3280000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3745861053 
0.3880000000  0.3888888889  0.3620000000  0.3571428571  0.6189759036  0.5963855422  0.6475903614  0.5903614458  0.3333333333  3.2000000000  1.0283940899  0.0311899185  50            0.0621241426 
0.4580000000  0.4444444444  0.4480000000  0.4285714286  0.7243975904  0.7048192771  0.8403614458  0.8072289157  0.3433333333  6.4000000000  0.9160574377  0.0311899185  100           0.0548986530 
0.4920000000  0.4523809524  0.4540000000  0.4365079365  0.7379518072  0.7228915663  0.8765060241  0.8433734940  0.3400000000  9.6000000000  0.7978237784  0.0312981606  150           0.0568208027 
0.5540000000  0.5317460317  0.5380000000  0.4841269841  0.7500000000  0.7349397590  0.8855421687  0.8554216867  0.3600000000  12.800000000  0.7139423144  0.0312981606  200           0.0568839598 
0.5840000000  0.5555555556  0.6220000000  0.5873015873  0.8042168675  0.7951807229  0.8765060241  0.8433734940  0.4133333333  16.000000000  0.6348621476  0.0312981606  250           0.0586466980 
0.6340000000  0.5793650794  0.6380000000  0.5873015873  0.8493975904  0.8433734940  0.8734939759  0.8433734940  0.4433333333  19.200000000  0.5556805778  0.0312981606  300           0.0559703016 
0.6500000000  0.5793650794  0.6660000000  0.5793650794  0.8539156627  0.8373493976  0.8900602410  0.8614457831  0.5366666667  22.400000000  0.5078654099  0.0312981606  350           0.0576069212 
0.6800000000  0.6269841270  0.6820000000  0.5952380952  0.8644578313  0.8674698795  0.8915662651  0.8915662651  0.6533333333  25.600000000  0.4424678433  0.0312981606  400           0.0564202881 
0.7100000000  0.6269841270  0.6960000000  0.5873015873  0.8689759036  0.8614457831  0.9006024096  0.9036144578  0.7000000000  28.800000000  0.4011284012  0.0312981606  450           0.0645613575 
0.7420000000  0.6428571429  0.7040000000  0.5952380952  0.8734939759  0.8674698795  0.9186746988  0.9277108434  0.7066666667  32.000000000  0.3768348521  0.0312981606  500           0.0543814802 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.9
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3682565689 
0.3920000000  0.3968253968  0.3700000000  0.3730158730  0.6867469880  0.6626506024  0.7530120482  0.7108433735  0.3333333333  3.2000000000  0.9974647999  0.0312027931  50            0.0547337294 
0.5240000000  0.4920634921  0.5080000000  0.4682539683  0.7319277108  0.7108433735  0.8554216867  0.8072289157  0.3600000000  6.4000000000  0.8333924162  0.0312027931  100           0.0542131615 
0.5660000000  0.5238095238  0.5540000000  0.4761904762  0.7876506024  0.7650602410  0.8915662651  0.8554216867  0.3833333333  9.6000000000  0.6871845782  0.0314722061  150           0.0575270653 
0.6060000000  0.5714285714  0.6440000000  0.5555555556  0.8207831325  0.7771084337  0.8780120482  0.8373493976  0.5333333333  12.800000000  0.5767637706  0.0314722061  200           0.0558164454 
0.6640000000  0.6349206349  0.6900000000  0.5952380952  0.8689759036  0.8614457831  0.8659638554  0.8493975904  0.7200000000  16.000000000  0.4871311665  0.0314722061  250           0.0555515814 
0.7080000000  0.6428571429  0.6860000000  0.5873015873  0.8659638554  0.8734939759  0.9246987952  0.9397590361  0.6800000000  19.200000000  0.4044010264  0.0314722061  300           0.0535513258 
0.7600000000  0.6428571429  0.7140000000  0.6190476190  0.8704819277  0.8554216867  0.9382530120  0.9457831325  0.7400000000  22.400000000  0.3592161936  0.0314722061  350           0.0532411289 
0.7920000000  0.7063492063  0.7440000000  0.6349206349  0.8750000000  0.8734939759  0.9638554217  0.9759036145  0.7866666667  25.600000000  0.3069063744  0.0314722061  400           0.0538345098 
0.8040000000  0.6984126984  0.7600000000  0.6190476190  0.8900602410  0.8855421687  0.9759036145  0.9879518072  0.7833333333  28.800000000  0.2704654714  0.0314722061  450           0.0539415884 
0.8380000000  0.7539682540  0.7900000000  0.6269841270  0.8840361446  0.8855421687  0.9849397590  0.9879518072  0.7566666667  32.000000000  0.2462600973  0.0314722061  500           0.0539374828 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.75
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 551982) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 312, in _exit_function
    for p in active_children():
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 45, in active_children
    _cleanup()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 55, in _cleanup
    if p._popen.poll() is not None:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 551723) is killed by signal: Terminated. 
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.75
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3921668530 
0.3900000000  0.3888888889  0.3680000000  0.3650793651  0.6656626506  0.6265060241  0.7153614458  0.6566265060  0.3333333333  3.2000000000  1.0127967453  0.0311450958  50            0.0507424164 
0.4840000000  0.4603174603  0.4740000000  0.4523809524  0.7289156627  0.7108433735  0.8554216867  0.8072289157  0.3433333333  6.4000000000  0.8734732032  0.0311450958  100           0.0535956573 
0.5340000000  0.4841269841  0.5140000000  0.4603174603  0.7620481928  0.7469879518  0.8840361446  0.8493975904  0.3566666667  9.6000000000  0.7404611647  0.0311794281  150           0.0504748535 
0.5820000000  0.5476190476  0.6040000000  0.5317460317  0.7756024096  0.7530120482  0.8810240964  0.8493975904  0.4200000000  12.800000000  0.6412205112  0.0311794281  200           0.0537897158 
0.6280000000  0.5952380952  0.6580000000  0.5873015873  0.8388554217  0.8373493976  0.8644578313  0.8313253012  0.5633333333  16.000000000  0.5546141392  0.0311794281  250           0.0517767191 
0.6640000000  0.6190476190  0.6780000000  0.5873015873  0.8674698795  0.8674698795  0.8855421687  0.8795180723  0.5800000000  19.200000000  0.4726496315  0.0311794281  300           0.0519410992 
0.7000000000  0.6111111111  0.6800000000  0.5634920635  0.8674698795  0.8554216867  0.9096385542  0.9036144578  0.7033333333  22.400000000  0.4246936482  0.0311794281  350           0.0569600248 
0.7500000000  0.6587301587  0.7080000000  0.6031746032  0.8734939759  0.8795180723  0.9307228916  0.9397590361  0.7600000000  25.600000000  0.3652992904  0.0311794281  400           0.0516403389 
0.7680000000  0.6825396825  0.7360000000  0.6190476190  0.8780120482  0.8855421687  0.9397590361  0.9397590361  0.7600000000  28.800000000  0.3246819380  0.0311794281  450           0.0527972746 
0.7940000000  0.6984126984  0.7500000000  0.6190476190  0.8750000000  0.8734939759  0.9653614458  0.9819277108  0.7600000000  32.000000000  0.3005752122  0.0311794281  500           0.0506999588 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.85
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.3578569889 
0.3900000000  0.3968253968  0.3700000000  0.3730158730  0.6716867470  0.6626506024  0.7424698795  0.6927710843  0.3333333333  3.2000000000  1.0023993433  0.0311059952  50            0.0497756910 
0.5120000000  0.4841269841  0.4980000000  0.4682539683  0.7319277108  0.7108433735  0.8539156627  0.8012048193  0.3500000000  6.4000000000  0.8464985371  0.0311532021  100           0.0488972902 
0.5560000000  0.5238095238  0.5400000000  0.4761904762  0.7740963855  0.7590361446  0.8915662651  0.8554216867  0.3700000000  9.6000000000  0.7048341584  0.0311532021  150           0.0552512312 
0.6000000000  0.5555555556  0.6380000000  0.5476190476  0.8117469880  0.7650602410  0.8795180723  0.8433734940  0.4833333333  12.800000000  0.5976597571  0.0311532021  200           0.0580850315 
0.6600000000  0.6190476190  0.6780000000  0.5873015873  0.8584337349  0.8554216867  0.8644578313  0.8313253012  0.6600000000  16.000000000  0.5086021173  0.0311927795  250           0.0513643408 
0.6920000000  0.6349206349  0.6800000000  0.5952380952  0.8734939759  0.8674698795  0.9156626506  0.9277108434  0.6600000000  19.200000000  0.4265171409  0.0312037468  300           0.0488201809 
0.7340000000  0.6428571429  0.7020000000  0.5952380952  0.8704819277  0.8554216867  0.9231927711  0.9337349398  0.7300000000  22.400000000  0.3794812167  0.0312037468  350           0.0497820711 
0.7800000000  0.6825396825  0.7380000000  0.6269841270  0.8719879518  0.8734939759  0.9563253012  0.9698795181  0.7800000000  25.600000000  0.3244336224  0.0312037468  400           0.0496851683 
0.7980000000  0.6904761905  0.7600000000  0.6190476190  0.8870481928  0.8855421687  0.9653614458  0.9819277108  0.7733333333  28.800000000  0.2860995093  0.0312037468  450           0.0491709137 
0.8280000000  0.7380952381  0.7840000000  0.6269841270  0.8795180723  0.8795180723  0.9789156627  0.9879518072  0.7566666667  32.000000000  0.2623257998  0.0328469276  500           0.0493490887 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Fish
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	meta_lr: 0.75
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3260000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.0889298916  0.0247988701  0             0.4240157604 
0.3900000000  0.3888888889  0.3680000000  0.3650793651  0.6656626506  0.6265060241  0.7153614458  0.6566265060  0.3333333333  3.2000000000  1.0127967453  0.0311541557  50            0.0575541687 
0.4840000000  0.4603174603  0.4740000000  0.4523809524  0.7289156627  0.7108433735  0.8554216867  0.8072289157  0.3433333333  6.4000000000  0.8734732032  0.0311899185  100           0.0503728342 
0.5340000000  0.4841269841  0.5140000000  0.4603174603  0.7620481928  0.7469879518  0.8840361446  0.8493975904  0.3566666667  9.6000000000  0.7404611647  0.0311899185  150           0.0514580154 
0.5820000000  0.5476190476  0.6040000000  0.5317460317  0.7756024096  0.7530120482  0.8810240964  0.8493975904  0.4200000000  12.800000000  0.6412205112  0.0311899185  200           0.0509132671 
0.6280000000  0.5952380952  0.6580000000  0.5873015873  0.8388554217  0.8373493976  0.8644578313  0.8313253012  0.5633333333  16.000000000  0.5546141392  0.0312027931  250           0.0520694017 
0.6640000000  0.6190476190  0.6780000000  0.5873015873  0.8674698795  0.8674698795  0.8855421687  0.8795180723  0.5800000000  19.200000000  0.4726496315  0.0312027931  300           0.0493713951 
0.7000000000  0.6111111111  0.6800000000  0.5634920635  0.8674698795  0.8554216867  0.9096385542  0.9036144578  0.7033333333  22.400000000  0.4246936482  0.0312027931  350           0.0563897038 
0.7500000000  0.6587301587  0.7080000000  0.6031746032  0.8734939759  0.8795180723  0.9307228916  0.9397590361  0.7600000000  25.600000000  0.3652992904  0.0312027931  400           0.0550219011 
0.7680000000  0.6825396825  0.7360000000  0.6190476190  0.8780120482  0.8855421687  0.9397590361  0.9397590361  0.7600000000  28.800000000  0.3246819380  0.0312066078  450           0.0549789429 
0.7940000000  0.6984126984  0.7500000000  0.6190476190  0.8750000000  0.8734939759  0.9653614458  0.9819277108  0.7600000000  32.000000000  0.3005752122  0.0312066078  500           0.0503355026 
0.8440000000  0.7380952381  0.7640000000  0.6190476190  0.8795180723  0.8795180723  0.9623493976  0.9819277108  0.8100000000  35.200000000  0.2662243205  0.0312066078  550           0.0513022757 
0.8420000000  0.7222222222  0.7680000000  0.5873015873  0.8990963855  0.8855421687  0.9849397590  0.9879518072  0.7266666667  38.400000000  0.2341880299  0.0312066078  600           0.0583822012 
0.8740000000  0.7698412698  0.8120000000  0.6587301587  0.8870481928  0.8855421687  0.9864457831  0.9819277108  0.7533333333  41.600000000  0.2168547124  0.0312066078  650           0.0529106236 
0.8780000000  0.7777777778  0.8300000000  0.6507936508  0.8960843373  0.8975903614  0.9924698795  0.9939759036  0.7600000000  44.800000000  0.1930818260  0.0312066078  700           0.0518738794 
0.8800000000  0.7619047619  0.8340000000  0.6269841270  0.9021084337  0.8855421687  0.9939759036  0.9879518072  0.7633333333  48.000000000  0.1832959217  0.0312066078  750           0.0534426069 
0.8900000000  0.7936507937  0.8600000000  0.6587301587  0.9021084337  0.8975903614  0.9909638554  0.9879518072  0.7300000000  51.200000000  0.1681824493  0.0312066078  800           0.0508513117 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3280000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3357536793 
0.5060000000  0.5079365079  0.4440000000  0.4047619048  0.7153614458  0.6807228916  0.3266666667  3.2000000000  1.0764351964  0.0465607643  50            0.0227548647 
0.5260000000  0.5158730159  0.4580000000  0.4523809524  0.8433734940  0.8433734940  0.3366666667  6.4000000000  1.0022918439  0.0466403961  100           0.0231109571 
0.6580000000  0.6349206349  0.5940000000  0.6349206349  0.7846385542  0.7891566265  0.3700000000  9.6000000000  0.9195937121  0.0466403961  150           0.0232944727 
0.6620000000  0.6666666667  0.6440000000  0.6428571429  0.7996987952  0.7891566265  0.4366666667  12.800000000  0.8240561581  0.0466403961  200           0.0230416775 
0.6920000000  0.6984126984  0.6800000000  0.6587301587  0.7635542169  0.7650602410  0.5700000000  16.000000000  0.7392039871  0.0466403961  250           0.0225871801 
0.7100000000  0.6825396825  0.6920000000  0.6587301587  0.7033132530  0.7048192771  0.6533333333  19.200000000  0.6527095723  0.0466766357  300           0.0231729937 
0.7560000000  0.7301587302  0.7400000000  0.6825396825  0.7334337349  0.7530120482  0.7666666667  22.400000000  0.5844006705  0.0466766357  350           0.0227242327 
0.7620000000  0.7380952381  0.7320000000  0.7142857143  0.7424698795  0.7650602410  0.7566666667  25.600000000  0.5366876566  0.0467848778  400           0.0226801252 
0.8600000000  0.7698412698  0.8300000000  0.7380952381  0.7605421687  0.7891566265  0.7766666667  28.800000000  0.5132747614  0.0467848778  450           0.0227532005 
0.8560000000  0.7936507937  0.7840000000  0.7301587302  0.7861445783  0.8072289157  0.7733333333  32.000000000  0.4680325198  0.0467848778  500           0.0224444389 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3229498863 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.5566666667  3.2000000000  0.4268348470  0.0465607643  50            0.0221553040 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.3766666667  6.4000000000  0.1205254655  0.0465607643  100           0.0223588705 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.7733333333  9.6000000000  0.0529191596  0.0465607643  150           0.0221966696 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.5700000000  12.800000000  0.0554661920  0.0466628075  200           0.0213017893 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.7033333333  16.000000000  0.0174377707  0.0466628075  250           0.0223521852 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.6766666667  19.200000000  0.0157823142  0.0466675758  300           0.0224238968 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.7366666667  22.400000000  0.0116568643  0.0466675758  350           0.0226882267 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.7833333333  25.600000000  0.0090472945  0.0466675758  400           0.0217908287 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.3833333333  28.800000000  0.0150124786  0.0466675758  450           0.0240142584 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.7133333333  32.000000000  0.0065325802  0.0466675758  500           0.0239929485 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.2920000000  0.3333333333  0.3240000000  0.2698412698  0.3358433735  0.3313253012  0.2833333333  0.3166666667  0.4457831325  0.0000000000  1.1511734724  0.0539798737  0.0958574712  0             0.3699080944 
0.4400000000  0.4444444444  0.4520000000  0.4285714286  0.7093373494  0.6927710843  0.7333333333  0.7166666667  0.3927710843  6.6666666667  1.0992645597  0.0617165565  0.0574089244  50            0.0127173662 
0.4900000000  0.5317460317  0.5300000000  0.4761904762  0.7831325301  0.7469879518  0.9791666667  0.9833333333  0.5301204819  13.333333333  1.0068901026  0.0617165565  0.0679010717  100           0.0128672028 
0.5520000000  0.5476190476  0.5820000000  0.5158730159  0.8253012048  0.7951807229  0.9958333333  1.0000000000  0.5518072289  20.000000000  0.9191579199  0.0617165565  0.1297881106  150           0.0130104017 
0.5640000000  0.5555555556  0.6100000000  0.5476190476  0.8659638554  0.8132530120  1.0000000000  1.0000000000  0.6192771084  26.666666666  0.8230655193  0.0617165565  0.2403660294  200           0.0139414835 
0.5860000000  0.5793650794  0.6620000000  0.5793650794  0.9036144578  0.8915662651  1.0000000000  1.0000000000  0.5903614458  33.333333333  0.7508184850  0.0617165565  0.3603433287  250           0.0131926918 
0.5880000000  0.6111111111  0.6820000000  0.5793650794  0.9171686747  0.8734939759  1.0000000000  1.0000000000  0.5903614458  40.000000000  0.6701029623  0.0617165565  0.5039961642  300           0.0142730761 
0.6180000000  0.6190476190  0.7020000000  0.6031746032  0.9442771084  0.9096385542  1.0000000000  1.0000000000  0.5493975904  46.666666666  0.6137164247  0.0617165565  0.6457297862  350           0.0127335072 
0.6220000000  0.6269841270  0.7140000000  0.5873015873  0.9548192771  0.9036144578  1.0000000000  1.0000000000  0.5566265060  53.333333333  0.5735773182  0.0617165565  0.7766909647  400           0.0132214737 
0.6660000000  0.6428571429  0.7260000000  0.6190476190  0.9638554217  0.9156626506  1.0000000000  1.0000000000  0.5373493976  60.000000000  0.5398295897  0.0617165565  0.8777553320  450           0.0132349491 
0.6820000000  0.6507936508  0.7640000000  0.6507936508  0.9759036145  0.9156626506  1.0000000000  1.0000000000  0.5493975904  66.666666666  0.5221435642  0.0617165565  0.9410163927  500           0.0139347172 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.2940000000  0.3412698413  0.3100000000  0.2619047619  0.3418674699  0.3313253012  0.2583333333  0.2500000000  0.4506024096  0.0000000000  1.1533818245  0.0521540642  0.0033427875  0             0.3571021557 
0.4300000000  0.4285714286  0.4500000000  0.4365079365  0.6927710843  0.7108433735  0.7375000000  0.6833333333  0.3734939759  6.6666666667  1.0973268199  0.0585174561  0.0032259855  50            0.0313751841 
0.4940000000  0.5000000000  0.5180000000  0.4682539683  0.7771084337  0.7108433735  0.9791666667  0.9833333333  0.5397590361  13.333333333  1.0037022972  0.0585722923  0.0034485646  100           0.0312121487 
0.5520000000  0.5476190476  0.5800000000  0.5158730159  0.8222891566  0.7951807229  0.9958333333  1.0000000000  0.5204819277  20.000000000  0.9118041515  0.0586743355  0.0047376899  150           0.0317073822 
0.5560000000  0.5238095238  0.5860000000  0.5317460317  0.8629518072  0.8253012048  1.0000000000  1.0000000000  0.5807228916  26.666666666  0.8140554273  0.0586743355  0.0063499939  200           0.0319185305 
0.5820000000  0.5555555556  0.6460000000  0.5714285714  0.8780120482  0.8493975904  1.0000000000  1.0000000000  0.5734939759  33.333333333  0.7324989223  0.0601005554  0.0078503665  250           0.0311086369 
0.5820000000  0.5714285714  0.6780000000  0.5793650794  0.8885542169  0.8674698795  1.0000000000  1.0000000000  0.5734939759  40.000000000  0.6445523071  0.0601005554  0.0080300942  300           0.0313583231 
0.6000000000  0.5873015873  0.6840000000  0.5952380952  0.8915662651  0.8554216867  1.0000000000  1.0000000000  0.5710843373  46.666666666  0.5713864964  0.0601005554  0.0083733789  350           0.0310284567 
0.5920000000  0.5873015873  0.6900000000  0.5873015873  0.9141566265  0.8614457831  1.0000000000  1.0000000000  0.5831325301  53.333333333  0.5187675250  0.0601005554  0.0088692464  400           0.0311532688 
0.6220000000  0.6269841270  0.6980000000  0.5952380952  0.8930722892  0.8614457831  1.0000000000  1.0000000000  0.5469879518  60.000000000  0.4696370667  0.0601005554  0.0095269264  450           0.0319263077 
0.6280000000  0.6190476190  0.7160000000  0.5952380952  0.9352409639  0.8855421687  1.0000000000  1.0000000000  0.5542168675  66.666666666  0.4487984228  0.0601005554  0.0107109365  500           0.0316232586 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3000000000  0.3492063492  0.3100000000  0.2539682540  0.3358433735  0.3313253012  0.3000000000  0.3000000000  0.4481927711  0.0000000000  1.1533818245  0.0521540642  0.0033427875  0             0.3685193062 
0.5480000000  0.5238095238  0.5660000000  0.5396825397  0.8719879518  0.8373493976  1.0000000000  1.0000000000  0.5734939759  6.6666666667  0.9268748486  0.0584907532  0.0048065527  50            0.0310703564 
0.6220000000  0.6111111111  0.6900000000  0.5873015873  0.9277108434  0.8795180723  1.0000000000  1.0000000000  0.5855421687  13.333333333  0.5618306619  0.0585784912  0.0096389607  100           0.0313805580 
0.6660000000  0.6746031746  0.7560000000  0.6349206349  0.9367469880  0.8915662651  1.0000000000  1.0000000000  0.5373493976  20.000000000  0.3894870532  0.0585784912  0.0127989733  150           0.0313978624 
0.7360000000  0.6984126984  0.8020000000  0.6666666667  0.9563253012  0.9216867470  1.0000000000  1.0000000000  0.5228915663  26.666666666  0.3103116584  0.0589094162  0.0169016505  200           0.0313025284 
0.8380000000  0.7619047619  0.8520000000  0.7222222222  0.9608433735  0.9156626506  1.0000000000  1.0000000000  0.5253012048  33.333333333  0.2728622332  0.0589094162  0.0186702803  250           0.0307669353 
0.8840000000  0.8571428571  0.8660000000  0.7063492063  0.9307228916  0.8915662651  0.9958333333  0.9833333333  0.4554216867  40.000000000  0.2266963384  0.0589094162  0.0179199660  300           0.0311072111 
0.9000000000  0.8650793651  0.8800000000  0.7460317460  0.9653614458  0.9337349398  1.0000000000  0.9833333333  0.5108433735  46.666666666  0.1824819708  0.0589094162  0.0173702733  350           0.0318918657 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 104, in start
    _cleanup()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 55, in _cleanup
    if p._popen.poll() is not None:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
KeyboardInterrupt
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3264935017 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6204819277  0.6024096386  0.6521084337  0.6325301205  0.3333333333  3.2000000000  1.0856223059  0.0585050583  0.0035792492  50            0.0313543177 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.7048192771  0.6867469880  0.8222891566  0.7710843373  0.3400000000  6.4000000000  1.0108268106  0.0585303307  0.0033916643  100           0.0318574142 
0.4680000000  0.4523809524  0.4460000000  0.4444444444  0.7108433735  0.6867469880  0.8689759036  0.8253012048  0.3400000000  9.6000000000  0.9460508597  0.0585303307  0.0038323120  150           0.0313069582 
0.5340000000  0.4841269841  0.5100000000  0.4682539683  0.7424698795  0.7409638554  0.8674698795  0.8313253012  0.3433333333  12.800000000  0.8821938789  0.0585784912  0.0045863282  200           0.0309491110 
0.5520000000  0.5000000000  0.5420000000  0.4841269841  0.7500000000  0.7469879518  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8046232104  0.0585784912  0.0050885933  250           0.0313134909 
0.5720000000  0.5396825397  0.5520000000  0.4920634921  0.8042168675  0.7951807229  0.8855421687  0.8554216867  0.3633333333  19.200000000  0.7314389277  0.0586323738  0.0053692613  300           0.0314322805 
0.6140000000  0.5238095238  0.6260000000  0.5793650794  0.8087349398  0.7650602410  0.8825301205  0.8433734940  0.4566666667  22.400000000  0.6669401252  0.0586323738  0.0057425372  350           0.0314167070 
0.6360000000  0.5873015873  0.6460000000  0.5952380952  0.8448795181  0.8373493976  0.8855421687  0.8433734940  0.5100000000  25.600000000  0.6119089890  0.0586323738  0.0069021878  400           0.0304983854 
0.6500000000  0.5952380952  0.6620000000  0.5793650794  0.8463855422  0.8313253012  0.8870481928  0.8493975904  0.5933333333  28.800000000  0.5671214885  0.0586323738  0.0075832909  450           0.0308783054 
0.6580000000  0.5952380952  0.6680000000  0.5714285714  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.5933333333  32.000000000  0.5203846246  0.0586323738  0.0091574265  500           0.0316992283 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3292777538 
0.5040000000  0.4761904762  0.4640000000  0.4523809524  0.7530120482  0.6626506024  0.8644578313  0.8313253012  0.3400000000  3.2000000000  0.9636924422  0.0584578514  0.0038287096  50            0.0305787754 
0.6380000000  0.5873015873  0.6680000000  0.5634920635  0.8584337349  0.8433734940  0.8930722892  0.8614457831  0.5166666667  6.4000000000  0.6632809925  0.0584959984  0.0062156739  100           0.0312416124 
0.7680000000  0.6666666667  0.7380000000  0.6269841270  0.8870481928  0.8734939759  0.9156626506  0.9156626506  0.7000000000  9.6000000000  0.4752927417  0.0585350990  0.0124006134  150           0.0308161592 
0.7980000000  0.7063492063  0.7760000000  0.6111111111  0.9201807229  0.9216867470  0.9864457831  0.9939759036  0.6533333333  12.800000000  0.3859751266  0.0585350990  0.0177460213  200           0.0313935423 
0.8740000000  0.7380952381  0.8220000000  0.6587301587  0.9051204819  0.8975903614  0.9939759036  0.9879518072  0.7033333333  16.000000000  0.3252533156  0.0585350990  0.0187378781  250           0.0318873167 
0.9140000000  0.8015873016  0.8640000000  0.6825396825  0.8960843373  0.8975903614  0.9954819277  0.9939759036  0.6200000000  19.200000000  0.2710960829  0.0610790253  0.0199365449  300           0.0316535759 
0.9420000000  0.8492063492  0.9120000000  0.7142857143  0.9262048193  0.9096385542  0.9939759036  0.9879518072  0.6533333333  22.400000000  0.2413911256  0.0610790253  0.0194536215  350           0.0313791084 
0.9660000000  0.8492063492  0.9420000000  0.7460317460  0.9262048193  0.9096385542  1.0000000000  1.0000000000  0.6733333333  25.600000000  0.2126762131  0.0610790253  0.0208320414  400           0.0321626949 
0.9700000000  0.8492063492  0.9360000000  0.7777777778  0.9864457831  0.9698795181  1.0000000000  1.0000000000  0.5966666667  28.800000000  0.1894681960  0.0610790253  0.0197266886  450           0.0313090706 
0.9780000000  0.8571428571  0.9540000000  0.8174603175  0.9804216867  0.9578313253  1.0000000000  1.0000000000  0.6000000000  32.000000000  0.1543866584  0.0610790253  0.0208979231  500           0.0313047504 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0005
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3298192771  0.3313253012  0.3493975904  0.3493975904  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3522405624 
0.6880000000  0.6031746032  0.7540000000  0.6349206349  0.9156626506  0.9036144578  0.9939759036  1.0000000000  0.4700000000  3.2000000000  0.5281723857  0.0584578514  0.0210814777  50            0.0311330652 
0.9520000000  0.8571428571  0.9320000000  0.8412698413  0.9864457831  0.9578313253  0.9984939759  0.9939759036  0.4966666667  6.4000000000  0.2237992522  0.0586004257  0.0216306069  100           0.0314114094 
1.0000000000  0.9761904762  0.9920000000  0.9285714286  0.9668674699  0.9277108434  0.9819277108  0.9759036145  0.5633333333  9.6000000000  0.1041669083  0.0586004257  0.0232865978  150           0.0319983339 
0.9820000000  0.8968253968  0.9700000000  0.8968253968  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.5566666667  12.800000000  0.0555860326  0.0586004257  0.0194537863  200           0.0325048208 
0.9980000000  0.9761904762  0.9960000000  0.9365079365  0.9819277108  0.9397590361  0.9984939759  0.9939759036  0.5500000000  16.000000000  0.0394774039  0.0586004257  0.0187209436  250           0.0322713947 
1.0000000000  0.9841269841  0.9980000000  0.9603174603  0.9819277108  0.9518072289  1.0000000000  1.0000000000  0.5100000000  19.200000000  0.0260201967  0.0586004257  0.0166629721  300           0.0326286936 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.5200000000  22.400000000  0.0220283682  0.0586485863  0.0157360578  350           0.0319509315 
1.0000000000  0.9841269841  0.9980000000  0.9444444444  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.5433333333  25.600000000  0.0186206030  0.0586485863  0.0147736225  400           0.0309426165 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9924698795  0.9457831325  1.0000000000  1.0000000000  0.4900000000  28.800000000  0.0180617549  0.0586485863  0.0127194764  450           0.0318925476 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.4900000000  32.000000000  0.0147328085  0.0586485863  0.0135021085  500           0.0302753210 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3470790386 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6084337349  0.5783132530  0.6430722892  0.6084337349  0.3333333333  3.2000000000  1.0857828617  0.0584578514  0.0034697066  50            0.0323670244 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.6987951807  0.6867469880  0.8237951807  0.7650602410  0.3400000000  6.4000000000  1.0114042175  0.0584821701  0.0031380788  100           0.0311996698 
0.4720000000  0.4523809524  0.4480000000  0.4444444444  0.7183734940  0.6927710843  0.8704819277  0.8313253012  0.3400000000  9.6000000000  0.9470374501  0.0584831238  0.0035039815  150           0.0314453220 
0.5360000000  0.4841269841  0.5180000000  0.4682539683  0.7349397590  0.7349397590  0.8719879518  0.8373493976  0.3433333333  12.800000000  0.8834300959  0.0584969521  0.0041725024  200           0.0318700886 
0.5540000000  0.5079365079  0.5420000000  0.4920634921  0.7469879518  0.7349397590  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8060756481  0.0585556030  0.0046456553  250           0.0323104191 
0.5700000000  0.5317460317  0.5460000000  0.4920634921  0.8057228916  0.7891566265  0.8840361446  0.8493975904  0.3633333333  19.200000000  0.7330884290  0.0585684776  0.0049227380  300           0.0318740177 
0.6120000000  0.5396825397  0.6240000000  0.5793650794  0.8057228916  0.7650602410  0.8825301205  0.8433734940  0.4600000000  22.400000000  0.6686418211  0.0586438179  0.0053092605  350           0.0304784489 
0.6360000000  0.5873015873  0.6480000000  0.5952380952  0.8418674699  0.8373493976  0.8855421687  0.8433734940  0.5200000000  25.600000000  0.6139377260  0.0586438179  0.0064325251  400           0.0317153263 
0.6440000000  0.5952380952  0.6540000000  0.5714285714  0.8418674699  0.8253012048  0.8855421687  0.8433734940  0.5933333333  28.800000000  0.5693841231  0.0588955879  0.0070879093  450           0.0310607195 
0.6540000000  0.5952380952  0.6700000000  0.5634920635  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.6000000000  32.000000000  0.5231861430  0.0588955879  0.0085389771  500           0.0314057779 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3369214535 
0.4260000000  0.4047619048  0.3800000000  0.3650793651  0.5948795181  0.5843373494  0.6385542169  0.5903614458  0.3333333333  3.2000000000  1.0867535472  0.0584969521  0.0029883892  50            0.0312198925 
0.4380000000  0.4444444444  0.4240000000  0.4047619048  0.6852409639  0.6325301205  0.8192771084  0.7831325301  0.3400000000  6.4000000000  1.0152439141  0.0584969521  0.0022882414  100           0.0311359930 
0.4760000000  0.4682539683  0.4580000000  0.4444444444  0.7259036145  0.6626506024  0.8629518072  0.8373493976  0.3400000000  9.6000000000  0.9536487687  0.0585851669  0.0025296386  150           0.0315570307 
0.5380000000  0.4920634921  0.5340000000  0.4682539683  0.7243975904  0.6927710843  0.8795180723  0.8554216867  0.3500000000  12.800000000  0.8919891679  0.0585851669  0.0030097071  200           0.0308209181 
0.5600000000  0.4920634921  0.5520000000  0.4841269841  0.7484939759  0.7168674699  0.8885542169  0.8554216867  0.3666666667  16.000000000  0.8159812915  0.0585851669  0.0034216358  250           0.0316238546 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 63, in handler
    def handler(signum, frame):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 755248) is killed by signal: Terminated. 
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 3
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3327739239 
0.4200000000  0.4047619048  0.3740000000  0.3571428571  0.6069277108  0.5843373494  0.6400602410  0.6084337349  0.3333333333  3.2000000000  1.0860923696  0.0584831238  0.0032771319  50            0.0309609270 
0.4360000000  0.4365079365  0.4180000000  0.4047619048  0.6867469880  0.6506024096  0.8298192771  0.7891566265  0.3400000000  6.4000000000  1.0126932800  0.0584831238  0.0027545212  100           0.0308644199 
0.4740000000  0.4603174603  0.4540000000  0.4444444444  0.7138554217  0.6867469880  0.8719879518  0.8373493976  0.3400000000  9.6000000000  0.9492137706  0.0584969521  0.0030473871  150           0.0314782572 
0.5400000000  0.4920634921  0.5320000000  0.4682539683  0.7289156627  0.7228915663  0.8795180723  0.8554216867  0.3433333333  12.800000000  0.8862403560  0.0584969521  0.0036185456  200           0.0322819185 
0.5620000000  0.5079365079  0.5480000000  0.4841269841  0.7515060241  0.7289156627  0.8870481928  0.8614457831  0.3666666667  16.000000000  0.8093729818  0.0584969521  0.0040519406  250           0.0314770079 
0.5700000000  0.5238095238  0.5480000000  0.4841269841  0.7981927711  0.7710843373  0.8840361446  0.8493975904  0.3633333333  19.200000000  0.7367748344  0.0597662926  0.0043478510  300           0.0323032665 
0.6140000000  0.5317460317  0.6280000000  0.5793650794  0.7996987952  0.7650602410  0.8825301205  0.8433734940  0.4633333333  22.400000000  0.6723632276  0.0597662926  0.0047656300  350           0.0309426212 
0.6380000000  0.5873015873  0.6500000000  0.5952380952  0.8418674699  0.8373493976  0.8855421687  0.8433734940  0.5133333333  25.600000000  0.6181153941  0.0597662926  0.0058153514  400           0.0317767906 
0.6460000000  0.5793650794  0.6480000000  0.5634920635  0.8418674699  0.8253012048  0.8870481928  0.8493975904  0.5800000000  28.800000000  0.5736967582  0.0597662926  0.0064293472  450           0.0310993767 
0.6520000000  0.5952380952  0.6680000000  0.5634920635  0.8614457831  0.8554216867  0.8975903614  0.8795180723  0.5933333333  32.000000000  0.5282968330  0.0597662926  0.0076828666  500           0.0320032263 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3240000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3410298824 
0.5000000000  0.4682539683  0.4640000000  0.4523809524  0.7545180723  0.6686746988  0.8659638554  0.8373493976  0.3400000000  3.2000000000  0.9644521010  0.0585594177  0.0035032331  50            0.0315865660 
0.6380000000  0.5873015873  0.6680000000  0.5714285714  0.8569277108  0.8373493976  0.8930722892  0.8734939759  0.5133333333  6.4000000000  0.6660808039  0.0586471558  0.0057148972  100           0.0316642809 
0.7580000000  0.6746031746  0.7380000000  0.6111111111  0.8870481928  0.8734939759  0.9186746988  0.9156626506  0.6966666667  9.6000000000  0.4792887110  0.0586471558  0.0113939493  150           0.0314468241 
0.7980000000  0.6984126984  0.7760000000  0.6031746032  0.9201807229  0.9216867470  0.9864457831  0.9939759036  0.6500000000  12.800000000  0.3913491207  0.0586471558  0.0155744624  200           0.0316909361 
0.8720000000  0.7380952381  0.8200000000  0.6666666667  0.9141566265  0.8975903614  0.9939759036  0.9879518072  0.7133333333  16.000000000  0.3302740365  0.0586471558  0.0161772561  250           0.0310216522 
0.9160000000  0.8015873016  0.8620000000  0.6825396825  0.8960843373  0.8975903614  0.9954819277  0.9939759036  0.6133333333  19.200000000  0.2765009984  0.0586471558  0.0171529544  300           0.0309057999 
0.9380000000  0.8412698413  0.9120000000  0.7222222222  0.9262048193  0.9096385542  0.9939759036  0.9879518072  0.6466666667  22.400000000  0.2460336167  0.0586471558  0.0168391685  350           0.0315614128 
0.9660000000  0.8571428571  0.9400000000  0.7460317460  0.9231927711  0.9096385542  1.0000000000  1.0000000000  0.6900000000  25.600000000  0.2176436859  0.0586471558  0.0180203335  400           0.0319053650 
0.9680000000  0.8412698413  0.9340000000  0.7698412698  0.9864457831  0.9698795181  1.0000000000  1.0000000000  0.6033333333  28.800000000  0.1936759517  0.0587162971  0.0170123107  450           0.0319126415 
0.9800000000  0.8650793651  0.9520000000  0.8095238095  0.9774096386  0.9578313253  1.0000000000  1.0000000000  0.6033333333  32.000000000  0.1591245453  0.0587353706  0.0179275063  500           0.0319920111 
0.9880000000  0.9126984127  0.9720000000  0.8174603175  0.9713855422  0.9457831325  0.9984939759  0.9939759036  0.6300000000  35.200000000  0.1428445336  0.0587353706  0.0184144762  550           0.0306009293 
0.9940000000  0.9206349206  0.9880000000  0.8492063492  0.9819277108  0.9518072289  0.9984939759  0.9939759036  0.6400000000  38.400000000  0.1242552450  0.0587801933  0.0176388376  600           0.0315168667 
0.9960000000  0.9206349206  0.9860000000  0.8650793651  0.9533132530  0.9216867470  0.9969879518  0.9879518072  0.6066666667  41.600000000  0.1216490522  0.0587801933  0.0169637119  650           0.0340644217 
0.9980000000  0.9365079365  0.9900000000  0.8571428571  0.9834337349  0.9457831325  0.9984939759  0.9939759036  0.5966666667  44.800000000  0.1038216884  0.0587801933  0.0179922277  700           0.0309740448 
0.9980000000  0.9365079365  0.9880000000  0.8650793651  0.9578313253  0.9277108434  0.9939759036  0.9879518072  0.6000000000  48.000000000  0.0934022396  0.0587801933  0.0175197382  750           0.0324162054 
0.9980000000  0.9523809524  0.9880000000  0.8730158730  0.9743975904  0.9578313253  0.9984939759  0.9939759036  0.5833333333  51.200000000  0.0815380128  0.0587801933  0.0158046138  800           0.0319053984 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3451581001 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6084337349  0.5783132530  0.6430722892  0.6084337349  0.3333333333  3.2000000000  1.0857828617  0.0584578514  0.0034697066  50            0.0309518719 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.6987951807  0.6867469880  0.8237951807  0.7650602410  0.3400000000  6.4000000000  1.0114042175  0.0584959984  0.0031380788  100           0.0310989189 
0.4720000000  0.4523809524  0.4480000000  0.4444444444  0.7183734940  0.6927710843  0.8704819277  0.8313253012  0.3400000000  9.6000000000  0.9470374501  0.0585107803  0.0035039815  150           0.0333609390 
0.5360000000  0.4841269841  0.5180000000  0.4682539683  0.7349397590  0.7349397590  0.8719879518  0.8373493976  0.3433333333  12.800000000  0.8834300959  0.0585107803  0.0041725024  200           0.0306675196 
0.5540000000  0.5079365079  0.5420000000  0.4920634921  0.7469879518  0.7349397590  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8060756481  0.0585107803  0.0046456553  250           0.0315464258 
0.5700000000  0.5317460317  0.5460000000  0.4920634921  0.8057228916  0.7891566265  0.8840361446  0.8493975904  0.3633333333  19.200000000  0.7330884290  0.0585837364  0.0049227380  300           0.0314137459 
0.6120000000  0.5396825397  0.6240000000  0.5793650794  0.8057228916  0.7650602410  0.8825301205  0.8433734940  0.4600000000  22.400000000  0.6686418211  0.0586199760  0.0053092605  350           0.0315745211 
0.6360000000  0.5873015873  0.6480000000  0.5952380952  0.8418674699  0.8373493976  0.8855421687  0.8433734940  0.5200000000  25.600000000  0.6139377260  0.0586199760  0.0064325251  400           0.0314762783 
0.6440000000  0.5952380952  0.6540000000  0.5714285714  0.8418674699  0.8253012048  0.8855421687  0.8433734940  0.5933333333  28.800000000  0.5693841231  0.0586199760  0.0070879093  450           0.0311008024 
0.6540000000  0.5952380952  0.6700000000  0.5634920635  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.6000000000  32.000000000  0.5231861430  0.0586199760  0.0085389771  500           0.0323733330 
0.7060000000  0.6428571429  0.7100000000  0.5952380952  0.8734939759  0.8674698795  0.9201807229  0.9216867470  0.7233333333  35.200000000  0.4897351414  0.0586199760  0.0099157404  550           0.0315527010 
0.7020000000  0.6031746032  0.7020000000  0.6031746032  0.8750000000  0.8734939759  0.9307228916  0.9397590361  0.7200000000  38.400000000  0.4642028099  0.0586199760  0.0113111357  600           0.0306564569 
0.7420000000  0.6428571429  0.7180000000  0.5873015873  0.8810240964  0.8734939759  0.9201807229  0.9096385542  0.7766666667  41.600000000  0.4464826357  0.0586199760  0.0119816326  650           0.0325559521 
0.7480000000  0.6428571429  0.7260000000  0.6031746032  0.8855421687  0.8915662651  0.9487951807  0.9638554217  0.7533333333  44.800000000  0.4184144706  0.0586199760  0.0133207620  700           0.0310249090 
0.7900000000  0.6666666667  0.7560000000  0.6190476190  0.8840361446  0.8734939759  0.9638554217  0.9759036145  0.7833333333  48.000000000  0.4083491182  0.0586199760  0.0133612520  750           0.0311110210 
0.7820000000  0.6666666667  0.7480000000  0.5952380952  0.8870481928  0.8734939759  0.9759036145  0.9879518072  0.7500000000  51.200000000  0.3860229146  0.0586199760  0.0133233863  800           0.0311392498 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3331680298 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6084337349  0.5783132530  0.6430722892  0.6084337349  0.3333333333  3.2000000000  1.0857828617  0.0585060120  0.0034697066  50            0.0307977343 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.6987951807  0.6867469880  0.8237951807  0.7650602410  0.3400000000  6.4000000000  1.0114042175  0.0585312843  0.0031380788  100           0.0315176725 
0.4720000000  0.4523809524  0.4480000000  0.4444444444  0.7183734940  0.6927710843  0.8704819277  0.8313253012  0.3400000000  9.6000000000  0.9470374501  0.0585451126  0.0035039815  150           0.0313826227 
0.5360000000  0.4841269841  0.5180000000  0.4682539683  0.7349397590  0.7349397590  0.8719879518  0.8373493976  0.3433333333  12.800000000  0.8834300959  0.0586304665  0.0041725024  200           0.0314082718 
0.5540000000  0.5079365079  0.5420000000  0.4920634921  0.7469879518  0.7349397590  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8060756481  0.0586304665  0.0046456553  250           0.0315484095 
0.5700000000  0.5317460317  0.5460000000  0.4920634921  0.8057228916  0.7891566265  0.8840361446  0.8493975904  0.3633333333  19.200000000  0.7330884290  0.0586442947  0.0049227380  300           0.0321188450 
0.6120000000  0.5396825397  0.6240000000  0.5793650794  0.8057228916  0.7650602410  0.8825301205  0.8433734940  0.4600000000  22.400000000  0.6686418211  0.0602474213  0.0053092605  350           0.0305404091 
0.6360000000  0.5873015873  0.6480000000  0.5952380952  0.8418674699  0.8373493976  0.8855421687  0.8433734940  0.5200000000  25.600000000  0.6139377260  0.0602474213  0.0064325251  400           0.0314766932 
0.6440000000  0.5952380952  0.6540000000  0.5714285714  0.8418674699  0.8253012048  0.8855421687  0.8433734940  0.5933333333  28.800000000  0.5693841231  0.0602474213  0.0070879093  450           0.0312726164 
0.6540000000  0.5952380952  0.6700000000  0.5634920635  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.6000000000  32.000000000  0.5231861430  0.0602474213  0.0085389771  500           0.0319344234 
0.7060000000  0.6428571429  0.7100000000  0.5952380952  0.8734939759  0.8674698795  0.9201807229  0.9216867470  0.7233333333  35.200000000  0.4897351414  0.0602474213  0.0099157404  550           0.0319559145 
0.7020000000  0.6031746032  0.7020000000  0.6031746032  0.8750000000  0.8734939759  0.9307228916  0.9397590361  0.7200000000  38.400000000  0.4642028099  0.0602474213  0.0113111357  600           0.0323646021 
0.7420000000  0.6428571429  0.7180000000  0.5873015873  0.8810240964  0.8734939759  0.9201807229  0.9096385542  0.7766666667  41.600000000  0.4464826357  0.0602474213  0.0119816326  650           0.0316384649 
0.7480000000  0.6428571429  0.7260000000  0.6031746032  0.8855421687  0.8915662651  0.9487951807  0.9638554217  0.7533333333  44.800000000  0.4184144706  0.0602474213  0.0133207620  700           0.0317692280 
0.7900000000  0.6666666667  0.7560000000  0.6190476190  0.8840361446  0.8734939759  0.9638554217  0.9759036145  0.7833333333  48.000000000  0.4083491182  0.0602474213  0.0133612520  750           0.0318568182 
0.7820000000  0.6666666667  0.7480000000  0.5952380952  0.8870481928  0.8734939759  0.9759036145  0.9879518072  0.7500000000  51.200000000  0.3860229146  0.0602474213  0.0133233863  800           0.0316167593 
0.8320000000  0.7222222222  0.7780000000  0.6269841270  0.8780120482  0.8734939759  0.9774096386  0.9819277108  0.8166666667  54.400000000  0.3754420507  0.0602474213  0.0138841097  850           0.0307533503 
0.8100000000  0.6746031746  0.7620000000  0.6190476190  0.9096385542  0.8915662651  0.9879518072  0.9879518072  0.6900000000  57.600000000  0.3547404402  0.0602474213  0.0138655843  900           0.0320102262 
0.8520000000  0.7460317460  0.8080000000  0.6428571429  0.8900602410  0.8734939759  0.9924698795  0.9939759036  0.7366666667  60.800000000  0.3392476338  0.0602474213  0.0153714049  950           0.0318504333 
0.8460000000  0.7301587302  0.8060000000  0.6349206349  0.9006024096  0.8915662651  0.9954819277  0.9939759036  0.7100000000  64.000000000  0.3292107576  0.0602474213  0.0139715347  1000          0.0316409254 
0.8600000000  0.7380952381  0.8060000000  0.6349206349  0.9412650602  0.9216867470  1.0000000000  1.0000000000  0.6733333333  67.200000000  0.3262318659  0.0602474213  0.0152978187  1050          0.0310327721 
0.8620000000  0.7698412698  0.8460000000  0.6428571429  0.9051204819  0.8855421687  0.9984939759  0.9939759036  0.6800000000  70.400000000  0.3169103217  0.0602474213  0.0147126841  1100          0.0324029970 
0.8700000000  0.7619047619  0.8520000000  0.6349206349  0.9231927711  0.9216867470  1.0000000000  1.0000000000  0.6533333333  73.600000000  0.2986624017  0.0616970062  0.0166607124  1150          0.0319673204 
0.8920000000  0.7936507937  0.8580000000  0.6587301587  0.9171686747  0.9216867470  1.0000000000  1.0000000000  0.7066666667  76.800000000  0.2914390790  0.0616970062  0.0152258130  1200          0.0315354443 
0.8880000000  0.7857142857  0.8580000000  0.6507936508  0.9156626506  0.9036144578  1.0000000000  1.0000000000  0.6666666667  80.000000000  0.2779512867  0.0616970062  0.0161762755  1250          0.0311646414 
0.9080000000  0.7777777778  0.8820000000  0.6587301587  0.9111445783  0.8975903614  1.0000000000  1.0000000000  0.6966666667  83.200000000  0.2718339479  0.0616970062  0.0160645703  1300          0.0320779133 
0.9120000000  0.7777777778  0.8900000000  0.6746031746  0.9126506024  0.9036144578  1.0000000000  1.0000000000  0.6833333333  86.400000000  0.2637611902  0.0616970062  0.0163873800  1350          0.0310929823 
0.9340000000  0.8174603175  0.8980000000  0.6984126984  0.9081325301  0.8975903614  0.9984939759  0.9939759036  0.7333333333  89.600000000  0.2537530282  0.0616970062  0.0164993243  1400          0.0317037582 
0.9260000000  0.8095238095  0.8940000000  0.7063492063  0.9186746988  0.9156626506  1.0000000000  1.0000000000  0.6900000000  92.800000000  0.2498343167  0.0616970062  0.0165846421  1450          0.0324335051 
0.9400000000  0.8015873016  0.9120000000  0.7301587302  0.9186746988  0.9156626506  1.0000000000  1.0000000000  0.7133333333  96.000000000  0.2430328521  0.0616970062  0.0168177966  1500          0.0319628620 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3240000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3649940491 
0.5000000000  0.4682539683  0.4640000000  0.4523809524  0.7545180723  0.6686746988  0.8659638554  0.8373493976  0.3400000000  3.2000000000  0.9644521010  0.0584831238  0.0035032331  50            0.0304368353 
0.6380000000  0.5873015873  0.6680000000  0.5714285714  0.8569277108  0.8373493976  0.8930722892  0.8734939759  0.5133333333  6.4000000000  0.6660808039  0.0584969521  0.0057148972  100           0.0302238178 
0.7580000000  0.6746031746  0.7380000000  0.6111111111  0.8870481928  0.8734939759  0.9186746988  0.9156626506  0.6966666667  9.6000000000  0.4792887110  0.0584969521  0.0113939493  150           0.0300180435 
0.7980000000  0.6984126984  0.7760000000  0.6031746032  0.9201807229  0.9216867470  0.9864457831  0.9939759036  0.6500000000  12.800000000  0.3913491207  0.0584969521  0.0155744624  200           0.0304964972 
0.8720000000  0.7380952381  0.8200000000  0.6666666667  0.9141566265  0.8975903614  0.9939759036  0.9879518072  0.7133333333  16.000000000  0.3302740365  0.0584969521  0.0161772561  250           0.0311834431 
0.9160000000  0.8015873016  0.8620000000  0.6825396825  0.8960843373  0.8975903614  0.9954819277  0.9939759036  0.6133333333  19.200000000  0.2765009984  0.0584969521  0.0171529544  300           0.0310096407 
0.9380000000  0.8412698413  0.9120000000  0.7222222222  0.9262048193  0.9096385542  0.9939759036  0.9879518072  0.6466666667  22.400000000  0.2460336167  0.0614571571  0.0168391685  350           0.0312205124 
0.9660000000  0.8571428571  0.9400000000  0.7460317460  0.9231927711  0.9096385542  1.0000000000  1.0000000000  0.6900000000  25.600000000  0.2176436859  0.0614571571  0.0180203335  400           0.0317809725 
0.9680000000  0.8412698413  0.9340000000  0.7698412698  0.9864457831  0.9698795181  1.0000000000  1.0000000000  0.6033333333  28.800000000  0.1936759517  0.0614571571  0.0170123107  450           0.0298996496 
0.9800000000  0.8650793651  0.9520000000  0.8095238095  0.9774096386  0.9578313253  1.0000000000  1.0000000000  0.6033333333  32.000000000  0.1591245453  0.0614571571  0.0179275063  500           0.0314792490 
0.9880000000  0.9126984127  0.9720000000  0.8174603175  0.9713855422  0.9457831325  0.9984939759  0.9939759036  0.6300000000  35.200000000  0.1428445336  0.0614571571  0.0184144762  550           0.0319083786 
0.9940000000  0.9206349206  0.9880000000  0.8492063492  0.9819277108  0.9518072289  0.9984939759  0.9939759036  0.6400000000  38.400000000  0.1242552450  0.0614571571  0.0176388376  600           0.0300854969 
0.9960000000  0.9206349206  0.9860000000  0.8650793651  0.9533132530  0.9216867470  0.9969879518  0.9879518072  0.6066666667  41.600000000  0.1216490522  0.0629653931  0.0169637119  650           0.0319859695 
0.9980000000  0.9365079365  0.9900000000  0.8571428571  0.9834337349  0.9457831325  0.9984939759  0.9939759036  0.5966666667  44.800000000  0.1038216884  0.0629653931  0.0179922277  700           0.0314194584 
0.9980000000  0.9365079365  0.9880000000  0.8650793651  0.9578313253  0.9277108434  0.9939759036  0.9879518072  0.6000000000  48.000000000  0.0934022396  0.0629653931  0.0175197382  750           0.0306086302 
0.9980000000  0.9523809524  0.9880000000  0.8730158730  0.9743975904  0.9578313253  0.9984939759  0.9939759036  0.5833333333  51.200000000  0.0815380128  0.0629653931  0.0158046138  800           0.0313526201 
0.9960000000  0.9444444444  0.9980000000  0.8730158730  0.9834337349  0.9578313253  0.9984939759  0.9939759036  0.6100000000  54.400000000  0.0793507091  0.0629653931  0.0168368521  850           0.0311314011 
0.9960000000  0.9444444444  0.9960000000  0.8809523810  0.9819277108  0.9638554217  0.9984939759  0.9939759036  0.6166666667  57.600000000  0.0686413423  0.0629653931  0.0150308525  900           0.0316042280 
0.9960000000  0.9444444444  1.0000000000  0.8809523810  0.9849397590  0.9638554217  0.9984939759  0.9939759036  0.6066666667  60.800000000  0.0626505916  0.0629653931  0.0172348232  950           0.0308118963 
0.9980000000  0.9444444444  0.9980000000  0.8888888889  0.9909638554  0.9638554217  1.0000000000  1.0000000000  0.5733333333  64.000000000  0.0594883203  0.0629653931  0.0148658626  1000          0.0322610760 
0.9980000000  0.9365079365  0.9980000000  0.8809523810  0.9924698795  0.9698795181  1.0000000000  1.0000000000  0.5766666667  67.200000000  0.0562498392  0.0629653931  0.0143440810  1050          0.0311538887 
1.0000000000  0.9444444444  1.0000000000  0.8809523810  0.9909638554  0.9638554217  1.0000000000  1.0000000000  0.5566666667  70.400000000  0.0529904280  0.0629653931  0.0146365291  1100          0.0308994675 
0.9980000000  0.9365079365  0.9980000000  0.8809523810  0.9969879518  0.9759036145  0.9984939759  0.9939759036  0.6000000000  73.600000000  0.0485684602  0.0629653931  0.0163814985  1150          0.0317293549 
1.0000000000  0.9444444444  1.0000000000  0.8809523810  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.5966666667  76.800000000  0.0437646466  0.0629653931  0.0138245741  1200          0.0310107756 
0.9980000000  0.9365079365  1.0000000000  0.8809523810  0.9954819277  0.9698795181  0.9984939759  0.9939759036  0.5933333333  80.000000000  0.0392620819  0.0629653931  0.0139596789  1250          0.0311165428 
1.0000000000  0.9444444444  1.0000000000  0.9047619048  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.5633333333  83.200000000  0.0391596614  0.0629653931  0.0139754258  1300          0.0318419790 
1.0000000000  0.9444444444  1.0000000000  0.8968253968  0.9924698795  0.9698795181  1.0000000000  1.0000000000  0.5700000000  86.400000000  0.0378196152  0.0629653931  0.0132264692  1350          0.0307594967 
1.0000000000  0.9444444444  1.0000000000  0.8968253968  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.5966666667  89.600000000  0.0371834597  0.0629653931  0.0138437325  1400          0.0304571581 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 905, in wait
    selector.register(obj, selectors.EVENT_READ)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 351, in register
    key = super().register(fileobj, events, data)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 237, in register
    key = SelectorKey(fileobj, self._fileobj_lookup(fileobj), events, data)
  File "<string>", line 14, in __new__
KeyboardInterrupt
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 863861) is killed by signal: Terminated. 
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 2.5e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3260000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3541233540 
0.4680000000  0.4603174603  0.4560000000  0.4444444444  0.7183734940  0.7048192771  0.8433734940  0.8072289157  0.3400000000  3.2000000000  1.0349637461  0.0585899353  0.0032717314  50            0.0316769886 
0.5380000000  0.5079365079  0.5460000000  0.4841269841  0.7349397590  0.6987951807  0.8825301205  0.8433734940  0.3600000000  6.4000000000  0.8736538637  0.0585899353  0.0038793545  100           0.0311276531 
0.6100000000  0.5555555556  0.6260000000  0.5555555556  0.7891566265  0.7710843373  0.8870481928  0.8493975904  0.4400000000  9.6000000000  0.7077612293  0.0585899353  0.0049331593  150           0.0318921471 
0.6380000000  0.5952380952  0.6580000000  0.5873015873  0.8614457831  0.8554216867  0.8885542169  0.8674698795  0.5633333333  12.800000000  0.5754968911  0.0585899353  0.0074747979  200           0.0307748747 
0.7040000000  0.6111111111  0.6940000000  0.5873015873  0.8689759036  0.8734939759  0.9277108434  0.9277108434  0.7300000000  16.000000000  0.4820435721  0.0589022636  0.0106798317  250           0.0316669273 
0.7440000000  0.6428571429  0.7060000000  0.5952380952  0.8750000000  0.8734939759  0.9457831325  0.9518072289  0.6400000000  19.200000000  0.4233335924  0.0589022636  0.0135481992  300           0.0306121016 
0.8120000000  0.7301587302  0.7960000000  0.6031746032  0.8915662651  0.8674698795  0.9774096386  0.9819277108  0.6900000000  22.400000000  0.3869269419  0.0589022636  0.0139102677  350           0.0315856838 
0.8340000000  0.7539682540  0.8160000000  0.6507936508  0.8915662651  0.8795180723  0.9879518072  0.9879518072  0.6833333333  25.600000000  0.3603958994  0.0589022636  0.0153572311  400           0.0315476131 
0.8620000000  0.7698412698  0.8240000000  0.6428571429  0.9322289157  0.9216867470  1.0000000000  1.0000000000  0.6300000000  28.800000000  0.3352179593  0.0589032173  0.0147424167  450           0.0316246557 
0.8880000000  0.7777777778  0.8460000000  0.6746031746  0.9171686747  0.9096385542  1.0000000000  1.0000000000  0.6233333333  32.000000000  0.2992144939  0.0589032173  0.0157033458  500           0.0315810919 
0.9100000000  0.8015873016  0.8980000000  0.6746031746  0.8960843373  0.8855421687  0.9969879518  0.9879518072  0.7066666667  35.200000000  0.2779858786  0.0610427856  0.0166140687  550           0.0309102011 
0.9240000000  0.8015873016  0.8920000000  0.6825396825  0.9533132530  0.9337349398  1.0000000000  1.0000000000  0.6666666667  38.400000000  0.2548862606  0.0611290932  0.0167010034  600           0.0303858852 
0.9460000000  0.8333333333  0.9200000000  0.7142857143  0.9216867470  0.9036144578  1.0000000000  1.0000000000  0.6800000000  41.600000000  0.2468183362  0.0611290932  0.0163342228  650           0.0315909481 
0.9500000000  0.8253968254  0.9320000000  0.7222222222  0.9638554217  0.9277108434  1.0000000000  1.0000000000  0.6400000000  44.800000000  0.2230581135  0.0611290932  0.0175629301  700           0.0311922169 
0.9680000000  0.8253968254  0.9400000000  0.7539682540  0.9231927711  0.9096385542  1.0000000000  1.0000000000  0.6400000000  48.000000000  0.2083398825  0.0611290932  0.0175728773  750           0.0313768864 
0.9780000000  0.8571428571  0.9360000000  0.7698412698  0.9322289157  0.9096385542  1.0000000000  1.0000000000  0.6200000000  51.200000000  0.1890939853  0.0611290932  0.0167317881  800           0.0311374617 
0.9800000000  0.8968253968  0.9640000000  0.8095238095  0.9578313253  0.9277108434  1.0000000000  1.0000000000  0.6566666667  54.400000000  0.1826988593  0.0611290932  0.0173420273  850           0.0309187222 
0.9840000000  0.8968253968  0.9580000000  0.7936507937  0.9593373494  0.9337349398  1.0000000000  1.0000000000  0.6300000000  57.600000000  0.1663975462  0.0611290932  0.0168191290  900           0.0320963860 
0.9900000000  0.9126984127  0.9720000000  0.8015873016  0.9623493976  0.9337349398  1.0000000000  1.0000000000  0.6433333333  60.800000000  0.1504902862  0.0611290932  0.0189123758  950           0.0312302923 
0.9860000000  0.9126984127  0.9620000000  0.8174603175  0.9653614458  0.9457831325  1.0000000000  1.0000000000  0.6200000000  64.000000000  0.1457335082  0.0611290932  0.0165886496  1000          0.0312850952 
0.9940000000  0.9126984127  0.9600000000  0.8412698413  0.9849397590  0.9638554217  1.0000000000  1.0000000000  0.5866666667  67.200000000  0.1391214922  0.0611290932  0.0170968557  1050          0.0331115198 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 297, in <module>
    for x, y in next(train_minibatches_iterator)]
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 46, in __iter__
    yield next(self._infinite_iterator)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 2e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3280000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3714768887 
0.4700000000  0.4603174603  0.4420000000  0.4206349206  0.7108433735  0.6987951807  0.8057228916  0.7891566265  0.3400000000  3.2000000000  1.0512325430  0.0584831238  0.0032691116  50            0.0302480459 
0.5160000000  0.5000000000  0.5120000000  0.4682539683  0.7213855422  0.6927710843  0.8719879518  0.8373493976  0.3433333333  6.4000000000  0.9197089040  0.0584831238  0.0035764757  100           0.0306433630 
0.5720000000  0.5158730159  0.5720000000  0.5000000000  0.7635542169  0.7168674699  0.8870481928  0.8493975904  0.3766666667  9.6000000000  0.7851302814  0.0584959984  0.0044134865  150           0.0318982840 
0.6120000000  0.5634920635  0.6480000000  0.5714285714  0.8328313253  0.8253012048  0.8870481928  0.8493975904  0.4933333333  12.800000000  0.6586949253  0.0584969521  0.0056947378  200           0.0319862843 
0.6600000000  0.6031746032  0.6740000000  0.5793650794  0.8614457831  0.8554216867  0.8855421687  0.8674698795  0.6433333333  16.000000000  0.5519131202  0.0584969521  0.0076640510  250           0.0312059164 
0.6740000000  0.5952380952  0.6840000000  0.5396825397  0.8659638554  0.8614457831  0.9216867470  0.9156626506  0.6233333333  19.200000000  0.4819506449  0.0585989952  0.0105635784  300           0.0309989262 
0.7620000000  0.6428571429  0.7300000000  0.5952380952  0.8780120482  0.8734939759  0.9457831325  0.9518072289  0.6766666667  22.400000000  0.4395839733  0.0585989952  0.0120147206  350           0.0315249777 
0.7820000000  0.6904761905  0.7740000000  0.6111111111  0.8810240964  0.8734939759  0.9774096386  0.9819277108  0.7066666667  25.600000000  0.4090370673  0.0585989952  0.0138058526  400           0.0317239809 
0.8100000000  0.6904761905  0.7800000000  0.6190476190  0.9081325301  0.9096385542  0.9864457831  0.9939759036  0.6666666667  28.800000000  0.3831467366  0.0585989952  0.0137184511  450           0.0311043310 
0.8420000000  0.7380952381  0.8020000000  0.6349206349  0.9036144578  0.8915662651  0.9984939759  0.9939759036  0.6533333333  32.000000000  0.3465514880  0.0614633560  0.0147222400  500           0.0314298964 
0.8800000000  0.7619047619  0.8320000000  0.6349206349  0.8840361446  0.8855421687  0.9879518072  0.9879518072  0.7533333333  35.200000000  0.3235906470  0.0614633560  0.0155338199  550           0.0318310404 
0.8840000000  0.7460317460  0.8400000000  0.6349206349  0.9337349398  0.9156626506  1.0000000000  1.0000000000  0.6966666667  38.400000000  0.3008810124  0.0615038872  0.0158830465  600           0.0321302032 
0.8960000000  0.7857142857  0.8580000000  0.6746031746  0.9051204819  0.8855421687  1.0000000000  1.0000000000  0.7133333333  41.600000000  0.2911255565  0.0615038872  0.0156417433  650           0.0316580391 
0.9140000000  0.7777777778  0.8840000000  0.6587301587  0.9518072289  0.9277108434  1.0000000000  1.0000000000  0.6866666667  44.800000000  0.2671920082  0.0615038872  0.0168720381  700           0.0315666199 
0.9320000000  0.8095238095  0.9020000000  0.6746031746  0.9021084337  0.8975903614  1.0000000000  1.0000000000  0.6766666667  48.000000000  0.2541695318  0.0615038872  0.0166936160  750           0.0305677366 
0.9400000000  0.8253968254  0.8960000000  0.6904761905  0.9171686747  0.9096385542  1.0000000000  1.0000000000  0.6566666667  51.200000000  0.2335468903  0.0615038872  0.0162330470  800           0.0311025906 
0.9640000000  0.8412698413  0.9420000000  0.7539682540  0.9307228916  0.9156626506  1.0000000000  1.0000000000  0.6900000000  54.400000000  0.2261037648  0.0615038872  0.0166831936  850           0.0310909176 
0.9520000000  0.8492063492  0.9280000000  0.7539682540  0.9487951807  0.9277108434  1.0000000000  1.0000000000  0.6466666667  57.600000000  0.2091400909  0.0615038872  0.0165768216  900           0.0306744862 
0.9680000000  0.8730158730  0.9460000000  0.7619047619  0.9412650602  0.9216867470  1.0000000000  1.0000000000  0.6633333333  60.800000000  0.1913361830  0.0615038872  0.0185894281  950           0.0312635183 
0.9640000000  0.8492063492  0.9400000000  0.7698412698  0.9487951807  0.9277108434  1.0000000000  1.0000000000  0.6166666667  64.000000000  0.1859043550  0.0615038872  0.0163928460  1000          0.0315310144 
0.9760000000  0.8650793651  0.9460000000  0.8015873016  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.5800000000  67.200000000  0.1801935735  0.0615038872  0.0172083819  1050          0.0317338133 
0.9800000000  0.8809523810  0.9620000000  0.8174603175  0.9337349398  0.9156626506  1.0000000000  1.0000000000  0.6000000000  70.400000000  0.1733278304  0.0615038872  0.0167719457  1100          0.0306607723 
0.9840000000  0.8809523810  0.9620000000  0.8095238095  0.9789156627  0.9638554217  0.9984939759  0.9939759036  0.5933333333  73.600000000  0.1578264329  0.0615038872  0.0194638201  1150          0.0320317125 
0.9900000000  0.9126984127  0.9740000000  0.8095238095  0.9683734940  0.9457831325  1.0000000000  1.0000000000  0.6266666667  76.800000000  0.1490659238  0.0615038872  0.0169029937  1200          0.0318936062 
0.9880000000  0.9206349206  0.9700000000  0.8015873016  0.9774096386  0.9578313253  0.9984939759  0.9939759036  0.6033333333  80.000000000  0.1401389325  0.0615038872  0.0174555679  1250          0.0315484381 
0.9900000000  0.9126984127  0.9720000000  0.8492063492  0.9774096386  0.9578313253  1.0000000000  1.0000000000  0.6033333333  83.200000000  0.1339070006  0.0615038872  0.0174391064  1300          0.0312600994 
0.9900000000  0.9126984127  0.9760000000  0.8492063492  0.9713855422  0.9457831325  0.9969879518  0.9879518072  0.6166666667  86.400000000  0.1299572681  0.0615038872  0.0175205136  1350          0.0311328268 
0.9920000000  0.9285714286  0.9820000000  0.8412698413  0.9804216867  0.9578313253  0.9984939759  0.9939759036  0.6166666667  89.600000000  0.1237967627  0.0615038872  0.0176477205  1400          0.0318736029 
0.9920000000  0.9285714286  0.9780000000  0.8412698413  0.9819277108  0.9638554217  0.9984939759  0.9939759036  0.6000000000  92.800000000  0.1201443180  0.0615038872  0.0173867719  1450          0.0315521955 
0.9940000000  0.8968253968  0.9860000000  0.8730158730  0.9819277108  0.9638554217  0.9984939759  0.9939759036  0.6000000000  96.000000000  0.1117783242  0.0615038872  0.0176107409  1500          0.0320851040 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1.5e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3280000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3289473057 
0.4500000000  0.4523809524  0.4140000000  0.3888888889  0.6852409639  0.6686746988  0.7861445783  0.7590361446  0.3400000000  3.2000000000  1.0676281977  0.0584578514  0.0033336104  50            0.0325264215 
0.4760000000  0.4603174603  0.4700000000  0.4444444444  0.7123493976  0.6927710843  0.8644578313  0.8313253012  0.3433333333  6.4000000000  0.9654632413  0.0584969521  0.0033262193  100           0.0316912937 
0.5280000000  0.4920634921  0.5280000000  0.4682539683  0.7349397590  0.7108433735  0.8825301205  0.8433734940  0.3433333333  9.6000000000  0.8670167220  0.0585951805  0.0040608771  150           0.0312029743 
0.5880000000  0.5476190476  0.5980000000  0.5476190476  0.7951807229  0.7951807229  0.8840361446  0.8493975904  0.3966666667  12.800000000  0.7660120225  0.0585951805  0.0048531327  200           0.0316598415 
0.6020000000  0.5555555556  0.6320000000  0.5555555556  0.8298192771  0.8132530120  0.8870481928  0.8493975904  0.4700000000  16.000000000  0.6589015436  0.0585951805  0.0055776650  250           0.0310803318 
0.6300000000  0.5555555556  0.6420000000  0.5793650794  0.8599397590  0.8373493976  0.8945783133  0.8554216867  0.4633333333  19.200000000  0.5759504592  0.0585951805  0.0069300970  300           0.0307939672 
0.6720000000  0.6031746032  0.6920000000  0.5714285714  0.8614457831  0.8554216867  0.8885542169  0.8674698795  0.6633333333  22.400000000  0.5197914195  0.0585951805  0.0086039799  350           0.0324817276 
0.7180000000  0.6190476190  0.7100000000  0.6111111111  0.8810240964  0.8734939759  0.9337349398  0.9397590361  0.7100000000  25.600000000  0.4797760874  0.0585951805  0.0107952152  400           0.0320498085 
0.7440000000  0.6507936508  0.7160000000  0.6031746032  0.8765060241  0.8795180723  0.9487951807  0.9518072289  0.6966666667  28.800000000  0.4491460073  0.0585951805  0.0116594609  450           0.0319083357 
0.7740000000  0.6587301587  0.7400000000  0.6190476190  0.8840361446  0.8734939759  0.9743975904  0.9819277108  0.6733333333  32.000000000  0.4111360568  0.0611367226  0.0130235449  500           0.0309406710 
0.8200000000  0.7142857143  0.7820000000  0.6111111111  0.8810240964  0.8734939759  0.9743975904  0.9819277108  0.7633333333  35.200000000  0.3853843749  0.0611367226  0.0139406238  550           0.0317536926 
0.8180000000  0.6984126984  0.7700000000  0.6031746032  0.9036144578  0.8915662651  0.9849397590  0.9879518072  0.7200000000  38.400000000  0.3635520852  0.0611367226  0.0145037777  600           0.0319251251 
0.8480000000  0.7380952381  0.7860000000  0.6111111111  0.8900602410  0.8855421687  0.9879518072  0.9879518072  0.7366666667  41.600000000  0.3515830201  0.0611367226  0.0144903459  650           0.0321744919 
0.8580000000  0.7222222222  0.8000000000  0.6269841270  0.9292168675  0.9096385542  1.0000000000  1.0000000000  0.6966666667  44.800000000  0.3266326445  0.0611367226  0.0154563027  700           0.0324622965 
0.8840000000  0.7539682540  0.8380000000  0.6269841270  0.8930722892  0.8855421687  0.9954819277  0.9939759036  0.7333333333  48.000000000  0.3157808203  0.0611367226  0.0153062619  750           0.0326390171 
0.8840000000  0.7460317460  0.8340000000  0.6507936508  0.9066265060  0.8915662651  0.9984939759  0.9939759036  0.6900000000  51.200000000  0.2943059254  0.0611367226  0.0150666827  800           0.0316526365 
0.9060000000  0.8015873016  0.8780000000  0.6587301587  0.8960843373  0.8855421687  0.9939759036  0.9879518072  0.7300000000  54.400000000  0.2860260788  0.0611367226  0.0155601956  850           0.0316254187 
0.8960000000  0.7936507937  0.8760000000  0.6746031746  0.9427710843  0.9277108434  1.0000000000  1.0000000000  0.6700000000  57.600000000  0.2681579664  0.0611367226  0.0155546016  900           0.0305284071 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 312, in _exit_function
    for p in active_children():
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 45, in active_children
    _cleanup()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 55, in _cleanup
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 978289) is killed by signal: Terminated. 
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.3539156914 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6084337349  0.5783132530  0.6430722892  0.6084337349  0.3333333333  3.2000000000  1.0857828617  0.0584716797  0.0034697066  50            0.0313110876 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.6987951807  0.6867469880  0.8237951807  0.7650602410  0.3400000000  6.4000000000  1.0114042175  0.0584831238  0.0031380788  100           0.0311942720 
0.4720000000  0.4523809524  0.4480000000  0.4444444444  0.7183734940  0.6927710843  0.8704819277  0.8313253012  0.3400000000  9.6000000000  0.9470374501  0.0585312843  0.0035039815  150           0.0321949768 
0.5360000000  0.4841269841  0.5180000000  0.4682539683  0.7349397590  0.7349397590  0.8719879518  0.8373493976  0.3433333333  12.800000000  0.8834300959  0.0585312843  0.0041725024  200           0.0314269257 
0.5540000000  0.5079365079  0.5420000000  0.4920634921  0.7469879518  0.7349397590  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8060756481  0.0586171150  0.0046456553  250           0.0314055634 
0.5700000000  0.5317460317  0.5460000000  0.4920634921  0.8057228916  0.7891566265  0.8840361446  0.8493975904  0.3633333333  19.200000000  0.7330884290  0.0586829185  0.0049227380  300           0.0318921852 
0.6120000000  0.5396825397  0.6240000000  0.5793650794  0.8057228916  0.7650602410  0.8825301205  0.8433734940  0.4600000000  22.400000000  0.6686418211  0.0586829185  0.0053092605  350           0.0315200853 
0.6360000000  0.5873015873  0.6480000000  0.5952380952  0.8418674699  0.8373493976  0.8855421687  0.8433734940  0.5200000000  25.600000000  0.6139377260  0.0586829185  0.0064325251  400           0.0325947905 
0.6440000000  0.5952380952  0.6540000000  0.5714285714  0.8418674699  0.8253012048  0.8855421687  0.8433734940  0.5933333333  28.800000000  0.5693841231  0.0606451035  0.0070879093  450           0.0322720003 
0.6540000000  0.5952380952  0.6700000000  0.5634920635  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.6000000000  32.000000000  0.5231861430  0.0606451035  0.0085389771  500           0.0316778469 
0.7060000000  0.6428571429  0.7100000000  0.5952380952  0.8734939759  0.8674698795  0.9201807229  0.9216867470  0.7233333333  35.200000000  0.4897351414  0.0606451035  0.0099157404  550           0.0311684084 
0.7020000000  0.6031746032  0.7020000000  0.6031746032  0.8750000000  0.8734939759  0.9307228916  0.9397590361  0.7200000000  38.400000000  0.4642028099  0.0606451035  0.0113111357  600           0.0309709358 
0.7420000000  0.6428571429  0.7180000000  0.5873015873  0.8810240964  0.8734939759  0.9201807229  0.9096385542  0.7766666667  41.600000000  0.4464826357  0.0606451035  0.0119816326  650           0.0319956589 
0.7480000000  0.6428571429  0.7260000000  0.6031746032  0.8855421687  0.8915662651  0.9487951807  0.9638554217  0.7533333333  44.800000000  0.4184144706  0.0606451035  0.0133207620  700           0.0309983349 
0.7900000000  0.6666666667  0.7560000000  0.6190476190  0.8840361446  0.8734939759  0.9638554217  0.9759036145  0.7833333333  48.000000000  0.4083491182  0.0606451035  0.0133612520  750           0.0314179611 
0.7820000000  0.6666666667  0.7480000000  0.5952380952  0.8870481928  0.8734939759  0.9759036145  0.9879518072  0.7500000000  51.200000000  0.3860229146  0.0606451035  0.0133233863  800           0.0314263916 
0.8320000000  0.7222222222  0.7780000000  0.6269841270  0.8780120482  0.8734939759  0.9774096386  0.9819277108  0.8166666667  54.400000000  0.3754420507  0.0629668236  0.0138841097  850           0.0328329086 
0.8100000000  0.6746031746  0.7620000000  0.6190476190  0.9096385542  0.8915662651  0.9879518072  0.9879518072  0.6900000000  57.600000000  0.3547404402  0.0629668236  0.0138655843  900           0.0328359461 
0.8520000000  0.7460317460  0.8080000000  0.6428571429  0.8900602410  0.8734939759  0.9924698795  0.9939759036  0.7366666667  60.800000000  0.3392476338  0.0629668236  0.0153714049  950           0.0319768524 
0.8460000000  0.7301587302  0.8060000000  0.6349206349  0.9006024096  0.8915662651  0.9954819277  0.9939759036  0.7100000000  64.000000000  0.3292107576  0.0629668236  0.0139715347  1000          0.0315048170 
0.8600000000  0.7380952381  0.8060000000  0.6349206349  0.9412650602  0.9216867470  1.0000000000  1.0000000000  0.6733333333  67.200000000  0.3262318659  0.0629668236  0.0152978187  1050          0.0317705154 
0.8620000000  0.7698412698  0.8460000000  0.6428571429  0.9051204819  0.8855421687  0.9984939759  0.9939759036  0.6800000000  70.400000000  0.3169103217  0.0629668236  0.0147126841  1100          0.0314314032 
0.8700000000  0.7619047619  0.8520000000  0.6349206349  0.9231927711  0.9216867470  1.0000000000  1.0000000000  0.6533333333  73.600000000  0.2986624017  0.0629668236  0.0166607124  1150          0.0316066217 
0.8920000000  0.7936507937  0.8580000000  0.6587301587  0.9171686747  0.9216867470  1.0000000000  1.0000000000  0.7066666667  76.800000000  0.2914390790  0.0629668236  0.0152258130  1200          0.0314647675 
0.8880000000  0.7857142857  0.8580000000  0.6507936508  0.9156626506  0.9036144578  1.0000000000  1.0000000000  0.6666666667  80.000000000  0.2779512867  0.0629668236  0.0161762755  1250          0.0314938450 
0.9080000000  0.7777777778  0.8820000000  0.6587301587  0.9111445783  0.8975903614  1.0000000000  1.0000000000  0.6966666667  83.200000000  0.2718339479  0.0629668236  0.0160645703  1300          0.0325758314 
0.9120000000  0.7777777778  0.8900000000  0.6746031746  0.9126506024  0.9036144578  1.0000000000  1.0000000000  0.6833333333  86.400000000  0.2637611902  0.0629668236  0.0163873800  1350          0.0318113375 
0.9340000000  0.8174603175  0.8980000000  0.6984126984  0.9081325301  0.8975903614  0.9984939759  0.9939759036  0.7333333333  89.600000000  0.2537530282  0.0629668236  0.0164993243  1400          0.0319446230 
0.9260000000  0.8095238095  0.8940000000  0.7063492063  0.9186746988  0.9156626506  1.0000000000  1.0000000000  0.6900000000  92.800000000  0.2498343167  0.0629668236  0.0165846421  1450          0.0317952728 
0.9400000000  0.8015873016  0.9120000000  0.7301587302  0.9186746988  0.9156626506  1.0000000000  1.0000000000  0.7133333333  96.000000000  0.2430328521  0.0629668236  0.0168177966  1500          0.0311381912 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.0046365983  0             0.4908688068 
0.4200000000  0.4047619048  0.3720000000  0.3571428571  0.6204819277  0.6024096386  0.6521084337  0.6325301205  0.3333333333  3.2000000000  1.0856223059  0.0585675240  0.0035792492  50            0.0302235556 
0.4340000000  0.4285714286  0.4160000000  0.4047619048  0.7048192771  0.6867469880  0.8222891566  0.7710843373  0.3400000000  6.4000000000  1.0108268106  0.0585675240  0.0033916643  100           0.0318323517 
0.4680000000  0.4523809524  0.4460000000  0.4444444444  0.7108433735  0.6867469880  0.8689759036  0.8253012048  0.3400000000  9.6000000000  0.9460508597  0.0585675240  0.0038323120  150           0.0309122705 
0.5340000000  0.4841269841  0.5100000000  0.4682539683  0.7424698795  0.7409638554  0.8674698795  0.8313253012  0.3433333333  12.800000000  0.8821938789  0.0585675240  0.0045863282  200           0.0314110994 
0.5520000000  0.5000000000  0.5420000000  0.4841269841  0.7500000000  0.7469879518  0.8795180723  0.8554216867  0.3666666667  16.000000000  0.8046232104  0.0609841347  0.0050885933  250           0.0312226772 
0.5720000000  0.5396825397  0.5520000000  0.4920634921  0.8042168675  0.7951807229  0.8855421687  0.8554216867  0.3633333333  19.200000000  0.7314389277  0.0609841347  0.0053692613  300           0.0307152700 
0.6140000000  0.5238095238  0.6260000000  0.5793650794  0.8087349398  0.7650602410  0.8825301205  0.8433734940  0.4566666667  22.400000000  0.6669401252  0.0609841347  0.0057425372  350           0.0319246674 
0.6360000000  0.5873015873  0.6460000000  0.5952380952  0.8448795181  0.8373493976  0.8855421687  0.8433734940  0.5100000000  25.600000000  0.6119089890  0.0609841347  0.0069021878  400           0.0315127182 
0.6500000000  0.5952380952  0.6620000000  0.5793650794  0.8463855422  0.8313253012  0.8870481928  0.8493975904  0.5933333333  28.800000000  0.5671214885  0.0609841347  0.0075832909  450           0.0312384701 
0.6580000000  0.5952380952  0.6680000000  0.5714285714  0.8584337349  0.8554216867  0.8975903614  0.8795180723  0.5933333333  32.000000000  0.5203846246  0.0609841347  0.0091574265  500           0.0314882421 
0.7100000000  0.6428571429  0.7100000000  0.5952380952  0.8734939759  0.8674698795  0.9216867470  0.9277108434  0.7366666667  35.200000000  0.4865269649  0.0609841347  0.0106671892  550           0.0312977743 
0.7040000000  0.6190476190  0.7040000000  0.6031746032  0.8750000000  0.8734939759  0.9307228916  0.9397590361  0.7233333333  38.400000000  0.4607597613  0.0609841347  0.0122523232  600           0.0306750584 
0.7400000000  0.6428571429  0.7200000000  0.5952380952  0.8810240964  0.8734939759  0.9201807229  0.9096385542  0.7833333333  41.600000000  0.4429140139  0.0609841347  0.0131525173  650           0.0315489626 
0.7500000000  0.6428571429  0.7340000000  0.6031746032  0.8855421687  0.8915662651  0.9487951807  0.9638554217  0.7566666667  44.800000000  0.4147832340  0.0609841347  0.0147090465  700           0.0312888527 
0.7920000000  0.6666666667  0.7560000000  0.6190476190  0.8810240964  0.8614457831  0.9668674699  0.9759036145  0.7900000000  48.000000000  0.4045095789  0.0609841347  0.0149209706  750           0.0314865971 
0.7880000000  0.6666666667  0.7460000000  0.5952380952  0.8870481928  0.8734939759  0.9789156627  0.9879518072  0.7633333333  51.200000000  0.3822581512  0.0609841347  0.0150287891  800           0.0314573956 
0.8380000000  0.7222222222  0.7860000000  0.6269841270  0.8780120482  0.8734939759  0.9713855422  0.9819277108  0.8200000000  54.400000000  0.3716662252  0.0629386902  0.0156623108  850           0.0304934597 
0.8140000000  0.6825396825  0.7660000000  0.6269841270  0.9096385542  0.8915662651  0.9879518072  0.9879518072  0.7033333333  57.600000000  0.3506180453  0.0629386902  0.0157426492  900           0.0323131943 
0.8560000000  0.7460317460  0.8040000000  0.6428571429  0.8870481928  0.8855421687  0.9894578313  0.9939759036  0.7533333333  60.800000000  0.3350434965  0.0629386902  0.0174169010  950           0.0317787027 
0.8460000000  0.7301587302  0.8060000000  0.6269841270  0.9006024096  0.8915662651  0.9954819277  0.9939759036  0.7200000000  64.000000000  0.3250823510  0.0629386902  0.0159405934  1000          0.0329497242 
0.8620000000  0.7619047619  0.8120000000  0.6349206349  0.9412650602  0.9216867470  1.0000000000  1.0000000000  0.6866666667  67.200000000  0.3220700923  0.0629386902  0.0174388694  1050          0.0309958744 
0.8660000000  0.7698412698  0.8400000000  0.6428571429  0.9051204819  0.8975903614  0.9984939759  0.9939759036  0.6933333333  70.400000000  0.3125539285  0.0629386902  0.0167663116  1100          0.0315502787 
0.8760000000  0.7619047619  0.8480000000  0.6269841270  0.9201807229  0.9216867470  1.0000000000  1.0000000000  0.6700000000  73.600000000  0.2939660969  0.0629386902  0.0189884074  1150          0.0325164700 
0.8920000000  0.7936507937  0.8580000000  0.6587301587  0.9141566265  0.9216867470  1.0000000000  1.0000000000  0.7166666667  76.800000000  0.2868945897  0.0629386902  0.0174337778  1200          0.0323094606 
0.8880000000  0.7936507937  0.8620000000  0.6428571429  0.9141566265  0.9096385542  1.0000000000  1.0000000000  0.6766666667  80.000000000  0.2734320042  0.0629386902  0.0185702106  1250          0.0317812252 
0.9120000000  0.7857142857  0.8840000000  0.6666666667  0.9081325301  0.8975903614  1.0000000000  1.0000000000  0.7000000000  83.200000000  0.2671900547  0.0629386902  0.0184031222  1300          0.0304976273 
0.9120000000  0.7857142857  0.8900000000  0.6746031746  0.9126506024  0.9036144578  1.0000000000  1.0000000000  0.6833333333  86.400000000  0.2591278359  0.0629386902  0.0187599532  1350          0.0312030697 
0.9340000000  0.8174603175  0.8980000000  0.7063492063  0.9051204819  0.8975903614  0.9984939759  0.9939759036  0.7366666667  89.600000000  0.2490121630  0.0629386902  0.0189363691  1400          0.0322805071 
0.9320000000  0.8015873016  0.8960000000  0.7063492063  0.9186746988  0.9156626506  1.0000000000  1.0000000000  0.6933333333  92.800000000  0.2452041176  0.0629386902  0.0190936331  1450          0.0311086607 
0.9440000000  0.8015873016  0.9140000000  0.7301587302  0.9171686747  0.9096385542  1.0000000000  1.0000000000  0.7166666667  96.000000000  0.2382801050  0.0629386902  0.0193727340  1500          0.0329015732 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: MMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.2869616449  0             0.3581888676 
0.4220000000  0.4206349206  0.3820000000  0.3571428571  0.5045180723  0.4638554217  0.5406626506  0.5000000000  0.3333333333  3.2000000000  1.0936138630  0.0601849556  0.2590754807  50            0.0407827520 
0.4500000000  0.4365079365  0.4200000000  0.4126984127  0.6370481928  0.5843373494  0.7259036145  0.6987951807  0.3366666667  6.4000000000  1.0338235235  0.0601849556  0.2466957512  100           0.0416847467 
0.4800000000  0.4761904762  0.4740000000  0.4444444444  0.7108433735  0.6506024096  0.7921686747  0.7590361446  0.3400000000  9.6000000000  0.9882804143  0.0610823631  0.2451485196  150           0.0419130850 
0.5280000000  0.4920634921  0.5220000000  0.4920634921  0.7198795181  0.6385542169  0.8704819277  0.8313253012  0.3466666667  12.800000000  0.9426265812  0.0610823631  0.2468595999  200           0.0411856461 
0.5420000000  0.4920634921  0.5380000000  0.4841269841  0.7379518072  0.6506024096  0.8795180723  0.8433734940  0.3633333333  16.000000000  0.8810606515  0.0610823631  0.2468172985  250           0.0411258984 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 379, in select
    for fd, event in fd_event_list:
KeyboardInterrupt
Args:
	algorithm: MMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1190717220  0.0521540642  0.2869616449  0             0.3473281860 
0.4220000000  0.4206349206  0.3820000000  0.3571428571  0.5045180723  0.4638554217  0.5406626506  0.5000000000  0.3333333333  3.2000000000  1.0936138630  0.0585165024  0.2590754807  50            0.0417742252 
0.4500000000  0.4365079365  0.4200000000  0.4126984127  0.6370481928  0.5843373494  0.7259036145  0.6987951807  0.3366666667  6.4000000000  1.0338235235  0.0585165024  0.2466957512  100           0.0428795433 
0.4800000000  0.4761904762  0.4740000000  0.4444444444  0.7108433735  0.6506024096  0.7921686747  0.7590361446  0.3400000000  9.6000000000  0.9882804143  0.0585165024  0.2451485196  150           0.0445454073 
0.5280000000  0.4920634921  0.5220000000  0.4920634921  0.7198795181  0.6385542169  0.8704819277  0.8313253012  0.3466666667  12.800000000  0.9426265812  0.0585165024  0.2468595999  200           0.0429785156 
0.5420000000  0.4920634921  0.5380000000  0.4841269841  0.7379518072  0.6506024096  0.8795180723  0.8433734940  0.3633333333  16.000000000  0.8810606515  0.0585165024  0.2468172985  250           0.0419633436 
0.5600000000  0.4841269841  0.5340000000  0.4761904762  0.7740963855  0.6746987952  0.8659638554  0.8493975904  0.3533333333  19.200000000  0.8178408229  0.0610313416  0.2479807839  300           0.0423076057 
0.5740000000  0.5238095238  0.6020000000  0.5317460317  0.7545180723  0.7048192771  0.8870481928  0.8493975904  0.4266666667  22.400000000  0.7559537494  0.0610313416  0.2500262734  350           0.0433448124 
0.6120000000  0.5476190476  0.6180000000  0.5555555556  0.8012048193  0.7710843373  0.8915662651  0.8554216867  0.4700000000  25.600000000  0.6996146274  0.0610313416  0.2538863125  400           0.0421430349 
0.6080000000  0.5396825397  0.6360000000  0.5555555556  0.8072289157  0.7710843373  0.8870481928  0.8493975904  0.5166666667  28.800000000  0.6516593540  0.0610313416  0.2551559314  450           0.0413580751 
0.6260000000  0.5634920635  0.6380000000  0.5952380952  0.8328313253  0.8012048193  0.8930722892  0.8614457831  0.5066666667  32.000000000  0.6034805489  0.0610313416  0.2580090395  500           0.0430056143 
0.6660000000  0.5714285714  0.6720000000  0.5793650794  0.8463855422  0.8554216867  0.8915662651  0.8674698795  0.5700000000  35.200000000  0.5681284988  0.0610313416  0.2599293590  550           0.0410215569 
0.6680000000  0.5714285714  0.6780000000  0.5714285714  0.8569277108  0.8614457831  0.9156626506  0.9156626506  0.5333333333  38.400000000  0.5406854367  0.0610313416  0.2621490806  600           0.0420281696 
0.6820000000  0.5873015873  0.6840000000  0.5634920635  0.8524096386  0.8433734940  0.9021084337  0.8855421687  0.6133333333  41.600000000  0.5189583242  0.0610313416  0.2627919489  650           0.0413659573 
0.6920000000  0.5952380952  0.6940000000  0.5634920635  0.8719879518  0.8373493976  0.9427710843  0.9397590361  0.5933333333  44.800000000  0.4900051993  0.0610313416  0.2652416760  700           0.0426990843 
0.7260000000  0.5952380952  0.7080000000  0.5952380952  0.8810240964  0.8734939759  0.9578313253  0.9638554217  0.5566666667  48.000000000  0.4770047963  0.0610313416  0.2628996101  750           0.0423893738 
0.7160000000  0.6111111111  0.7180000000  0.5634920635  0.8855421687  0.8795180723  0.9683734940  0.9698795181  0.5966666667  51.200000000  0.4523828226  0.0610313416  0.2620886368  800           0.0438776159 
0.7740000000  0.6587301587  0.7320000000  0.5952380952  0.8870481928  0.8734939759  0.9683734940  0.9698795181  0.6166666667  54.400000000  0.4417019552  0.0610313416  0.2626922458  850           0.0415429068 
0.7320000000  0.6031746032  0.7260000000  0.5873015873  0.9051204819  0.8975903614  0.9834337349  0.9939759036  0.5200000000  57.600000000  0.4212872475  0.0610313416  0.2631663406  900           0.0429959583 
0.8020000000  0.6587301587  0.7700000000  0.6111111111  0.8960843373  0.8734939759  0.9909638554  0.9879518072  0.5533333333  60.800000000  0.4048969835  0.0610313416  0.2663496542  950           0.0433147430 
0.7860000000  0.6666666667  0.7540000000  0.5952380952  0.9006024096  0.8795180723  0.9954819277  0.9939759036  0.5800000000  64.000000000  0.3937459022  0.0610313416  0.2606363720  1000          0.0409082317 
0.7980000000  0.6746031746  0.7540000000  0.5873015873  0.9186746988  0.9036144578  0.9984939759  0.9939759036  0.5566666667  67.200000000  0.3875210732  0.0610313416  0.2634787571  1050          0.0412723780 
0.8220000000  0.6904761905  0.7960000000  0.6269841270  0.9051204819  0.8975903614  1.0000000000  1.0000000000  0.5433333333  70.400000000  0.3794612354  0.0610313416  0.2599792624  1100          0.0421705055 
0.8160000000  0.7063492063  0.8100000000  0.6269841270  0.9262048193  0.9096385542  1.0000000000  1.0000000000  0.5300000000  73.600000000  0.3602552408  0.0610313416  0.2645563498  1150          0.0414442158 
0.8580000000  0.7222222222  0.8260000000  0.6269841270  0.9156626506  0.9036144578  1.0000000000  1.0000000000  0.5700000000  76.800000000  0.3523314035  0.0616426468  0.2599557045  1200          0.0434958887 
0.8320000000  0.7222222222  0.8280000000  0.6190476190  0.9216867470  0.9036144578  1.0000000000  1.0000000000  0.5533333333  80.000000000  0.3377021396  0.0616426468  0.2616761616  1250          0.0450207329 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 261, in <module>
    algorithm = algorithm_class(dataset.input_shape, dataset.num_classes, domain_num, hparams)  # 
TypeError: __init__() missing 1 required positional argument: 'gaussian'
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1141543) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.4314076900 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.3333333333  3.2000000000  1.0863952875  0.0584840775  0.0035801551  50            0.0324058723 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.3400000000  6.4000000000  1.0156705594  0.0584840775  0.0033667640  100           0.0333298206 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.3400000000  9.6000000000  0.9642919290  0.0585384369  0.0036399547  150           0.0318312645 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.3666666667  12.800000000  0.9088471997  0.0585427284  0.0040172963  200           0.0317317295 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.4000000000  16.000000000  0.8264292121  0.0585427284  0.0041483414  250           0.0321307087 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.4633333333  19.200000000  0.7424530327  0.0585427284  0.0043478890  300           0.0314563084 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.8000000000  22.400000000  0.6723435402  0.0586676598  0.0049792113  350           0.0316987705 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.8600000000  25.600000000  0.6225443816  0.0586676598  0.0063166928  400           0.0323892879 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.8500000000  28.800000000  0.5896604264  0.0586676598  0.0077219444  450           0.0320453691 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.8066666667  32.000000000  0.5433739918  0.0586676598  0.0095699535  500           0.0320724916 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.8833333333  35.200000000  0.5112437510  0.0600123405  0.0111136780  550           0.0319255877 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.8300000000  38.400000000  0.4874049777  0.0600123405  0.0126885303  600           0.0313020754 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.8433333333  41.600000000  0.4726694584  0.0600123405  0.0134815287  650           0.0325401783 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.8066666667  44.800000000  0.4451555741  0.0613989830  0.0147170640  700           0.0311149597 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.8400000000  48.000000000  0.4351268834  0.0613989830  0.0149744838  750           0.0325224733 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.8133333333  51.200000000  0.4126618165  0.0613989830  0.0150636691  800           0.0323029423 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.8533333333  54.400000000  0.4068649602  0.0613989830  0.0155919066  850           0.0321575022 
0.8440000000  0.7301587302  0.8020000000  0.6269841270  0.9186746988  0.9156626506  0.9412650602  0.9457831325  0.8233333333  57.600000000  0.3860806674  0.0613989830  0.0158579047  900           0.0318451023 
0.8820000000  0.8015873016  0.8520000000  0.6746031746  0.8719879518  0.8734939759  0.9096385542  0.9397590361  0.8333333333  60.800000000  0.3732662004  0.0613989830  0.0169738634  950           0.0331739092 
0.8840000000  0.7698412698  0.8560000000  0.6587301587  0.8900602410  0.8734939759  0.9397590361  0.9518072289  0.8200000000  64.000000000  0.3651448047  0.0613989830  0.0156023700  1000          0.0329908228 
0.8840000000  0.7698412698  0.8760000000  0.6666666667  0.9246987952  0.9036144578  0.9623493976  0.9698795181  0.7666666667  67.200000000  0.3608324832  0.0613989830  0.0166367842  1050          0.0330782700 
0.8980000000  0.7857142857  0.9120000000  0.7222222222  0.9036144578  0.9036144578  0.9623493976  0.9698795181  0.7833333333  70.400000000  0.3541577953  0.0613989830  0.0160910764  1100          0.0333656073 
0.9060000000  0.7777777778  0.9180000000  0.7460317460  0.9171686747  0.9096385542  0.9774096386  0.9819277108  0.7733333333  73.600000000  0.3321434653  0.0613989830  0.0177045583  1150          0.0322638035 
0.9140000000  0.8174603175  0.9320000000  0.7460317460  0.9006024096  0.8915662651  0.9623493976  0.9698795181  0.7866666667  76.800000000  0.3237835652  0.0613989830  0.0163696761  1200          0.0325235271 
0.9260000000  0.8015873016  0.9360000000  0.7380952381  0.9096385542  0.9036144578  0.9698795181  0.9759036145  0.7700000000  80.000000000  0.3045102352  0.0613989830  0.0175527207  1250          0.0315336847 
0.9400000000  0.8015873016  0.9500000000  0.7301587302  0.9006024096  0.8915662651  0.9533132530  0.9578313253  0.7200000000  83.200000000  0.2984843615  0.0613989830  0.0169518461  1300          0.0319689655 
0.9380000000  0.8095238095  0.9580000000  0.7460317460  0.9036144578  0.9036144578  0.9608433735  0.9638554217  0.7266666667  86.400000000  0.2899814868  0.0613989830  0.0172848462  1350          0.0325110722 
0.9600000000  0.8492063492  0.9640000000  0.7539682540  0.8795180723  0.8795180723  0.9307228916  0.9277108434  0.6966666667  89.600000000  0.2747318462  0.0613989830  0.0175238248  1400          0.0325338030 
0.9580000000  0.8412698413  0.9660000000  0.7619047619  0.8975903614  0.9036144578  0.9638554217  0.9638554217  0.7133333333  92.800000000  0.2730405775  0.0613989830  0.0173876758  1450          0.0328771210 
0.9640000000  0.8571428571  0.9700000000  0.7777777778  0.9066265060  0.9036144578  0.9638554217  0.9638554217  0.6933333333  96.000000000  0.2628393283  0.0613989830  0.0174610336  1500          0.0320627737 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3518221378 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0585618019  0.0035801551  50            0.0313773823 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0610041618  0.0033667640  100           0.0324833488 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.4857142857  9.6000000000  0.9642919290  0.0610041618  0.0036399547  150           0.0324304008 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.5412698413  12.800000000  0.9088471997  0.0610041618  0.0040172963  200           0.0318055582 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.5222222222  16.000000000  0.8264292121  0.0610041618  0.0041483414  250           0.0317408705 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.5444444444  19.200000000  0.7424530327  0.0610041618  0.0043478890  300           0.0318758297 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.5825396825  22.400000000  0.6723435402  0.0610041618  0.0049792113  350           0.0325280285 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.6412698413  25.600000000  0.6225443816  0.0610041618  0.0063166928  400           0.0310323095 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.6523809524  28.800000000  0.5896604264  0.0610041618  0.0077219444  450           0.0318464565 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
KeyboardInterrupt
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.4819023609 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0585031509  0.0035801551  50            0.0323301411 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0585031509  0.0033667640  100           0.0330681133 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.4857142857  9.6000000000  0.9642919290  0.0585169792  0.0036399547  150           0.0325736856 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.5412698413  12.800000000  0.9088471997  0.0585756302  0.0040172963  200           0.0319641638 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.5222222222  16.000000000  0.8264292121  0.0585756302  0.0041483414  250           0.0316787052 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.5444444444  19.200000000  0.7424530327  0.0585756302  0.0043478890  300           0.0326042271 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.5825396825  22.400000000  0.6723435402  0.0585756302  0.0049792113  350           0.0314969254 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.6412698413  25.600000000  0.6225443816  0.0585756302  0.0063166928  400           0.0326444149 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.6523809524  28.800000000  0.5896604264  0.0585756302  0.0077219444  450           0.0320311689 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.6793650794  32.000000000  0.5433739918  0.0585756302  0.0095699535  500           0.0328055763 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.7142857143  35.200000000  0.5112437510  0.0585756302  0.0111136780  550           0.0334384727 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.7111111111  38.400000000  0.4874049777  0.0585756302  0.0126885303  600           0.0324381304 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.6936507937  41.600000000  0.4726694584  0.0585756302  0.0134815287  650           0.0320580149 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.6904761905  44.800000000  0.4451555741  0.0585756302  0.0147170640  700           0.0331648445 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.7126984127  48.000000000  0.4351268834  0.0585756302  0.0149744838  750           0.0319641638 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.6873015873  51.200000000  0.4126618165  0.0585756302  0.0150636691  800           0.0322999001 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.6904761905  54.400000000  0.4068649602  0.0585756302  0.0155919066  850           0.0318480825 
0.8440000000  0.7301587302  0.8020000000  0.6269841270  0.9186746988  0.9156626506  0.9412650602  0.9457831325  0.6809523810  57.600000000  0.3860806674  0.0586042404  0.0158579047  900           0.0317043686 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1201896) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 50, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1202032) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3298192771  0.3313253012  0.3493975904  0.3493975904  0.3349206349  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3695755005 
0.6900000000  0.6111111111  0.7440000000  0.6507936508  0.9246987952  0.9156626506  0.9894578313  0.9939759036  0.6079365079  3.2000000000  0.5357892358  0.0605525970  0.0204420282  50            0.0336432362 
0.9720000000  0.9126984127  0.9440000000  0.8333333333  0.9277108434  0.9036144578  0.9879518072  0.9879518072  0.6968253968  6.4000000000  0.2456789592  0.0605525970  0.0205709133  100           0.0312802362 
0.9980000000  0.9682539683  0.9940000000  0.9126984127  0.9382530120  0.8734939759  0.9578313253  0.9638554217  0.5825396825  9.6000000000  0.1074073016  0.0605525970  0.0220030408  150           0.0325963163 
0.9860000000  0.9126984127  0.9800000000  0.8968253968  0.9984939759  0.9939759036  0.9984939759  0.9939759036  0.6301587302  12.800000000  0.0616724156  0.0605525970  0.0194898378  200           0.0334526682 
0.9980000000  0.9841269841  0.9960000000  0.9206349206  0.9442771084  0.9337349398  0.9879518072  0.9879518072  0.6396825397  16.000000000  0.0418081714  0.0605525970  0.0189040260  250           0.0327615643 
1.0000000000  0.9920634921  0.9960000000  0.9444444444  0.9367469880  0.9036144578  0.9774096386  0.9698795181  0.5063492063  19.200000000  0.0266752347  0.0605525970  0.0168835827  300           0.0327272892 
1.0000000000  0.9761904762  1.0000000000  0.9285714286  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6460317460  22.400000000  0.0237558756  0.0605525970  0.0159194507  350           0.0325730467 
1.0000000000  0.9841269841  1.0000000000  0.9444444444  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6888888889  25.600000000  0.0207336409  0.0605525970  0.0148178323  400           0.0333650684 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.6031746032  28.800000000  0.0187822996  0.0605525970  0.0130161679  450           0.0322704077 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9939759036  0.9518072289  1.0000000000  0.9879518072  0.6015873016  32.000000000  0.0157587688  0.0605525970  0.0139373167  500           0.0313841677 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9879518072  0.9518072289  1.0000000000  1.0000000000  0.6380952381  35.200000000  0.0135994953  0.0605525970  0.0128748809  550           0.0323297548 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.5761904762  38.400000000  0.0100040785  0.0605525970  0.0103032121  600           0.0322828674 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9939759036  0.9879518072  1.0000000000  1.0000000000  0.5984126984  41.600000000  0.0109439510  0.0605525970  0.0110314968  650           0.0332040453 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9909638554  0.9397590361  1.0000000000  0.9879518072  0.6126984127  44.800000000  0.0118016341  0.0605525970  0.0108947866  700           0.0315287828 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9849397590  0.9397590361  1.0000000000  1.0000000000  0.5968253968  48.000000000  0.0106098465  0.0605525970  0.0109093209  750           0.0330103827 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.4932069778 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.5746031746  3.2000000000  0.5294519615  0.0586528778  50            0.0288687468 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.7555555556  6.4000000000  0.2354695666  0.0586528778  100           0.0289840460 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.6984126984  9.6000000000  0.0897018895  0.0587387085  150           0.0288141680 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.6190476190  12.800000000  0.0471370297  0.0587387085  200           0.0281640863 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.7031746032  16.000000000  0.0281241818  0.0587387085  250           0.0284663153 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  0.9246987952  0.8915662651  0.9698795181  0.9638554217  0.5222222222  19.200000000  0.0178615930  0.0587387085  300           0.0289511871 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9789156627  0.9397590361  0.9909638554  0.9879518072  0.6603174603  22.400000000  0.0163820754  0.0615124702  350           0.0294076681 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9698795181  0.9277108434  0.9984939759  0.9939759036  0.6126984127  25.600000000  0.0141548238  0.0615124702  400           0.0283927393 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6111111111  28.800000000  0.0116662318  0.0615124702  450           0.0295899773 
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()

During handling of the above exception, another exception occurred:


During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
KeyboardInterrupt
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1253721) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 312, in _exit_function
    for p in active_children():
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 45, in active_children
    _cleanup()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 55, in _cleanup
    if p._popen.poll() is not None:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1253285) is killed by signal: Terminated. 
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3188989162 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.5746031746  3.2000000000  0.5294519615  0.0615124702  50            0.0279838705 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.7555555556  6.4000000000  0.2354695666  0.0615124702  100           0.0280260134 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.6984126984  9.6000000000  0.0897018895  0.0615124702  150           0.0283176184 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.6190476190  12.800000000  0.0471370297  0.0615124702  200           0.0279161644 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.7031746032  16.000000000  0.0281241818  0.0615124702  250           0.0269842529 
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 13616) is killed by signal: Terminated. 
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3207831325  0.3313253012  0.3689759036  0.3554216867  0.3333333333  0.0000000000  1.1192054749  0.0521492958  0             0.3494729996 
0.7000000000  0.6349206349  0.7140000000  0.6190476190  0.9126506024  0.9036144578  0.9909638554  1.0000000000  0.5746031746  3.2000000000  0.5294519615  0.0585460663  50            0.0290023851 
0.9640000000  0.9047619048  0.9240000000  0.8095238095  0.9367469880  0.9156626506  0.9939759036  0.9879518072  0.7555555556  6.4000000000  0.2354695666  0.0585741997  100           0.0287518692 
0.9920000000  0.9682539683  0.9900000000  0.9126984127  0.9066265060  0.8795180723  0.9412650602  0.9457831325  0.6984126984  9.6000000000  0.0897018895  0.0585741997  150           0.0281489229 
0.9140000000  0.7857142857  0.9300000000  0.8888888889  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.6190476190  12.800000000  0.0471370297  0.0585741997  200           0.0287168312 
0.9940000000  0.9603174603  0.9940000000  0.9206349206  0.9668674699  0.9397590361  0.9909638554  0.9879518072  0.7031746032  16.000000000  0.0281241818  0.0585741997  250           0.0274964428 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  0.9246987952  0.8915662651  0.9698795181  0.9638554217  0.5222222222  19.200000000  0.0178615930  0.0586633682  300           0.0277295971 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.9789156627  0.9397590361  0.9909638554  0.9879518072  0.6603174603  22.400000000  0.0163820754  0.0586714745  350           0.0274087000 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9698795181  0.9277108434  0.9984939759  0.9939759036  0.6126984127  25.600000000  0.0141548238  0.0586714745  400           0.0286485195 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6111111111  28.800000000  0.0116662318  0.0586714745  450           0.0277977228 
1.0000000000  0.9682539683  0.9960000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.6920634921  32.000000000  0.0093445297  0.0586714745  500           0.0282500172 
1.0000000000  0.9761904762  1.0000000000  0.9841269841  0.9939759036  0.9759036145  1.0000000000  1.0000000000  0.6222222222  35.200000000  0.0060832818  0.0586714745  550           0.0278641748 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9864457831  0.9698795181  0.9954819277  0.9939759036  0.5222222222  38.400000000  0.0035756806  0.0611343384  600           0.0282222748 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  0.9879518072  0.9518072289  0.9984939759  0.9939759036  0.5888888889  41.600000000  0.0034661700  0.0611343384  650           0.0269714689 
1.0000000000  0.9920634921  0.9960000000  0.9444444444  0.9804216867  0.9457831325  0.9939759036  0.9879518072  0.5650793651  44.800000000  0.0075763612  0.0611343384  700           0.0270855761 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.9051204819  0.8855421687  0.9533132530  0.9578313253  0.4809523810  48.000000000  0.0091222201  0.0611343384  750           0.0277046585 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.5460317460  51.200000000  0.0071901920  0.0611343384  800           0.0270749617 
1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5682539683  54.400000000  0.0042002827  0.0611343384  850           0.0279188156 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6333333333  57.600000000  0.0027169366  0.0611343384  900           0.0286758518 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9593373494  0.9578313253  0.9939759036  1.0000000000  0.5333333333  60.800000000  0.0067801333  0.0611343384  950           0.0283556366 
1.0000000000  0.9761904762  0.9980000000  0.9603174603  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.6015873016  64.000000000  0.0071806511  0.0611343384  1000          0.0284863997 
1.0000000000  1.0000000000  1.0000000000  0.9523809524  0.9322289157  0.9337349398  0.9879518072  0.9879518072  0.5126984127  67.200000000  0.0044703314  0.0611343384  1050          0.0283288097 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.4968253968  70.400000000  0.0049613605  0.0611343384  1100          0.0286143541 
1.0000000000  0.9682539683  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5968253968  73.600000000  0.0026519648  0.0611343384  1150          0.0282687330 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5968253968  76.800000000  0.0037359284  0.0611343384  1200          0.0286167431 
1.0000000000  0.9761904762  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6031746032  80.000000000  0.0044088399  0.0615372658  1250          0.0270416880 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  0.9698795181  0.9518072289  0.9954819277  0.9939759036  0.4269841270  83.200000000  0.0057274551  0.0615372658  1300          0.0287353373 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.9909638554  0.9638554217  1.0000000000  1.0000000000  0.6190476190  86.400000000  0.0034941241  0.0615372658  1350          0.0289288950 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5777777778  89.600000000  0.0051812165  0.0615372658  1400          0.0292373753 
1.0000000000  0.9841269841  0.9920000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6603174603  92.800000000  0.0066806748  0.0615372658  1450          0.0279020023 
1.0000000000  0.9761904762  1.0000000000  0.9920634921  0.9698795181  0.9518072289  1.0000000000  1.0000000000  0.4666666667  96.000000000  0.0054567734  0.0615372658  1500          0.0282393742 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3412698413  0.3360000000  0.3333333333  0.3298192771  0.3313253012  0.3493975904  0.3493975904  0.3349206349  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3487045765 
0.6900000000  0.6111111111  0.7440000000  0.6507936508  0.9246987952  0.9156626506  0.9894578313  0.9939759036  0.6079365079  3.2000000000  0.5357892358  0.0585513115  0.0204420282  50            0.0315565109 
0.9720000000  0.9126984127  0.9440000000  0.8333333333  0.9277108434  0.9036144578  0.9879518072  0.9879518072  0.6968253968  6.4000000000  0.2456789592  0.0602188110  0.0205709133  100           0.0322555828 
0.9980000000  0.9682539683  0.9940000000  0.9126984127  0.9382530120  0.8734939759  0.9578313253  0.9638554217  0.5825396825  9.6000000000  0.1074073016  0.0602188110  0.0220030408  150           0.0308477211 
0.9860000000  0.9126984127  0.9800000000  0.8968253968  0.9984939759  0.9939759036  0.9984939759  0.9939759036  0.6301587302  12.800000000  0.0616724156  0.0602188110  0.0194898378  200           0.0318640137 
0.9980000000  0.9841269841  0.9960000000  0.9206349206  0.9442771084  0.9337349398  0.9879518072  0.9879518072  0.6396825397  16.000000000  0.0418081714  0.0602188110  0.0189040260  250           0.0314981794 
1.0000000000  0.9920634921  0.9960000000  0.9444444444  0.9367469880  0.9036144578  0.9774096386  0.9698795181  0.5063492063  19.200000000  0.0266752347  0.0602188110  0.0168835827  300           0.0322937012 
1.0000000000  0.9761904762  1.0000000000  0.9285714286  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6460317460  22.400000000  0.0237558756  0.0602188110  0.0159194507  350           0.0340682125 
1.0000000000  0.9841269841  1.0000000000  0.9444444444  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6888888889  25.600000000  0.0207336409  0.0602188110  0.0148178323  400           0.0314295816 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.6031746032  28.800000000  0.0187822996  0.0602188110  0.0130161679  450           0.0313260126 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9939759036  0.9518072289  1.0000000000  0.9879518072  0.6015873016  32.000000000  0.0157587688  0.0602188110  0.0139373167  500           0.0314952755 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9879518072  0.9518072289  1.0000000000  1.0000000000  0.6380952381  35.200000000  0.0135994953  0.0602188110  0.0128748809  550           0.0319771433 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.5761904762  38.400000000  0.0100040785  0.0602188110  0.0103032121  600           0.0313845396 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9939759036  0.9879518072  1.0000000000  1.0000000000  0.5984126984  41.600000000  0.0109439510  0.0602188110  0.0110314968  650           0.0322122383 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  0.9909638554  0.9397590361  1.0000000000  0.9879518072  0.6126984127  44.800000000  0.0118016341  0.0602188110  0.0108947866  700           0.0321832037 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9849397590  0.9397590361  1.0000000000  1.0000000000  0.5968253968  48.000000000  0.0106098465  0.0602188110  0.0109093209  750           0.0315886688 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9954819277  0.9578313253  1.0000000000  1.0000000000  0.6380952381  51.200000000  0.0092722110  0.0602188110  0.0082210215  800           0.0332910204 
1.0000000000  1.0000000000  1.0000000000  0.9523809524  0.9713855422  0.9337349398  0.9969879518  0.9879518072  0.5253968254  54.400000000  0.0091691166  0.0602188110  0.0092926139  850           0.0314024019 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.6349206349  57.600000000  0.0067610079  0.0602188110  0.0080489672  900           0.0302884722 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.9924698795  0.9698795181  1.0000000000  1.0000000000  0.5825396825  60.800000000  0.0076159684  0.0602188110  0.0088176022  950           0.0310919333 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  0.9909638554  0.9638554217  1.0000000000  1.0000000000  0.5920634921  64.000000000  0.0068233845  0.0602188110  0.0075489577  1000          0.0326822758 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6857142857  67.200000000  0.0054011321  0.0602188110  0.0066959694  1050          0.0318214464 
1.0000000000  1.0000000000  1.0000000000  0.9761904762  0.9292168675  0.8975903614  0.9909638554  0.9879518072  0.3952380952  70.400000000  0.0069741028  0.0617289543  0.0071334581  1100          0.0317780352 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5841269841  73.600000000  0.0065745024  0.0617289543  0.0077366622  1150          0.0324801970 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9924698795  0.9698795181  1.0000000000  1.0000000000  0.5682539683  76.800000000  0.0063888957  0.0617289543  0.0066307358  1200          0.0314877462 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6238095238  80.000000000  0.0062865130  0.0617289543  0.0067075123  1250          0.0322958612 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  0.9939759036  0.9759036145  1.0000000000  1.0000000000  0.6111111111  83.200000000  0.0082931655  0.0617289543  0.0064380471  1300          0.0331645107 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.6190476190  86.400000000  0.0077607441  0.0617289543  0.0067516012  1350          0.0322747946 
1.0000000000  1.0000000000  1.0000000000  0.9761904762  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.5873015873  89.600000000  0.0102365202  0.0617289543  0.0064998963  1400          0.0308532524 
1.0000000000  0.9761904762  0.9980000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6095238095  92.800000000  0.0067836411  0.0617289543  0.0062664129  1450          0.0315826845 
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3257977962 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0588469505  0.0035801551  50            0.0312114048 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0588469505  0.0033667640  100           0.0308472395 
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
KeyboardInterrupt
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
KeyboardInterrupt

During handling of the above exception, another exception occurred:


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

KeyboardInterrupt
KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)

During handling of the above exception, another exception occurred:

AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 104895) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3179836273 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0585169792  0.0035801551  50            0.0309683371 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0585169792  0.0033667640  100           0.0316303349 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.4857142857  9.6000000000  0.9642919290  0.0614624023  0.0036399547  150           0.0314300728 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.5412698413  12.800000000  0.9088471997  0.0614624023  0.0040172963  200           0.0309227657 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.5222222222  16.000000000  0.8264292121  0.0614624023  0.0041483414  250           0.0318778419 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.5444444444  19.200000000  0.7424530327  0.0614624023  0.0043478890  300           0.0317351770 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.5825396825  22.400000000  0.6723435402  0.0614624023  0.0049792113  350           0.0314668322 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.6412698413  25.600000000  0.6225443816  0.0614624023  0.0063166928  400           0.0327822638 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.6523809524  28.800000000  0.5896604264  0.0614624023  0.0077219444  450           0.0316978025 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.6793650794  32.000000000  0.5433739918  0.0614624023  0.0095699535  500           0.0313097095 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.7142857143  35.200000000  0.5112437510  0.0614624023  0.0111136780  550           0.0326542664 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.7111111111  38.400000000  0.4874049777  0.0615282059  0.0126885303  600           0.0325296831 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.6936507937  41.600000000  0.4726694584  0.0615282059  0.0134815287  650           0.0359140062 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.6904761905  44.800000000  0.4451555741  0.0615282059  0.0147170640  700           0.0314506674 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.7126984127  48.000000000  0.4351268834  0.0615282059  0.0149744838  750           0.0314767218 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.6873015873  51.200000000  0.4126618165  0.0615282059  0.0150636691  800           0.0321736670 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.6904761905  54.400000000  0.4068649602  0.0615282059  0.0155919066  850           0.0321307993 
0.8440000000  0.7301587302  0.8020000000  0.6269841270  0.9186746988  0.9156626506  0.9412650602  0.9457831325  0.6809523810  57.600000000  0.3860806674  0.0615282059  0.0158579047  900           0.0311573029 
0.8820000000  0.8015873016  0.8520000000  0.6746031746  0.8719879518  0.8734939759  0.9096385542  0.9397590361  0.6952380952  60.800000000  0.3732662004  0.0615282059  0.0169738634  950           0.0313636398 
0.8840000000  0.7698412698  0.8560000000  0.6587301587  0.8900602410  0.8734939759  0.9397590361  0.9518072289  0.6841269841  64.000000000  0.3651448047  0.0615282059  0.0156023700  1000          0.0323543262 
0.8840000000  0.7698412698  0.8760000000  0.6666666667  0.9246987952  0.9036144578  0.9623493976  0.9698795181  0.6746031746  67.200000000  0.3608324832  0.0615282059  0.0166367842  1050          0.0325685835 
0.8980000000  0.7857142857  0.9120000000  0.7222222222  0.9036144578  0.9036144578  0.9623493976  0.9698795181  0.6777777778  70.400000000  0.3541577953  0.0615282059  0.0160910764  1100          0.0323498058 
0.9060000000  0.7777777778  0.9180000000  0.7460317460  0.9171686747  0.9096385542  0.9774096386  0.9819277108  0.6761904762  73.600000000  0.3321434653  0.0615282059  0.0177045583  1150          0.0338110638 
0.9140000000  0.8174603175  0.9320000000  0.7460317460  0.9006024096  0.8915662651  0.9623493976  0.9698795181  0.7015873016  76.800000000  0.3237835652  0.0615282059  0.0163696761  1200          0.0320038223 
0.9260000000  0.8015873016  0.9360000000  0.7380952381  0.9096385542  0.9036144578  0.9698795181  0.9759036145  0.7015873016  80.000000000  0.3045102352  0.0615282059  0.0175527207  1250          0.0325595999 
0.9400000000  0.8015873016  0.9500000000  0.7301587302  0.9006024096  0.8915662651  0.9533132530  0.9578313253  0.6857142857  83.200000000  0.2984843615  0.0615282059  0.0169518461  1300          0.0320279360 
0.9380000000  0.8095238095  0.9580000000  0.7460317460  0.9036144578  0.9036144578  0.9608433735  0.9638554217  0.6698412698  86.400000000  0.2899814868  0.0615282059  0.0172848462  1350          0.0320178366 
0.9600000000  0.8492063492  0.9640000000  0.7539682540  0.8795180723  0.8795180723  0.9307228916  0.9277108434  0.6634920635  89.600000000  0.2747318462  0.0615282059  0.0175238248  1400          0.0328052998 
0.9580000000  0.8412698413  0.9660000000  0.7619047619  0.8975903614  0.9036144578  0.9638554217  0.9638554217  0.6857142857  92.800000000  0.2730405775  0.0615282059  0.0173876758  1450          0.0318977785 
0.9640000000  0.8571428571  0.9700000000  0.7777777778  0.9066265060  0.9036144578  0.9638554217  0.9638554217  0.6714285714  96.000000000  0.2628393283  0.0615282059  0.0174610336  1500          0.0329337311 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3269910812 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.3333333333  3.2000000000  1.0863952875  0.0597586632  0.0035801551  50            0.0316725206 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.3400000000  6.4000000000  1.0156705594  0.0616126060  0.0033667640  100           0.0318327904 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.3400000000  9.6000000000  0.9642919290  0.0616126060  0.0036399547  150           0.0324427938 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.3666666667  12.800000000  0.9088471997  0.0616126060  0.0040172963  200           0.0312766790 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.4000000000  16.000000000  0.8264292121  0.0616126060  0.0041483414  250           0.0317559814 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.4633333333  19.200000000  0.7424530327  0.0616126060  0.0043478890  300           0.0316549444 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.8000000000  22.400000000  0.6723435402  0.0616126060  0.0049792113  350           0.0325820112 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.8600000000  25.600000000  0.6225443816  0.0616126060  0.0063166928  400           0.0354441881 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.8500000000  28.800000000  0.5896604264  0.0616126060  0.0077219444  450           0.0333052111 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.8066666667  32.000000000  0.5433739918  0.0616126060  0.0095699535  500           0.0321971035 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.8833333333  35.200000000  0.5112437510  0.0616126060  0.0111136780  550           0.0327734327 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.8300000000  38.400000000  0.4874049777  0.0616126060  0.0126885303  600           0.0310364151 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.8433333333  41.600000000  0.4726694584  0.0616126060  0.0134815287  650           0.0336761522 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.8066666667  44.800000000  0.4451555741  0.0616126060  0.0147170640  700           0.0333871937 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.8400000000  48.000000000  0.4351268834  0.0616126060  0.0149744838  750           0.0327672815 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.8133333333  51.200000000  0.4126618165  0.0616126060  0.0150636691  800           0.0316193199 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.8533333333  54.400000000  0.4068649602  0.0616126060  0.0155919066  850           0.0316462708 
0.8440000000  0.7301587302  0.8020000000  0.6269841270  0.9186746988  0.9156626506  0.9412650602  0.9457831325  0.8233333333  57.600000000  0.3860806674  0.0616126060  0.0158579047  900           0.0319357252 
0.8820000000  0.8015873016  0.8520000000  0.6746031746  0.8719879518  0.8734939759  0.9096385542  0.9397590361  0.8333333333  60.800000000  0.3732662004  0.0616126060  0.0169738634  950           0.0320813322 
0.8840000000  0.7698412698  0.8560000000  0.6587301587  0.8900602410  0.8734939759  0.9397590361  0.9518072289  0.8200000000  64.000000000  0.3651448047  0.0616126060  0.0156023700  1000          0.0337855625 
0.8840000000  0.7698412698  0.8760000000  0.6666666667  0.9246987952  0.9036144578  0.9623493976  0.9698795181  0.7666666667  67.200000000  0.3608324832  0.0616126060  0.0166367842  1050          0.0314758110 
0.8980000000  0.7857142857  0.9120000000  0.7222222222  0.9036144578  0.9036144578  0.9623493976  0.9698795181  0.7833333333  70.400000000  0.3541577953  0.0616126060  0.0160910764  1100          0.0310381126 
0.9060000000  0.7777777778  0.9180000000  0.7460317460  0.9171686747  0.9096385542  0.9774096386  0.9819277108  0.7733333333  73.600000000  0.3321434653  0.0616126060  0.0177045583  1150          0.0312991047 
0.9140000000  0.8174603175  0.9320000000  0.7460317460  0.9006024096  0.8915662651  0.9623493976  0.9698795181  0.7866666667  76.800000000  0.3237835652  0.0616126060  0.0163696761  1200          0.0326262856 
0.9260000000  0.8015873016  0.9360000000  0.7380952381  0.9096385542  0.9036144578  0.9698795181  0.9759036145  0.7700000000  80.000000000  0.3045102352  0.0616126060  0.0175527207  1250          0.0331344748 
0.9400000000  0.8015873016  0.9500000000  0.7301587302  0.9006024096  0.8915662651  0.9533132530  0.9578313253  0.7200000000  83.200000000  0.2984843615  0.0616126060  0.0169518461  1300          0.0327661514 
0.9380000000  0.8095238095  0.9580000000  0.7460317460  0.9036144578  0.9036144578  0.9608433735  0.9638554217  0.7266666667  86.400000000  0.2899814868  0.0616126060  0.0172848462  1350          0.0326119375 
0.9600000000  0.8492063492  0.9640000000  0.7539682540  0.8795180723  0.8795180723  0.9307228916  0.9277108434  0.6966666667  89.600000000  0.2747318462  0.0616126060  0.0175238248  1400          0.0317713976 
0.9580000000  0.8412698413  0.9660000000  0.7619047619  0.8975903614  0.9036144578  0.9638554217  0.9638554217  0.7133333333  92.800000000  0.2730405775  0.0616126060  0.0173876758  1450          0.0328320742 
0.9640000000  0.8571428571  0.9700000000  0.7777777778  0.9066265060  0.9036144578  0.9638554217  0.9638554217  0.6933333333  96.000000000  0.2628393283  0.0616126060  0.0174610336  1500          0.0334644222 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.2869616449  0             0.3696904182 
0.4180000000  0.4126984127  0.3820000000  0.3571428571  0.5135542169  0.4759036145  0.5286144578  0.4759036145  0.3333333333  3.2000000000  1.0942434120  0.0584840775  0.2592301735  50            0.0420729113 
0.4460000000  0.4365079365  0.4180000000  0.4126984127  0.6460843373  0.5843373494  0.6882530120  0.6686746988  0.3333333333  6.4000000000  1.0363710546  0.0584840775  0.2471443751  100           0.0429836798 
0.4780000000  0.4682539683  0.4640000000  0.4523809524  0.7198795181  0.6626506024  0.7725903614  0.7530120482  0.3400000000  9.6000000000  0.9980519187  0.0585460663  0.2449491474  150           0.0466107225 
0.5260000000  0.4841269841  0.5240000000  0.4761904762  0.7243975904  0.6325301205  0.8283132530  0.7710843373  0.3566666667  12.800000000  0.9578628397  0.0585460663  0.2456282526  200           0.0425508165 
0.5580000000  0.5000000000  0.5520000000  0.4920634921  0.7334337349  0.6325301205  0.8599397590  0.8132530120  0.3700000000  16.000000000  0.8986453474  0.0585460663  0.2453475383  250           0.0422557640 
0.5860000000  0.4920634921  0.5760000000  0.4761904762  0.7334337349  0.6566265060  0.8493975904  0.8192771084  0.3766666667  19.200000000  0.8316901529  0.0585460663  0.2467115816  300           0.0424368906 
0.6080000000  0.5317460317  0.6400000000  0.5714285714  0.7259036145  0.7108433735  0.8524096386  0.8192771084  0.5733333333  22.400000000  0.7655296898  0.0585460663  0.2509063399  350           0.0429600620 
0.6460000000  0.5793650794  0.6640000000  0.5793650794  0.7740963855  0.7590361446  0.8509036145  0.8253012048  0.6300000000  25.600000000  0.7088456392  0.0616126060  0.2552775332  400           0.0422973251 
0.6500000000  0.5476190476  0.6680000000  0.5634920635  0.7545180723  0.7289156627  0.8704819277  0.8313253012  0.6600000000  28.800000000  0.6696021402  0.0616126060  0.2573030171  450           0.0418711519 
0.6700000000  0.5873015873  0.6780000000  0.5476190476  0.7996987952  0.7891566265  0.8765060241  0.8554216867  0.6266666667  32.000000000  0.6224756145  0.0616126060  0.2611239889  500           0.0432157040 
0.7240000000  0.6031746032  0.7100000000  0.5873015873  0.8147590361  0.8132530120  0.8569277108  0.8373493976  0.7133333333  35.200000000  0.5887829530  0.0616126060  0.2628194842  550           0.0421624565 
0.7300000000  0.5952380952  0.7080000000  0.5634920635  0.8177710843  0.8253012048  0.8644578313  0.8674698795  0.6566666667  38.400000000  0.5612491071  0.0616126060  0.2649993163  600           0.0430537415 
0.7460000000  0.6507936508  0.7040000000  0.5714285714  0.8117469880  0.8012048193  0.8704819277  0.8554216867  0.6766666667  41.600000000  0.5436367458  0.0616126060  0.2641746110  650           0.0445151711 
0.7700000000  0.6428571429  0.7140000000  0.5873015873  0.8463855422  0.8072289157  0.9066265060  0.8915662651  0.6666666667  44.800000000  0.5162987173  0.0616126060  0.2676745272  700           0.0421437168 
0.8040000000  0.6666666667  0.7500000000  0.6111111111  0.8478915663  0.8493975904  0.9006024096  0.9277108434  0.6533333333  48.000000000  0.5039659858  0.0616126060  0.2659131318  750           0.0425679684 
0.8060000000  0.6825396825  0.7380000000  0.5793650794  0.8825301205  0.8674698795  0.9246987952  0.9156626506  0.6633333333  51.200000000  0.4786942595  0.0616126060  0.2638885546  800           0.0424248219 
0.8420000000  0.7222222222  0.7760000000  0.6190476190  0.8704819277  0.8554216867  0.9021084337  0.9337349398  0.7100000000  54.400000000  0.4699270982  0.0616126060  0.2630600184  850           0.0416728258 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.2869616449  0             0.3464148045 
0.4180000000  0.4126984127  0.3820000000  0.3571428571  0.5135542169  0.4759036145  0.5286144578  0.4759036145  0.3333333333  3.2000000000  1.0942434120  0.0584840775  0.2592301735  50            0.0421067667 
0.4460000000  0.4365079365  0.4180000000  0.4126984127  0.6460843373  0.5843373494  0.6882530120  0.6686746988  0.3333333333  6.4000000000  1.0363710546  0.0584840775  0.2471443751  100           0.0430251455 
0.4780000000  0.4682539683  0.4640000000  0.4523809524  0.7198795181  0.6626506024  0.7725903614  0.7530120482  0.3400000000  9.6000000000  0.9980519187  0.0584840775  0.2449491474  150           0.0430235434 
0.5260000000  0.4841269841  0.5240000000  0.4761904762  0.7243975904  0.6325301205  0.8283132530  0.7710843373  0.3566666667  12.800000000  0.9578628397  0.0584979057  0.2456282526  200           0.0431621218 
0.5580000000  0.5000000000  0.5520000000  0.4920634921  0.7334337349  0.6325301205  0.8599397590  0.8132530120  0.3700000000  16.000000000  0.8986453474  0.0585455894  0.2453475383  250           0.0426055574 
0.5860000000  0.4920634921  0.5760000000  0.4761904762  0.7334337349  0.6566265060  0.8493975904  0.8192771084  0.3766666667  19.200000000  0.8316901529  0.0585708618  0.2467115816  300           0.0436163521 
0.6080000000  0.5317460317  0.6400000000  0.5714285714  0.7259036145  0.7108433735  0.8524096386  0.8192771084  0.5733333333  22.400000000  0.7655296898  0.0585708618  0.2509063399  350           0.0422095394 
0.6460000000  0.5793650794  0.6640000000  0.5793650794  0.7740963855  0.7590361446  0.8509036145  0.8253012048  0.6300000000  25.600000000  0.7088456392  0.0585708618  0.2552775332  400           0.0436786366 
0.6500000000  0.5476190476  0.6680000000  0.5634920635  0.7545180723  0.7289156627  0.8704819277  0.8313253012  0.6600000000  28.800000000  0.6696021402  0.0585708618  0.2573030171  450           0.0429056931 
0.6700000000  0.5873015873  0.6780000000  0.5476190476  0.7996987952  0.7891566265  0.8765060241  0.8554216867  0.6266666667  32.000000000  0.6224756145  0.0585832596  0.2611239889  500           0.0439138031 
0.7240000000  0.6031746032  0.7100000000  0.5873015873  0.8147590361  0.8132530120  0.8569277108  0.8373493976  0.7133333333  35.200000000  0.5887829530  0.0585832596  0.2628194842  550           0.0438614178 
0.7300000000  0.5952380952  0.7080000000  0.5634920635  0.8177710843  0.8253012048  0.8644578313  0.8674698795  0.6566666667  38.400000000  0.5612491071  0.0586209297  0.2649993163  600           0.0427866554 
0.7460000000  0.6507936508  0.7040000000  0.5714285714  0.8117469880  0.8012048193  0.8704819277  0.8554216867  0.6766666667  41.600000000  0.5436367458  0.0589842796  0.2641746110  650           0.0433861971 
0.7700000000  0.6428571429  0.7140000000  0.5873015873  0.8463855422  0.8072289157  0.9066265060  0.8915662651  0.6666666667  44.800000000  0.5162987173  0.0589842796  0.2676745272  700           0.0427466345 
0.8040000000  0.6666666667  0.7500000000  0.6111111111  0.8478915663  0.8493975904  0.9006024096  0.9277108434  0.6533333333  48.000000000  0.5039659858  0.0589842796  0.2659131318  750           0.0421518612 
0.8060000000  0.6825396825  0.7380000000  0.5793650794  0.8825301205  0.8674698795  0.9246987952  0.9156626506  0.6633333333  51.200000000  0.4786942595  0.0589842796  0.2638885546  800           0.0446151733 
0.8420000000  0.7222222222  0.7760000000  0.6190476190  0.8704819277  0.8554216867  0.9021084337  0.9337349398  0.7100000000  54.400000000  0.4699270982  0.0589842796  0.2630600184  850           0.0417841864 
0.8080000000  0.6984126984  0.7580000000  0.6190476190  0.8990963855  0.8855421687  0.9201807229  0.9337349398  0.6200000000  57.600000000  0.4511158490  0.0589842796  0.2638968271  900           0.0445663500 
0.8560000000  0.7301587302  0.8160000000  0.6587301587  0.8930722892  0.8734939759  0.9216867470  0.9518072289  0.6633333333  60.800000000  0.4378064924  0.0589842796  0.2667015237  950           0.0423539495 
0.8640000000  0.7142857143  0.8220000000  0.6428571429  0.9111445783  0.8975903614  0.9367469880  0.9518072289  0.6533333333  64.000000000  0.4302799618  0.0589842796  0.2607001024  1000          0.0423592615 
0.8700000000  0.7222222222  0.8260000000  0.6269841270  0.9156626506  0.9036144578  0.9503012048  0.9578313253  0.6533333333  67.200000000  0.4232729858  0.0589842796  0.2645543852  1050          0.0419220829 
0.8960000000  0.7539682540  0.8720000000  0.6904761905  0.9081325301  0.8975903614  0.9503012048  0.9698795181  0.6466666667  70.400000000  0.4189538121  0.0589842796  0.2616769683  1100          0.0420213699 
0.8860000000  0.7380952381  0.8720000000  0.7142857143  0.9216867470  0.9156626506  0.9668674699  0.9638554217  0.6300000000  73.600000000  0.3965542430  0.0589842796  0.2657981077  1150          0.0436232996 
0.9100000000  0.7936507937  0.8860000000  0.7301587302  0.9066265060  0.8795180723  0.9638554217  0.9759036145  0.6633333333  76.800000000  0.3899067825  0.0589842796  0.2593593034  1200          0.0441857338 
0.9000000000  0.7777777778  0.8880000000  0.7142857143  0.9186746988  0.9156626506  0.9683734940  0.9698795181  0.6500000000  80.000000000  0.3717135769  0.0589842796  0.2608465502  1250          0.0418047142 
0.9220000000  0.7619047619  0.9080000000  0.6904761905  0.9156626506  0.8915662651  0.9593373494  0.9819277108  0.6600000000  83.200000000  0.3624545717  0.0589842796  0.2600741604  1300          0.0428531551 
0.9260000000  0.7777777778  0.9160000000  0.7142857143  0.9186746988  0.8915662651  0.9578313253  0.9759036145  0.6533333333  86.400000000  0.3546889085  0.0615410805  0.2606799474  1350          0.0424532175 
0.9460000000  0.8095238095  0.9340000000  0.7301587302  0.8900602410  0.8734939759  0.9503012048  0.9698795181  0.6766666667  89.600000000  0.3355760735  0.0615410805  0.2595935866  1400          0.0432652473 
0.9440000000  0.8015873016  0.9300000000  0.7222222222  0.8960843373  0.8855421687  0.9713855422  0.9698795181  0.6566666667  92.800000000  0.3339800954  0.0615410805  0.2594800082  1450          0.0421919489 
0.9480000000  0.8253968254  0.9440000000  0.7539682540  0.9096385542  0.8915662651  0.9698795181  0.9759036145  0.6566666667  96.000000000  0.3276362419  0.0615410805  0.2623712879  1500          0.0433402300 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.2869616449  0             0.3363013268 
0.4180000000  0.4126984127  0.3820000000  0.3571428571  0.5135542169  0.4759036145  0.5286144578  0.4759036145  0.4079365079  3.2000000000  1.0942434120  0.0585031509  0.2592301735  50            0.0427797174 
0.4460000000  0.4365079365  0.4180000000  0.4126984127  0.6460843373  0.5843373494  0.6882530120  0.6686746988  0.4333333333  6.4000000000  1.0363710546  0.0585031509  0.2471443751  100           0.0426328659 
0.4780000000  0.4682539683  0.4640000000  0.4523809524  0.7198795181  0.6626506024  0.7725903614  0.7530120482  0.4777777778  9.6000000000  0.9980519187  0.0586204529  0.2449491474  150           0.0414828920 
0.5260000000  0.4841269841  0.5240000000  0.4761904762  0.7243975904  0.6325301205  0.8283132530  0.7710843373  0.5174603175  12.800000000  0.9578628397  0.0586204529  0.2456282526  200           0.0423093319 
0.5580000000  0.5000000000  0.5520000000  0.4920634921  0.7334337349  0.6325301205  0.8599397590  0.8132530120  0.5063492063  16.000000000  0.8986453474  0.0586204529  0.2453475383  250           0.0448620939 
0.5860000000  0.4920634921  0.5760000000  0.4761904762  0.7334337349  0.6566265060  0.8493975904  0.8192771084  0.4952380952  19.200000000  0.8316901529  0.0586204529  0.2467115816  300           0.0434572601 
0.6080000000  0.5317460317  0.6400000000  0.5714285714  0.7259036145  0.7108433735  0.8524096386  0.8192771084  0.5444444444  22.400000000  0.7655296898  0.0586204529  0.2509063399  350           0.0438603830 
0.6460000000  0.5793650794  0.6640000000  0.5793650794  0.7740963855  0.7590361446  0.8509036145  0.8253012048  0.5968253968  25.600000000  0.7088456392  0.0614695549  0.2552775332  400           0.0425047636 
0.6500000000  0.5476190476  0.6680000000  0.5634920635  0.7545180723  0.7289156627  0.8704819277  0.8313253012  0.5968253968  28.800000000  0.6696021402  0.0614695549  0.2573030171  450           0.0433518791 
0.6700000000  0.5873015873  0.6780000000  0.5476190476  0.7996987952  0.7891566265  0.8765060241  0.8554216867  0.6301587302  32.000000000  0.6224756145  0.0614695549  0.2611239889  500           0.0433962297 
0.7240000000  0.6031746032  0.7100000000  0.5873015873  0.8147590361  0.8132530120  0.8569277108  0.8373493976  0.6603174603  35.200000000  0.5887829530  0.0614695549  0.2628194842  550           0.0427128458 
0.7300000000  0.5952380952  0.7080000000  0.5634920635  0.8177710843  0.8253012048  0.8644578313  0.8674698795  0.6682539683  38.400000000  0.5612491071  0.0614695549  0.2649993163  600           0.0433165932 
0.7460000000  0.6507936508  0.7040000000  0.5714285714  0.8117469880  0.8012048193  0.8704819277  0.8554216867  0.6587301587  41.600000000  0.5436367458  0.0614695549  0.2641746110  650           0.0431199789 
0.7700000000  0.6428571429  0.7140000000  0.5873015873  0.8463855422  0.8072289157  0.9066265060  0.8915662651  0.6507936508  44.800000000  0.5162987173  0.0614695549  0.2676745272  700           0.0440286160 
0.8040000000  0.6666666667  0.7500000000  0.6111111111  0.8478915663  0.8493975904  0.9006024096  0.9277108434  0.6793650794  48.000000000  0.5039659858  0.0614695549  0.2659131318  750           0.0421385527 
0.8060000000  0.6825396825  0.7380000000  0.5793650794  0.8825301205  0.8674698795  0.9246987952  0.9156626506  0.6634920635  51.200000000  0.4786942595  0.0614695549  0.2638885546  800           0.0418963718 
0.8420000000  0.7222222222  0.7760000000  0.6190476190  0.8704819277  0.8554216867  0.9021084337  0.9337349398  0.6634920635  54.400000000  0.4699270982  0.0614695549  0.2630600184  850           0.0424275541 
0.8080000000  0.6984126984  0.7580000000  0.6190476190  0.8990963855  0.8855421687  0.9201807229  0.9337349398  0.6571428571  57.600000000  0.4511158490  0.0614695549  0.2638968271  900           0.0413858271 
0.8560000000  0.7301587302  0.8160000000  0.6587301587  0.8930722892  0.8734939759  0.9216867470  0.9518072289  0.6587301587  60.800000000  0.4378064924  0.0614695549  0.2667015237  950           0.0416067362 
0.8640000000  0.7142857143  0.8220000000  0.6428571429  0.9111445783  0.8975903614  0.9367469880  0.9518072289  0.6492063492  64.000000000  0.4302799618  0.0614695549  0.2607001024  1000          0.0441681719 
0.8700000000  0.7222222222  0.8260000000  0.6269841270  0.9156626506  0.9036144578  0.9503012048  0.9578313253  0.6333333333  67.200000000  0.4232729858  0.0614695549  0.2645543852  1050          0.0433387661 
0.8960000000  0.7539682540  0.8720000000  0.6904761905  0.9081325301  0.8975903614  0.9503012048  0.9698795181  0.6555555556  70.400000000  0.4189538121  0.0614695549  0.2616769683  1100          0.0419597530 
0.8860000000  0.7380952381  0.8720000000  0.7142857143  0.9216867470  0.9156626506  0.9668674699  0.9638554217  0.6476190476  73.600000000  0.3965542430  0.0614695549  0.2657981077  1150          0.0423802710 
0.9100000000  0.7936507937  0.8860000000  0.7301587302  0.9066265060  0.8795180723  0.9638554217  0.9759036145  0.6634920635  76.800000000  0.3899067825  0.0614695549  0.2593593034  1200          0.0441581821 
0.9000000000  0.7777777778  0.8880000000  0.7142857143  0.9186746988  0.9156626506  0.9683734940  0.9698795181  0.6603174603  80.000000000  0.3717135769  0.0614695549  0.2608465502  1250          0.0431661129 
0.9220000000  0.7619047619  0.9080000000  0.6904761905  0.9156626506  0.8915662651  0.9593373494  0.9819277108  0.6365079365  83.200000000  0.3624545717  0.0614695549  0.2600741604  1300          0.0426160669 
0.9260000000  0.7777777778  0.9160000000  0.7142857143  0.9186746988  0.8915662651  0.9578313253  0.9759036145  0.6269841270  86.400000000  0.3546889085  0.0614695549  0.2606799474  1350          0.0420475292 
0.9460000000  0.8095238095  0.9340000000  0.7301587302  0.8900602410  0.8734939759  0.9503012048  0.9698795181  0.6349206349  89.600000000  0.3355760735  0.0614695549  0.2595935866  1400          0.0434966612 
0.9440000000  0.8015873016  0.9300000000  0.7222222222  0.8960843373  0.8855421687  0.9713855422  0.9698795181  0.6507936508  92.800000000  0.3339800954  0.0614695549  0.2594800082  1450          0.0423330259 
0.9480000000  0.8253968254  0.9440000000  0.7539682540  0.9096385542  0.8915662651  0.9698795181  0.9759036145  0.6460317460  96.000000000  0.3276362419  0.0614695549  0.2623712879  1500          0.0436043024 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3404967785 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0585618019  0.0035801551  50            0.0314874172 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0585618019  0.0033667640  100           0.0326797581 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.4857142857  9.6000000000  0.9642919290  0.0585618019  0.0036399547  150           0.0316771603 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.5412698413  12.800000000  0.9088471997  0.0585618019  0.0040172963  200           0.0324393272 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.5222222222  16.000000000  0.8264292121  0.0614695549  0.0041483414  250           0.0334028530 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.5444444444  19.200000000  0.7424530327  0.0614695549  0.0043478890  300           0.0315954304 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.5825396825  22.400000000  0.6723435402  0.0614695549  0.0049792113  350           0.0329067755 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.6412698413  25.600000000  0.6225443816  0.0614695549  0.0063166928  400           0.0321504307 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.6523809524  28.800000000  0.5896604264  0.0614695549  0.0077219444  450           0.0317127037 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.6793650794  32.000000000  0.5433739918  0.0619959831  0.0095699535  500           0.0313136864 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.7142857143  35.200000000  0.5112437510  0.0619959831  0.0111136780  550           0.0323106050 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.7111111111  38.400000000  0.4874049777  0.0619959831  0.0126885303  600           0.0311516523 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.6936507937  41.600000000  0.4726694584  0.0619959831  0.0134815287  650           0.0328072071 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.6904761905  44.800000000  0.4451555741  0.0619959831  0.0147170640  700           0.0319114399 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.7126984127  48.000000000  0.4351268834  0.0619959831  0.0149744838  750           0.0324162149 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.6873015873  51.200000000  0.4126618165  0.0619959831  0.0150636691  800           0.0319379473 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.6904761905  54.400000000  0.4068649602  0.0619959831  0.0155919066  850           0.0328144836 
0.8440000000  0.7301587302  0.8020000000  0.6269841270  0.9186746988  0.9156626506  0.9412650602  0.9457831325  0.6809523810  57.600000000  0.3860806674  0.0619959831  0.0158579047  900           0.0324895382 
0.8820000000  0.8015873016  0.8520000000  0.6746031746  0.8719879518  0.8734939759  0.9096385542  0.9397590361  0.6952380952  60.800000000  0.3732662004  0.0619959831  0.0169738634  950           0.0319479227 
0.8840000000  0.7698412698  0.8560000000  0.6587301587  0.8900602410  0.8734939759  0.9397590361  0.9518072289  0.6841269841  64.000000000  0.3651448047  0.0619959831  0.0156023700  1000          0.0329957724 
0.8840000000  0.7698412698  0.8760000000  0.6666666667  0.9246987952  0.9036144578  0.9623493976  0.9698795181  0.6746031746  67.200000000  0.3608324832  0.0619959831  0.0166367842  1050          0.0323741150 
0.8980000000  0.7857142857  0.9120000000  0.7222222222  0.9036144578  0.9036144578  0.9623493976  0.9698795181  0.6777777778  70.400000000  0.3541577953  0.0619959831  0.0160910764  1100          0.0353427124 
0.9060000000  0.7777777778  0.9180000000  0.7460317460  0.9171686747  0.9096385542  0.9774096386  0.9819277108  0.6761904762  73.600000000  0.3321434653  0.0619959831  0.0177045583  1150          0.0317499256 
0.9140000000  0.8174603175  0.9320000000  0.7460317460  0.9006024096  0.8915662651  0.9623493976  0.9698795181  0.7015873016  76.800000000  0.3237835652  0.0619959831  0.0163696761  1200          0.0329483747 
0.9260000000  0.8015873016  0.9360000000  0.7380952381  0.9096385542  0.9036144578  0.9698795181  0.9759036145  0.7015873016  80.000000000  0.3045102352  0.0619959831  0.0175527207  1250          0.0367098999 
0.9400000000  0.8015873016  0.9500000000  0.7301587302  0.9006024096  0.8915662651  0.9533132530  0.9578313253  0.6857142857  83.200000000  0.2984843615  0.0619959831  0.0169518461  1300          0.0334586668 
0.9380000000  0.8095238095  0.9580000000  0.7460317460  0.9036144578  0.9036144578  0.9608433735  0.9638554217  0.6698412698  86.400000000  0.2899814868  0.0619959831  0.0172848462  1350          0.0325322723 
0.9600000000  0.8492063492  0.9640000000  0.7539682540  0.8795180723  0.8795180723  0.9307228916  0.9277108434  0.6634920635  89.600000000  0.2747318462  0.0619959831  0.0175238248  1400          0.0325040245 
0.9580000000  0.8412698413  0.9660000000  0.7619047619  0.8975903614  0.9036144578  0.9638554217  0.9638554217  0.6857142857  92.800000000  0.2730405775  0.0619959831  0.0173876758  1450          0.0321357536 
0.9640000000  0.8571428571  0.9700000000  0.7777777778  0.9066265060  0.9036144578  0.9638554217  0.9638554217  0.6714285714  96.000000000  0.2628393283  0.0619959831  0.0174610336  1500          0.0345880461 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3262944221 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.3333333333  3.2000000000  1.0863952875  0.0585069656  0.0035801551  50            0.0318747139 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.3400000000  6.4000000000  1.0156705594  0.0585069656  0.0033667640  100           0.0311363411 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.3400000000  9.6000000000  0.9642919290  0.0586066246  0.0036399547  150           0.0315572786 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.3666666667  12.800000000  0.9088471997  0.0586066246  0.0040172963  200           0.0327828884 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.4000000000  16.000000000  0.8264292121  0.0614504814  0.0041483414  250           0.0323157310 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.4633333333  19.200000000  0.7424530327  0.0614504814  0.0043478890  300           0.0349140358 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.8000000000  22.400000000  0.6723435402  0.0614504814  0.0049792113  350           0.0321742249 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.8600000000  25.600000000  0.6225443816  0.0614504814  0.0063166928  400           0.0323724794 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.8500000000  28.800000000  0.5896604264  0.0614504814  0.0077219444  450           0.0315206146 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.8066666667  32.000000000  0.5433739918  0.0614504814  0.0095699535  500           0.0318442726 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.8833333333  35.200000000  0.5112437510  0.0614504814  0.0111136780  550           0.0313578796 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.8300000000  38.400000000  0.4874049777  0.0614504814  0.0126885303  600           0.0319923496 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.8433333333  41.600000000  0.4726694584  0.0614504814  0.0134815287  650           0.0326138973 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.8066666667  44.800000000  0.4451555741  0.0614504814  0.0147170640  700           0.0332310200 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.8400000000  48.000000000  0.4351268834  0.0614504814  0.0149744838  750           0.0305303860 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.8133333333  51.200000000  0.4126618165  0.0614504814  0.0150636691  800           0.0318287611 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.8533333333  54.400000000  0.4068649602  0.0614504814  0.0155919066  850           0.0315992880 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    with open(os.path.join(args.output_dir, 'done'), 'w') as f:
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1524477005  0.0539798737  0.2110469639  0             0.3391590118 
0.4220000000  0.4126984127  0.3880000000  0.3571428571  0.6611445783  0.6204819277  0.6219879518  0.6204819277  0.3333333333  3.2000000000  1.0876426578  0.0605225563  0.0848252965  50            0.0130198574 
0.4380000000  0.4206349206  0.4120000000  0.3888888889  0.6987951807  0.6506024096  0.8237951807  0.7771084337  0.3366666667  6.4000000000  1.0128150296  0.0605225563  0.0793189414  100           0.0133880901 
0.4560000000  0.4523809524  0.4420000000  0.4206349206  0.7213855422  0.7048192771  0.8734939759  0.8313253012  0.3366666667  9.6000000000  0.9514655769  0.0605478287  0.1197353540  150           0.0139405775 
0.5200000000  0.4682539683  0.5060000000  0.4761904762  0.7560240964  0.7349397590  0.8795180723  0.8554216867  0.3433333333  12.800000000  0.8958815205  0.0605478287  0.1821986547  200           0.0139239550 
0.5620000000  0.5000000000  0.5380000000  0.4761904762  0.7786144578  0.7530120482  0.8840361446  0.8493975904  0.3500000000  16.000000000  0.8218774366  0.0605478287  0.2651867965  250           0.0140076017 
0.5880000000  0.5158730159  0.5760000000  0.5158730159  0.8524096386  0.7590361446  0.8674698795  0.8433734940  0.3566666667  19.200000000  0.7635530806  0.0609641075  0.3599688011  300           0.0129466248 
0.6420000000  0.5396825397  0.6500000000  0.5873015873  0.8524096386  0.7710843373  0.8765060241  0.8433734940  0.4766666667  22.400000000  0.7062480283  0.0609641075  0.4692000014  350           0.0129696655 
0.6700000000  0.6190476190  0.6940000000  0.5793650794  0.8765060241  0.7951807229  0.8825301205  0.8554216867  0.6266666667  25.600000000  0.6624762392  0.0609641075  0.6004446644  400           0.0130975819 
0.6800000000  0.6349206349  0.6940000000  0.5714285714  0.8915662651  0.7951807229  0.8795180723  0.8674698795  0.6833333333  28.800000000  0.6268118942  0.0609641075  0.6926501572  450           0.0133261061 
0.7220000000  0.6507936508  0.7120000000  0.6031746032  0.8795180723  0.7951807229  0.9096385542  0.9036144578  0.7266666667  32.000000000  0.5886018217  0.0609641075  0.8092807388  500           0.0139832687 
0.7460000000  0.6746031746  0.7260000000  0.5952380952  0.8780120482  0.8012048193  0.9337349398  0.9277108434  0.7466666667  35.200000000  0.5585034013  0.0609641075  0.8739057028  550           0.0130317068 
0.7620000000  0.6746031746  0.7340000000  0.6031746032  0.8975903614  0.8072289157  0.9442771084  0.9457831325  0.7633333333  38.400000000  0.5487112606  0.0609641075  0.9255547273  600           0.0127040434 
0.7900000000  0.7142857143  0.7600000000  0.5952380952  0.8975903614  0.8072289157  0.9442771084  0.9457831325  0.7866666667  41.600000000  0.5341934109  0.0609641075  0.9671792841  650           0.0143182707 
0.8080000000  0.7142857143  0.7720000000  0.6111111111  0.9111445783  0.8253012048  0.9503012048  0.9578313253  0.7700000000  44.800000000  0.5146688318  0.0609641075  1.0132854950  700           0.0134196997 
0.8260000000  0.7142857143  0.7860000000  0.6269841270  0.9156626506  0.8554216867  0.9774096386  0.9939759036  0.7000000000  48.000000000  0.5006609428  0.0609641075  1.0355134189  750           0.0138181257 
0.8480000000  0.7539682540  0.7980000000  0.6031746032  0.9231927711  0.8373493976  0.9774096386  0.9939759036  0.7533333333  51.200000000  0.4859842765  0.0609641075  1.0566707718  800           0.0128440523 
0.8400000000  0.7539682540  0.8060000000  0.6269841270  0.9307228916  0.8554216867  0.9834337349  0.9939759036  0.7233333333  54.400000000  0.4750181353  0.0609641075  1.0811847901  850           0.0128856754 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1524477005  0.0539798737  0.2110469639  0             0.3443875313 
0.4220000000  0.4126984127  0.3880000000  0.3571428571  0.6611445783  0.6204819277  0.6219879518  0.6204819277  0.4301587302  3.2000000000  1.0876426578  0.0605187416  0.0848252965  50            0.0139842987 
0.4380000000  0.4206349206  0.4120000000  0.3888888889  0.6987951807  0.6506024096  0.8237951807  0.7771084337  0.4444444444  6.4000000000  1.0128150296  0.0605187416  0.0793189414  100           0.0139157581 
0.4560000000  0.4523809524  0.4420000000  0.4206349206  0.7213855422  0.7048192771  0.8734939759  0.8313253012  0.4761904762  9.6000000000  0.9514655769  0.0605187416  0.1197353540  150           0.0143875360 
0.5200000000  0.4682539683  0.5060000000  0.4761904762  0.7560240964  0.7349397590  0.8795180723  0.8554216867  0.5158730159  12.800000000  0.8958815205  0.0605187416  0.1821986547  200           0.0138445425 
0.5620000000  0.5000000000  0.5380000000  0.4761904762  0.7786144578  0.7530120482  0.8840361446  0.8493975904  0.5428571429  16.000000000  0.8218774366  0.0605187416  0.2651867965  250           0.0131202507 
0.5880000000  0.5158730159  0.5760000000  0.5158730159  0.8524096386  0.7590361446  0.8674698795  0.8433734940  0.5587301587  19.200000000  0.7635530806  0.0605187416  0.3599688011  300           0.0129267740 
0.6420000000  0.5396825397  0.6500000000  0.5873015873  0.8524096386  0.7710843373  0.8765060241  0.8433734940  0.5952380952  22.400000000  0.7062480283  0.0605435371  0.4692000014  350           0.0130983162 
0.6700000000  0.6190476190  0.6940000000  0.5793650794  0.8765060241  0.7951807229  0.8825301205  0.8554216867  0.6587301587  25.600000000  0.6624762392  0.0605435371  0.6004446644  400           0.0132893181 
0.6800000000  0.6349206349  0.6940000000  0.5714285714  0.8915662651  0.7951807229  0.8795180723  0.8674698795  0.6650793651  28.800000000  0.6268118942  0.0605435371  0.6926501572  450           0.0131059980 
0.7220000000  0.6507936508  0.7120000000  0.6031746032  0.8795180723  0.7951807229  0.9096385542  0.9036144578  0.6841269841  32.000000000  0.5886018217  0.0620131493  0.8092807388  500           0.0133176184 
0.7460000000  0.6746031746  0.7260000000  0.5952380952  0.8780120482  0.8012048193  0.9337349398  0.9277108434  0.6936507937  35.200000000  0.5585034013  0.0620131493  0.8739057028  550           0.0132559347 
0.7620000000  0.6746031746  0.7340000000  0.6031746032  0.8975903614  0.8072289157  0.9442771084  0.9457831325  0.7000000000  38.400000000  0.5487112606  0.0620131493  0.9255547273  600           0.0133070278 
0.7900000000  0.7142857143  0.7600000000  0.5952380952  0.8975903614  0.8072289157  0.9442771084  0.9457831325  0.6904761905  41.600000000  0.5341934109  0.0620131493  0.9671792841  650           0.0131744528 
0.8080000000  0.7142857143  0.7720000000  0.6111111111  0.9111445783  0.8253012048  0.9503012048  0.9578313253  0.6920634921  44.800000000  0.5146688318  0.0620131493  1.0132854950  700           0.0128564167 
0.8260000000  0.7142857143  0.7860000000  0.6269841270  0.9156626506  0.8554216867  0.9774096386  0.9939759036  0.7015873016  48.000000000  0.5006609428  0.0620131493  1.0355134189  750           0.0133373308 
0.8480000000  0.7539682540  0.7980000000  0.6031746032  0.9231927711  0.8373493976  0.9774096386  0.9939759036  0.6777777778  51.200000000  0.4859842765  0.0620131493  1.0566707718  800           0.0128566504 
0.8400000000  0.7539682540  0.8060000000  0.6269841270  0.9307228916  0.8554216867  0.9834337349  0.9939759036  0.6888888889  54.400000000  0.4750181353  0.0620131493  1.0811847901  850           0.0132673073 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: SD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.1524477005  0.0539798737  0.2110469639  0             0.3202364445 
0.8560000000  0.8253968254  0.8500000000  0.6666666667  0.9638554217  0.9518072289  1.0000000000  1.0000000000  0.6746031746  3.2000000000  0.6267833030  0.0604572296  0.9324540059  50            0.0133348560 
0.9780000000  0.9682539683  0.9580000000  0.8333333333  0.9668674699  0.9518072289  1.0000000000  1.0000000000  0.4698412698  6.4000000000  0.3476204589  0.0605158806  1.3414526320  100           0.0138238811 
1.0000000000  0.9761904762  0.9960000000  0.9444444444  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5492063492  9.6000000000  0.2189122429  0.0608596802  1.5281972241  150           0.0133249998 
1.0000000000  0.9841269841  1.0000000000  0.9920634921  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5269841270  12.800000000  0.1780410495  0.0608596802  1.6001168370  200           0.0129474306 
1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4888888889  16.000000000  0.1591288146  0.0608596802  1.6257793808  250           0.0132163048 
1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4888888889  19.200000000  0.1511535066  0.0608596802  1.6137769079  300           0.0136688662 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4873015873  22.400000000  0.1449973294  0.0608596802  1.6225326991  350           0.0135393238 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4222222222  25.600000000  0.1433196640  0.0608596802  1.6142144537  400           0.0139661980 
1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5126984127  28.800000000  0.1410796562  0.0608596802  1.6116420960  450           0.0134465075 
1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4206349206  32.000000000  0.1389535984  0.0608596802  1.6124257207  500           0.0130390596 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5111111111  35.200000000  0.1376968518  0.0608596802  1.6115222716  550           0.0131473112 
1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3857142857  38.400000000  0.1364463417  0.0634307861  1.6110302258  600           0.0130669880 
1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4047619048  41.600000000  0.1361728142  0.0634307861  1.6082446456  650           0.0131732607 
1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4619047619  44.800000000  0.1353285480  0.0634307861  1.6064076328  700           0.0144613552 
1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4714285714  48.000000000  0.1347826840  0.0634307861  1.6069827914  750           0.0133106899 
1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4190476190  51.200000000  0.1338272442  0.0634307861  1.6044697022  800           0.0130014372 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4603174603  54.400000000  0.1339835407  0.0634307861  1.6003373337  850           0.0131824160 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: CORAL
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Python 3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
Type 'copyright', 'credits' or 'license' for more information
IPython 7.16.1 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.16.1

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/IPython/core/interactiveshell.py", line 3343, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-1-c6f9a0240ec6>", line 1, in <module>
    f_all = torch.cat(x for x in features)
TypeError: cat(): argument 'tensors' (position 1) must be tuple of Tensors, not generator
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 694, in update
    classifs = [self.classifier(fi) for fi in features]   # 
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2112, in update
    objective = loss + self.sd_reg * penalty
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'DROMMD' object has no attribute 'sd_reg'
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2112, in update
    objective = loss + self.sd_reg * penalty
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'DROMMD' object has no attribute 'sd_reg'
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2112, in update
    objective = loss + self.sd_reg * penalty
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'DROMMD' object has no attribute 'sd_reg'
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521564484  0.2022679299  0             0.3325533867 
0.4240000000  0.4126984127  0.3780000000  0.3571428571  0.6566265060  0.6385542169  0.6024096386  0.5903614458  0.4269841270  3.2000000000  1.0873769069  0.0585045815  0.0842489345  50            0.0280887032 
0.4400000000  0.4285714286  0.4140000000  0.4047619048  0.7168674699  0.6987951807  0.7921686747  0.7710843373  0.4460317460  6.4000000000  1.0183649182  0.0585937500  0.0769745577  100           0.0277135420 
0.4880000000  0.4682539683  0.4540000000  0.4444444444  0.7439759036  0.7108433735  0.8493975904  0.7951807229  0.4698412698  9.6000000000  0.9689095998  0.0585937500  0.1080684876  150           0.0281759596 
0.5720000000  0.5396825397  0.5500000000  0.4920634921  0.7515060241  0.7289156627  0.8418674699  0.7891566265  0.5301587302  12.800000000  0.9180920005  0.0585937500  0.1539507835  200           0.0285539770 
0.6020000000  0.5317460317  0.6000000000  0.5000000000  0.7469879518  0.7228915663  0.8433734940  0.7951807229  0.5190476190  16.000000000  0.8435693073  0.0585937500  0.2252548170  250           0.0280575180 
0.6320000000  0.5714285714  0.6440000000  0.5396825397  0.7786144578  0.7650602410  0.8599397590  0.8253012048  0.5365079365  19.200000000  0.7668210936  0.0586190224  0.3249594793  300           0.0279991579 
0.6620000000  0.5873015873  0.7220000000  0.5714285714  0.7725903614  0.7650602410  0.8403614458  0.8072289157  0.5777777778  22.400000000  0.7046243215  0.0586190224  0.4504084516  350           0.0277481318 
0.6960000000  0.6190476190  0.7260000000  0.5793650794  0.8027108434  0.7891566265  0.8584337349  0.8433734940  0.6317460317  25.600000000  0.6607714391  0.0586190224  0.6016192544  400           0.0286199617 
0.7080000000  0.6428571429  0.7400000000  0.5555555556  0.7951807229  0.7469879518  0.8795180723  0.8433734940  0.6460317460  28.800000000  0.6365184987  0.0586190224  0.6982232034  450           0.0281133080 
0.7200000000  0.6428571429  0.7340000000  0.5634920635  0.8222891566  0.7951807229  0.8975903614  0.8795180723  0.6571428571  32.000000000  0.5988964808  0.0586190224  0.7998821855  500           0.0282924604 
0.7820000000  0.6904761905  0.7640000000  0.6269841270  0.8584337349  0.8313253012  0.8975903614  0.9036144578  0.6984126984  35.200000000  0.5751795292  0.0586190224  0.8780784285  550           0.0282808208 
0.7720000000  0.6507936508  0.7560000000  0.5952380952  0.8629518072  0.8373493976  0.9111445783  0.9096385542  0.6746031746  38.400000000  0.5568938881  0.0586190224  0.9356113434  600           0.0278701639 
0.7960000000  0.6825396825  0.7480000000  0.5634920635  0.8659638554  0.8373493976  0.9036144578  0.8915662651  0.6714285714  41.600000000  0.5440513408  0.0586190224  0.9724478805  650           0.0284696436 
0.7860000000  0.6666666667  0.7600000000  0.6031746032  0.8975903614  0.8674698795  0.9231927711  0.9216867470  0.6571428571  44.800000000  0.5209035420  0.0600466728  1.0206177866  700           0.0279257965 
0.8220000000  0.6984126984  0.7660000000  0.6190476190  0.8960843373  0.8855421687  0.9352409639  0.9578313253  0.6841269841  48.000000000  0.5138982695  0.0600466728  1.0340378189  750           0.0286531067 
0.8300000000  0.7142857143  0.7760000000  0.6031746032  0.9216867470  0.8915662651  0.9367469880  0.9397590361  0.6682539683  51.200000000  0.4955055630  0.0605058670  1.0597606158  800           0.0286062527 
0.8660000000  0.7380952381  0.8300000000  0.6349206349  0.9021084337  0.8975903614  0.9322289157  0.9457831325  0.6730158730  54.400000000  0.4877481371  0.0614194870  1.0821420228  850           0.0290494585 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3355767727 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.4142857143  3.2000000000  1.0863952875  0.0585069656  0.0035801551  50            0.0316457987 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.4492063492  6.4000000000  1.0156705594  0.0585513115  0.0033667640  100           0.0322627258 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.4857142857  9.6000000000  0.9642919290  0.0585651398  0.0036399547  150           0.0325314045 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.5412698413  12.800000000  0.9088471997  0.0585994720  0.0040172963  200           0.0328253698 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.5222222222  16.000000000  0.8264292121  0.0585994720  0.0041483414  250           0.0324245405 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.5444444444  19.200000000  0.7424530327  0.0585994720  0.0043478890  300           0.0317089415 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.5825396825  22.400000000  0.6723435402  0.0585994720  0.0049792113  350           0.0327796650 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.6412698413  25.600000000  0.6225443816  0.0585994720  0.0063166928  400           0.0325280857 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.6523809524  28.800000000  0.5896604264  0.0585994720  0.0077219444  450           0.0311783695 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.6793650794  32.000000000  0.5433739918  0.0605340004  0.0095699535  500           0.0322009706 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.7142857143  35.200000000  0.5112437510  0.0605340004  0.0111136780  550           0.0317037582 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.7111111111  38.400000000  0.4874049777  0.0605340004  0.0126885303  600           0.0326161814 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.6936507937  41.600000000  0.4726694584  0.0605340004  0.0134815287  650           0.0319245481 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.6904761905  44.800000000  0.4451555741  0.0605340004  0.0147170640  700           0.0320300961 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.7126984127  48.000000000  0.4351268834  0.0605340004  0.0149744838  750           0.0330320883 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.6873015873  51.200000000  0.4126618165  0.0605340004  0.0150636691  800           0.0328220892 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.6904761905  54.400000000  0.4068649602  0.0605340004  0.0155919066  850           0.0319619608 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521550179  0.0046365983  0             0.3632392883 
0.4200000000  0.4126984127  0.3700000000  0.3571428571  0.6219879518  0.5963855422  0.6370481928  0.6084337349  0.3333333333  3.2000000000  1.0863952875  0.0584840775  0.0035801551  50            0.0319880676 
0.4420000000  0.4444444444  0.4160000000  0.4047619048  0.7018072289  0.6867469880  0.8087349398  0.7650602410  0.3400000000  6.4000000000  1.0156705594  0.0584840775  0.0033667640  100           0.0319498920 
0.4960000000  0.4682539683  0.4600000000  0.4523809524  0.7228915663  0.6987951807  0.8569277108  0.8012048193  0.3400000000  9.6000000000  0.9642919290  0.0584840775  0.0036399547  150           0.0309943438 
0.5780000000  0.5396825397  0.5580000000  0.4920634921  0.7394578313  0.7289156627  0.8493975904  0.7951807229  0.3666666667  12.800000000  0.9088471997  0.0585322380  0.0040172963  200           0.0321038437 
0.5980000000  0.5317460317  0.6040000000  0.5158730159  0.7274096386  0.7168674699  0.8524096386  0.8072289157  0.4000000000  16.000000000  0.8264292121  0.0585322380  0.0041483414  250           0.0331640768 
0.6280000000  0.5476190476  0.6360000000  0.5396825397  0.7439759036  0.7469879518  0.8539156627  0.8253012048  0.4633333333  19.200000000  0.7424530327  0.0602688789  0.0043478890  300           0.0331414747 
0.6600000000  0.5714285714  0.7140000000  0.5793650794  0.7590361446  0.7349397590  0.8162650602  0.7951807229  0.8000000000  22.400000000  0.6723435402  0.0602688789  0.0049792113  350           0.0315798950 
0.6800000000  0.6190476190  0.6980000000  0.5873015873  0.8087349398  0.8012048193  0.8147590361  0.8012048193  0.8600000000  25.600000000  0.6225443816  0.0602688789  0.0063166928  400           0.0326173258 
0.6940000000  0.6349206349  0.7260000000  0.5476190476  0.7740963855  0.7469879518  0.8478915663  0.8253012048  0.8500000000  28.800000000  0.5896604264  0.0602688789  0.0077219444  450           0.0323378181 
0.7100000000  0.6428571429  0.7240000000  0.5714285714  0.8132530120  0.8192771084  0.8840361446  0.8855421687  0.8066666667  32.000000000  0.5433739918  0.0602688789  0.0095699535  500           0.0319907379 
0.7780000000  0.6746031746  0.7420000000  0.5952380952  0.8569277108  0.8253012048  0.8554216867  0.8554216867  0.8833333333  35.200000000  0.5112437510  0.0610394478  0.0111136780  550           0.0322343588 
0.7700000000  0.6587301587  0.7420000000  0.5952380952  0.8524096386  0.8313253012  0.8960843373  0.8975903614  0.8300000000  38.400000000  0.4874049777  0.0610394478  0.0126885303  600           0.0327864599 
0.7880000000  0.6746031746  0.7540000000  0.5873015873  0.8539156627  0.8253012048  0.8704819277  0.8674698795  0.8433333333  41.600000000  0.4726694584  0.0610394478  0.0134815287  650           0.0326617527 
0.7980000000  0.6825396825  0.7420000000  0.6031746032  0.8719879518  0.8493975904  0.9081325301  0.9096385542  0.8066666667  44.800000000  0.4451555741  0.0610394478  0.0147170640  700           0.0318135881 
0.8300000000  0.7301587302  0.7780000000  0.6111111111  0.8734939759  0.8674698795  0.9066265060  0.9277108434  0.8400000000  48.000000000  0.4351268834  0.0617799759  0.0149744838  750           0.0323432779 
0.8280000000  0.7222222222  0.7700000000  0.5952380952  0.8930722892  0.8614457831  0.9216867470  0.9397590361  0.8133333333  51.200000000  0.4126618165  0.0617799759  0.0150636691  800           0.0320684624 
0.8700000000  0.7698412698  0.8260000000  0.6190476190  0.8704819277  0.8674698795  0.8689759036  0.8855421687  0.8533333333  54.400000000  0.4068649602  0.0617799759  0.0155919066  850           0.0324217987 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1192054749  0.0521564484  0.2022679299  0             0.3281776905 
0.4240000000  0.4126984127  0.3780000000  0.3571428571  0.6566265060  0.6385542169  0.6024096386  0.5903614458  0.3333333333  3.2000000000  1.0873769069  0.0584602356  0.0842489345  50            0.0275284529 
0.4400000000  0.4285714286  0.4140000000  0.4047619048  0.7168674699  0.6987951807  0.7921686747  0.7710843373  0.3366666667  6.4000000000  1.0183649182  0.0614795685  0.0769745577  100           0.0286726761 
0.4880000000  0.4682539683  0.4540000000  0.4444444444  0.7439759036  0.7108433735  0.8493975904  0.7951807229  0.3366666667  9.6000000000  0.9689095998  0.0614867210  0.1080684876  150           0.0283202457 
0.5720000000  0.5396825397  0.5500000000  0.4920634921  0.7515060241  0.7289156627  0.8418674699  0.7891566265  0.3533333333  12.800000000  0.9180920005  0.0614867210  0.1539507835  200           0.0284682846 
0.6020000000  0.5317460317  0.6000000000  0.5000000000  0.7469879518  0.7228915663  0.8433734940  0.7951807229  0.3833333333  16.000000000  0.8435693073  0.0614867210  0.2252548170  250           0.0282053852 
0.6320000000  0.5714285714  0.6440000000  0.5396825397  0.7786144578  0.7650602410  0.8599397590  0.8253012048  0.4466666667  19.200000000  0.7668210936  0.0614867210  0.3249594793  300           0.0283163071 
0.6620000000  0.5873015873  0.7220000000  0.5714285714  0.7725903614  0.7650602410  0.8403614458  0.8072289157  0.7500000000  22.400000000  0.7046243215  0.0614867210  0.4504084516  350           0.0293911552 
0.6960000000  0.6190476190  0.7260000000  0.5793650794  0.8027108434  0.7891566265  0.8584337349  0.8433734940  0.7866666667  25.600000000  0.6607714391  0.0614867210  0.6016192544  400           0.0288072872 
0.7080000000  0.6428571429  0.7400000000  0.5555555556  0.7951807229  0.7469879518  0.8795180723  0.8433734940  0.7700000000  28.800000000  0.6365184987  0.0614867210  0.6982232034  450           0.0285265350 
0.7200000000  0.6428571429  0.7340000000  0.5634920635  0.8222891566  0.7951807229  0.8975903614  0.8795180723  0.7133333333  32.000000000  0.5988964808  0.0614867210  0.7998821855  500           0.0277588654 
0.7820000000  0.6904761905  0.7640000000  0.6269841270  0.8584337349  0.8313253012  0.8975903614  0.9036144578  0.7900000000  35.200000000  0.5751795292  0.0614867210  0.8780784285  550           0.0277599192 
0.7720000000  0.6507936508  0.7560000000  0.5952380952  0.8629518072  0.8373493976  0.9111445783  0.9096385542  0.7100000000  38.400000000  0.5568938881  0.0614867210  0.9356113434  600           0.0280848837 
0.7960000000  0.6825396825  0.7480000000  0.5634920635  0.8659638554  0.8373493976  0.9036144578  0.8915662651  0.7666666667  41.600000000  0.5440513408  0.0614867210  0.9724478805  650           0.0285763502 
0.7860000000  0.6666666667  0.7600000000  0.6031746032  0.8975903614  0.8674698795  0.9231927711  0.9216867470  0.6933333333  44.800000000  0.5209035420  0.0614867210  1.0206177866  700           0.0295002842 
0.8220000000  0.6984126984  0.7660000000  0.6190476190  0.8960843373  0.8855421687  0.9352409639  0.9578313253  0.7500000000  48.000000000  0.5138982695  0.0614867210  1.0340378189  750           0.0284432840 
0.8300000000  0.7142857143  0.7760000000  0.6031746032  0.9216867470  0.8915662651  0.9367469880  0.9397590361  0.7566666667  51.200000000  0.4955055630  0.0614867210  1.0597606158  800           0.0290586233 
0.8660000000  0.7380952381  0.8300000000  0.6349206349  0.9021084337  0.8975903614  0.9322289157  0.9457831325  0.7833333333  54.400000000  0.4877481371  0.0614867210  1.0821420228  850           0.0287937975 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Mixup
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mixup_alpha: 0.15
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1278418303  0.0523958206  0             0.3315362930 
0.4060000000  0.3968253968  0.3700000000  0.3412698413  0.5873493976  0.5542168675  0.6325301205  0.5903614458  0.3333333333  3.2000000000  1.0925702572  0.0587482452  50            0.0286675549 
0.4260000000  0.4206349206  0.4120000000  0.3968253968  0.6596385542  0.6506024096  0.8328313253  0.7891566265  0.3366666667  6.4000000000  1.0306498301  0.0587482452  100           0.0273602676 
0.4480000000  0.4444444444  0.4360000000  0.4206349206  0.7439759036  0.7228915663  0.8478915663  0.8012048193  0.3400000000  9.6000000000  0.9784752476  0.0588269234  150           0.0281049252 
0.5280000000  0.4682539683  0.5000000000  0.4841269841  0.7590361446  0.7349397590  0.8328313253  0.7891566265  0.3433333333  12.800000000  0.9249290371  0.0588269234  200           0.0276823187 
0.5480000000  0.5079365079  0.5300000000  0.4841269841  0.7635542169  0.7530120482  0.8629518072  0.8132530120  0.3533333333  16.000000000  0.8617619359  0.0588269234  250           0.0285491514 
0.5680000000  0.5079365079  0.5440000000  0.4682539683  0.8027108434  0.8132530120  0.8795180723  0.8554216867  0.3500000000  19.200000000  0.8042158568  0.0588269234  300           0.0289465761 
0.5800000000  0.5317460317  0.5860000000  0.4920634921  0.7861445783  0.7590361446  0.8900602410  0.8493975904  0.3766666667  22.400000000  0.7423637915  0.0588269234  350           0.0280669403 
0.6300000000  0.5793650794  0.6680000000  0.5714285714  0.8343373494  0.8313253012  0.8524096386  0.8313253012  0.5500000000  25.600000000  0.7143330371  0.0588421822  400           0.0290965271 
0.6320000000  0.5555555556  0.6620000000  0.5793650794  0.8283132530  0.8072289157  0.8855421687  0.8433734940  0.5933333333  28.800000000  0.6677151346  0.0589008331  450           0.0287021399 
0.6680000000  0.6111111111  0.7000000000  0.5873015873  0.8509036145  0.8373493976  0.8719879518  0.8373493976  0.6666666667  32.000000000  0.6320501834  0.0589008331  500           0.0286857986 
0.7020000000  0.6190476190  0.7160000000  0.6031746032  0.8644578313  0.8554216867  0.8554216867  0.8313253012  0.7733333333  35.200000000  0.6186578614  0.0589008331  550           0.0287539482 
0.6840000000  0.6507936508  0.6880000000  0.6111111111  0.8704819277  0.8554216867  0.9096385542  0.8915662651  0.6700000000  38.400000000  0.5840875697  0.0589008331  600           0.0291047430 
0.7360000000  0.6428571429  0.7340000000  0.6269841270  0.8750000000  0.8734939759  0.9111445783  0.9096385542  0.7566666667  41.600000000  0.5852439821  0.0589008331  650           0.0291702604 
0.7600000000  0.6666666667  0.7380000000  0.6269841270  0.8780120482  0.8734939759  0.9096385542  0.9156626506  0.7533333333  44.800000000  0.5535121644  0.0589008331  700           0.0286731291 
0.7380000000  0.6269841270  0.7120000000  0.5793650794  0.8840361446  0.8614457831  0.9292168675  0.9337349398  0.7000000000  48.000000000  0.5525724339  0.0589008331  750           0.0280051899 
0.7640000000  0.6507936508  0.7420000000  0.6190476190  0.8840361446  0.8734939759  0.9412650602  0.9578313253  0.7233333333  51.200000000  0.5164595836  0.0589985847  800           0.0297965574 
0.7540000000  0.6587301587  0.7500000000  0.6349206349  0.8840361446  0.8734939759  0.9503012048  0.9698795181  0.6833333333  54.400000000  0.5305978900  0.0589985847  850           0.0289111328 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4631328583 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0605201721  50            0.1677586317 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0605201721  100           0.1684040403 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0605816841  150           0.1720122194 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0605816841  200           0.1715037775 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0606236458  250           0.1701692343 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0606236458  300           0.1697996998 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0606236458  350           0.1757226801 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0606374741  400           0.1692501450 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0606374741  450           0.1790768480 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0606374741  500           0.1692619467 
0.8840000000  0.8968253968  0.8900000000  0.7936507937  0.8885542169  0.8554216867  0.8403614458  0.8554216867  0.7507936508  35.200000000  0.2419313052  0.3252618343  0.0606374741  550           0.1729663610 
0.9100000000  0.9365079365  0.8640000000  0.7936507937  0.8750000000  0.8614457831  0.9713855422  0.9578313253  0.4380952381  38.400000000  0.2657356302  0.2643318608  0.0606374741  600           0.1771503067 
0.9660000000  0.9365079365  0.9920000000  0.9047619048  0.8885542169  0.9036144578  1.0000000000  1.0000000000  0.4761904762  41.600000000  0.2468533722  0.2249038902  0.0606641769  650           0.1735656595 
0.9660000000  0.9841269841  0.9880000000  0.9126984127  0.9021084337  0.9216867470  1.0000000000  1.0000000000  0.7047619048  44.800000000  0.2122929779  0.1698070164  0.0609078407  700           0.1785517073 
0.9940000000  0.9761904762  0.9720000000  0.9047619048  0.9774096386  0.9578313253  0.9984939759  0.9939759036  0.6349206349  48.000000000  0.2187857401  0.1379998183  0.0609078407  750           0.1743137074 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1965, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3720000000  0.3650793651  0.3540000000  0.3492063492  0.6490963855  0.6084337349  0.6174698795  0.5662650602  0.3333333333  0.0000000000  0.3615057468  1.1561778784  0.0539793968  0             0.4693055153 
0.5360000000  0.5317460317  0.5360000000  0.5793650794  0.6490963855  0.6084337349  0.6596385542  0.6626506024  0.4466666667  3.2000000000  0.2017986745  1.0208707917  0.0604619980  50            0.1673512936 
0.6400000000  0.6428571429  0.5820000000  0.5952380952  0.7921686747  0.7349397590  0.7605421687  0.7530120482  0.5466666667  6.4000000000  0.2154226691  0.8338650405  0.0631685257  100           0.1698566294 
0.7380000000  0.7539682540  0.7040000000  0.6825396825  0.8012048193  0.8072289157  0.7635542169  0.7409638554  0.5300000000  9.6000000000  0.2517008200  0.6285696876  0.0631685257  150           0.1707088137 
0.7680000000  0.7777777778  0.7180000000  0.6349206349  0.7409638554  0.6506024096  0.6837349398  0.6746987952  0.5633333333  12.800000000  0.2460836294  0.5246899807  0.0631685257  200           0.1737880564 
0.6720000000  0.6904761905  0.6680000000  0.6666666667  0.9774096386  0.9457831325  0.8539156627  0.8253012048  0.3433333333  16.000000000  0.2839040297  0.4811392301  0.0631685257  250           0.1756463575 
0.8140000000  0.8492063492  0.8200000000  0.7777777778  0.7756024096  0.8132530120  0.9849397590  0.9759036145  0.2100000000  19.200000000  0.2426318544  0.4505567020  0.0631685257  300           0.1725810480 
0.8360000000  0.8412698413  0.8360000000  0.8174603175  0.8885542169  0.9036144578  0.9894578313  0.9819277108  0.3066666667  22.400000000  0.2463013878  0.4011737651  0.0631685257  350           0.1687227774 
0.8080000000  0.8253968254  0.8240000000  0.7857142857  0.9111445783  0.8734939759  0.8388554217  0.8614457831  0.4233333333  25.600000000  0.2485448140  0.3718120098  0.0631685257  400           0.1721656895 
0.8640000000  0.8571428571  0.8500000000  0.8015873016  0.8689759036  0.8614457831  0.9653614458  0.9698795181  0.3300000000  28.800000000  0.2779712018  0.3450753987  0.0631685257  450           0.1733780432 
0.8500000000  0.8333333333  0.8820000000  0.8412698413  0.8930722892  0.8614457831  0.9728915663  0.9638554217  0.3200000000  32.000000000  0.2253262275  0.2917491800  0.0631685257  500           0.1668878937 
0.9360000000  0.9444444444  0.9360000000  0.8809523810  0.9307228916  0.8915662651  0.8343373494  0.8674698795  0.3333333333  35.200000000  0.2687938143  0.2736084631  0.0631685257  550           0.1686626005 
0.9480000000  0.9285714286  0.9700000000  0.9206349206  0.9849397590  0.9879518072  0.8900602410  0.9337349398  0.3300000000  38.400000000  0.2783926141  0.2403288537  0.0631685257  600           0.1663654900 
0.9660000000  0.9523809524  0.9660000000  0.8968253968  0.9759036145  0.9638554217  0.9608433735  0.9518072289  0.3333333333  41.600000000  0.2387436806  0.1817065758  0.0631685257  650           0.1701544380 
0.9620000000  0.9444444444  0.9740000000  0.9206349206  0.9292168675  0.9457831325  1.0000000000  1.0000000000  0.3500000000  44.800000000  0.2345488055  0.1615230285  0.0631685257  700           0.1745574522 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1965, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3960843373  0.3674698795  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3275811672 
0.8340000000  0.8015873016  0.6940000000  0.7142857143  0.8328313253  0.8373493976  0.9789156627  0.9759036145  0.6433333333  3.2000000000  0.5151218218  0.0584545135  50            0.0278690195 
0.9500000000  0.8888888889  0.9080000000  0.8333333333  0.9728915663  0.9277108434  0.9969879518  0.9879518072  0.5700000000  6.4000000000  0.2053392652  0.0613946915  100           0.0285418367 
0.9800000000  0.9285714286  0.9840000000  0.9523809524  0.9668674699  0.9397590361  0.9834337349  0.9819277108  0.4866666667  9.6000000000  0.1038684525  0.0613946915  150           0.0278651619 
0.9800000000  0.9126984127  0.9720000000  0.9047619048  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.5100000000  12.800000000  0.0394192308  0.0613946915  200           0.0276955175 
1.0000000000  0.9841269841  0.9960000000  0.9444444444  0.9186746988  0.8915662651  0.9593373494  0.9819277108  0.4200000000  16.000000000  0.0268516193  0.0613946915  250           0.0279565191 
1.0000000000  0.9920634921  0.9980000000  0.9682539683  0.9548192771  0.9156626506  0.9849397590  0.9879518072  0.4033333333  19.200000000  0.0219132745  0.0613946915  300           0.0287365294 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.9894578313  0.9819277108  0.9984939759  0.9939759036  0.4000000000  22.400000000  0.0101959666  0.0613946915  350           0.0280184031 
0.9960000000  0.9841269841  0.9920000000  0.9841269841  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.4466666667  25.600000000  0.0123701479  0.0613946915  400           0.0285023832 
1.0000000000  0.9603174603  0.9960000000  0.9444444444  0.9533132530  0.9216867470  0.9924698795  0.9939759036  0.3800000000  28.800000000  0.0107058332  0.0613946915  450           0.0282493544 
1.0000000000  0.9841269841  0.9980000000  0.9761904762  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.4566666667  32.000000000  0.0134816373  0.0613946915  500           0.0285873127 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9849397590  0.9397590361  0.9984939759  0.9939759036  0.4700000000  35.200000000  0.0112589381  0.0613946915  550           0.0283553076 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.4133333333  38.400000000  0.0048939074  0.0613946915  600           0.0289117908 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9909638554  0.9518072289  1.0000000000  1.0000000000  0.4066666667  41.600000000  0.0055699067  0.0613946915  650           0.0288327551 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9894578313  0.9698795181  1.0000000000  1.0000000000  0.3900000000  44.800000000  0.0027473035  0.0613946915  700           0.0283097458 
1.0000000000  0.9920634921  1.0000000000  0.9523809524  0.9563253012  0.9096385542  0.9939759036  0.9879518072  0.3500000000  48.000000000  0.0053606867  0.0613946915  750           0.0286553574 
1.0000000000  0.9761904762  0.9980000000  0.9761904762  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.4066666667  51.200000000  0.0039572465  0.0613946915  800           0.0284506750 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9969879518  0.9879518072  1.0000000000  1.0000000000  0.3533333333  54.400000000  0.0029241914  0.0613946915  850           0.0286485815 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3117469880  0.3192771084  0.3960843373  0.3674698795  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.4822618961 
0.8340000000  0.8015873016  0.6940000000  0.7142857143  0.8328313253  0.8373493976  0.9789156627  0.9759036145  0.7079365079  3.2000000000  0.5151218218  0.0604677200  50            0.0285029125 
0.9500000000  0.8888888889  0.9080000000  0.8333333333  0.9728915663  0.9277108434  0.9969879518  0.9879518072  0.8396825397  6.4000000000  0.2053392652  0.0604677200  100           0.0288398266 
0.9800000000  0.9285714286  0.9840000000  0.9523809524  0.9668674699  0.9397590361  0.9834337349  0.9819277108  0.7460317460  9.6000000000  0.1038684525  0.0604677200  150           0.0296626425 
0.9800000000  0.9126984127  0.9720000000  0.9047619048  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.7380952381  12.800000000  0.0394192308  0.0604677200  200           0.0284560061 
1.0000000000  0.9841269841  0.9960000000  0.9444444444  0.9186746988  0.8915662651  0.9593373494  0.9819277108  0.7396825397  16.000000000  0.0268516193  0.0604677200  250           0.0279199314 
1.0000000000  0.9920634921  0.9980000000  0.9682539683  0.9548192771  0.9156626506  0.9849397590  0.9879518072  0.7047619048  19.200000000  0.0219132745  0.0604677200  300           0.0284871769 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.9894578313  0.9819277108  0.9984939759  0.9939759036  0.7047619048  22.400000000  0.0101959666  0.0604677200  350           0.0277958155 
0.9960000000  0.9841269841  0.9920000000  0.9841269841  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.7873015873  25.600000000  0.0123701479  0.0604677200  400           0.0280594349 
1.0000000000  0.9603174603  0.9960000000  0.9444444444  0.9533132530  0.9216867470  0.9924698795  0.9939759036  0.7952380952  28.800000000  0.0107058332  0.0604677200  450           0.0285347939 
1.0000000000  0.9841269841  0.9980000000  0.9761904762  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.7269841270  32.000000000  0.0134816373  0.0604677200  500           0.0278168631 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9849397590  0.9397590361  0.9984939759  0.9939759036  0.6349206349  35.200000000  0.0112589381  0.0604677200  550           0.0290232372 
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 63, in handler
    def handler(signum, frame):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3554978371 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6460843373  0.6325301205  0.6174698795  0.5903614458  0.3333333333  3.2000000000  1.0885902977  0.0585131645  50            0.0286130238 
0.4400000000  0.3809523810  0.3940000000  0.3492063492  0.7213855422  0.7048192771  0.7906626506  0.7530120482  0.3400000000  6.4000000000  1.0225170028  0.0585131645  100           0.0289721107 
0.4840000000  0.4126984127  0.4300000000  0.3730158730  0.7409638554  0.7349397590  0.8313253012  0.7831325301  0.3400000000  9.6000000000  0.9725380445  0.0605201721  150           0.0285365963 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7665662651  0.7289156627  0.8042168675  0.7590361446  0.3466666667  12.800000000  0.9227569604  0.0615668297  200           0.0279315042 
0.6100000000  0.5079365079  0.5040000000  0.4603174603  0.7620481928  0.7349397590  0.8102409639  0.7710843373  0.3833333333  16.000000000  0.8565853465  0.0615668297  250           0.0288441420 
0.6360000000  0.5317460317  0.5520000000  0.5476190476  0.7575301205  0.7530120482  0.8237951807  0.7650602410  0.4233333333  19.200000000  0.7725161803  0.0615668297  300           0.0282056475 
0.6780000000  0.5396825397  0.6500000000  0.5873015873  0.7650602410  0.7349397590  0.7816265060  0.7530120482  0.6833333333  22.400000000  0.6962408984  0.0615668297  350           0.0274598312 
0.7220000000  0.6349206349  0.6900000000  0.6190476190  0.8027108434  0.7891566265  0.8132530120  0.7590361446  0.8100000000  25.600000000  0.6357664907  0.0615668297  400           0.0290232420 
0.7360000000  0.6428571429  0.6960000000  0.6031746032  0.7680722892  0.7349397590  0.8463855422  0.8072289157  0.7566666667  28.800000000  0.5955067039  0.0615668297  450           0.0285570049 
0.7700000000  0.6666666667  0.7160000000  0.6190476190  0.8147590361  0.7891566265  0.8463855422  0.8192771084  0.8133333333  32.000000000  0.5510424501  0.0615668297  500           0.0284255743 
0.8020000000  0.7063492063  0.7600000000  0.6507936508  0.8524096386  0.8072289157  0.8298192771  0.8253012048  0.8466666667  35.200000000  0.5137320542  0.0615668297  550           0.0288349009 
0.7960000000  0.7063492063  0.7340000000  0.6349206349  0.8509036145  0.8373493976  0.8584337349  0.8674698795  0.8200000000  38.400000000  0.4868571657  0.0615668297  600           0.0269497681 
0.7960000000  0.6904761905  0.7120000000  0.6111111111  0.8509036145  0.8253012048  0.8463855422  0.8192771084  0.7866666667  41.600000000  0.4677641279  0.0615668297  650           0.0283912659 
0.8000000000  0.6904761905  0.7060000000  0.5952380952  0.8659638554  0.8493975904  0.8810240964  0.8734939759  0.7733333333  44.800000000  0.4440859377  0.0615668297  700           0.0270534945 
0.8220000000  0.7539682540  0.7680000000  0.6428571429  0.8614457831  0.8433734940  0.8840361446  0.8975903614  0.7933333333  48.000000000  0.4258887321  0.0615668297  750           0.0280252457 
0.8140000000  0.7142857143  0.7220000000  0.6349206349  0.8780120482  0.8493975904  0.9081325301  0.9096385542  0.7766666667  51.200000000  0.3989466709  0.0615668297  800           0.0283824444 
0.8500000000  0.8015873016  0.8000000000  0.6428571429  0.8524096386  0.8554216867  0.8478915663  0.8614457831  0.7733333333  54.400000000  0.3887472343  0.0615668297  850           0.0280700016 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3592765331 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6460843373  0.6325301205  0.6174698795  0.5903614458  0.4174603175  3.2000000000  1.0885902977  0.0585641861  50            0.0290458250 
0.4400000000  0.3809523810  0.3940000000  0.3492063492  0.7213855422  0.7048192771  0.7906626506  0.7530120482  0.4444444444  6.4000000000  1.0225170028  0.0615019798  100           0.0285075283 
0.4840000000  0.4126984127  0.4300000000  0.3730158730  0.7409638554  0.7349397590  0.8313253012  0.7831325301  0.4873015873  9.6000000000  0.9725380445  0.0615158081  150           0.0292700815 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7665662651  0.7289156627  0.8042168675  0.7590361446  0.5396825397  12.800000000  0.9227569604  0.0640029907  200           0.0283506536 
0.6100000000  0.5079365079  0.5040000000  0.4603174603  0.7620481928  0.7349397590  0.8102409639  0.7710843373  0.5476190476  16.000000000  0.8565853465  0.0640029907  250           0.0278597832 
0.6360000000  0.5317460317  0.5520000000  0.5476190476  0.7575301205  0.7530120482  0.8237951807  0.7650602410  0.5571428571  19.200000000  0.7725161803  0.0640029907  300           0.0286661243 
0.6780000000  0.5396825397  0.6500000000  0.5873015873  0.7650602410  0.7349397590  0.7816265060  0.7530120482  0.6238095238  22.400000000  0.6962408984  0.0640029907  350           0.0271313047 
0.7220000000  0.6349206349  0.6900000000  0.6190476190  0.8027108434  0.7891566265  0.8132530120  0.7590361446  0.6666666667  25.600000000  0.6357664907  0.0640029907  400           0.0285938406 
0.7360000000  0.6428571429  0.6960000000  0.6031746032  0.7680722892  0.7349397590  0.8463855422  0.8072289157  0.6920634921  28.800000000  0.5955067039  0.0640029907  450           0.0274286795 
0.7700000000  0.6666666667  0.7160000000  0.6190476190  0.8147590361  0.7891566265  0.8463855422  0.8192771084  0.7222222222  32.000000000  0.5510424501  0.0640029907  500           0.0291805553 
0.8020000000  0.7063492063  0.7600000000  0.6507936508  0.8524096386  0.8072289157  0.8298192771  0.8253012048  0.7603174603  35.200000000  0.5137320542  0.0640029907  550           0.0282565355 
0.7960000000  0.7063492063  0.7340000000  0.6349206349  0.8509036145  0.8373493976  0.8584337349  0.8674698795  0.7587301587  38.400000000  0.4868571657  0.0640029907  600           0.0281789494 
0.7960000000  0.6904761905  0.7120000000  0.6111111111  0.8509036145  0.8253012048  0.8463855422  0.8192771084  0.7507936508  41.600000000  0.4677641279  0.0640029907  650           0.0284756470 
0.8000000000  0.6904761905  0.7060000000  0.5952380952  0.8659638554  0.8493975904  0.8810240964  0.8734939759  0.7412698413  44.800000000  0.4440859377  0.0640029907  700           0.0289145660 
0.8220000000  0.7539682540  0.7680000000  0.6428571429  0.8614457831  0.8433734940  0.8840361446  0.8975903614  0.7714285714  48.000000000  0.4258887321  0.0640029907  750           0.0287670612 
0.8140000000  0.7142857143  0.7220000000  0.6349206349  0.8780120482  0.8493975904  0.9081325301  0.9096385542  0.7507936508  51.200000000  0.3989466709  0.0640029907  800           0.0287320518 
0.8500000000  0.8015873016  0.8000000000  0.6428571429  0.8524096386  0.8554216867  0.8478915663  0.8614457831  0.7650793651  54.400000000  0.3887472343  0.0640029907  850           0.0288917875 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3304269314 
0.4200000000  0.3730158730  0.3680000000  0.3492063492  0.6280120482  0.6084337349  0.6265060241  0.5903614458  0.4174603175  3.2000000000  1.0889353848  0.0588240623  0.0035127851  50            0.0324779701 
0.4420000000  0.3888888889  0.4000000000  0.3650793651  0.7018072289  0.6867469880  0.7996987952  0.7650602410  0.4476190476  6.4000000000  1.0239371145  0.0588240623  0.0033016612  100           0.0324736595 
0.4900000000  0.4206349206  0.4380000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.7891566265  0.4888888889  9.6000000000  0.9741142941  0.0588240623  0.0036220232  150           0.0321073437 
0.5760000000  0.4682539683  0.4880000000  0.4444444444  0.7469879518  0.7349397590  0.8298192771  0.7891566265  0.5555555556  12.800000000  0.9242961252  0.0588240623  0.0039255980  200           0.0327296400 
0.6000000000  0.5158730159  0.5100000000  0.4761904762  0.7274096386  0.7168674699  0.8463855422  0.8072289157  0.5523809524  16.000000000  0.8587973392  0.0588240623  0.0042045757  250           0.0330253792 
0.6360000000  0.5238095238  0.5640000000  0.5476190476  0.7319277108  0.7108433735  0.8584337349  0.8313253012  0.5666666667  19.200000000  0.7748589766  0.0588240623  0.0042076483  300           0.0324451447 
0.6720000000  0.5555555556  0.6520000000  0.5873015873  0.7515060241  0.7289156627  0.8147590361  0.7650602410  0.6301587302  22.400000000  0.6997439349  0.0588240623  0.0045469394  350           0.0320997477 
0.7260000000  0.6190476190  0.6860000000  0.6269841270  0.7936746988  0.7891566265  0.8177710843  0.7650602410  0.6650793651  25.600000000  0.6412479722  0.0588240623  0.0055485273  400           0.0323393726 
0.7240000000  0.6269841270  0.6820000000  0.5873015873  0.7665662651  0.7409638554  0.8493975904  0.8072289157  0.6841269841  28.800000000  0.6025609183  0.0605726242  0.0070150951  450           0.0324679899 
0.7620000000  0.6587301587  0.7060000000  0.6031746032  0.8087349398  0.7891566265  0.8463855422  0.8192771084  0.7142857143  32.000000000  0.5598969489  0.0605726242  0.0088766846  500           0.0317830992 
0.7960000000  0.6825396825  0.7440000000  0.6269841270  0.8524096386  0.7951807229  0.8433734940  0.8433734940  0.7507936508  35.200000000  0.5228240591  0.0605726242  0.0102560242  550           0.0323182583 
0.7740000000  0.6746031746  0.7220000000  0.6111111111  0.8478915663  0.8253012048  0.8765060241  0.8795180723  0.7523809524  38.400000000  0.4969186020  0.0605726242  0.0120133222  600           0.0320519161 
0.7880000000  0.6666666667  0.7100000000  0.5952380952  0.8509036145  0.8253012048  0.8659638554  0.8373493976  0.7412698413  41.600000000  0.4775755030  0.0605726242  0.0127892325  650           0.0321247816 
0.7920000000  0.6746031746  0.7120000000  0.5873015873  0.8704819277  0.8313253012  0.9006024096  0.8915662651  0.7365079365  44.800000000  0.4559174609  0.0605726242  0.0141443968  700           0.0317585230 
0.8200000000  0.7380952381  0.7560000000  0.6190476190  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7571428571  48.000000000  0.4380651706  0.0605726242  0.0146536771  750           0.0308376074 
0.8160000000  0.6984126984  0.7340000000  0.6190476190  0.8900602410  0.8493975904  0.9337349398  0.9397590361  0.7396825397  51.200000000  0.4128440714  0.0605726242  0.0151030729  800           0.0328512001 
0.8540000000  0.7698412698  0.8000000000  0.6428571429  0.8584337349  0.8554216867  0.8885542169  0.9036144578  0.7555555556  54.400000000  0.4032918805  0.0605726242  0.0156271937  850           0.0341438770 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.3177710843  0.3192771084  0.3810240964  0.3674698795  0.3349206349  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3248941898 
0.8240000000  0.7301587302  0.6980000000  0.6746031746  0.8990963855  0.8975903614  0.9909638554  1.0000000000  0.6857142857  3.2000000000  0.5320587200  0.0584588051  0.0196275976  50            0.0312653255 
0.9840000000  0.9285714286  0.9560000000  0.9047619048  0.9668674699  0.9277108434  0.9698795181  0.9638554217  0.7682539683  6.4000000000  0.2218566200  0.0585756302  0.0221927300  100           0.0317384624 
1.0000000000  0.9841269841  0.9960000000  0.9523809524  0.9533132530  0.9096385542  0.9909638554  0.9879518072  0.7444444444  9.6000000000  0.1066002648  0.0587110519  0.0212483487  150           0.0317116690 
0.9940000000  0.9444444444  0.9860000000  0.9523809524  0.9984939759  0.9939759036  0.9984939759  0.9939759036  0.7126984127  12.800000000  0.0534325835  0.0587110519  0.0191759424  200           0.0328195810 
1.0000000000  0.9523809524  0.9880000000  0.9206349206  0.9487951807  0.9156626506  0.9924698795  0.9939759036  0.7158730159  16.000000000  0.0366181937  0.0587110519  0.0182811761  250           0.0326388884 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  0.9939759036  0.9638554217  0.9969879518  1.0000000000  0.7031746032  19.200000000  0.0266570376  0.0587110519  0.0172297756  300           0.0318965626 
1.0000000000  0.9761904762  0.9960000000  0.9682539683  0.9969879518  0.9879518072  0.9984939759  0.9939759036  0.6952380952  22.400000000  0.0211534716  0.0587110519  0.0152583950  350           0.0326875019 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.7587301587  25.600000000  0.0190700550  0.0587110519  0.0139627541  400           0.0327486134 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  0.9759036145  0.9397590361  1.0000000000  1.0000000000  0.7317460317  28.800000000  0.0149886889  0.0587110519  0.0121744600  450           0.0316595697 
1.0000000000  0.9841269841  0.9980000000  0.9603174603  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.7111111111  32.000000000  0.0134989499  0.0589690208  0.0134166563  500           0.0320942211 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.7444444444  35.200000000  0.0146248926  0.0589690208  0.0122055330  550           0.0311710835 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.7158730159  38.400000000  0.0101529572  0.0589690208  0.0105029660  600           0.0318432570 
1.0000000000  0.9841269841  0.9960000000  0.9761904762  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.7492063492  41.600000000  0.0112295451  0.0589690208  0.0106264672  650           0.0321688080 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9924698795  0.9819277108  1.0000000000  1.0000000000  0.6904761905  44.800000000  0.0103277726  0.0589690208  0.0103660768  700           0.0329012871 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.9894578313  0.9457831325  1.0000000000  1.0000000000  0.7142857143  48.000000000  0.0077106661  0.0589690208  0.0093135854  750           0.0325776148 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9864457831  0.9578313253  1.0000000000  1.0000000000  0.6698412698  51.200000000  0.0086570784  0.0589690208  0.0076795571  800           0.0315548849 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.7015873016  54.400000000  0.0080407803  0.0589690208  0.0087184758  850           0.0323303986 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0003
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3720000000  0.3412698413  0.3380000000  0.3333333333  0.2756024096  0.3072289157  0.4352409639  0.3795180723  0.3412698413  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3417091370 
0.7920000000  0.7380952381  0.6700000000  0.6666666667  0.9036144578  0.9036144578  0.9834337349  0.9939759036  0.6904761905  3.2000000000  0.6418809974  0.0585174561  0.0143624935  50            0.0321642160 
0.9440000000  0.9206349206  0.9200000000  0.8333333333  0.8930722892  0.8855421687  0.9774096386  0.9578313253  0.7777777778  6.4000000000  0.2966989750  0.0585799217  0.0213915640  100           0.0326272917 
0.9940000000  0.9365079365  0.9840000000  0.9285714286  0.9156626506  0.8915662651  0.9548192771  0.9638554217  0.7333333333  9.6000000000  0.1669056970  0.0585799217  0.0214691319  150           0.0327343369 
0.9760000000  0.8888888889  0.9740000000  0.9206349206  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.7000000000  12.800000000  0.0926779582  0.0586090088  0.0200724769  200           0.0321009779 
1.0000000000  0.9682539683  0.9920000000  0.9206349206  0.9789156627  0.9518072289  0.9939759036  0.9879518072  0.7190476190  16.000000000  0.0584016057  0.0586090088  0.0197055733  250           0.0312017155 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  0.9759036145  0.9397590361  0.9698795181  0.9759036145  0.7000000000  19.200000000  0.0413988718  0.0586090088  0.0182091775  300           0.0323248005 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  0.9954819277  0.9698795181  1.0000000000  1.0000000000  0.7206349206  22.400000000  0.0322998239  0.0586090088  0.0168176191  350           0.0318710232 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.7365079365  25.600000000  0.0267620529  0.0614695549  0.0158693715  400           0.0324362183 
1.0000000000  0.9841269841  1.0000000000  0.9365079365  0.9939759036  0.9759036145  1.0000000000  1.0000000000  0.7142857143  28.800000000  0.0217607231  0.0614695549  0.0139573102  450           0.0318229151 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.7206349206  32.000000000  0.0185456738  0.0614695549  0.0149322269  500           0.0325983334 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.7428571429  35.200000000  0.0197363673  0.0614695549  0.0144371467  550           0.0315200520 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9924698795  0.9578313253  1.0000000000  1.0000000000  0.7174603175  38.400000000  0.0136369699  0.0614695549  0.0121451067  600           0.0323872757 
1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.7460317460  41.600000000  0.0147613266  0.0614695549  0.0125624716  650           0.0312985945 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9969879518  0.9879518072  1.0000000000  1.0000000000  0.6920634921  44.800000000  0.0136672185  0.0614695549  0.0122207764  700           0.0321612883 
1.0000000000  0.9761904762  1.0000000000  0.9761904762  0.9924698795  0.9457831325  1.0000000000  1.0000000000  0.7317460317  48.000000000  0.0114488080  0.0614695549  0.0114600471  750           0.0310038614 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.7031746032  51.200000000  0.0108727210  0.0614695549  0.0094761434  800           0.0308340025 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.6920634921  54.400000000  0.0103141892  0.0614695549  0.0105601924  850           0.0317760134 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 5e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3320000000  0.3333333333  0.3280000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3349206349  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3322470188 
0.5080000000  0.4444444444  0.4420000000  0.4126984127  0.7349397590  0.6626506024  0.8689759036  0.8373493976  0.5079365079  3.2000000000  0.9792021847  0.0585031509  0.0038022209  50            0.0322138214 
0.7120000000  0.6031746032  0.6340000000  0.5714285714  0.8433734940  0.8313253012  0.8509036145  0.8253012048  0.6936507937  6.4000000000  0.7046841431  0.0585608482  0.0054299074  100           0.0314207935 
0.8240000000  0.7301587302  0.7420000000  0.6349206349  0.8569277108  0.8253012048  0.8539156627  0.8253012048  0.7333333333  9.6000000000  0.4951163077  0.0586013794  0.0126364103  150           0.0313657856 
0.8420000000  0.7460317460  0.7920000000  0.6587301587  0.8840361446  0.8614457831  0.9578313253  0.9518072289  0.7333333333  12.800000000  0.4147180843  0.0586013794  0.0164684594  200           0.0315608549 
0.9180000000  0.8571428571  0.8580000000  0.6984126984  0.8780120482  0.8614457831  0.9608433735  0.9638554217  0.7555555556  16.000000000  0.3558374476  0.0586013794  0.0176894471  250           0.0320682716 
0.9420000000  0.8888888889  0.8900000000  0.7619047619  0.8629518072  0.8614457831  0.9518072289  0.9397590361  0.7365079365  19.200000000  0.3019306263  0.0586013794  0.0182070561  300           0.0327903080 
0.9700000000  0.9206349206  0.9420000000  0.7857142857  0.8870481928  0.8734939759  0.9548192771  0.9638554217  0.7285714286  22.400000000  0.2595432007  0.0586600304  0.0181135873  350           0.0325675774 
0.9760000000  0.9285714286  0.9600000000  0.8095238095  0.9021084337  0.8855421687  0.9608433735  0.9638554217  0.7396825397  25.600000000  0.2329759350  0.0588254929  0.0190251075  400           0.0314629650 
0.9780000000  0.9047619048  0.9560000000  0.8095238095  0.9412650602  0.9096385542  0.9728915663  0.9638554217  0.7222222222  28.800000000  0.2012271324  0.0588383675  0.0180992915  450           0.0327105045 
0.9940000000  0.9126984127  0.9620000000  0.8333333333  0.9457831325  0.9156626506  0.9804216867  0.9819277108  0.6920634921  32.000000000  0.1659790272  0.0588383675  0.0196084076  500           0.0325087023 
0.9920000000  0.9126984127  0.9780000000  0.8809523810  0.9277108434  0.9036144578  0.9728915663  0.9759036145  0.6920634921  35.200000000  0.1463438180  0.0588393211  0.0200891378  550           0.0314768505 
1.0000000000  0.9126984127  0.9780000000  0.8650793651  0.9743975904  0.9457831325  0.9849397590  0.9879518072  0.6920634921  38.400000000  0.1251752725  0.0588393211  0.0187188783  600           0.0328115845 
0.9980000000  0.9126984127  0.9840000000  0.8730158730  0.9503012048  0.9096385542  0.9759036145  0.9759036145  0.6746031746  41.600000000  0.1124163342  0.0589146614  0.0191583266  650           0.0320280266 
0.9980000000  0.9126984127  0.9900000000  0.8968253968  0.9789156627  0.9518072289  0.9909638554  0.9879518072  0.6825396825  44.800000000  0.1027401075  0.0589146614  0.0198212582  700           0.0333747721 
1.0000000000  0.9285714286  0.9980000000  0.9047619048  0.9352409639  0.9096385542  0.9819277108  0.9759036145  0.6698412698  48.000000000  0.0902982309  0.0589146614  0.0201776524  750           0.0323099947 
1.0000000000  0.9206349206  0.9920000000  0.8809523810  0.9743975904  0.9457831325  0.9984939759  0.9939759036  0.6666666667  51.200000000  0.0776493450  0.0589146614  0.0176357468  800           0.0330946207 
1.0000000000  0.9365079365  0.9980000000  0.9126984127  0.9819277108  0.9518072289  1.0000000000  1.0000000000  0.6301587302  54.400000000  0.0774345989  0.0589146614  0.0190194041  850           0.0327924347 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0001
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3420000000  0.3253968254  0.3360000000  0.3253968254  0.3328313253  0.3313253012  0.4442771084  0.4518072289  0.3523809524  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3360571861 
0.6160000000  0.5317460317  0.5140000000  0.4682539683  0.8433734940  0.7710843373  0.8614457831  0.8192771084  0.5777777778  3.2000000000  0.8579864883  0.0585503578  0.0047986923  50            0.0319852972 
0.8360000000  0.7936507937  0.7300000000  0.6746031746  0.8554216867  0.8433734940  0.9006024096  0.8795180723  0.7492063492  6.4000000000  0.4713377291  0.0585503578  0.0147013102  100           0.0319090366 
0.9260000000  0.9047619048  0.8780000000  0.7142857143  0.8795180723  0.8795180723  0.9533132530  0.9698795181  0.7428571429  9.6000000000  0.3521823853  0.0585503578  0.0178356387  150           0.0316679621 
0.9380000000  0.8333333333  0.9120000000  0.7619047619  0.9533132530  0.9337349398  0.9939759036  0.9879518072  0.7222222222  12.800000000  0.2776943055  0.0585641861  0.0188300636  200           0.0329041052 
0.9780000000  0.9047619048  0.9400000000  0.7936507937  0.9457831325  0.9156626506  0.9879518072  0.9879518072  0.6730158730  16.000000000  0.2102925885  0.0585646629  0.0189791612  250           0.0314405680 
0.9920000000  0.9047619048  0.9800000000  0.8253968254  0.9141566265  0.8975903614  0.9728915663  0.9879518072  0.6952380952  19.200000000  0.1515079844  0.0585646629  0.0194109545  300           0.0321304941 
1.0000000000  0.9047619048  0.9880000000  0.8730158730  0.9472891566  0.9096385542  0.9774096386  0.9819277108  0.6841269841  22.400000000  0.1200786610  0.0586524010  0.0190778941  350           0.0319759274 
1.0000000000  0.9285714286  0.9900000000  0.8809523810  0.9698795181  0.9518072289  0.9849397590  0.9759036145  0.7095238095  25.600000000  0.1019579824  0.0586524010  0.0196399154  400           0.0328626585 
1.0000000000  0.9523809524  0.9920000000  0.8888888889  0.9668674699  0.9518072289  1.0000000000  1.0000000000  0.6888888889  28.800000000  0.0844279087  0.0586524010  0.0176853199  450           0.0321526003 
1.0000000000  0.9444444444  0.9960000000  0.8968253968  0.9939759036  0.9759036145  1.0000000000  1.0000000000  0.6603174603  32.000000000  0.0681678757  0.0586524010  0.0193959081  500           0.0319395208 
1.0000000000  0.9523809524  1.0000000000  0.9047619048  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.6952380952  35.200000000  0.0607807573  0.0586524010  0.0187877771  550           0.0336845398 
1.0000000000  0.9603174603  1.0000000000  0.9206349206  0.9879518072  0.9638554217  0.9984939759  0.9939759036  0.7142857143  38.400000000  0.0489403223  0.0586524010  0.0169174846  600           0.0311241245 
1.0000000000  0.9603174603  0.9980000000  0.9047619048  0.9894578313  0.9578313253  1.0000000000  1.0000000000  0.7031746032  41.600000000  0.0456725540  0.0587143898  0.0174718368  650           0.0316699362 
1.0000000000  0.9682539683  0.9980000000  0.9206349206  0.9924698795  0.9578313253  1.0000000000  1.0000000000  0.7095238095  44.800000000  0.0411860266  0.0613231659  0.0176150734  700           0.0315722418 
1.0000000000  0.9603174603  1.0000000000  0.9285714286  0.9638554217  0.9277108434  0.9984939759  0.9939759036  0.7142857143  48.000000000  0.0353875848  0.0613231659  0.0169191603  750           0.0327819300 
1.0000000000  0.9761904762  1.0000000000  0.9126984127  0.9924698795  0.9578313253  1.0000000000  1.0000000000  0.7015873016  51.200000000  0.0311467888  0.0613231659  0.0144192238  800           0.0324417830 
1.0000000000  0.9682539683  1.0000000000  0.9285714286  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.6444444444  54.400000000  0.0308675206  0.0613231659  0.0155452944  850           0.0319125032 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3292200565 
0.4200000000  0.3730158730  0.3680000000  0.3492063492  0.6280120482  0.6084337349  0.6265060241  0.5903614458  0.4174603175  3.2000000000  1.0889353848  0.0588469505  0.0035127851  50            0.0338539362 
0.4420000000  0.3888888889  0.4000000000  0.3650793651  0.7018072289  0.6867469880  0.7996987952  0.7650602410  0.4476190476  6.4000000000  1.0239371145  0.0588469505  0.0033016612  100           0.0321368980 
0.4900000000  0.4206349206  0.4380000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.7891566265  0.4888888889  9.6000000000  0.9741142941  0.0597472191  0.0036220232  150           0.0314584112 
0.5760000000  0.4682539683  0.4880000000  0.4444444444  0.7469879518  0.7349397590  0.8298192771  0.7891566265  0.5555555556  12.800000000  0.9242961252  0.0597472191  0.0039255980  200           0.0328639317 
0.6000000000  0.5158730159  0.5100000000  0.4761904762  0.7274096386  0.7168674699  0.8463855422  0.8072289157  0.5523809524  16.000000000  0.8587973392  0.0597472191  0.0042045757  250           0.0320295763 
0.6360000000  0.5238095238  0.5640000000  0.5476190476  0.7319277108  0.7108433735  0.8584337349  0.8313253012  0.5666666667  19.200000000  0.7748589766  0.0597472191  0.0042076483  300           0.0319316673 
0.6720000000  0.5555555556  0.6520000000  0.5873015873  0.7515060241  0.7289156627  0.8147590361  0.7650602410  0.6301587302  22.400000000  0.6997439349  0.0614647865  0.0045469394  350           0.0315267277 
0.7260000000  0.6190476190  0.6860000000  0.6269841270  0.7936746988  0.7891566265  0.8177710843  0.7650602410  0.6650793651  25.600000000  0.6412479722  0.0614647865  0.0055485273  400           0.0326088142 
0.7240000000  0.6269841270  0.6820000000  0.5873015873  0.7665662651  0.7409638554  0.8493975904  0.8072289157  0.6841269841  28.800000000  0.6025609183  0.0614647865  0.0070150951  450           0.0323995209 
0.7620000000  0.6587301587  0.7060000000  0.6031746032  0.8087349398  0.7891566265  0.8463855422  0.8192771084  0.7142857143  32.000000000  0.5598969489  0.0614647865  0.0088766846  500           0.0321820927 
0.7960000000  0.6825396825  0.7440000000  0.6269841270  0.8524096386  0.7951807229  0.8433734940  0.8433734940  0.7507936508  35.200000000  0.5228240591  0.0614647865  0.0102560242  550           0.0325725889 
0.7740000000  0.6746031746  0.7220000000  0.6111111111  0.8478915663  0.8253012048  0.8765060241  0.8795180723  0.7523809524  38.400000000  0.4969186020  0.0614647865  0.0120133222  600           0.0313825512 
0.7880000000  0.6666666667  0.7100000000  0.5952380952  0.8509036145  0.8253012048  0.8659638554  0.8373493976  0.7412698413  41.600000000  0.4775755030  0.0614647865  0.0127892325  650           0.0320354223 
0.7920000000  0.6746031746  0.7120000000  0.5873015873  0.8704819277  0.8313253012  0.9006024096  0.8915662651  0.7365079365  44.800000000  0.4559174609  0.0614647865  0.0141443968  700           0.0318000603 
0.8200000000  0.7380952381  0.7560000000  0.6190476190  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7571428571  48.000000000  0.4380651706  0.0614647865  0.0146536771  750           0.0310923862 
0.8160000000  0.6984126984  0.7340000000  0.6190476190  0.8900602410  0.8493975904  0.9337349398  0.9397590361  0.7396825397  51.200000000  0.4128440714  0.0614647865  0.0151030729  800           0.0319681501 
0.8540000000  0.7698412698  0.8000000000  0.6428571429  0.8584337349  0.8554216867  0.8885542169  0.9036144578  0.7555555556  54.400000000  0.4032918805  0.0614647865  0.0156271937  850           0.0319985485 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3447732925 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6460843373  0.6325301205  0.6174698795  0.5903614458  0.4174603175  3.2000000000  1.0885902977  0.0585756302  50            0.0292491102 
0.4400000000  0.3809523810  0.3940000000  0.3492063492  0.7213855422  0.7048192771  0.7906626506  0.7530120482  0.4444444444  6.4000000000  1.0225170028  0.0585756302  100           0.0279575825 
0.4840000000  0.4126984127  0.4300000000  0.3730158730  0.7409638554  0.7349397590  0.8313253012  0.7831325301  0.4873015873  9.6000000000  0.9725380445  0.0586671829  150           0.0277199268 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7665662651  0.7289156627  0.8042168675  0.7590361446  0.5396825397  12.800000000  0.9227569604  0.0601444244  200           0.0274861002 
0.6100000000  0.5079365079  0.5040000000  0.4603174603  0.7620481928  0.7349397590  0.8102409639  0.7710843373  0.5476190476  16.000000000  0.8565853465  0.0601444244  250           0.0286258745 
0.6360000000  0.5317460317  0.5520000000  0.5476190476  0.7575301205  0.7530120482  0.8237951807  0.7650602410  0.5571428571  19.200000000  0.7725161803  0.0601444244  300           0.0290489721 
0.6780000000  0.5396825397  0.6500000000  0.5873015873  0.7650602410  0.7349397590  0.7816265060  0.7530120482  0.6238095238  22.400000000  0.6962408984  0.0601444244  350           0.0275864124 
0.7220000000  0.6349206349  0.6900000000  0.6190476190  0.8027108434  0.7891566265  0.8132530120  0.7590361446  0.6666666667  25.600000000  0.6357664907  0.0601444244  400           0.0279219294 
0.7360000000  0.6428571429  0.6960000000  0.6031746032  0.7680722892  0.7349397590  0.8463855422  0.8072289157  0.6920634921  28.800000000  0.5955067039  0.0601444244  450           0.0281080389 
0.7700000000  0.6666666667  0.7160000000  0.6190476190  0.8147590361  0.7891566265  0.8463855422  0.8192771084  0.7222222222  32.000000000  0.5510424501  0.0601444244  500           0.0289239073 
0.8020000000  0.7063492063  0.7600000000  0.6507936508  0.8524096386  0.8072289157  0.8298192771  0.8253012048  0.7603174603  35.200000000  0.5137320542  0.0601444244  550           0.0285051870 
0.7960000000  0.7063492063  0.7340000000  0.6349206349  0.8509036145  0.8373493976  0.8584337349  0.8674698795  0.7587301587  38.400000000  0.4868571657  0.0601444244  600           0.0289311361 
0.7960000000  0.6904761905  0.7120000000  0.6111111111  0.8509036145  0.8253012048  0.8463855422  0.8192771084  0.7507936508  41.600000000  0.4677641279  0.0601444244  650           0.0297328186 
0.8000000000  0.6904761905  0.7060000000  0.5952380952  0.8659638554  0.8493975904  0.8810240964  0.8734939759  0.7412698413  44.800000000  0.4440859377  0.0601444244  700           0.0297504568 
0.8220000000  0.7539682540  0.7680000000  0.6428571429  0.8614457831  0.8433734940  0.8840361446  0.8975903614  0.7714285714  48.000000000  0.4258887321  0.0601444244  750           0.0287290478 
0.8140000000  0.7142857143  0.7220000000  0.6349206349  0.8780120482  0.8493975904  0.9081325301  0.9096385542  0.7507936508  51.200000000  0.3989466709  0.0601444244  800           0.0287282228 
0.8500000000  0.8015873016  0.8000000000  0.6428571429  0.8524096386  0.8554216867  0.8478915663  0.8614457831  0.7650793651  54.400000000  0.3887472343  0.0601444244  850           0.0287870932 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521564484  0.1983531564  0             0.4951086044 
0.4340000000  0.4047619048  0.3720000000  0.3492063492  0.6611445783  0.6325301205  0.6054216867  0.5903614458  0.4380952381  3.2000000000  1.0898350334  0.0584602356  0.0842469743  50            0.0282545996 
0.4500000000  0.3809523810  0.4040000000  0.3650793651  0.7319277108  0.7108433735  0.7786144578  0.7530120482  0.4523809524  6.4000000000  1.0264133239  0.0585312843  0.0759924887  100           0.0279316235 
0.4940000000  0.4047619048  0.4280000000  0.3888888889  0.7469879518  0.7349397590  0.8313253012  0.7831325301  0.4857142857  9.6000000000  0.9791754544  0.0605010986  0.1047191203  150           0.0283276320 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7590361446  0.7349397590  0.8162650602  0.7710843373  0.5412698413  12.800000000  0.9335016525  0.0605010986  0.1468886445  200           0.0286701488 
0.6000000000  0.5238095238  0.5140000000  0.4682539683  0.7635542169  0.7530120482  0.8388554217  0.8012048193  0.5349206349  16.000000000  0.8751737189  0.0605010986  0.2015877664  250           0.0283267641 
0.6400000000  0.5476190476  0.5540000000  0.5079365079  0.7635542169  0.7530120482  0.8478915663  0.8253012048  0.5396825397  19.200000000  0.8000668585  0.0605010986  0.2757240385  300           0.0286086941 
0.6840000000  0.5634920635  0.6540000000  0.5634920635  0.7786144578  0.7530120482  0.8207831325  0.7771084337  0.6111111111  22.400000000  0.7319196343  0.0605010986  0.3915761960  350           0.0293176174 
0.7300000000  0.6269841270  0.6880000000  0.6269841270  0.7966867470  0.7891566265  0.8358433735  0.8132530120  0.6571428571  25.600000000  0.6789308786  0.0605010986  0.5417248583  400           0.0281765795 
0.7220000000  0.6349206349  0.6960000000  0.6031746032  0.7831325301  0.7228915663  0.8659638554  0.8493975904  0.6698412698  28.800000000  0.6491078675  0.0605010986  0.6612624705  450           0.0289888573 
0.7600000000  0.6428571429  0.7260000000  0.6190476190  0.8072289157  0.7710843373  0.8689759036  0.8614457831  0.6984126984  32.000000000  0.6148422015  0.0605010986  0.7638727665  500           0.0293109465 
0.7900000000  0.6984126984  0.7660000000  0.6428571429  0.8539156627  0.8132530120  0.8765060241  0.8915662651  0.7190476190  35.200000000  0.5861151671  0.0605010986  0.8463623309  550           0.0287197971 
0.7800000000  0.6666666667  0.7540000000  0.6428571429  0.8554216867  0.8313253012  0.8960843373  0.8975903614  0.7174603175  38.400000000  0.5664903641  0.0605010986  0.9169087052  600           0.0284316063 
0.7720000000  0.6746031746  0.7460000000  0.6190476190  0.8569277108  0.8373493976  0.8885542169  0.8795180723  0.7142857143  41.600000000  0.5508784533  0.0605010986  0.9485754824  650           0.0281921148 
0.7760000000  0.6825396825  0.7400000000  0.6349206349  0.8795180723  0.8313253012  0.9141566265  0.9216867470  0.6904761905  44.800000000  0.5344226909  0.0605010986  0.9989729106  700           0.0296253586 
0.8200000000  0.7063492063  0.7960000000  0.6269841270  0.8870481928  0.8614457831  0.9367469880  0.9397590361  0.7349206349  48.000000000  0.5191156936  0.0605010986  1.0231211126  750           0.0279524708 
0.8180000000  0.7142857143  0.7800000000  0.6428571429  0.9021084337  0.8734939759  0.9382530120  0.9457831325  0.7174603175  51.200000000  0.4982768142  0.0605010986  1.0554095256  800           0.0289711952 
0.8380000000  0.7619047619  0.8240000000  0.6349206349  0.8990963855  0.8855421687  0.9563253012  0.9578313253  0.7269841270  54.400000000  0.4886435723  0.0605010986  1.0762997162  850           0.0280999947 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521564484  0.1983531564  0             0.3342339993 
0.4340000000  0.4047619048  0.3720000000  0.3492063492  0.6611445783  0.6325301205  0.6054216867  0.5903614458  0.3333333333  3.2000000000  1.0898350334  0.0584983826  0.0842469743  50            0.0278073740 
0.4500000000  0.3809523810  0.4040000000  0.3650793651  0.7319277108  0.7108433735  0.7786144578  0.7530120482  0.3366666667  6.4000000000  1.0264133239  0.0585122108  0.0759924887  100           0.0283650446 
0.4940000000  0.4047619048  0.4280000000  0.3888888889  0.7469879518  0.7349397590  0.8313253012  0.7831325301  0.3366666667  9.6000000000  0.9791754544  0.0614280701  0.1047191203  150           0.0278172874 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7590361446  0.7349397590  0.8162650602  0.7710843373  0.3466666667  12.800000000  0.9335016525  0.0614280701  0.1468886445  200           0.0286970282 
0.6000000000  0.5238095238  0.5140000000  0.4682539683  0.7635542169  0.7530120482  0.8388554217  0.8012048193  0.3633333333  16.000000000  0.8751737189  0.0614280701  0.2015877664  250           0.0286529636 
0.6400000000  0.5476190476  0.5540000000  0.5079365079  0.7635542169  0.7530120482  0.8478915663  0.8253012048  0.4166666667  19.200000000  0.8000668585  0.0614280701  0.2757240385  300           0.0285574102 
0.6840000000  0.5634920635  0.6540000000  0.5634920635  0.7786144578  0.7530120482  0.8207831325  0.7771084337  0.6900000000  22.400000000  0.7319196343  0.0614280701  0.3915761960  350           0.0275369596 
0.7300000000  0.6269841270  0.6880000000  0.6269841270  0.7966867470  0.7891566265  0.8358433735  0.8132530120  0.7066666667  25.600000000  0.6789308786  0.0614280701  0.5417248583  400           0.0278037930 
0.7220000000  0.6349206349  0.6960000000  0.6031746032  0.7831325301  0.7228915663  0.8659638554  0.8493975904  0.7566666667  28.800000000  0.6491078675  0.0614280701  0.6612624705  450           0.0277570772 
0.7600000000  0.6428571429  0.7260000000  0.6190476190  0.8072289157  0.7710843373  0.8689759036  0.8614457831  0.7566666667  32.000000000  0.6148422015  0.0614280701  0.7638727665  500           0.0281936169 
0.7900000000  0.6984126984  0.7660000000  0.6428571429  0.8539156627  0.8132530120  0.8765060241  0.8915662651  0.7333333333  35.200000000  0.5861151671  0.0614280701  0.8463623309  550           0.0282720184 
0.7800000000  0.6666666667  0.7540000000  0.6428571429  0.8554216867  0.8313253012  0.8960843373  0.8975903614  0.6866666667  38.400000000  0.5664903641  0.0614280701  0.9169087052  600           0.0282183313 
0.7720000000  0.6746031746  0.7460000000  0.6190476190  0.8569277108  0.8373493976  0.8885542169  0.8795180723  0.6900000000  41.600000000  0.5508784533  0.0614280701  0.9485754824  650           0.0279965878 
0.7760000000  0.6825396825  0.7400000000  0.6349206349  0.8795180723  0.8313253012  0.9141566265  0.9216867470  0.6166666667  44.800000000  0.5344226909  0.0614280701  0.9989729106  700           0.0271744108 
0.8200000000  0.7063492063  0.7960000000  0.6269841270  0.8870481928  0.8614457831  0.9367469880  0.9397590361  0.6766666667  48.000000000  0.5191156936  0.0614280701  1.0231211126  750           0.0292385960 
0.8180000000  0.7142857143  0.7800000000  0.6428571429  0.9021084337  0.8734939759  0.9382530120  0.9457831325  0.6633333333  51.200000000  0.4982768142  0.0614280701  1.0554095256  800           0.0274052763 
0.8380000000  0.7619047619  0.8240000000  0.6349206349  0.8990963855  0.8855421687  0.9563253012  0.9578313253  0.6933333333  54.400000000  0.4886435723  0.0614280701  1.0762997162  850           0.0288139009 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3042168675  0.3132530120  0.4021084337  0.3674698795  0.3333333333  0.0000000000  1.1199481487  0.0521564484  0.1983531564  0             0.3498008251 
0.8440000000  0.7777777778  0.7660000000  0.7142857143  0.8975903614  0.8915662651  0.9909638554  1.0000000000  0.6166666667  3.2000000000  0.6365494895  0.0585699081  0.9034658732  50            0.0272044468 
0.9800000000  0.9682539683  0.9600000000  0.8888888889  0.9367469880  0.9156626506  0.9954819277  0.9939759036  0.5600000000  6.4000000000  0.3301738775  0.0585951805  1.3806866860  100           0.0273352432 
1.0000000000  0.9603174603  0.9980000000  0.9285714286  0.9804216867  0.9457831325  0.9984939759  0.9939759036  0.4766666667  9.6000000000  0.2190117142  0.0585951805  1.5222118783  150           0.0287357378 
0.9980000000  0.9682539683  0.9900000000  0.8968253968  0.9969879518  0.9879518072  1.0000000000  1.0000000000  0.5333333333  12.800000000  0.1753998277  0.0615692139  1.6001757264  200           0.0289494276 
1.0000000000  0.9841269841  0.9900000000  0.9365079365  0.9909638554  0.9518072289  0.9984939759  0.9939759036  0.5033333333  16.000000000  0.1613936764  0.0615692139  1.6099913764  250           0.0285025835 
1.0000000000  0.9841269841  1.0000000000  0.9365079365  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5000000000  19.200000000  0.1516737476  0.0615692139  1.6142989922  300           0.0283094978 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 955404) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 50, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 954355) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 5e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3320000000  0.3253968254  0.3280000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.1199481487  0.0521564484  0.1983531564  0             0.3791759014 
0.5060000000  0.4444444444  0.4340000000  0.3968253968  0.7605421687  0.6807228916  0.8719879518  0.8373493976  0.3366666667  3.2000000000  0.9844703019  0.0605025291  0.1271437865  50            0.0284151793 
0.7300000000  0.6190476190  0.6580000000  0.5714285714  0.8493975904  0.8313253012  0.8810240964  0.8493975904  0.6166666667  6.4000000000  0.7321886301  0.0605025291  0.4786187327  100           0.0278745937 
0.8060000000  0.7460317460  0.7660000000  0.6666666667  0.8584337349  0.8313253012  0.8885542169  0.8674698795  0.7266666667  9.6000000000  0.5615954071  0.0605401993  0.9623549044  150           0.0273011541 
0.8500000000  0.7619047619  0.8200000000  0.6746031746  0.9006024096  0.8554216867  0.9503012048  0.9578313253  0.7033333333  12.800000000  0.4987769777  0.0611081123  1.0524224460  200           0.0282569122 
0.9200000000  0.8650793651  0.8980000000  0.7063492063  0.8885542169  0.8674698795  0.9668674699  0.9759036145  0.6700000000  16.000000000  0.4486188936  0.0611081123  1.1169882870  250           0.0281743479 
0.9440000000  0.8809523810  0.9240000000  0.7539682540  0.8960843373  0.8734939759  0.9894578313  0.9819277108  0.5600000000  19.200000000  0.3992073828  0.0611081123  1.2191236973  300           0.0270972633 
0.9680000000  0.8809523810  0.9540000000  0.8492063492  0.9352409639  0.9216867470  0.9909638554  1.0000000000  0.5933333333  22.400000000  0.3654153651  0.0611081123  1.2509127331  350           0.0286303616 
0.9680000000  0.8809523810  0.9600000000  0.8174603175  0.9503012048  0.9337349398  1.0000000000  1.0000000000  0.5900000000  25.600000000  0.3400935709  0.0611081123  1.3064734149  400           0.0285403776 
0.9820000000  0.9126984127  0.9780000000  0.8492063492  0.9337349398  0.8915662651  0.9969879518  1.0000000000  0.5400000000  28.800000000  0.3140727687  0.0611081123  1.3626558661  450           0.0285257864 
0.9860000000  0.9126984127  0.9680000000  0.8730158730  0.9804216867  0.9578313253  1.0000000000  1.0000000000  0.4966666667  32.000000000  0.2850174648  0.0611081123  1.4013774085  500           0.0269196415 
0.9860000000  0.9047619048  0.9880000000  0.8968253968  0.9563253012  0.9337349398  1.0000000000  1.0000000000  0.5300000000  35.200000000  0.2637425163  0.0611081123  1.4630422974  550           0.0280777740 
1.0000000000  0.9126984127  0.9820000000  0.8730158730  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.4833333333  38.400000000  0.2504897913  0.0611081123  1.4704289007  600           0.0278447199 
0.9980000000  0.9126984127  0.9920000000  0.8968253968  0.9668674699  0.9397590361  1.0000000000  1.0000000000  0.5266666667  41.600000000  0.2362800375  0.0611081123  1.5069133377  650           0.0284574986 
1.0000000000  0.9365079365  0.9980000000  0.8968253968  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.4966666667  44.800000000  0.2264236876  0.0611081123  1.5315734458  700           0.0274434710 
1.0000000000  0.9365079365  1.0000000000  0.9047619048  0.9789156627  0.9638554217  1.0000000000  1.0000000000  0.4533333333  48.000000000  0.2161109936  0.0611081123  1.5541500878  750           0.0276919460 
1.0000000000  0.9365079365  0.9960000000  0.8968253968  0.9849397590  0.9638554217  1.0000000000  1.0000000000  0.4533333333  51.200000000  0.2071811739  0.0611081123  1.5551908708  800           0.0276997089 
1.0000000000  0.9444444444  1.0000000000  0.9126984127  0.9879518072  0.9638554217  1.0000000000  1.0000000000  0.4600000000  54.400000000  0.2033994836  0.0611081123  1.5682068777  850           0.0274001837 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 5e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3320000000  0.3333333333  0.3280000000  0.3333333333  0.3328313253  0.3313253012  0.4412650602  0.4397590361  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3491380215 
0.5080000000  0.4444444444  0.4420000000  0.4126984127  0.7349397590  0.6626506024  0.8689759036  0.8373493976  0.3400000000  3.2000000000  0.9792021847  0.0584840775  0.0038022209  50            0.0315594959 
0.7120000000  0.6031746032  0.6340000000  0.5714285714  0.8433734940  0.8313253012  0.8509036145  0.8253012048  0.6300000000  6.4000000000  0.7046841431  0.0584840775  0.0054299074  100           0.0311754942 
0.8240000000  0.7301587302  0.7420000000  0.6349206349  0.8569277108  0.8253012048  0.8539156627  0.8253012048  0.7533333333  9.6000000000  0.4951163077  0.0584840775  0.0126364103  150           0.0321617460 
0.8420000000  0.7460317460  0.7920000000  0.6587301587  0.8840361446  0.8614457831  0.9578313253  0.9518072289  0.7133333333  12.800000000  0.4147180843  0.0584840775  0.0164684594  200           0.0317003870 
0.9180000000  0.8571428571  0.8580000000  0.6984126984  0.8780120482  0.8614457831  0.9608433735  0.9638554217  0.6833333333  16.000000000  0.3558374476  0.0585427284  0.0176894471  250           0.0313334322 
0.9420000000  0.8888888889  0.8900000000  0.7619047619  0.8629518072  0.8614457831  0.9518072289  0.9397590361  0.5500000000  19.200000000  0.3019306263  0.0616540909  0.0182070561  300           0.0319886065 
0.9700000000  0.9206349206  0.9420000000  0.7857142857  0.8870481928  0.8734939759  0.9548192771  0.9638554217  0.6033333333  22.400000000  0.2595432007  0.0616540909  0.0181135873  350           0.0323139381 
0.9760000000  0.9285714286  0.9600000000  0.8095238095  0.9021084337  0.8855421687  0.9608433735  0.9638554217  0.6500000000  25.600000000  0.2329759350  0.0616540909  0.0190251075  400           0.0318866014 
0.9780000000  0.9047619048  0.9560000000  0.8095238095  0.9412650602  0.9096385542  0.9728915663  0.9638554217  0.6433333333  28.800000000  0.2012271324  0.0616540909  0.0180992915  450           0.0313845205 
0.9940000000  0.9126984127  0.9620000000  0.8333333333  0.9457831325  0.9156626506  0.9804216867  0.9819277108  0.5900000000  32.000000000  0.1659790272  0.0616540909  0.0196084076  500           0.0329440928 
0.9920000000  0.9126984127  0.9780000000  0.8809523810  0.9277108434  0.9036144578  0.9728915663  0.9759036145  0.6166666667  35.200000000  0.1463438180  0.0616540909  0.0200891378  550           0.0315735960 
1.0000000000  0.9126984127  0.9780000000  0.8650793651  0.9743975904  0.9457831325  0.9849397590  0.9879518072  0.5900000000  38.400000000  0.1251752725  0.0616540909  0.0187188783  600           0.0317283821 
0.9980000000  0.9126984127  0.9840000000  0.8730158730  0.9503012048  0.9096385542  0.9759036145  0.9759036145  0.6100000000  41.600000000  0.1124163342  0.0616540909  0.0191583266  650           0.0319766569 
0.9980000000  0.9126984127  0.9900000000  0.8968253968  0.9789156627  0.9518072289  0.9909638554  0.9879518072  0.6266666667  44.800000000  0.1027401075  0.0616540909  0.0198212582  700           0.0313206291 
1.0000000000  0.9285714286  0.9980000000  0.9047619048  0.9352409639  0.9096385542  0.9819277108  0.9759036145  0.5766666667  48.000000000  0.0902982309  0.0616540909  0.0201776524  750           0.0324332142 
1.0000000000  0.9206349206  0.9920000000  0.8809523810  0.9743975904  0.9457831325  0.9984939759  0.9939759036  0.5533333333  51.200000000  0.0776493450  0.0616540909  0.0176357468  800           0.0320364666 
1.0000000000  0.9365079365  0.9980000000  0.9126984127  0.9819277108  0.9518072289  1.0000000000  1.0000000000  0.5933333333  54.400000000  0.0774345989  0.0616540909  0.0190194041  850           0.0323612833 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3810150623 
0.4200000000  0.3730158730  0.3680000000  0.3492063492  0.6280120482  0.6084337349  0.6265060241  0.5903614458  0.3333333333  3.2000000000  1.0889353848  0.0584840775  0.0035127851  50            0.0320155430 
0.4420000000  0.3888888889  0.4000000000  0.3650793651  0.7018072289  0.6867469880  0.7996987952  0.7650602410  0.3400000000  6.4000000000  1.0239371145  0.0584840775  0.0033016612  100           0.0321004295 
0.4900000000  0.4206349206  0.4380000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.7891566265  0.3400000000  9.6000000000  0.9741142941  0.0585246086  0.0036220232  150           0.0325628996 
0.5760000000  0.4682539683  0.4880000000  0.4444444444  0.7469879518  0.7349397590  0.8298192771  0.7891566265  0.3433333333  12.800000000  0.9242961252  0.0585246086  0.0039255980  200           0.0322239637 
0.6000000000  0.5158730159  0.5100000000  0.4761904762  0.7274096386  0.7168674699  0.8463855422  0.8072289157  0.3733333333  16.000000000  0.8587973392  0.0585246086  0.0042045757  250           0.0318828964 
0.6360000000  0.5238095238  0.5640000000  0.5476190476  0.7319277108  0.7108433735  0.8584337349  0.8313253012  0.4233333333  19.200000000  0.7748589766  0.0585703850  0.0042076483  300           0.0315632820 
0.6720000000  0.5555555556  0.6520000000  0.5873015873  0.7515060241  0.7289156627  0.8147590361  0.7650602410  0.6866666667  22.400000000  0.6997439349  0.0585918427  0.0045469394  350           0.0322559309 
0.7260000000  0.6190476190  0.6860000000  0.6269841270  0.7936746988  0.7891566265  0.8177710843  0.7650602410  0.7766666667  25.600000000  0.6412479722  0.0585918427  0.0055485273  400           0.0323535585 
0.7240000000  0.6269841270  0.6820000000  0.5873015873  0.7665662651  0.7409638554  0.8493975904  0.8072289157  0.7400000000  28.800000000  0.6025609183  0.0585918427  0.0070150951  450           0.0329256630 
0.7620000000  0.6587301587  0.7060000000  0.6031746032  0.8087349398  0.7891566265  0.8463855422  0.8192771084  0.7866666667  32.000000000  0.5598969489  0.0585918427  0.0088766846  500           0.0331331062 
0.7960000000  0.6825396825  0.7440000000  0.6269841270  0.8524096386  0.7951807229  0.8433734940  0.8433734940  0.8233333333  35.200000000  0.5228240591  0.0586013794  0.0102560242  550           0.0330621147 
0.7740000000  0.6746031746  0.7220000000  0.6111111111  0.8478915663  0.8253012048  0.8765060241  0.8795180723  0.7700000000  38.400000000  0.4969186020  0.0586013794  0.0120133222  600           0.0328251886 
0.7880000000  0.6666666667  0.7100000000  0.5952380952  0.8509036145  0.8253012048  0.8659638554  0.8373493976  0.7633333333  41.600000000  0.4775755030  0.0615720749  0.0127892325  650           0.0312356472 
0.7920000000  0.6746031746  0.7120000000  0.5873015873  0.8704819277  0.8313253012  0.9006024096  0.8915662651  0.7433333333  44.800000000  0.4559174609  0.0615720749  0.0141443968  700           0.0319005013 
0.8200000000  0.7380952381  0.7560000000  0.6190476190  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7600000000  48.000000000  0.4380651706  0.0615720749  0.0146536771  750           0.0322667551 
0.8160000000  0.6984126984  0.7340000000  0.6190476190  0.8900602410  0.8493975904  0.9337349398  0.9397590361  0.7466666667  51.200000000  0.4128440714  0.0615720749  0.0151030729  800           0.0320303726 
0.8540000000  0.7698412698  0.8000000000  0.6428571429  0.8584337349  0.8554216867  0.8885542169  0.9036144578  0.7866666667  54.400000000  0.4032918805  0.0615720749  0.0156271937  850           0.0328392172 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             1.6020693779 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6460843373  0.6325301205  0.6174698795  0.5903614458  0.3333333333  3.2000000000  1.0885902977  0.0584797859  50            0.0262768650 
0.4400000000  0.3809523810  0.3940000000  0.3492063492  0.7213855422  0.7048192771  0.7906626506  0.7530120482  0.3400000000  6.4000000000  1.0225170028  0.0584797859  100           0.0267193079 
0.4840000000  0.4126984127  0.4300000000  0.3730158730  0.7409638554  0.7349397590  0.8313253012  0.7831325301  0.3400000000  9.6000000000  0.9725380445  0.0584797859  150           0.0276702070 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7665662651  0.7289156627  0.8042168675  0.7590361446  0.3466666667  12.800000000  0.9227569604  0.0584936142  200           0.0267101097 
0.6100000000  0.5079365079  0.5040000000  0.4603174603  0.7620481928  0.7349397590  0.8102409639  0.7710843373  0.3833333333  16.000000000  0.8565853465  0.0585279465  250           0.0283688927 
0.6360000000  0.5317460317  0.5520000000  0.5476190476  0.7575301205  0.7530120482  0.8237951807  0.7650602410  0.4233333333  19.200000000  0.7725161803  0.0585417747  300           0.0283961916 
0.6780000000  0.5396825397  0.6500000000  0.5873015873  0.7650602410  0.7349397590  0.7816265060  0.7530120482  0.6833333333  22.400000000  0.6962408984  0.0586166382  350           0.0279610348 
0.7220000000  0.6349206349  0.6900000000  0.6190476190  0.8027108434  0.7891566265  0.8132530120  0.7590361446  0.8100000000  25.600000000  0.6357664907  0.0586166382  400           0.0282528639 
0.7360000000  0.6428571429  0.6960000000  0.6031746032  0.7680722892  0.7349397590  0.8463855422  0.8072289157  0.7566666667  28.800000000  0.5955067039  0.0586166382  450           0.0283149242 
0.7700000000  0.6666666667  0.7160000000  0.6190476190  0.8147590361  0.7891566265  0.8463855422  0.8192771084  0.8133333333  32.000000000  0.5510424501  0.0586166382  500           0.0273226261 
0.8020000000  0.7063492063  0.7600000000  0.6507936508  0.8524096386  0.8072289157  0.8298192771  0.8253012048  0.8466666667  35.200000000  0.5137320542  0.0586166382  550           0.0281650400 
0.7960000000  0.7063492063  0.7340000000  0.6349206349  0.8509036145  0.8373493976  0.8584337349  0.8674698795  0.8200000000  38.400000000  0.4868571657  0.0586166382  600           0.0276018238 
0.7960000000  0.6904761905  0.7120000000  0.6111111111  0.8509036145  0.8253012048  0.8463855422  0.8192771084  0.7866666667  41.600000000  0.4677641279  0.0586166382  650           0.0287009954 
Could not connect to 127.0.0.1: 37561
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 458, in start_client
    s.connect((host, port))
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 638, in new_fork
    _on_forked_process()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 74, in _on_forked_process
    pydevd.settrace_forked()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1887, in settrace_forked
    host, port = dispatch()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1872, in dispatch
    dispatcher.connect(host, port)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1826, in connect
    self.client = start_client(self.host, self.port)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 458, in start_client
    s.connect((host, port))
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 634, in new_fork
    child_process = getattr(os, original_name)()  # fork
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1043350) is killed by signal: Terminated. 
Could not connect to 127.0.0.1: 37561
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 458, in start_client
    s.connect((host, port))
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 638, in new_fork
    _on_forked_process()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 74, in _on_forked_process
    pydevd.settrace_forked()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1887, in settrace_forked
    host, port = dispatch()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1872, in dispatch
    dispatcher.connect(host, port)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1826, in connect
    self.client = start_client(self.host, self.port)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 458, in start_client
    s.connect((host, port))
ConnectionRefusedError: [Errno 111] Connection refused
We've got an error while stopping in post-mortem: <class 'RuntimeError'>

Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    RuntimeError: DataLoader worker (pid 1043198) is killed by signal: Terminated. 
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521492958  0             0.3783233166 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6460843373  0.6325301205  0.6174698795  0.5903614458  0.3333333333  3.2000000000  1.0885902977  0.0585384369  50            0.0271585751 
0.4400000000  0.3809523810  0.3940000000  0.3492063492  0.7213855422  0.7048192771  0.7906626506  0.7530120482  0.3400000000  6.4000000000  1.0225170028  0.0585384369  100           0.0277995920 
0.4840000000  0.4126984127  0.4300000000  0.3730158730  0.7409638554  0.7349397590  0.8313253012  0.7831325301  0.3400000000  9.6000000000  0.9725380445  0.0585384369  150           0.0278155375 
0.5720000000  0.4603174603  0.4840000000  0.4365079365  0.7665662651  0.7289156627  0.8042168675  0.7590361446  0.3466666667  12.800000000  0.9227569604  0.0585384369  200           0.0279288578 
0.6100000000  0.5079365079  0.5040000000  0.4603174603  0.7620481928  0.7349397590  0.8102409639  0.7710843373  0.3833333333  16.000000000  0.8565853465  0.0585384369  250           0.0276820660 
0.6360000000  0.5317460317  0.5520000000  0.5476190476  0.7575301205  0.7530120482  0.8237951807  0.7650602410  0.4233333333  19.200000000  0.7725161803  0.0585513115  300           0.0285201263 
0.6780000000  0.5396825397  0.6500000000  0.5873015873  0.7650602410  0.7349397590  0.7816265060  0.7530120482  0.6833333333  22.400000000  0.6962408984  0.0585513115  350           0.0280710220 
0.7220000000  0.6349206349  0.6900000000  0.6190476190  0.8027108434  0.7891566265  0.8132530120  0.7590361446  0.8100000000  25.600000000  0.6357664907  0.0585513115  400           0.0278663778 
0.7360000000  0.6428571429  0.6960000000  0.6031746032  0.7680722892  0.7349397590  0.8463855422  0.8072289157  0.7566666667  28.800000000  0.5955067039  0.0585513115  450           0.0282616949 
0.7700000000  0.6666666667  0.7160000000  0.6190476190  0.8147590361  0.7891566265  0.8463855422  0.8192771084  0.8133333333  32.000000000  0.5510424501  0.0585513115  500           0.0292791033 
0.8020000000  0.7063492063  0.7600000000  0.6507936508  0.8524096386  0.8072289157  0.8298192771  0.8253012048  0.8466666667  35.200000000  0.5137320542  0.0585513115  550           0.0290635490 
0.7960000000  0.7063492063  0.7340000000  0.6349206349  0.8509036145  0.8373493976  0.8584337349  0.8674698795  0.8200000000  38.400000000  0.4868571657  0.0585513115  600           0.0269753742 
0.7960000000  0.6904761905  0.7120000000  0.6111111111  0.8509036145  0.8253012048  0.8463855422  0.8192771084  0.7866666667  41.600000000  0.4677641279  0.0585513115  650           0.0275637865 
0.8000000000  0.6904761905  0.7060000000  0.5952380952  0.8659638554  0.8493975904  0.8810240964  0.8734939759  0.7733333333  44.800000000  0.4440859377  0.0585513115  700           0.0289226103 
0.8220000000  0.7539682540  0.7680000000  0.6428571429  0.8614457831  0.8433734940  0.8840361446  0.8975903614  0.7933333333  48.000000000  0.4258887321  0.0585513115  750           0.0277212954 
0.8140000000  0.7142857143  0.7220000000  0.6349206349  0.8780120482  0.8493975904  0.9081325301  0.9096385542  0.7766666667  51.200000000  0.3989466709  0.0585513115  800           0.0276916504 
0.8500000000  0.8015873016  0.8000000000  0.6428571429  0.8524096386  0.8554216867  0.8478915663  0.8614457831  0.7733333333  54.400000000  0.3887472343  0.0585513115  850           0.0283834410 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3331329823 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6340361446  0.6084337349  0.6234939759  0.5903614458  0.3333333333  3.2000000000  1.0887905717  0.0585908890  0.0036286129  50            0.0326683617 
0.4400000000  0.3888888889  0.4000000000  0.3650793651  0.7063253012  0.6927710843  0.7996987952  0.7650602410  0.3400000000  6.4000000000  1.0233835459  0.0585908890  0.0035932592  100           0.0320562315 
0.4880000000  0.4206349206  0.4340000000  0.3968253968  0.7259036145  0.7108433735  0.8373493976  0.7951807229  0.3400000000  9.6000000000  0.9734797788  0.0585908890  0.0040327660  150           0.0310766649 
0.5740000000  0.4761904762  0.4900000000  0.4444444444  0.7545180723  0.7409638554  0.8192771084  0.7710843373  0.3466666667  12.800000000  0.9235190010  0.0586047173  0.0044478468  200           0.0319262362 
0.6000000000  0.5158730159  0.5180000000  0.4761904762  0.7349397590  0.7349397590  0.8373493976  0.7951807229  0.3800000000  16.000000000  0.8574966848  0.0586047173  0.0047544128  250           0.0321816969 
0.6380000000  0.5317460317  0.5640000000  0.5396825397  0.7334337349  0.7168674699  0.8539156627  0.8132530120  0.4266666667  19.200000000  0.7734115613  0.0586047173  0.0047431128  300           0.0317972374 
0.6780000000  0.5555555556  0.6460000000  0.5873015873  0.7605421687  0.7289156627  0.8087349398  0.7650602410  0.6900000000  22.400000000  0.6978601730  0.0588564873  0.0050109300  350           0.0324292469 
0.7300000000  0.6269841270  0.6920000000  0.6190476190  0.7996987952  0.7891566265  0.8162650602  0.7590361446  0.7900000000  25.600000000  0.6389575541  0.0588564873  0.0060025550  400           0.0327463245 
0.7300000000  0.6349206349  0.6880000000  0.5793650794  0.7695783133  0.7409638554  0.8493975904  0.8072289157  0.7433333333  28.800000000  0.5997356021  0.0588564873  0.0076099738  450           0.0320523405 
0.7620000000  0.6587301587  0.7100000000  0.5952380952  0.8132530120  0.7951807229  0.8463855422  0.8192771084  0.7833333333  32.000000000  0.5567857391  0.0588564873  0.0096716401  500           0.0324039221 
0.7980000000  0.6825396825  0.7520000000  0.6349206349  0.8569277108  0.8012048193  0.8358433735  0.8373493976  0.8300000000  35.200000000  0.5197908282  0.0588564873  0.0113154559  550           0.0318007421 
0.7780000000  0.6746031746  0.7300000000  0.6190476190  0.8478915663  0.8253012048  0.8750000000  0.8734939759  0.7800000000  38.400000000  0.4936393881  0.0588564873  0.0134169746  600           0.0321801233 
0.7940000000  0.6746031746  0.7140000000  0.6111111111  0.8509036145  0.8253012048  0.8629518072  0.8373493976  0.7633333333  41.600000000  0.4741820741  0.0611729622  0.0145187117  650           0.0317886829 
0.7880000000  0.6746031746  0.7160000000  0.5873015873  0.8704819277  0.8433734940  0.8930722892  0.8734939759  0.7533333333  44.800000000  0.4520701152  0.0611729622  0.0161605125  700           0.0325640011 
0.8200000000  0.7380952381  0.7540000000  0.6269841270  0.8674698795  0.8433734940  0.8930722892  0.9096385542  0.7800000000  48.000000000  0.4341102225  0.0616383553  0.0169584996  750           0.0324617004 
0.8160000000  0.7063492063  0.7300000000  0.6190476190  0.8840361446  0.8614457831  0.9277108434  0.9277108434  0.7566666667  51.200000000  0.4088988382  0.0616383553  0.0177306183  800           0.0319523764 
0.8520000000  0.7857142857  0.8000000000  0.6428571429  0.8554216867  0.8554216867  0.8855421687  0.8915662651  0.7966666667  54.400000000  0.3989405918  0.0616383553  0.0184740849  850           0.0322309637 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.25
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3793745041 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6340361446  0.6084337349  0.6204819277  0.5903614458  0.3333333333  3.2000000000  1.0888605666  0.0585322380  0.0035705252  50            0.0327996826 
0.4400000000  0.3888888889  0.4020000000  0.3650793651  0.7033132530  0.6927710843  0.7996987952  0.7650602410  0.3400000000  6.4000000000  1.0236210907  0.0585908890  0.0034437259  100           0.0319876528 
0.4900000000  0.4206349206  0.4340000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.8012048193  0.3400000000  9.6000000000  0.9738303792  0.0585908890  0.0038170696  150           0.0321368408 
0.5740000000  0.4682539683  0.4900000000  0.4523809524  0.7545180723  0.7409638554  0.8237951807  0.7771084337  0.3466666667  12.800000000  0.9239427531  0.0586900711  0.0041639855  200           0.0319230938 
0.6000000000  0.5158730159  0.5140000000  0.4761904762  0.7319277108  0.7228915663  0.8403614458  0.7951807229  0.3766666667  16.000000000  0.8582583511  0.0586900711  0.0044474068  250           0.0319419003 
0.6400000000  0.5238095238  0.5640000000  0.5476190476  0.7289156627  0.7108433735  0.8554216867  0.8192771084  0.4300000000  19.200000000  0.7742255378  0.0586900711  0.0044492868  300           0.0311999846 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1116108) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.25
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3393304348 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6340361446  0.6084337349  0.6204819277  0.5903614458  0.3333333333  3.2000000000  1.0888605666  0.0585427284  0.0035705252  50            0.0329284859 
0.4400000000  0.3888888889  0.4020000000  0.3650793651  0.7033132530  0.6927710843  0.7996987952  0.7650602410  0.3400000000  6.4000000000  1.0236210907  0.0585427284  0.0034437259  100           0.0315745735 
0.4900000000  0.4206349206  0.4340000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.8012048193  0.3400000000  9.6000000000  0.9738303792  0.0585427284  0.0038170696  150           0.0321055365 
0.5740000000  0.4682539683  0.4900000000  0.4523809524  0.7545180723  0.7409638554  0.8237951807  0.7771084337  0.3466666667  12.800000000  0.9239427531  0.0585427284  0.0041639855  200           0.0316673136 
0.6000000000  0.5158730159  0.5140000000  0.4761904762  0.7319277108  0.7228915663  0.8403614458  0.7951807229  0.3766666667  16.000000000  0.8582583511  0.0585427284  0.0044474068  250           0.0318588209 
0.6400000000  0.5238095238  0.5640000000  0.5476190476  0.7289156627  0.7108433735  0.8554216867  0.8192771084  0.4300000000  19.200000000  0.7742255378  0.0585427284  0.0044492868  300           0.0320659637 
0.6760000000  0.5476190476  0.6480000000  0.5873015873  0.7515060241  0.7289156627  0.8147590361  0.7650602410  0.6900000000  22.400000000  0.6988718045  0.0585427284  0.0047575048  350           0.0305418730 
0.7300000000  0.6269841270  0.6880000000  0.6190476190  0.7951807229  0.7831325301  0.8162650602  0.7590361446  0.7866666667  25.600000000  0.6401538050  0.0585427284  0.0057520856  400           0.0326286221 
0.7240000000  0.6269841270  0.6880000000  0.5714285714  0.7695783133  0.7409638554  0.8493975904  0.8072289157  0.7400000000  28.800000000  0.6011833894  0.0585427284  0.0072724725  450           0.0320361567 
0.7620000000  0.6587301587  0.7100000000  0.6031746032  0.8162650602  0.7951807229  0.8463855422  0.8192771084  0.7866666667  32.000000000  0.5584159708  0.0585427284  0.0092279192  500           0.0320625830 
0.7980000000  0.6825396825  0.7480000000  0.6349206349  0.8569277108  0.8012048193  0.8358433735  0.8373493976  0.8233333333  35.200000000  0.5213471293  0.0585427284  0.0107352873  550           0.0330373573 
0.7760000000  0.6746031746  0.7280000000  0.6111111111  0.8478915663  0.8253012048  0.8765060241  0.8795180723  0.7800000000  38.400000000  0.4952692473  0.0585427284  0.0126457347  600           0.0319549227 
0.7880000000  0.6746031746  0.7120000000  0.6031746032  0.8478915663  0.8253012048  0.8659638554  0.8373493976  0.7666666667  41.600000000  0.4758732224  0.0605578423  0.0135708252  650           0.0320549774 
0.7900000000  0.6746031746  0.7140000000  0.5873015873  0.8704819277  0.8433734940  0.8975903614  0.8795180723  0.7500000000  44.800000000  0.4540228522  0.0605578423  0.0150387861  700           0.0319112253 
0.8220000000  0.7380952381  0.7540000000  0.6269841270  0.8674698795  0.8433734940  0.8975903614  0.9036144578  0.7733333333  48.000000000  0.4360588014  0.0605578423  0.0156789265  750           0.0321996641 
0.8140000000  0.6984126984  0.7320000000  0.6190476190  0.8870481928  0.8493975904  0.9307228916  0.9397590361  0.7433333333  51.200000000  0.4108297622  0.0622615814  0.0162747661  800           0.0324334383 
0.8520000000  0.7777777778  0.7980000000  0.6428571429  0.8584337349  0.8554216867  0.8870481928  0.8975903614  0.7933333333  54.400000000  0.4011313045  0.0622615814  0.0168897740  850           0.0310493469 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3532798290 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6204819277  0.5903614458  0.6219879518  0.5843373494  0.3333333333  3.2000000000  1.0890639567  0.0584588051  0.0034014111  50            0.0326721478 
0.4460000000  0.3888888889  0.4040000000  0.3650793651  0.6972891566  0.6807228916  0.7966867470  0.7650602410  0.3400000000  6.4000000000  1.0245223999  0.0584979057  0.0030425546  100           0.0315328598 
0.4940000000  0.4206349206  0.4380000000  0.3968253968  0.7213855422  0.6927710843  0.8403614458  0.7951807229  0.3400000000  9.6000000000  0.9748928332  0.0584979057  0.0033062060  150           0.0321793270 
0.5780000000  0.4761904762  0.4900000000  0.4523809524  0.7439759036  0.7349397590  0.8388554217  0.7891566265  0.3433333333  12.800000000  0.9252501059  0.0584979057  0.0035614868  200           0.0316112852 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 2
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3579163551 
0.4180000000  0.3730158730  0.3680000000  0.3492063492  0.6204819277  0.5903614458  0.6219879518  0.5843373494  0.3333333333  3.2000000000  1.0890639567  0.0585937500  0.0034014111  50            0.0320258141 
0.4460000000  0.3888888889  0.4040000000  0.3650793651  0.6972891566  0.6807228916  0.7966867470  0.7650602410  0.3400000000  6.4000000000  1.0245223999  0.0585937500  0.0030425546  100           0.0317217541 
0.4940000000  0.4206349206  0.4380000000  0.3968253968  0.7213855422  0.6927710843  0.8403614458  0.7951807229  0.3400000000  9.6000000000  0.9748928332  0.0585937500  0.0033062060  150           0.0326480770 
0.5780000000  0.4761904762  0.4900000000  0.4523809524  0.7439759036  0.7349397590  0.8388554217  0.7891566265  0.3433333333  12.800000000  0.9252501059  0.0586075783  0.0035614868  200           0.0319571638 
0.6040000000  0.4920634921  0.5100000000  0.4761904762  0.7228915663  0.7228915663  0.8554216867  0.8192771084  0.3700000000  16.000000000  0.8600868571  0.0586075783  0.0038425045  250           0.0329206133 
0.6400000000  0.5238095238  0.5600000000  0.5476190476  0.7319277108  0.7108433735  0.8554216867  0.8313253012  0.4266666667  19.200000000  0.7762992859  0.0586552620  0.0038786103  300           0.0324969673 
0.6700000000  0.5634920635  0.6520000000  0.5793650794  0.7500000000  0.7228915663  0.8177710843  0.7650602410  0.6866666667  22.400000000  0.7014191258  0.0586552620  0.0042648725  350           0.0318564224 
0.7180000000  0.6031746032  0.6840000000  0.6190476190  0.7891566265  0.7831325301  0.8207831325  0.7650602410  0.7700000000  25.600000000  0.6429490995  0.0586552620  0.0052600416  400           0.0326477051 
0.7280000000  0.6349206349  0.6760000000  0.5793650794  0.7665662651  0.7409638554  0.8463855422  0.8072289157  0.7366666667  28.800000000  0.6048405981  0.0586552620  0.0066087483  450           0.0322393417 
0.7620000000  0.6507936508  0.7020000000  0.5793650794  0.8117469880  0.7891566265  0.8433734940  0.8192771084  0.7766666667  32.000000000  0.5623187512  0.0586552620  0.0082909502  500           0.0321959877 
0.7900000000  0.6825396825  0.7400000000  0.6269841270  0.8599397590  0.8132530120  0.8328313253  0.8373493976  0.8000000000  35.200000000  0.5254752403  0.0586957932  0.0094491664  550           0.0327301931 
0.7720000000  0.6825396825  0.7220000000  0.6190476190  0.8478915663  0.8253012048  0.8750000000  0.8734939759  0.7700000000  38.400000000  0.5002784455  0.0586957932  0.0109506271  600           0.0314405107 
0.7800000000  0.6666666667  0.7040000000  0.5952380952  0.8509036145  0.8253012048  0.8659638554  0.8373493976  0.7600000000  41.600000000  0.4813083339  0.0586957932  0.0114956824  650           0.0334512854 
0.7860000000  0.6666666667  0.7180000000  0.5952380952  0.8719879518  0.8373493976  0.9036144578  0.8915662651  0.7400000000  44.800000000  0.4599647629  0.0586957932  0.0126624314  700           0.0330873156 
0.8240000000  0.7301587302  0.7600000000  0.6349206349  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7500000000  48.000000000  0.4421360832  0.0616765022  0.0130018662  750           0.0311233854 
0.8100000000  0.6984126984  0.7360000000  0.6190476190  0.8930722892  0.8493975904  0.9307228916  0.9397590361  0.7366666667  51.200000000  0.4167676377  0.0616765022  0.0132604383  800           0.0328348064 
0.8540000000  0.7698412698  0.8000000000  0.6428571429  0.8629518072  0.8614457831  0.8945783133  0.9036144578  0.7700000000  54.400000000  0.4072425461  0.0616765022  0.0136894155  850           0.0327136421 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.75
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3417215347 
0.4200000000  0.3730158730  0.3680000000  0.3492063492  0.6219879518  0.5963855422  0.6265060241  0.5903614458  0.3333333333  3.2000000000  1.0889952683  0.0585427284  0.0034550192  50            0.0314528513 
0.4460000000  0.3888888889  0.4000000000  0.3650793651  0.6972891566  0.6807228916  0.7966867470  0.7650602410  0.3400000000  6.4000000000  1.0242669141  0.0585427284  0.0031656893  100           0.0323951006 
0.4940000000  0.4206349206  0.4380000000  0.3968253968  0.7213855422  0.7048192771  0.8403614458  0.7951807229  0.3400000000  9.6000000000  0.9745394862  0.0615229607  0.0034563065  150           0.0315631008 
0.5760000000  0.4761904762  0.4880000000  0.4523809524  0.7469879518  0.7349397590  0.8328313253  0.7891566265  0.3466666667  12.800000000  0.9248672700  0.0615229607  0.0037299068  200           0.0318328285 
0.6020000000  0.5079365079  0.5120000000  0.4761904762  0.7243975904  0.7168674699  0.8493975904  0.8192771084  0.3733333333  16.000000000  0.8596106601  0.0615229607  0.0040107472  250           0.0316330481 
0.6380000000  0.5317460317  0.5640000000  0.5476190476  0.7334337349  0.7168674699  0.8584337349  0.8313253012  0.4266666667  19.200000000  0.7757616138  0.0615229607  0.0040327645  300           0.0320038700 
0.6700000000  0.5634920635  0.6500000000  0.5793650794  0.7530120482  0.7228915663  0.8177710843  0.7650602410  0.6833333333  22.400000000  0.7007043719  0.0615229607  0.0043844086  350           0.0316687584 
0.7220000000  0.6111111111  0.6880000000  0.6190476190  0.7936746988  0.7891566265  0.8162650602  0.7590361446  0.7700000000  25.600000000  0.6421292162  0.0615229607  0.0053808702  400           0.0318692684 
0.7280000000  0.6269841270  0.6800000000  0.5793650794  0.7665662651  0.7409638554  0.8463855422  0.8072289157  0.7366666667  28.800000000  0.6037042904  0.0615229607  0.0067809904  450           0.0318879890 
0.7620000000  0.6507936508  0.7080000000  0.5873015873  0.8132530120  0.7951807229  0.8463855422  0.8192771084  0.7700000000  32.000000000  0.5611470723  0.0615229607  0.0085571205  500           0.0323428631 
0.7940000000  0.6825396825  0.7400000000  0.6349206349  0.8584337349  0.8072289157  0.8388554217  0.8373493976  0.7966666667  35.200000000  0.5241919219  0.0625405312  0.0097985537  550           0.0319266605 
0.7740000000  0.6746031746  0.7220000000  0.6190476190  0.8478915663  0.8253012048  0.8750000000  0.8734939759  0.7766666667  38.400000000  0.4986789685  0.0625405312  0.0114175525  600           0.0325868177 
0.7840000000  0.6666666667  0.7060000000  0.6031746032  0.8539156627  0.8253012048  0.8689759036  0.8373493976  0.7500000000  41.600000000  0.4795294994  0.0625405312  0.0120576381  650           0.0320034409 
0.7880000000  0.6666666667  0.7200000000  0.5873015873  0.8719879518  0.8373493976  0.9021084337  0.8855421687  0.7433333333  44.800000000  0.4581568140  0.0625405312  0.0133274047  700           0.0327138233 
0.8220000000  0.7380952381  0.7600000000  0.6269841270  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7566666667  48.000000000  0.4402916229  0.0625405312  0.0137234894  750           0.0317755651 
0.8140000000  0.6984126984  0.7360000000  0.6111111111  0.8870481928  0.8493975904  0.9337349398  0.9397590361  0.7433333333  51.200000000  0.4150481695  0.0625405312  0.0140751749  800           0.0330891180 
0.8560000000  0.7698412698  0.8040000000  0.6507936508  0.8599397590  0.8614457831  0.8915662651  0.9036144578  0.7733333333  54.400000000  0.4053892958  0.0625405312  0.0145550366  850           0.0326333952 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.45
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
    p.join()AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1213820) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.45
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1217300) is killed by signal: Terminated. 
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.45
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  1.1199481487  0.0521550179  0.0037104930  0             0.3337490559 
0.4200000000  0.3730158730  0.3680000000  0.3492063492  0.6280120482  0.6084337349  0.6204819277  0.5903614458  0.3333333333  3.2000000000  1.0889283085  0.0584588051  0.0035226773  50            0.0315270996 
0.4440000000  0.3888888889  0.4040000000  0.3650793651  0.7018072289  0.6867469880  0.7996987952  0.7650602410  0.3400000000  6.4000000000  1.0238806236  0.0584979057  0.0033251430  100           0.0315632963 
0.4900000000  0.4206349206  0.4360000000  0.3968253968  0.7183734940  0.7048192771  0.8388554217  0.8012048193  0.3400000000  9.6000000000  0.9741235650  0.0584979057  0.0036598320  150           0.0322186565 
0.5760000000  0.4682539683  0.4900000000  0.4444444444  0.7469879518  0.7349397590  0.8268072289  0.7891566265  0.3466666667  12.800000000  0.9243576884  0.0585174561  0.0039683808  200           0.0330887604 
0.6020000000  0.5000000000  0.5120000000  0.4761904762  0.7289156627  0.7228915663  0.8448795181  0.8012048193  0.3733333333  16.000000000  0.8587654722  0.0613989830  0.0042489842  250           0.0328986597 
0.6360000000  0.5238095238  0.5660000000  0.5476190476  0.7289156627  0.7108433735  0.8584337349  0.8313253012  0.4266666667  19.200000000  0.7749202025  0.0613989830  0.0042571217  300           0.0320997238 
0.6720000000  0.5634920635  0.6520000000  0.5793650794  0.7515060241  0.7289156627  0.8147590361  0.7650602410  0.6900000000  22.400000000  0.6996842659  0.0613989830  0.0045866656  350           0.0319391108 
0.7220000000  0.6190476190  0.6880000000  0.6190476190  0.7891566265  0.7831325301  0.8162650602  0.7590361446  0.7700000000  25.600000000  0.6410313356  0.0613989830  0.0055855374  400           0.0318598557 
0.7280000000  0.6269841270  0.6800000000  0.5873015873  0.7695783133  0.7409638554  0.8493975904  0.8072289157  0.7366666667  28.800000000  0.6023909760  0.0613989830  0.0070806329  450           0.0318989563 
0.7620000000  0.6587301587  0.7060000000  0.6031746032  0.8162650602  0.7951807229  0.8463855422  0.8192771084  0.7833333333  32.000000000  0.5595528561  0.0613989830  0.0089551417  500           0.0318950796 
0.7940000000  0.6825396825  0.7480000000  0.6349206349  0.8584337349  0.8072289157  0.8358433735  0.8373493976  0.8233333333  35.200000000  0.5223539269  0.0613989830  0.0103378892  550           0.0324842739 
0.7780000000  0.6746031746  0.7220000000  0.6111111111  0.8509036145  0.8253012048  0.8765060241  0.8795180723  0.7733333333  38.400000000  0.4966481143  0.0613989830  0.0121091448  600           0.0319743633 
0.7900000000  0.6666666667  0.7080000000  0.6031746032  0.8539156627  0.8253012048  0.8689759036  0.8373493976  0.7666666667  41.600000000  0.4774247217  0.0613989830  0.0128809850  650           0.0323882437 
0.7900000000  0.6746031746  0.7140000000  0.5873015873  0.8704819277  0.8313253012  0.8975903614  0.8795180723  0.7466666667  44.800000000  0.4557060909  0.0613989830  0.0142443919  700           0.0323138142 
0.8180000000  0.7380952381  0.7540000000  0.6190476190  0.8674698795  0.8433734940  0.9006024096  0.9036144578  0.7600000000  48.000000000  0.4378328174  0.0613989830  0.0147728774  750           0.0316296482 
0.8160000000  0.6984126984  0.7340000000  0.6111111111  0.8870481928  0.8493975904  0.9307228916  0.9397590361  0.7466666667  51.200000000  0.4124088281  0.0613989830  0.0152425549  800           0.0324954653 
0.8540000000  0.7698412698  0.7980000000  0.6428571429  0.8584337349  0.8554216867  0.8915662651  0.9036144578  0.7900000000  54.400000000  0.4028303039  0.0613989830  0.0157887427  850           0.0327325678 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	mldg_beta: 1.0
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  2.2755838037  0.0312581062  0             0.4136464596 
0.4180000000  0.4047619048  0.3700000000  0.3888888889  0.4743975904  0.4759036145  0.5256024096  0.5722891566  0.3333333333  3.2000000000  2.1565827215  0.0355005264  50            0.0875152493 
0.3880000000  0.3730158730  0.3740000000  0.3412698413  0.6009036145  0.6204819277  0.6716867470  0.6746987952  0.3333333333  6.4000000000  1.9957983854  0.0356063843  100           0.0958480644 
0.3860000000  0.3730158730  0.3900000000  0.3412698413  0.6114457831  0.6144578313  0.7213855422  0.7289156627  0.3366666667  9.6000000000  1.8491854778  0.0356063843  150           0.0931668282 
0.3780000000  0.3730158730  0.3860000000  0.3412698413  0.5813253012  0.5783132530  0.6656626506  0.6746987952  0.3333333333  12.800000000  1.6994625896  0.0356063843  200           0.0934142685 
0.3700000000  0.3730158730  0.3780000000  0.3412698413  0.5527108434  0.5481927711  0.5677710843  0.5843373494  0.3333333333  16.000000000  1.5173622093  0.0356063843  250           0.0938272095 
0.3680000000  0.3730158730  0.3660000000  0.3412698413  0.5030120482  0.5180722892  0.4578313253  0.4698795181  0.3333333333  19.200000000  1.3600835106  0.0356063843  300           0.0869024849 
0.3800000000  0.3888888889  0.3780000000  0.3492063492  0.5240963855  0.5180722892  0.5030120482  0.5301204819  0.3366666667  22.400000000  1.2244182342  0.0356063843  350           0.0917183399 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 587, in update
    allow_unused=True)
KeyboardInterrupt
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.0005
	mldg_beta: 1.0
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3600000000  0.3492063492  0.3440000000  0.3333333333  0.4156626506  0.4337349398  0.3524096386  0.3493975904  0.3333333333  0.0000000000  2.3091602623  0.0312581062  0             0.4236814976 
0.3800000000  0.4047619048  0.3400000000  0.3412698413  0.3915662651  0.4096385542  0.3328313253  0.3313253012  0.3333333333  3.2000000000  1.0126208578  0.0355195999  50            0.0855517817 
0.4320000000  0.4444444444  0.3720000000  0.3888888889  0.3750000000  0.3795180723  0.3328313253  0.3313253012  0.3333333333  6.4000000000  0.3551140011  0.0355195999  100           0.0864056635 
0.4540000000  0.4444444444  0.4200000000  0.4365079365  0.4759036145  0.4819277108  0.3734939759  0.3855421687  0.3366666667  9.6000000000  0.1474071878  0.0355362892  150           0.0860609484 
0.5240000000  0.5079365079  0.5060000000  0.5476190476  0.6144578313  0.5903614458  0.5978915663  0.6084337349  0.5066666667  12.800000000  0.0687280632  0.0355362892  200           0.0865598869 
0.4380000000  0.4444444444  0.3780000000  0.3650793651  0.3960843373  0.4156626506  0.3328313253  0.3313253012  0.3333333333  16.000000000  0.0346216404  0.0355362892  250           0.0867380333 
0.4920000000  0.4682539683  0.4720000000  0.4920634921  0.5030120482  0.5060240964  0.3840361446  0.4036144578  0.3433333333  19.200000000  0.0195415878  0.0355362892  300           0.0873235559 
0.4660000000  0.4603174603  0.4120000000  0.4126984127  0.4126506024  0.4457831325  0.3328313253  0.3313253012  0.3333333333  22.400000000  0.0173760759  0.0355362892  350           0.0903136444 
0.4940000000  0.4682539683  0.4580000000  0.5079365079  0.4487951807  0.4578313253  0.3433734940  0.3493975904  0.3466666667  25.600000000  0.0125597192  0.0355362892  400           0.0869677973 
0.5120000000  0.4841269841  0.4960000000  0.5238095238  0.5240963855  0.5180722892  0.4442771084  0.4397590361  0.3833333333  28.800000000  0.0088798113  0.0355362892  450           0.0887650919 
0.6680000000  0.6666666667  0.6660000000  0.6666666667  0.6475903614  0.6506024096  0.7665662651  0.7771084337  0.3966666667  32.000000000  0.0070729720  0.0355362892  500           0.0870541573 
0.6200000000  0.5793650794  0.5760000000  0.6031746032  0.5722891566  0.5662650602  0.5888554217  0.6084337349  0.5866666667  35.200000000  0.0068489298  0.0355362892  550           0.0876075172 
0.6360000000  0.5793650794  0.5900000000  0.6269841270  0.5843373494  0.5662650602  0.6310240964  0.6445783133  0.5700000000  38.400000000  0.0051742676  0.0355362892  600           0.0865292263 
0.6340000000  0.5793650794  0.5880000000  0.6031746032  0.5873493976  0.5783132530  0.6415662651  0.6626506024  0.5866666667  41.600000000  0.0038458687  0.0358934402  650           0.0930007601 
0.6680000000  0.6666666667  0.6500000000  0.6587301587  0.6566265060  0.6385542169  0.7484939759  0.7650602410  0.4766666667  44.800000000  0.0065802301  0.0358934402  700           0.0852389765 
0.5180000000  0.4841269841  0.4900000000  0.5158730159  0.5391566265  0.5301204819  0.4503012048  0.4759036145  0.3566666667  48.000000000  0.0030415228  0.0358934402  750           0.0876165009 
0.4920000000  0.4603174603  0.4300000000  0.4126984127  0.4638554217  0.4698795181  0.3403614458  0.3493975904  0.3333333333  51.200000000  0.0061299370  0.0358934402  800           0.0883646345 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.4849397590  0.4578313253  0.7259036145  0.7349397590  0.3500000000  54.400000000  0.0044652121  0.0358934402  850           0.0886730242 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	mldg_beta: 1.0
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  2.2685197294  0.0312581062  0             0.4065315723 
0.3660000000  0.3571428571  0.3700000000  0.3412698413  0.5572289157  0.5542168675  0.5737951807  0.5843373494  0.3333333333  3.2000000000  1.8818310121  0.0354862213  50            0.0865409088 
0.4240000000  0.4365079365  0.4000000000  0.3571428571  0.4954819277  0.5120481928  0.4623493976  0.4759036145  0.3366666667  6.4000000000  1.2153797044  0.0355005264  100           0.0872531509 
0.5080000000  0.5000000000  0.4960000000  0.5238095238  0.6219879518  0.6204819277  0.7153614458  0.7168674699  0.5566666667  9.6000000000  0.8223056346  0.0355591774  150           0.0866670942 
0.5180000000  0.5079365079  0.5080000000  0.5238095238  0.6265060241  0.6265060241  0.7063253012  0.7168674699  0.5500000000  12.800000000  0.6453958778  0.0355591774  200           0.0873030901 
0.6520000000  0.6587301587  0.6400000000  0.6269841270  0.6445783133  0.6385542169  0.7756024096  0.7771084337  0.6033333333  16.000000000  0.5089315461  0.0355591774  250           0.0872242451 
0.6640000000  0.6666666667  0.6640000000  0.6587301587  0.5421686747  0.5301204819  0.7048192771  0.7108433735  0.3866666667  19.200000000  0.4132193473  0.0355591774  300           0.0873005104 
0.6640000000  0.6666666667  0.6680000000  0.6666666667  0.5105421687  0.5120481928  0.6656626506  0.6746987952  0.3433333333  22.400000000  0.3522157604  0.0355591774  350           0.0875291967 
0.5880000000  0.6111111111  0.6560000000  0.6587301587  0.4337349398  0.3975903614  0.5677710843  0.5722891566  0.3333333333  25.600000000  0.2831805545  0.0355591774  400           0.0860380793 
0.4760000000  0.4682539683  0.5600000000  0.6031746032  0.3644578313  0.3493975904  0.4909638554  0.4939759036  0.3333333333  28.800000000  0.2400852692  0.0355591774  450           0.0870784950 
0.3460000000  0.3730158730  0.4160000000  0.4523809524  0.3328313253  0.3313253012  0.4472891566  0.4518072289  0.3333333333  32.000000000  0.1981992888  0.0355591774  500           0.0880527067 
0.3560000000  0.3809523810  0.4400000000  0.4603174603  0.3328313253  0.3313253012  0.4472891566  0.4518072289  0.3333333333  35.200000000  0.1728855213  0.0355591774  550           0.0915026760 
0.3340000000  0.3333333333  0.3520000000  0.3492063492  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  38.400000000  0.1413137220  0.0355591774  600           0.0917455959 
0.3380000000  0.3650793651  0.3880000000  0.4206349206  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  41.600000000  0.1270882435  0.0355591774  650           0.0911634445 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 587, in update
    allow_unused=True)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 197, in grad
    inputs = (inputs,) if isinstance(inputs, torch.Tensor) else tuple(inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1261, in parameters
    for name, param in self.named_parameters(recurse=recurse):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1287, in named_parameters
    for elem in gen:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1231, in _named_members
    for module_prefix, module in modules:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1429, in named_modules
    for m in module.named_modules(memo, submodule_prefix):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1429, in named_modules
    for m in module.named_modules(memo, submodule_prefix):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1429, in named_modules
    for m in module.named_modules(memo, submodule_prefix):
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3809523810  0.3200000000  0.3650793651  0.3569277108  0.3192771084  0.4141566265  0.4156626506  0.4047619048  0.0000000000  0.2088990808  1.1561778784  0.0563254356  0             0.5330061913 
0.4760000000  0.3571428571  0.4940000000  0.4126984127  0.5451807229  0.5301204819  0.5421686747  0.5180722892  0.4365079365  3.2000000000  0.1512940288  1.0858359480  0.0605063438  50            0.1768838215 
0.4760000000  0.4285714286  0.4760000000  0.4682539683  0.4924698795  0.5361445783  0.5707831325  0.5602409639  0.4603174603  6.4000000000  0.1004757345  1.0612950683  0.0605063438  100           0.1687858057 
0.5300000000  0.5079365079  0.5200000000  0.4920634921  0.7003012048  0.6807228916  0.7063253012  0.7168674699  0.5301587302  9.6000000000  0.0914842427  1.0531449699  0.0605063438  150           0.1702078533 
0.5460000000  0.5158730159  0.5340000000  0.4444444444  0.7108433735  0.6506024096  0.7635542169  0.7530120482  0.5507936508  12.800000000  0.0879260719  1.0287800717  0.0605063438  200           0.1704551649 
0.6140000000  0.5317460317  0.6100000000  0.5555555556  0.8087349398  0.7771084337  0.7213855422  0.7530120482  0.5809523810  16.000000000  0.1101896346  0.9970663095  0.0605063438  250           0.1714444923 
0.6840000000  0.5873015873  0.6680000000  0.6269841270  0.7379518072  0.7349397590  0.7469879518  0.7108433735  0.6730158730  19.200000000  0.1207642555  0.9605737042  0.0605063438  300           0.1746108198 
0.6180000000  0.5476190476  0.6240000000  0.6111111111  0.7500000000  0.7590361446  0.8298192771  0.8132530120  0.6460317460  22.400000000  0.1311122596  0.9092923284  0.0634789467  350           0.1708399725 
0.5620000000  0.5238095238  0.5360000000  0.5476190476  0.8840361446  0.8012048193  0.7921686747  0.7951807229  0.6761904762  25.600000000  0.1338886410  0.8553787708  0.0634789467  400           0.1709324503 
0.5820000000  0.5238095238  0.6020000000  0.5952380952  0.8614457831  0.8192771084  0.8734939759  0.8313253012  0.6952380952  28.800000000  0.1990851527  0.7859668398  0.0634789467  450           0.1694774580 
0.6620000000  0.6587301587  0.6800000000  0.6428571429  0.8388554217  0.8253012048  0.8493975904  0.8192771084  0.7841269841  32.000000000  0.1770966321  0.7323047435  0.0634789467  500           0.1710382462 
0.7240000000  0.7063492063  0.6700000000  0.6111111111  0.9081325301  0.8614457831  0.8750000000  0.8253012048  0.8000000000  35.200000000  0.2062908506  0.6846158493  0.0634789467  550           0.1673954964 
0.7360000000  0.7698412698  0.6700000000  0.6111111111  0.8433734940  0.8192771084  0.8704819277  0.8554216867  0.8142857143  38.400000000  0.2292673945  0.6426601839  0.0634789467  600           0.1725428581 
0.7740000000  0.8253968254  0.6960000000  0.6746031746  0.8689759036  0.7891566265  0.8268072289  0.8012048193  0.8126984127  41.600000000  0.2363484818  0.6053857636  0.0634789467  650           0.1674757385 
0.7700000000  0.7539682540  0.7100000000  0.6587301587  0.8478915663  0.8012048193  0.9954819277  0.9457831325  0.8015873016  44.800000000  0.2294034556  0.5716073513  0.0634789467  700           0.1759223366 
0.8360000000  0.9047619048  0.8220000000  0.7142857143  0.8750000000  0.8493975904  0.9698795181  0.9397590361  0.7746031746  48.000000000  0.2146944863  0.5528572083  0.0634789467  750           0.1715516615 
0.8040000000  0.8412698413  0.7800000000  0.6428571429  0.9713855422  0.9337349398  0.9141566265  0.8975903614  0.8301587302  51.200000000  0.2327338865  0.5317156810  0.0634789467  800           0.1751668596 
0.8860000000  0.8888888889  0.8240000000  0.6904761905  0.9216867470  0.8674698795  0.9412650602  0.9216867470  0.7730158730  54.400000000  0.2185559532  0.5084251541  0.0634789467  850           0.1829473305 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3444444444  0.0000000000  0.3645455837  1.1524477005  0.0539793968  0             0.4790585041 
0.4040000000  0.3730158730  0.3720000000  0.3492063492  0.4804216867  0.4879518072  0.3734939759  0.3373493976  0.4238095238  3.2000000000  0.1772725463  1.1033680630  0.0620965958  50            0.1725199842 
0.4320000000  0.4047619048  0.4100000000  0.3650793651  0.4427710843  0.4337349398  0.3900602410  0.3433734940  0.4206349206  6.4000000000  0.1304577231  1.0841080713  0.0620965958  100           0.1680024576 
0.4400000000  0.4206349206  0.4620000000  0.4126984127  0.4563253012  0.4277108434  0.4186746988  0.3975903614  0.4507936508  9.6000000000  0.1407905489  1.0746172523  0.0630931854  150           0.1684193277 
0.4880000000  0.4523809524  0.4860000000  0.4365079365  0.5150602410  0.5301204819  0.3960843373  0.3674698795  0.4523809524  12.800000000  0.1265559703  1.0719041204  0.0630931854  200           0.1676058578 
0.4840000000  0.4444444444  0.4480000000  0.3888888889  0.5572289157  0.5662650602  0.4307228916  0.4216867470  0.4571428571  16.000000000  0.1207760394  1.0675013399  0.0630931854  250           0.1757503128 
0.5120000000  0.5158730159  0.5040000000  0.4206349206  0.6204819277  0.5903614458  0.5542168675  0.5060240964  0.4841269841  19.200000000  0.1272573054  1.0592082524  0.0630931854  300           0.1736601830 
0.5000000000  0.4920634921  0.4640000000  0.3968253968  0.5753012048  0.5783132530  0.5105421687  0.5000000000  0.4777777778  22.400000000  0.1165877104  1.0529104376  0.0630931854  350           0.1722728491 
0.4800000000  0.4523809524  0.4320000000  0.3650793651  0.5271084337  0.5542168675  0.4713855422  0.4518072289  0.4634920635  25.600000000  0.1185866594  1.0500988293  0.0630931854  400           0.1705369806 
0.5100000000  0.4920634921  0.4480000000  0.3650793651  0.5286144578  0.5240963855  0.4548192771  0.4216867470  0.4571428571  28.800000000  0.1212382197  1.0405656123  0.0630931854  450           0.1669044399 
0.5500000000  0.5158730159  0.5120000000  0.4126984127  0.6114457831  0.6144578313  0.6114457831  0.6144578313  0.5079365079  32.000000000  0.1116123408  1.0420798230  0.0630931854  500           0.1709863329 
0.5780000000  0.5476190476  0.5140000000  0.4047619048  0.5557228916  0.5843373494  0.6852409639  0.6325301205  0.5365079365  35.200000000  0.0964395463  1.0382253671  0.0630931854  550           0.1725408936 
0.5960000000  0.5317460317  0.5800000000  0.5238095238  0.6701807229  0.7048192771  0.7003012048  0.7048192771  0.5126984127  38.400000000  0.0977869481  1.0296067739  0.0630931854  600           0.1742889261 
0.6420000000  0.5634920635  0.5800000000  0.4682539683  0.6626506024  0.6987951807  0.6987951807  0.6987951807  0.5619047619  41.600000000  0.1002508342  1.0272022057  0.0630931854  650           0.1695165157 
0.6300000000  0.5793650794  0.5940000000  0.5000000000  0.7259036145  0.7469879518  0.7560240964  0.7228915663  0.5857142857  44.800000000  0.0994685173  1.0250438499  0.0630931854  700           0.1768700981 
0.5640000000  0.5158730159  0.5640000000  0.5238095238  0.7575301205  0.7409638554  0.7319277108  0.7349397590  0.5285714286  48.000000000  0.1070968807  1.0183532834  0.0630931854  750           0.1714447641 
0.5640000000  0.5158730159  0.5800000000  0.5158730159  0.7725903614  0.8012048193  0.7846385542  0.7650602410  0.5412698413  51.200000000  0.1047965288  1.0114959550  0.0630931854  800           0.1750964928 
0.5840000000  0.5238095238  0.5640000000  0.5158730159  0.8192771084  0.7831325301  0.8132530120  0.7710843373  0.5587301587  54.400000000  0.1122874677  1.0033526456  0.0630931854  850           0.1707808924 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4782197475 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0604581833  50            0.1707988453 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0604581833  100           0.1766485739 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0604581833  150           0.1684426546 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0605168343  200           0.1697912407 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0605168343  250           0.1727523994 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0605168343  300           0.1667216349 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0605168343  350           0.1686342955 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0605168343  400           0.1730992317 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0605168343  450           0.1679768944 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0605678558  500           0.1725963640 
0.8840000000  0.8968253968  0.8900000000  0.7936507937  0.8885542169  0.8554216867  0.8403614458  0.8554216867  0.7507936508  35.200000000  0.2419313052  0.3252618343  0.0605678558  550           0.1696054506 
0.9100000000  0.9365079365  0.8640000000  0.7936507937  0.8750000000  0.8614457831  0.9713855422  0.9578313253  0.4380952381  38.400000000  0.2657356302  0.2643318608  0.0605678558  600           0.1694717884 
0.9660000000  0.9365079365  0.9920000000  0.9047619048  0.8885542169  0.9036144578  1.0000000000  1.0000000000  0.4761904762  41.600000000  0.2468533722  0.2249038902  0.0625076294  650           0.1781736898 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1965, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0001
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4360000000  0.4285714286  0.4120000000  0.3571428571  0.4231927711  0.4397590361  0.3975903614  0.3734939759  0.4333333333  0.0000000000  0.1275363564  1.1524477005  0.0563254356  0             0.4903783798 
0.4880000000  0.4603174603  0.5340000000  0.5238095238  0.4533132530  0.4277108434  0.5722891566  0.5301204819  0.4936507937  3.2000000000  0.1537893713  1.0594015503  0.0604138374  50            0.1706071138 
0.6000000000  0.5317460317  0.6380000000  0.5317460317  0.7349397590  0.6987951807  0.7334337349  0.7168674699  0.5793650794  6.4000000000  0.1233890772  1.0100021398  0.0604572296  100           0.1695920467 
0.6480000000  0.6587301587  0.6220000000  0.5634920635  0.8554216867  0.8554216867  0.7680722892  0.7228915663  0.6984126984  9.6000000000  0.1728001684  0.9190026784  0.0604581833  150           0.1688457203 
0.7020000000  0.6984126984  0.6840000000  0.5952380952  0.7454819277  0.7650602410  0.7771084337  0.7590361446  0.6666666667  12.800000000  0.2109431827  0.8063762128  0.0605788231  200           0.1701304388 
0.6240000000  0.6190476190  0.6560000000  0.5952380952  0.7575301205  0.7409638554  0.7861445783  0.7469879518  0.6968253968  16.000000000  0.2529338211  0.7314094532  0.0605788231  250           0.1726074600 
0.6840000000  0.7222222222  0.6960000000  0.5634920635  0.8313253012  0.8192771084  0.8358433735  0.8012048193  0.6920634921  19.200000000  0.2089112642  0.6341001499  0.0605788231  300           0.1742306042 
0.7760000000  0.7619047619  0.7400000000  0.5873015873  0.9668674699  0.9156626506  0.9201807229  0.8975903614  0.7301587302  22.400000000  0.2249380550  0.5830028903  0.0605788231  350           0.1718406343 
0.7380000000  0.7380952381  0.7060000000  0.5714285714  0.9533132530  0.9216867470  0.9819277108  0.9759036145  0.7825396825  25.600000000  0.2120336467  0.5494807762  0.0605788231  400           0.1780168629 
0.8420000000  0.8571428571  0.7980000000  0.6507936508  0.8780120482  0.8614457831  0.9352409639  0.9337349398  0.7222222222  28.800000000  0.2595955116  0.5254607683  0.0635037422  450           0.1730163717 
0.8680000000  0.8571428571  0.8160000000  0.5952380952  0.8960843373  0.9096385542  0.9668674699  0.9518072289  0.7523809524  32.000000000  0.2196786618  0.4923178989  0.0635037422  500           0.1727295732 
0.8400000000  0.8174603175  0.7600000000  0.5793650794  0.9518072289  0.9277108434  0.8463855422  0.8795180723  0.8126984127  35.200000000  0.2258685312  0.4722198802  0.0635037422  550           0.1776197815 
0.8960000000  0.8730158730  0.8600000000  0.7142857143  0.9864457831  0.9698795181  0.9593373494  0.9698795181  0.6809523810  38.400000000  0.2502111736  0.4584288645  0.0635037422  600           0.1813200617 
0.9120000000  0.8571428571  0.8600000000  0.6666666667  0.9487951807  0.9156626506  0.9337349398  0.9036144578  0.6507936508  41.600000000  0.2319312763  0.4424760151  0.0635037422  650           0.1710326433 
0.8680000000  0.7301587302  0.8540000000  0.6904761905  0.9367469880  0.9156626506  0.9909638554  1.0000000000  0.7031746032  44.800000000  0.1917438310  0.4273447996  0.0635037422  700           0.1682837343 
0.9040000000  0.8333333333  0.9180000000  0.7698412698  0.8750000000  0.8975903614  0.9608433735  0.9759036145  0.5666666667  48.000000000  0.2499551696  0.3926160061  0.0635037422  750           0.1713046837 
0.9360000000  0.8968253968  0.8820000000  0.6746031746  0.9216867470  0.9156626506  0.9939759036  1.0000000000  0.7444444444  51.200000000  0.2171059528  0.3695397156  0.0635037422  800           0.1760661268 
0.9160000000  0.9047619048  0.9280000000  0.6984126984  0.9352409639  0.9216867470  0.9939759036  1.0000000000  0.6428571429  54.400000000  0.2253329962  0.3512157696  0.0635037422  850           0.1682301331 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0001
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4280000000  0.4285714286  0.3880000000  0.3412698413  0.4337349398  0.4337349398  0.4186746988  0.3975903614  0.4444444444  0.0000000000  0.2283233404  1.1561778784  0.0563254356  0             0.4780228138 
0.4420000000  0.4047619048  0.4780000000  0.4682539683  0.6716867470  0.6144578313  0.5647590361  0.5240963855  0.4000000000  3.2000000000  0.1478052437  1.0659815955  0.0624632835  50            0.1715241146 
0.5460000000  0.5158730159  0.5420000000  0.5238095238  0.6159638554  0.5963855422  0.6385542169  0.5421686747  0.5126984127  6.4000000000  0.1248036236  1.0195044219  0.0624632835  100           0.1711784887 
0.5900000000  0.4920634921  0.5400000000  0.5396825397  0.7831325301  0.7469879518  0.8614457831  0.8433734940  0.5158730159  9.6000000000  0.1204638183  0.9738578010  0.0624632835  150           0.1710105944 
0.6680000000  0.5555555556  0.6760000000  0.6349206349  0.8509036145  0.8132530120  0.8222891566  0.8072289157  0.6920634921  12.800000000  0.1386551648  0.8839935422  0.0624632835  200           0.1729232740 
0.5940000000  0.5555555556  0.6300000000  0.6111111111  0.7816265060  0.7530120482  0.7590361446  0.7108433735  0.6587301587  16.000000000  0.1950571954  0.7894366050  0.0624632835  250           0.1710560131 
0.7920000000  0.7460317460  0.6660000000  0.6746031746  0.8930722892  0.8734939759  0.7665662651  0.7530120482  0.7317460317  19.200000000  0.2043951958  0.6976800895  0.0624632835  300           0.1702702427 
0.8180000000  0.8253968254  0.7380000000  0.6825396825  0.9186746988  0.9156626506  0.9141566265  0.9457831325  0.7682539683  22.400000000  0.2246947140  0.6203418612  0.0624632835  350           0.1716466045 
0.7440000000  0.7063492063  0.6780000000  0.6666666667  0.9578313253  0.9277108434  0.7876506024  0.8012048193  0.7253968254  25.600000000  0.2131765631  0.5827919960  0.0624632835  400           0.1728488731 
0.8480000000  0.8730158730  0.7940000000  0.7380952381  0.8734939759  0.8674698795  0.8674698795  0.8433734940  0.7634920635  28.800000000  0.2318875107  0.5299135768  0.0624632835  450           0.1739236832 
0.8160000000  0.8412698413  0.8040000000  0.6904761905  0.8734939759  0.8795180723  0.9021084337  0.8975903614  0.7412698413  32.000000000  0.2350289840  0.4986653244  0.0624632835  500           0.1723169327 
0.8300000000  0.8809523810  0.7920000000  0.7142857143  0.9216867470  0.8674698795  0.7816265060  0.7771084337  0.7444444444  35.200000000  0.2470668197  0.4922255909  0.0624632835  550           0.1717734909 
0.8500000000  0.8730158730  0.8320000000  0.7380952381  0.9262048193  0.9096385542  0.9728915663  0.9638554217  0.6968253968  38.400000000  0.2601678100  0.4690281212  0.0633845329  600           0.1727485275 
0.8180000000  0.7777777778  0.8120000000  0.7063492063  0.8539156627  0.8132530120  0.8915662651  0.8554216867  0.5968253968  41.600000000  0.2345222273  0.4290800327  0.0638637543  650           0.1702144337 
0.8620000000  0.8650793651  0.8340000000  0.7301587302  0.9834337349  0.9578313253  0.9819277108  0.9879518072  0.8333333333  44.800000000  0.2347687033  0.4164865053  0.0638637543  700           0.1753538084 
0.8820000000  0.8253968254  0.9380000000  0.8095238095  0.9713855422  0.9698795181  0.9954819277  0.9819277108  0.6539682540  48.000000000  0.2503231767  0.3912515080  0.0638637543  750           0.1858545351 
0.8840000000  0.8571428571  0.8860000000  0.7698412698  0.9668674699  0.9277108434  1.0000000000  1.0000000000  0.7857142857  51.200000000  0.2087779179  0.3771785176  0.0677990913  800           0.1737680101 
0.9320000000  0.8888888889  0.9240000000  0.7777777778  0.9728915663  0.9397590361  1.0000000000  1.0000000000  0.7238095238  54.400000000  0.2249376193  0.3544593358  0.0677990913  850           0.1730126619 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3720000000  0.3650793651  0.3540000000  0.3492063492  0.6490963855  0.6084337349  0.6174698795  0.5662650602  0.3809523810  0.0000000000  0.3615057468  1.1561778784  0.0539793968  0             0.4847722054 
0.5360000000  0.5317460317  0.5360000000  0.5793650794  0.6490963855  0.6084337349  0.6596385542  0.6626506024  0.5539682540  3.2000000000  0.2017986745  1.0208707917  0.0630211830  50            0.1736685181 
0.6400000000  0.6428571429  0.5820000000  0.5952380952  0.7921686747  0.7349397590  0.7605421687  0.7530120482  0.6825396825  6.4000000000  0.2154226691  0.8338650405  0.0630211830  100           0.1762910748 
0.7380000000  0.7539682540  0.7040000000  0.6825396825  0.8012048193  0.8072289157  0.7635542169  0.7409638554  0.8000000000  9.6000000000  0.2517008200  0.6285696876  0.0644111633  150           0.1802456188 
0.7680000000  0.7777777778  0.7180000000  0.6349206349  0.7409638554  0.6506024096  0.6837349398  0.6746987952  0.6571428571  12.800000000  0.2460836294  0.5246899807  0.0644111633  200           0.1806374264 
0.6720000000  0.6904761905  0.6680000000  0.6666666667  0.9774096386  0.9457831325  0.8539156627  0.8253012048  0.6698412698  16.000000000  0.2839040297  0.4811392301  0.0644111633  250           0.1914528847 
0.8140000000  0.8492063492  0.8200000000  0.7777777778  0.7756024096  0.8132530120  0.9849397590  0.9759036145  0.8904761905  19.200000000  0.2426318544  0.4505567020  0.0644111633  300           0.1768177652 
0.8360000000  0.8412698413  0.8360000000  0.8174603175  0.8885542169  0.9036144578  0.9894578313  0.9819277108  0.8158730159  22.400000000  0.2463013878  0.4011737651  0.0644111633  350           0.1689014196 
0.8080000000  0.8253968254  0.8240000000  0.7857142857  0.9111445783  0.8734939759  0.8388554217  0.8614457831  0.8158730159  25.600000000  0.2485448140  0.3718120098  0.0644111633  400           0.1691041279 
0.8640000000  0.8571428571  0.8500000000  0.8015873016  0.8689759036  0.8614457831  0.9653614458  0.9698795181  0.7047619048  28.800000000  0.2779712018  0.3450753987  0.0644111633  450           0.1714407539 
0.8500000000  0.8333333333  0.8820000000  0.8412698413  0.8930722892  0.8614457831  0.9728915663  0.9638554217  0.3460317460  32.000000000  0.2253262275  0.2917491800  0.0644111633  500           0.1710661316 
0.9360000000  0.9444444444  0.9360000000  0.8809523810  0.9307228916  0.8915662651  0.8343373494  0.8674698795  0.6666666667  35.200000000  0.2687938143  0.2736084631  0.0644111633  550           0.1818548298 
0.9480000000  0.9285714286  0.9700000000  0.9206349206  0.9849397590  0.9879518072  0.8900602410  0.9337349398  0.5428571429  38.400000000  0.2783926141  0.2403288537  0.0644111633  600           0.1692305470 
0.9660000000  0.9523809524  0.9660000000  0.8968253968  0.9759036145  0.9638554217  0.9608433735  0.9518072289  0.5619047619  41.600000000  0.2387436806  0.1817065758  0.0644111633  650           0.1736193371 
0.9620000000  0.9444444444  0.9740000000  0.9206349206  0.9292168675  0.9457831325  1.0000000000  1.0000000000  0.6698412698  44.800000000  0.2345488055  0.1615230285  0.0644111633  700           0.1785267210 
0.9880000000  0.9682539683  0.9940000000  0.9206349206  0.8870481928  0.8975903614  0.9759036145  0.9638554217  0.6936507937  48.000000000  0.2066005206  0.1338029043  0.0644111633  750           0.1812608528 
0.9560000000  0.9126984127  0.9840000000  0.9523809524  1.0000000000  1.0000000000  0.9503012048  0.9578313253  0.8015873016  51.200000000  0.1780196163  0.1053306082  0.0644111633  800           0.1782366037 
0.9880000000  0.9206349206  0.9840000000  0.9285714286  1.0000000000  1.0000000000  0.9879518072  1.0000000000  0.5730158730  54.400000000  0.1611617914  0.0982361323  0.0644111633  850           0.1741937828 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00025
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4040000000  0.3809523810  0.3660000000  0.3650793651  0.6024096386  0.5783132530  0.5918674699  0.5240963855  0.4571428571  0.0000000000  0.2453483641  1.1561778784  0.0539793968  0             0.4927527905 
0.5380000000  0.5555555556  0.5920000000  0.5634920635  0.3855421687  0.3614457831  0.4864457831  0.4759036145  0.4920634921  3.2000000000  0.1613447905  1.0592384958  0.0604581833  50            0.1809356880 
0.5500000000  0.5158730159  0.6000000000  0.6111111111  0.7033132530  0.6807228916  0.8283132530  0.7951807229  0.5984126984  6.4000000000  0.1278130889  0.9716328788  0.0604581833  100           0.1850274372 
0.7160000000  0.6825396825  0.6580000000  0.6190476190  0.8027108434  0.8132530120  0.7018072289  0.6746987952  0.7523809524  9.6000000000  0.1795436233  0.8307972491  0.0605025291  150           0.1713561201 
0.7860000000  0.8015873016  0.7260000000  0.6190476190  0.9156626506  0.8915662651  0.7530120482  0.7469879518  0.7444444444  12.800000000  0.2354645669  0.6697514784  0.0605025291  200           0.1789618778 
0.7500000000  0.8095238095  0.7200000000  0.6904761905  0.9864457831  0.9819277108  0.8222891566  0.7951807229  0.7285714286  16.000000000  0.2684050441  0.5643583930  0.0605025291  250           0.1780591202 
0.7780000000  0.7698412698  0.7720000000  0.6904761905  0.7454819277  0.7289156627  0.9156626506  0.9036144578  0.6873015873  19.200000000  0.2125114247  0.5202391446  0.0631289482  300           0.1771243143 
0.8120000000  0.8333333333  0.7880000000  0.6984126984  0.9036144578  0.8795180723  0.9427710843  0.9277108434  0.7698412698  22.400000000  0.2168512154  0.4728814399  0.0631289482  350           0.1719518709 
0.8200000000  0.8492063492  0.7640000000  0.6746031746  0.9578313253  0.9036144578  0.7831325301  0.7831325301  0.8158730159  25.600000000  0.2342818031  0.4512764347  0.0631289482  400           0.1711541748 
0.8420000000  0.8253968254  0.9060000000  0.8015873016  0.7319277108  0.7469879518  0.8975903614  0.8674698795  0.5682539683  28.800000000  0.2389116740  0.4222030872  0.0631289482  450           0.1707389736 
0.8020000000  0.8095238095  0.8080000000  0.7301587302  0.9367469880  0.9036144578  0.9066265060  0.8915662651  0.4666666667  32.000000000  0.2605690473  0.3841814089  0.0631289482  500           0.1723752975 
0.8900000000  0.9047619048  0.8620000000  0.7857142857  0.9503012048  0.9096385542  0.8689759036  0.8855421687  0.8349206349  35.200000000  0.2256539550  0.3577417225  0.0631289482  550           0.1721124649 
0.8320000000  0.8333333333  0.8340000000  0.7380952381  0.8975903614  0.8674698795  0.9954819277  0.9939759036  0.5952380952  38.400000000  0.2634923533  0.3240120494  0.0631289482  600           0.1725031471 
0.9340000000  0.9126984127  0.9020000000  0.8253968254  0.8885542169  0.8915662651  1.0000000000  0.9879518072  0.6984126984  41.600000000  0.2524211521  0.3086915526  0.0631289482  650           0.1812680960 
0.9700000000  0.9285714286  0.9740000000  0.8809523810  0.9066265060  0.9277108434  0.9969879518  1.0000000000  0.7317460317  44.800000000  0.2233195789  0.2614578652  0.0631289482  700           0.1707468510 
0.9740000000  0.9365079365  0.9800000000  0.9206349206  0.8870481928  0.8975903614  1.0000000000  1.0000000000  0.7587301587  48.000000000  0.2112172768  0.2005084267  0.0631289482  750           0.1737397814 
0.9800000000  0.9365079365  0.9720000000  0.8809523810  0.9698795181  0.9518072289  1.0000000000  1.0000000000  0.8047619048  51.200000000  0.2385201278  0.1830356108  0.0631289482  800           0.1724510479 
0.9840000000  0.9126984127  0.9900000000  0.9285714286  0.9894578313  0.9819277108  0.9909638554  0.9879518072  0.7000000000  54.400000000  0.2269391586  0.1531142394  0.0631289482  850           0.1687821293 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 87, in <module>
    hparams = hparams_registry.default_hparams(args.algorithm, args.dataset)   #  
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/hparams_registry.py", line 211, in default_hparams
    return {a: b for a, (b, c) in _hparams(algorithm, dataset, 0).items()}
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/hparams_registry.py", line 154, in _hparams
    _hparam('t_lambda', 2.5, lambda r: 10 ** r.uniform(-2, 1))  # best 2.5// 500 50 update  2.75 // 400 50
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/hparams_registry.py", line 22, in _hparam
    assert(name not in hparams)
AssertionError
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3809523810  0.3200000000  0.3650793651  0.3569277108  0.3192771084  0.4141566265  0.4156626506  0.4047619048  0.0000000000  0.2083626390  1.1561778784  0.0563254356  0             0.4684388638 
0.4940000000  0.4206349206  0.5220000000  0.4444444444  0.5527108434  0.5240963855  0.5030120482  0.4939759036  0.4523809524  3.2000000000  0.1495712161  1.0849273753  0.0604138374  50            0.1707509899 
0.4940000000  0.4841269841  0.5480000000  0.5476190476  0.4879518072  0.4819277108  0.5557228916  0.5481927711  0.4888888889  6.4000000000  0.0913987547  1.0633805251  0.0605754852  100           0.1713574839 
0.4920000000  0.4365079365  0.4240000000  0.4206349206  0.7108433735  0.6987951807  0.6837349398  0.6987951807  0.4523809524  9.6000000000  0.0930115998  1.0563893819  0.0605754852  150           0.1722748756 
0.5200000000  0.4603174603  0.4800000000  0.4682539683  0.6475903614  0.6506024096  0.7560240964  0.7469879518  0.5206349206  12.800000000  0.0892269611  1.0328043127  0.0605754852  200           0.1685191631 
0.6180000000  0.6111111111  0.6820000000  0.6031746032  0.7183734940  0.6807228916  0.6189759036  0.6566265060  0.5539682540  16.000000000  0.1153998107  1.0091335261  0.0622186661  250           0.1697049522 
0.6840000000  0.6190476190  0.6740000000  0.6428571429  0.7605421687  0.7771084337  0.7831325301  0.7831325301  0.7063492063  19.200000000  0.1026149035  0.9808006263  0.0622186661  300           0.1701566172 
0.6340000000  0.5317460317  0.6020000000  0.5873015873  0.8072289157  0.7831325301  0.8614457831  0.8313253012  0.6603174603  22.400000000  0.1224679947  0.9273375010  0.0622186661  350           0.1725004053 
0.5880000000  0.5396825397  0.5800000000  0.5634920635  0.8027108434  0.7650602410  0.9201807229  0.9096385542  0.6698412698  25.600000000  0.1371196449  0.8760725319  0.0622186661  400           0.1696054792 
0.5840000000  0.5634920635  0.6200000000  0.6111111111  0.8283132530  0.8072289157  0.9021084337  0.8855421687  0.6936507937  28.800000000  0.1719302565  0.7997370529  0.0622186661  450           0.1730816412 
0.6520000000  0.6587301587  0.6600000000  0.6507936508  0.8915662651  0.8433734940  0.8539156627  0.8253012048  0.7682539683  32.000000000  0.1799394965  0.7463342440  0.0622186661  500           0.1679887104 
0.7220000000  0.7063492063  0.6600000000  0.6428571429  0.8373493976  0.8433734940  0.9503012048  0.9216867470  0.7936507937  35.200000000  0.1858843476  0.6887592947  0.0622186661  550           0.1718121195 
0.7300000000  0.7460317460  0.6820000000  0.6587301587  0.8659638554  0.8493975904  0.9262048193  0.9096385542  0.7873015873  38.400000000  0.2188268834  0.6512725770  0.0622186661  600           0.1706403112 
0.7960000000  0.8412698413  0.7020000000  0.6666666667  0.9156626506  0.8795180723  0.9081325301  0.8855421687  0.7984126984  41.600000000  0.2149007094  0.6115308189  0.0622186661  650           0.1702173471 
0.7280000000  0.7380952381  0.7260000000  0.6746031746  0.9337349398  0.8915662651  0.9352409639  0.9337349398  0.8079365079  44.800000000  0.2173806596  0.5844715655  0.0622186661  700           0.1714928198 
0.8140000000  0.8888888889  0.8180000000  0.7698412698  0.8539156627  0.8493975904  0.9593373494  0.9698795181  0.8174603175  48.000000000  0.2150144064  0.5663781083  0.0622186661  750           0.1720969534 
0.7940000000  0.8333333333  0.7200000000  0.6746031746  0.9231927711  0.8734939759  0.9412650602  0.9096385542  0.8206349206  51.200000000  0.1947704387  0.5396973884  0.0622186661  800           0.1690078068 
0.8340000000  0.8968253968  0.8360000000  0.7142857143  0.8975903614  0.8674698795  0.9909638554  0.9638554217  0.8047619048  54.400000000  0.2142481819  0.5201699692  0.0622186661  850           0.1711226368 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 1
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3809523810  0.3200000000  0.3650793651  0.3569277108  0.3192771084  0.4141566265  0.4156626506  0.4047619048  0.0000000000  0.2085551620  1.1561778784  0.0563254356  0             0.4787886143 
0.4820000000  0.4761904762  0.5020000000  0.5079365079  0.5557228916  0.6325301205  0.5783132530  0.5542168675  0.4650793651  3.2000000000  0.1526873767  1.0852331138  0.0605678558  50            0.1707016468 
0.5300000000  0.5079365079  0.5640000000  0.6031746032  0.4292168675  0.4397590361  0.4834337349  0.4759036145  0.4841269841  6.4000000000  0.1107574999  1.0598530912  0.0633730888  100           0.1692095709 
0.4700000000  0.4603174603  0.4580000000  0.4206349206  0.6626506024  0.6385542169  0.5542168675  0.5421686747  0.4619047619  9.6000000000  0.0834099531  1.0575237894  0.0633730888  150           0.1741301489 
0.5660000000  0.4841269841  0.5540000000  0.5158730159  0.8012048193  0.7469879518  0.6475903614  0.6626506024  0.5746031746  12.800000000  0.0826362014  1.0404156995  0.0633730888  200           0.1760981560 
0.5860000000  0.5000000000  0.6180000000  0.5158730159  0.7545180723  0.7289156627  0.6626506024  0.6987951807  0.5730158730  16.000000000  0.0876241535  1.0186200392  0.0633730888  250           0.1748155403 
0.6600000000  0.5476190476  0.6200000000  0.6031746032  0.8012048193  0.7710843373  0.7831325301  0.7590361446  0.6015873016  19.200000000  0.1015217811  0.9825131691  0.0633730888  300           0.1716249895 
0.6500000000  0.6111111111  0.6540000000  0.6190476190  0.8042168675  0.7951807229  0.8448795181  0.8373493976  0.7015873016  22.400000000  0.1194804311  0.9357697904  0.0633730888  350           0.1757690907 
0.6300000000  0.5793650794  0.6380000000  0.6111111111  0.8313253012  0.7831325301  0.8177710843  0.8132530120  0.6857142857  25.600000000  0.1201256216  0.8892356455  0.0633730888  400           0.1757517385 
0.5700000000  0.5396825397  0.5940000000  0.6031746032  0.8027108434  0.7771084337  0.8750000000  0.8373493976  0.6285714286  28.800000000  0.1651422381  0.8239491391  0.0633730888  450           0.1735233831 
0.6960000000  0.7301587302  0.6920000000  0.6111111111  0.8027108434  0.7891566265  0.7635542169  0.7530120482  0.8253968254  32.000000000  0.1877117306  0.7517734551  0.0633730888  500           0.1728378248 
0.6740000000  0.6587301587  0.6120000000  0.5793650794  0.8177710843  0.8012048193  0.9066265060  0.8795180723  0.7777777778  35.200000000  0.1904689366  0.6978243399  0.0633730888  550           0.1706527615 
0.7500000000  0.7301587302  0.6680000000  0.6507936508  0.8147590361  0.8012048193  0.8885542169  0.8554216867  0.7682539683  38.400000000  0.2245423055  0.6644057190  0.0635132790  600           0.1694306850 
0.8040000000  0.8174603175  0.7280000000  0.6507936508  0.8930722892  0.8614457831  0.7740963855  0.7831325301  0.7444444444  41.600000000  0.2110662043  0.6198803937  0.0635132790  650           0.1777745438 
0.7220000000  0.7142857143  0.7080000000  0.6587301587  0.8087349398  0.7530120482  0.9909638554  0.9638554217  0.7777777778  44.800000000  0.2359898365  0.5834812808  0.0635132790  700           0.1745881081 
0.8260000000  0.8492063492  0.7940000000  0.7063492063  0.7289156627  0.7228915663  0.8659638554  0.8373493976  0.7841269841  48.000000000  0.2100171226  0.5714863753  0.0635132790  750           0.1767746258 
0.7600000000  0.7301587302  0.7200000000  0.6666666667  0.9593373494  0.9337349398  0.9231927711  0.8975903614  0.7920634921  51.200000000  0.2258165345  0.5439055550  0.0635132790  800           0.1782255030 
0.8160000000  0.8730158730  0.8120000000  0.6587301587  0.9171686747  0.8855421687  0.9698795181  0.9518072289  0.8285714286  54.400000000  0.2085562372  0.5281949782  0.0635132790  850           0.1694641542 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3540000000  0.3412698413  0.3340000000  0.3333333333  0.3539156627  0.3192771084  0.4277108434  0.4337349398  0.2600000000  0.0000000000  0.2106440067  1.1524477005  0.0563254356  0             0.4729874134 
0.5120000000  0.4365079365  0.4680000000  0.3968253968  0.6325301205  0.6867469880  0.4819277108  0.4698795181  0.5133333333  3.2000000000  0.1471421897  1.0863261700  0.0604863167  50            0.1746867275 
0.5800000000  0.4682539683  0.6000000000  0.5079365079  0.6039156627  0.5361445783  0.7018072289  0.6987951807  0.6433333333  6.4000000000  0.1263157338  1.0488750672  0.0604863167  100           0.1889513206 
0.5400000000  0.4920634921  0.5900000000  0.5000000000  0.6686746988  0.6385542169  0.7530120482  0.6867469880  0.4766666667  9.6000000000  0.1122387886  1.0230613124  0.0605006218  150           0.1693225193 
0.6240000000  0.6031746032  0.6700000000  0.5793650794  0.7153614458  0.6807228916  0.7635542169  0.7650602410  0.6200000000  12.800000000  0.1212214410  0.9940004480  0.0605006218  200           0.1676911211 
0.6300000000  0.5634920635  0.6680000000  0.5714285714  0.7560240964  0.7349397590  0.7605421687  0.7530120482  0.6666666667  16.000000000  0.1453430861  0.9494834077  0.0624403954  250           0.1689911222 
0.5760000000  0.5634920635  0.6700000000  0.6428571429  0.8313253012  0.7710843373  0.7153614458  0.7289156627  0.6366666667  19.200000000  0.1503544211  0.8908771420  0.0624403954  300           0.1686958218 
0.6740000000  0.6111111111  0.6780000000  0.5476190476  0.7695783133  0.7891566265  0.8915662651  0.8674698795  0.7366666667  22.400000000  0.1669511259  0.8232347071  0.0624403954  350           0.1682366180 
0.5560000000  0.4920634921  0.5740000000  0.5158730159  0.8659638554  0.8012048193  0.7876506024  0.8012048193  0.4366666667  25.600000000  0.2233926892  0.7636528671  0.0624403954  400           0.1692433167 
0.6640000000  0.6031746032  0.6680000000  0.5476190476  0.8162650602  0.8072289157  0.8689759036  0.8493975904  0.6333333333  28.800000000  0.2383253390  0.7065511405  0.0624403954  450           0.1691751814 
0.6980000000  0.6666666667  0.6840000000  0.5634920635  0.7996987952  0.7289156627  0.8599397590  0.8373493976  0.6766666667  32.000000000  0.2237681985  0.6530180526  0.0624403954  500           0.1684245300 
0.6740000000  0.6666666667  0.6580000000  0.6111111111  0.9292168675  0.8614457831  0.8750000000  0.8614457831  0.6766666667  35.200000000  0.2350268900  0.6079860103  0.0624403954  550           0.1660945177 
0.8040000000  0.8095238095  0.6920000000  0.5952380952  0.8719879518  0.8614457831  0.9427710843  0.9277108434  0.6133333333  38.400000000  0.2675338709  0.5945701981  0.0624403954  600           0.1700182772 
0.7980000000  0.7460317460  0.7440000000  0.5952380952  0.8840361446  0.8373493976  0.8795180723  0.8433734940  0.6400000000  41.600000000  0.2228041664  0.5651975739  0.0624403954  650           0.1701557255 
0.7540000000  0.7460317460  0.7380000000  0.6111111111  0.9246987952  0.8554216867  0.9713855422  0.9698795181  0.5433333333  44.800000000  0.2376883507  0.5372160345  0.0624403954  700           0.1712277126 
0.8600000000  0.8095238095  0.8400000000  0.6666666667  0.9066265060  0.8915662651  0.9879518072  0.9759036145  0.4100000000  48.000000000  0.2522296464  0.5241366142  0.0624403954  750           0.1688503265 
0.8240000000  0.7301587302  0.7820000000  0.6190476190  0.9743975904  0.9578313253  0.9427710843  0.9277108434  0.5066666667  51.200000000  0.2239149365  0.5076096123  0.0631189346  800           0.1688239098 
0.8840000000  0.8095238095  0.8480000000  0.6587301587  0.9427710843  0.9156626506  0.9683734940  0.9698795181  0.4066666667  54.400000000  0.2089678344  0.4896085644  0.0631189346  850           0.1674767637 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3620000000  0.3650793651  0.3460000000  0.3412698413  0.3569277108  0.3192771084  0.4111445783  0.4156626506  0.2533333333  0.0000000000  0.0826622248  1.1524477005  0.0563254356  0             0.4875001907 
0.5620000000  0.5000000000  0.5660000000  0.5079365079  0.6506024096  0.6144578313  0.7530120482  0.7349397590  0.5100000000  3.2000000000  0.0566186893  1.0527866483  0.0604391098  50            0.1711740589 
0.5780000000  0.5634920635  0.6120000000  0.5396825397  0.7650602410  0.6867469880  0.8689759036  0.8493975904  0.4566666667  6.4000000000  0.0881935787  0.9100849867  0.0604510307  100           0.1728026533 
0.6680000000  0.6269841270  0.7060000000  0.6111111111  0.8358433735  0.8132530120  0.9036144578  0.8795180723  0.7433333333  9.6000000000  0.1005735850  0.7233445823  0.0604519844  150           0.1702591038 
0.7700000000  0.7619047619  0.7640000000  0.6111111111  0.8448795181  0.7771084337  0.8855421687  0.8674698795  0.8466666667  12.800000000  0.1203631777  0.6036172295  0.0604872704  200           0.1723852062 
0.7760000000  0.7460317460  0.7900000000  0.6031746032  0.8960843373  0.8734939759  0.8750000000  0.8493975904  0.8133333333  16.000000000  0.1258230603  0.5285587621  0.0633540154  250           0.1714517736 
0.8360000000  0.8095238095  0.8300000000  0.6269841270  0.9367469880  0.8915662651  0.9337349398  0.9277108434  0.6766666667  19.200000000  0.1189446688  0.4663957518  0.0633540154  300           0.1712242126 
0.8580000000  0.8095238095  0.8700000000  0.6269841270  0.9608433735  0.9156626506  0.9608433735  0.9397590361  0.4600000000  22.400000000  0.1141255862  0.4335644710  0.0633540154  350           0.1695026445 
0.8600000000  0.8015873016  0.8740000000  0.6587301587  0.9322289157  0.8855421687  0.9111445783  0.9096385542  0.6166666667  25.600000000  0.1218891752  0.4043434709  0.0633540154  400           0.1837530041 
0.8900000000  0.8492063492  0.8840000000  0.7142857143  0.9231927711  0.9216867470  0.9984939759  0.9819277108  0.5966666667  28.800000000  0.1389380911  0.3649831069  0.0633540154  450           0.1867956400 
0.9240000000  0.8888888889  0.9240000000  0.7063492063  0.9894578313  0.9578313253  0.9683734940  0.9457831325  0.5633333333  32.000000000  0.1077631167  0.3363204789  0.0633540154  500           0.1779305601 
0.9400000000  0.8888888889  0.9040000000  0.7222222222  0.9819277108  0.9518072289  0.9713855422  0.9578313253  0.5266666667  35.200000000  0.1022069880  0.3048041123  0.0633540154  550           0.1690051174 
0.9740000000  0.9206349206  0.9660000000  0.7619047619  0.9939759036  0.9759036145  0.9984939759  0.9819277108  0.3933333333  38.400000000  0.1139301127  0.2739161164  0.0633540154  600           0.1786897659 
0.9700000000  0.8809523810  0.9640000000  0.7460317460  0.9879518072  0.9759036145  0.9939759036  0.9759036145  0.3833333333  41.600000000  0.1055746439  0.2445506191  0.0633540154  650           0.1778246927 
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1442421675  1.1524477005  0.0539793968  0             0.4752378464 
0.4240000000  0.3968253968  0.3720000000  0.3333333333  0.5572289157  0.5783132530  0.4126506024  0.4096385542  0.3466666667  3.2000000000  0.0695685959  1.0937404752  0.0604872704  50            0.1703393364 
0.4180000000  0.4126984127  0.3820000000  0.3412698413  0.5662650602  0.5180722892  0.5090361446  0.5060240964  0.3433333333  6.4000000000  0.0600129700  1.0617027068  0.0604872704  100           0.1665912676 
0.5120000000  0.4603174603  0.4580000000  0.4126984127  0.6490963855  0.6084337349  0.5587349398  0.5361445783  0.3600000000  9.6000000000  0.0641903090  1.0369308114  0.0605001450  150           0.1708665514 
0.5120000000  0.4523809524  0.4500000000  0.4126984127  0.6686746988  0.6265060241  0.5436746988  0.5240963855  0.3366666667  12.800000000  0.0586610293  1.0174789906  0.0605001450  200           0.1697599602 
0.5560000000  0.5317460317  0.5720000000  0.4920634921  0.7439759036  0.6867469880  0.7936746988  0.7530120482  0.3700000000  16.000000000  0.0680934680  0.9889520454  0.0605001450  250           0.1687443256 
0.5840000000  0.5476190476  0.6020000000  0.5396825397  0.7620481928  0.6987951807  0.8192771084  0.7831325301  0.4300000000  19.200000000  0.0734602857  0.9564167118  0.0605001450  300           0.1708776951 
0.6460000000  0.5714285714  0.6460000000  0.5555555556  0.7635542169  0.7530120482  0.8147590361  0.7891566265  0.4833333333  22.400000000  0.0760667121  0.9170265782  0.0624561310  350           0.1712529325 
0.6160000000  0.5396825397  0.6100000000  0.5317460317  0.7816265060  0.6927710843  0.8433734940  0.7951807229  0.3766666667  25.600000000  0.0755368268  0.8829330707  0.0624561310  400           0.1696274567 
0.6100000000  0.5555555556  0.6140000000  0.5555555556  0.7936746988  0.7409638554  0.8358433735  0.7891566265  0.4600000000  28.800000000  0.0908235514  0.8390831316  0.0624561310  450           0.1680242682 
0.6320000000  0.5555555556  0.6500000000  0.5793650794  0.8072289157  0.7228915663  0.8524096386  0.8072289157  0.5500000000  32.000000000  0.0893640220  0.8084155524  0.0624561310  500           0.1695383406 
0.6600000000  0.6031746032  0.6680000000  0.5873015873  0.7966867470  0.7530120482  0.8810240964  0.8373493976  0.6100000000  35.200000000  0.0801585793  0.7665813947  0.0624561310  550           0.1667700720 
0.7320000000  0.6587301587  0.7300000000  0.5793650794  0.8192771084  0.8072289157  0.8132530120  0.7951807229  0.8400000000  38.400000000  0.0919758201  0.7280041945  0.0624561310  600           0.1723558044 
0.6980000000  0.6269841270  0.7000000000  0.5873015873  0.8207831325  0.7891566265  0.8810240964  0.8373493976  0.8733333333  41.600000000  0.0937571359  0.6990717220  0.0624561310  650           0.1701083612 
0.7040000000  0.6666666667  0.7140000000  0.6031746032  0.8463855422  0.8072289157  0.9021084337  0.8855421687  0.7766666667  44.800000000  0.1087179971  0.6703038180  0.0624561310  700           0.1695213842 
0.7340000000  0.6746031746  0.7260000000  0.5793650794  0.8539156627  0.8132530120  0.8840361446  0.8493975904  0.8333333333  48.000000000  0.1058421618  0.6394057024  0.0635261536  750           0.1714625263 
0.6820000000  0.6269841270  0.7060000000  0.5873015873  0.8840361446  0.8132530120  0.8885542169  0.8674698795  0.8100000000  51.200000000  0.1124761140  0.6194773185  0.0635261536  800           0.1814774704 
0.7180000000  0.6507936508  0.7360000000  0.5793650794  0.9006024096  0.8313253012  0.8915662651  0.8674698795  0.8833333333  54.400000000  0.0998703706  0.5998680496  0.0635261536  850           0.1823904181 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    with open(os.path.join(args.output_dir, 'done'), 'w') as f:
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1442421675  1.1524477005  0.0539793968  0             0.5401682854 
0.4240000000  0.3968253968  0.3720000000  0.3333333333  0.5572289157  0.5783132530  0.4126506024  0.4096385542  0.3466666667  3.2000000000  0.0695685959  1.0937404752  0.0606822968  50            0.1702187300 
0.4180000000  0.4126984127  0.3820000000  0.3412698413  0.5662650602  0.5180722892  0.5090361446  0.5060240964  0.3433333333  6.4000000000  0.0600129700  1.0617027068  0.0607829094  100           0.1821253824 
0.5120000000  0.4603174603  0.4580000000  0.4126984127  0.6490963855  0.6084337349  0.5587349398  0.5361445783  0.3600000000  9.6000000000  0.0641903090  1.0369308114  0.0607829094  150           0.1727797365 
0.5120000000  0.4523809524  0.4500000000  0.4126984127  0.6686746988  0.6265060241  0.5436746988  0.5240963855  0.3366666667  12.800000000  0.0586610293  1.0174789906  0.0620260239  200           0.1774465895 
0.5560000000  0.5317460317  0.5720000000  0.4920634921  0.7439759036  0.6867469880  0.7936746988  0.7530120482  0.3700000000  16.000000000  0.0680934680  0.9889520454  0.0620260239  250           0.1723471880 
0.5840000000  0.5476190476  0.6020000000  0.5396825397  0.7620481928  0.6987951807  0.8192771084  0.7831325301  0.4300000000  19.200000000  0.0734602857  0.9564167118  0.0620260239  300           0.1693573427 
0.6460000000  0.5714285714  0.6460000000  0.5555555556  0.7635542169  0.7530120482  0.8147590361  0.7891566265  0.4833333333  22.400000000  0.0760667121  0.9170265782  0.0626726151  350           0.1668503046 
0.6160000000  0.5396825397  0.6100000000  0.5317460317  0.7816265060  0.6927710843  0.8433734940  0.7951807229  0.3766666667  25.600000000  0.0755368268  0.8829330707  0.0626726151  400           0.1691030073 
0.6100000000  0.5555555556  0.6140000000  0.5555555556  0.7936746988  0.7409638554  0.8358433735  0.7891566265  0.4600000000  28.800000000  0.0908235514  0.8390831316  0.0626726151  450           0.1694853687 
0.6320000000  0.5555555556  0.6500000000  0.5793650794  0.8072289157  0.7228915663  0.8524096386  0.8072289157  0.5500000000  32.000000000  0.0893640220  0.8084155524  0.0626726151  500           0.1696087980 
0.6600000000  0.6031746032  0.6680000000  0.5873015873  0.7966867470  0.7530120482  0.8810240964  0.8373493976  0.6100000000  35.200000000  0.0801585793  0.7665813947  0.0626726151  550           0.1691362000 
0.7320000000  0.6587301587  0.7300000000  0.5793650794  0.8192771084  0.8072289157  0.8132530120  0.7951807229  0.8400000000  38.400000000  0.0919758201  0.7280041945  0.0632634163  600           0.1695181561 
0.6980000000  0.6269841270  0.7000000000  0.5873015873  0.8207831325  0.7891566265  0.8810240964  0.8373493976  0.8733333333  41.600000000  0.0937571359  0.6990717220  0.0632634163  650           0.1759124136 
0.7040000000  0.6666666667  0.7140000000  0.6031746032  0.8463855422  0.8072289157  0.9021084337  0.8855421687  0.7766666667  44.800000000  0.1087179971  0.6703038180  0.0632634163  700           0.1846174431 
0.7340000000  0.6746031746  0.7260000000  0.5793650794  0.8539156627  0.8132530120  0.8840361446  0.8493975904  0.8333333333  48.000000000  0.1058421618  0.6394057024  0.0632634163  750           0.1697833347 
0.6820000000  0.6269841270  0.7060000000  0.5873015873  0.8840361446  0.8132530120  0.8885542169  0.8674698795  0.8100000000  51.200000000  0.1124761140  0.6194773185  0.0632634163  800           0.1694594097 
0.7180000000  0.6507936508  0.7360000000  0.5793650794  0.9006024096  0.8313253012  0.8915662651  0.8674698795  0.8833333333  54.400000000  0.0998703706  0.5998680496  0.0632634163  850           0.1719014454 
0.7820000000  0.7301587302  0.7680000000  0.5952380952  0.9171686747  0.8734939759  0.8870481928  0.8855421687  0.7233333333  57.600000000  0.0985479313  0.5728941429  0.0632634163  900           0.1701017046 
0.7400000000  0.6587301587  0.7600000000  0.5793650794  0.9171686747  0.8493975904  0.8795180723  0.8554216867  0.8566666667  60.800000000  0.1047254795  0.5591618997  0.0632634163  950           0.1706459332 
0.7740000000  0.6984126984  0.7460000000  0.5873015873  0.9171686747  0.8614457831  0.8780120482  0.8493975904  0.8300000000  64.000000000  0.1144965947  0.5418922555  0.0632634163  1000          0.1714004230 
0.7940000000  0.7063492063  0.7960000000  0.5952380952  0.9111445783  0.8734939759  0.9201807229  0.9096385542  0.7733333333  67.200000000  0.1103242266  0.5250371021  0.0632634163  1050          0.1727788591 
0.8180000000  0.6984126984  0.7880000000  0.6031746032  0.9171686747  0.8373493976  0.9126506024  0.9156626506  0.7733333333  70.400000000  0.1220399666  0.5207167906  0.0632634163  1100          0.1743626928 
0.7940000000  0.6904761905  0.7420000000  0.6031746032  0.8915662651  0.8554216867  0.8945783133  0.8674698795  0.6533333333  73.600000000  0.1093884015  0.5058292019  0.0632634163  1150          0.1870620155 
0.8040000000  0.7222222222  0.8100000000  0.6349206349  0.9277108434  0.8915662651  0.9367469880  0.9277108434  0.7800000000  76.800000000  0.1051805019  0.5015869379  0.0632634163  1200          0.1782773018 
0.8460000000  0.7936507937  0.8320000000  0.6507936508  0.9292168675  0.9096385542  0.9563253012  0.9698795181  0.6366666667  80.000000000  0.1117906368  0.4875261897  0.0632634163  1250          0.1710159302 
0.8660000000  0.7777777778  0.8400000000  0.6349206349  0.9352409639  0.9096385542  0.9578313253  0.9638554217  0.6066666667  83.200000000  0.0964651394  0.4642918992  0.0632634163  1300          0.1711380386 
0.8600000000  0.7619047619  0.8680000000  0.6428571429  0.9292168675  0.8734939759  0.9563253012  0.9578313253  0.6033333333  86.400000000  0.1134875834  0.4639800197  0.0632634163  1350          0.1749040508 
0.8860000000  0.7777777778  0.8680000000  0.6587301587  0.9066265060  0.8795180723  0.9608433735  0.9638554217  0.5366666667  89.600000000  0.1171895206  0.4538094836  0.0632634163  1400          0.1745404816 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1965, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1443498135  1.1524477005  0.0539793968  0             0.4820384979 
0.4200000000  0.3968253968  0.3740000000  0.3333333333  0.5572289157  0.5783132530  0.4021084337  0.4036144578  0.3466666667  3.2000000000  0.0695893431  1.0937381029  0.0604138374  50            0.1740075922 
0.4200000000  0.4206349206  0.3860000000  0.3412698413  0.5662650602  0.5180722892  0.5240963855  0.5060240964  0.3366666667  6.4000000000  0.0600506961  1.0616395283  0.0624079704  100           0.1686185217 
0.5100000000  0.4841269841  0.4620000000  0.4285714286  0.6822289157  0.6445783133  0.5858433735  0.5361445783  0.3566666667  9.6000000000  0.0647162402  1.0364101648  0.0624079704  150           0.1689927912 
0.5060000000  0.4603174603  0.4300000000  0.4047619048  0.6716867470  0.6265060241  0.5195783133  0.5000000000  0.3366666667  12.800000000  0.0601301849  1.0168619418  0.0624079704  200           0.1686339092 
0.5520000000  0.5158730159  0.5680000000  0.4761904762  0.7515060241  0.6566265060  0.7740963855  0.7469879518  0.3633333333  16.000000000  0.0673235023  0.9893236125  0.0633668900  250           0.1723393583 
0.5760000000  0.5634920635  0.5920000000  0.5238095238  0.7635542169  0.6807228916  0.8298192771  0.7891566265  0.3866666667  19.200000000  0.0729120529  0.9564550054  0.0633668900  300           0.1681480169 
0.6440000000  0.5714285714  0.6500000000  0.5476190476  0.7665662651  0.7409638554  0.8222891566  0.7951807229  0.4766666667  22.400000000  0.0753290117  0.9164945018  0.0633668900  350           0.1699420738 
0.6140000000  0.5476190476  0.6100000000  0.5158730159  0.7786144578  0.6807228916  0.8554216867  0.8072289157  0.3766666667  25.600000000  0.0765212607  0.8838707376  0.0633668900  400           0.1715825272 
0.6040000000  0.5634920635  0.6280000000  0.5873015873  0.8042168675  0.7349397590  0.8463855422  0.8072289157  0.4966666667  28.800000000  0.0900721109  0.8386899209  0.0633668900  450           0.1693058586 
0.6340000000  0.5714285714  0.6560000000  0.5873015873  0.8087349398  0.7289156627  0.8539156627  0.8012048193  0.5966666667  32.000000000  0.0880306625  0.8098014832  0.0633668900  500           0.1723972178 
0.6540000000  0.6111111111  0.6660000000  0.5873015873  0.8072289157  0.7831325301  0.8825301205  0.8433734940  0.6000000000  35.200000000  0.0791148400  0.7668377423  0.0633668900  550           0.1687865925 
0.7280000000  0.6746031746  0.7200000000  0.5873015873  0.8057228916  0.8012048193  0.8027108434  0.7891566265  0.8300000000  38.400000000  0.0926698732  0.7285821724  0.0633668900  600           0.1701697159 
0.6960000000  0.6269841270  0.7140000000  0.5873015873  0.8253012048  0.7951807229  0.8825301205  0.8433734940  0.8633333333  41.600000000  0.0927491283  0.6985825753  0.0633668900  650           0.1692821741 
0.7180000000  0.6746031746  0.7240000000  0.5952380952  0.8554216867  0.8313253012  0.9006024096  0.9036144578  0.7833333333  44.800000000  0.1058241403  0.6718021309  0.0633668900  700           0.1722871971 
0.7380000000  0.6587301587  0.7140000000  0.5873015873  0.8569277108  0.8132530120  0.8795180723  0.8554216867  0.8300000000  48.000000000  0.1055369616  0.6405608559  0.0633678436  750           0.1681908894 
0.6740000000  0.6269841270  0.7060000000  0.5793650794  0.8975903614  0.8192771084  0.8885542169  0.8674698795  0.8333333333  51.200000000  0.1112495917  0.6201067531  0.0633678436  800           0.1723142624 
0.7080000000  0.6507936508  0.7480000000  0.5873015873  0.9066265060  0.8313253012  0.8900602410  0.8734939759  0.8866666667  54.400000000  0.0981036091  0.6025695956  0.0633678436  850           0.1682562971 
0.7900000000  0.7301587302  0.7700000000  0.6031746032  0.9186746988  0.8915662651  0.8975903614  0.9156626506  0.7333333333  57.600000000  0.0993265545  0.5739618230  0.0633678436  900           0.1707612705 
0.7420000000  0.6507936508  0.7680000000  0.5873015873  0.9096385542  0.8313253012  0.8810240964  0.8734939759  0.8666666667  60.800000000  0.1034032786  0.5599337691  0.0633678436  950           0.1687746906 
0.7840000000  0.6984126984  0.7760000000  0.5952380952  0.9262048193  0.8734939759  0.8870481928  0.8855421687  0.8100000000  64.000000000  0.1130085665  0.5420927888  0.0633678436  1000          0.1717259169 
0.8040000000  0.7222222222  0.7980000000  0.6031746032  0.9141566265  0.8614457831  0.9201807229  0.9216867470  0.7500000000  67.200000000  0.1084737831  0.5254741234  0.0633678436  1050          0.1716199732 
0.8140000000  0.6666666667  0.7940000000  0.6269841270  0.9156626506  0.8433734940  0.9231927711  0.9216867470  0.7833333333  70.400000000  0.1222081286  0.5199344444  0.0633678436  1100          0.1701916218 
0.8140000000  0.6904761905  0.7600000000  0.5952380952  0.8915662651  0.8674698795  0.8990963855  0.8855421687  0.6500000000  73.600000000  0.1123876214  0.5050998318  0.0633678436  1150          0.1676486206 
0.8140000000  0.7539682540  0.8140000000  0.6349206349  0.9171686747  0.8855421687  0.9442771084  0.9337349398  0.7300000000  76.800000000  0.1045275581  0.5021288359  0.0633678436  1200          0.1700232029 
0.8540000000  0.8095238095  0.8380000000  0.6587301587  0.9216867470  0.8915662651  0.9518072289  0.9518072289  0.6133333333  80.000000000  0.1139967620  0.4865859973  0.0633678436  1250          0.1723184824 
0.8620000000  0.8253968254  0.8420000000  0.6428571429  0.9352409639  0.9096385542  0.9578313253  0.9638554217  0.5866666667  83.200000000  0.0952419722  0.4644885963  0.0633678436  1300          0.1682493305 
0.8640000000  0.7777777778  0.8640000000  0.6269841270  0.9322289157  0.8855421687  0.9578313253  0.9518072289  0.6000000000  86.400000000  0.1135122168  0.4633393741  0.0634183884  1350          0.1683642721 
0.8800000000  0.8095238095  0.8620000000  0.6587301587  0.9066265060  0.8915662651  0.9578313253  0.9638554217  0.5400000000  89.600000000  0.1167982620  0.4543887860  0.0634183884  1400          0.1696228743 
0.8480000000  0.7460317460  0.8600000000  0.6428571429  0.9307228916  0.8795180723  0.9111445783  0.8975903614  0.6733333333  92.800000000  0.1129809386  0.4405469549  0.0634183884  1450          0.1698422003 
0.8720000000  0.8095238095  0.8700000000  0.6746031746  0.9352409639  0.9096385542  0.9623493976  0.9578313253  0.5733333333  96.000000000  0.1070316041  0.4308107179  0.0634183884  1500          0.1720015335 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1444826126  1.1524477005  0.0539793968  0             0.4778742790 
0.4220000000  0.4047619048  0.3720000000  0.3333333333  0.5572289157  0.5783132530  0.4096385542  0.4096385542  0.3500000000  3.2000000000  0.0696444201  1.0937333965  0.0604138374  50            0.1737380791 
0.4200000000  0.4206349206  0.3880000000  0.3412698413  0.5722891566  0.5180722892  0.5210843373  0.5060240964  0.3366666667  6.4000000000  0.0599062395  1.0617860842  0.0604391098  100           0.1715550280 
0.4920000000  0.4761904762  0.4480000000  0.3888888889  0.6475903614  0.6024096386  0.5572289157  0.5421686747  0.3566666667  9.6000000000  0.0645249569  1.0359079814  0.0604391098  150           0.1782163239 
0.5040000000  0.4682539683  0.4320000000  0.3968253968  0.6626506024  0.6144578313  0.5225903614  0.5000000000  0.3366666667  12.800000000  0.0592848015  1.0169205904  0.0607600212  200           0.1685262632 
0.5560000000  0.5317460317  0.5740000000  0.5000000000  0.7665662651  0.6686746988  0.7680722892  0.7590361446  0.3733333333  16.000000000  0.0677149069  0.9898804057  0.0607600212  250           0.1697572803 
0.5900000000  0.5555555556  0.6040000000  0.5317460317  0.7635542169  0.6807228916  0.8237951807  0.7891566265  0.4366666667  19.200000000  0.0711029351  0.9576342130  0.0607600212  300           0.1696186924 
0.6480000000  0.5634920635  0.6500000000  0.5555555556  0.7665662651  0.7530120482  0.8072289157  0.7831325301  0.4733333333  22.400000000  0.0755173957  0.9177092886  0.0607600212  350           0.1679243755 
0.6160000000  0.5476190476  0.6060000000  0.5158730159  0.7725903614  0.6807228916  0.8524096386  0.8072289157  0.3766666667  25.600000000  0.0770409858  0.8826687789  0.0607600212  400           0.1696162558 
0.6100000000  0.5476190476  0.6220000000  0.5793650794  0.7981927711  0.7590361446  0.8433734940  0.7951807229  0.4566666667  28.800000000  0.0910527515  0.8378484297  0.0607600212  450           0.1755974197 
0.6280000000  0.5793650794  0.6500000000  0.5793650794  0.8042168675  0.7228915663  0.8493975904  0.8072289157  0.6066666667  32.000000000  0.0891511202  0.8088631153  0.0607600212  500           0.1717570210 
0.6620000000  0.6269841270  0.6740000000  0.5793650794  0.8057228916  0.7530120482  0.8780120482  0.8373493976  0.6266666667  35.200000000  0.0797672999  0.7662184429  0.0607600212  550           0.1722114658 
0.7400000000  0.6666666667  0.7240000000  0.5873015873  0.8147590361  0.8012048193  0.8042168675  0.7831325301  0.8166666667  38.400000000  0.0912307656  0.7282053757  0.0607600212  600           0.1738729954 
0.7040000000  0.6349206349  0.7020000000  0.5634920635  0.8207831325  0.7771084337  0.8840361446  0.8493975904  0.8633333333  41.600000000  0.0927428389  0.6983192527  0.0608491898  650           0.1666588545 
0.7160000000  0.6666666667  0.7200000000  0.5952380952  0.8599397590  0.8253012048  0.9021084337  0.8975903614  0.8033333333  44.800000000  0.1054909480  0.6713742208  0.0608491898  700           0.1784272957 
0.7320000000  0.6587301587  0.7200000000  0.5714285714  0.8478915663  0.8132530120  0.8734939759  0.8433734940  0.8266666667  48.000000000  0.1056622207  0.6409948075  0.0608491898  750           0.1672440243 
0.6820000000  0.6428571429  0.6980000000  0.5793650794  0.8885542169  0.8072289157  0.8750000000  0.8614457831  0.8033333333  51.200000000  0.1120382524  0.6200429332  0.0608491898  800           0.1698468018 
0.7160000000  0.6587301587  0.7460000000  0.5873015873  0.9021084337  0.8253012048  0.8765060241  0.8674698795  0.8800000000  54.400000000  0.0982672834  0.6024837506  0.0608491898  850           0.1682164574 
0.7840000000  0.7142857143  0.7820000000  0.6031746032  0.9201807229  0.8614457831  0.8915662651  0.8915662651  0.7366666667  57.600000000  0.1011211473  0.5733249748  0.0608491898  900           0.1715056229 
0.7480000000  0.6825396825  0.7760000000  0.6031746032  0.9111445783  0.8493975904  0.8795180723  0.8554216867  0.8533333333  60.800000000  0.1033431995  0.5605471861  0.0608491898  950           0.1725017834 
0.7700000000  0.6984126984  0.7400000000  0.6031746032  0.9111445783  0.8493975904  0.8765060241  0.8674698795  0.8366666667  64.000000000  0.1113460839  0.5417652220  0.0608491898  1000          0.1815684128 
0.8000000000  0.7063492063  0.7820000000  0.6031746032  0.9081325301  0.8373493976  0.9006024096  0.8915662651  0.7766666667  67.200000000  0.1110821539  0.5258483976  0.0608491898  1050          0.1784811163 
0.8180000000  0.6984126984  0.7900000000  0.6428571429  0.9231927711  0.8614457831  0.9216867470  0.9156626506  0.7666666667  70.400000000  0.1225395733  0.5198351914  0.0608491898  1100          0.1764183521 
0.7980000000  0.6904761905  0.7440000000  0.6031746032  0.8930722892  0.8493975904  0.8960843373  0.8855421687  0.6366666667  73.600000000  0.1105990797  0.5064074630  0.0608491898  1150          0.1806948423 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.001
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1443498135  1.1524477005  0.0539793968  0             0.4671769142 
0.4200000000  0.3968253968  0.3740000000  0.3333333333  0.5572289157  0.5783132530  0.4021084337  0.4036144578  0.3466666667  3.2000000000  0.0695893431  1.0937381029  0.0604977608  50            0.1733252525 
0.4200000000  0.4206349206  0.3860000000  0.3412698413  0.5662650602  0.5180722892  0.5240963855  0.5060240964  0.3366666667  6.4000000000  0.0600506961  1.0616395283  0.0604977608  100           0.1727239609 
0.5100000000  0.4841269841  0.4620000000  0.4285714286  0.6822289157  0.6445783133  0.5858433735  0.5361445783  0.3566666667  9.6000000000  0.0647162402  1.0364101648  0.0605459213  150           0.1925324202 
0.5060000000  0.4603174603  0.4300000000  0.4047619048  0.6716867470  0.6265060241  0.5195783133  0.5000000000  0.3366666667  12.800000000  0.0601301849  1.0168619418  0.0606694221  200           0.1821761847 
0.5520000000  0.5158730159  0.5680000000  0.4761904762  0.7515060241  0.6566265060  0.7740963855  0.7469879518  0.3633333333  16.000000000  0.0673235023  0.9893236125  0.0606694221  250           0.1727708054 
0.5760000000  0.5634920635  0.5920000000  0.5238095238  0.7635542169  0.6807228916  0.8298192771  0.7891566265  0.3866666667  19.200000000  0.0729120529  0.9564550054  0.0606694221  300           0.1808195734 
0.6440000000  0.5714285714  0.6500000000  0.5476190476  0.7665662651  0.7409638554  0.8222891566  0.7951807229  0.4766666667  22.400000000  0.0753290117  0.9164945018  0.0606694221  350           0.1724572182 
0.6140000000  0.5476190476  0.6100000000  0.5158730159  0.7786144578  0.6807228916  0.8554216867  0.8072289157  0.3766666667  25.600000000  0.0765212607  0.8838707376  0.0606694221  400           0.1715409994 
0.6040000000  0.5634920635  0.6280000000  0.5873015873  0.8042168675  0.7349397590  0.8463855422  0.8072289157  0.4966666667  28.800000000  0.0900721109  0.8386899209  0.0606694221  450           0.1722028589 
0.6340000000  0.5714285714  0.6560000000  0.5873015873  0.8087349398  0.7289156627  0.8539156627  0.8012048193  0.5966666667  32.000000000  0.0880306625  0.8098014832  0.0606694221  500           0.1688673258 
0.6540000000  0.6111111111  0.6660000000  0.5873015873  0.8072289157  0.7831325301  0.8825301205  0.8433734940  0.6000000000  35.200000000  0.0791148400  0.7668377423  0.0606694221  550           0.1657542229 
0.7280000000  0.6746031746  0.7200000000  0.5873015873  0.8057228916  0.8012048193  0.8027108434  0.7891566265  0.8300000000  38.400000000  0.0926698732  0.7285821724  0.0606694221  600           0.1703737068 
0.6960000000  0.6269841270  0.7140000000  0.5873015873  0.8253012048  0.7951807229  0.8825301205  0.8433734940  0.8633333333  41.600000000  0.0927491283  0.6985825753  0.0606694221  650           0.1780452824 
0.7180000000  0.6746031746  0.7240000000  0.5952380952  0.8554216867  0.8313253012  0.9006024096  0.9036144578  0.7833333333  44.800000000  0.1058241403  0.6718021309  0.0608820915  700           0.1742524815 
0.7380000000  0.6587301587  0.7140000000  0.5873015873  0.8569277108  0.8132530120  0.8795180723  0.8554216867  0.8300000000  48.000000000  0.1055369616  0.6405608559  0.0608820915  750           0.1682234669 
0.6740000000  0.6269841270  0.7060000000  0.5793650794  0.8975903614  0.8192771084  0.8885542169  0.8674698795  0.8333333333  51.200000000  0.1112495917  0.6201067531  0.0608820915  800           0.1661925364 
0.7080000000  0.6507936508  0.7480000000  0.5873015873  0.9066265060  0.8313253012  0.8900602410  0.8734939759  0.8866666667  54.400000000  0.0981036091  0.6025695956  0.0608820915  850           0.1833773518 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    with open(os.path.join(args.output_dir, 'done'), 'w') as f:
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 8e-05
	weight_decay_d: 0.001
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1443387270  1.1524477005  0.0539793968  0             0.4904344082 
0.4240000000  0.4047619048  0.3720000000  0.3333333333  0.5572289157  0.5783132530  0.4081325301  0.4156626506  0.3433333333  3.2000000000  0.0696102095  1.0937396455  0.0604872704  50            0.1685390759 
0.4180000000  0.4206349206  0.3880000000  0.3412698413  0.5692771084  0.5180722892  0.5195783133  0.5120481928  0.3366666667  6.4000000000  0.0599430859  1.0616944075  0.0604872704  100           0.1661319017 
0.4980000000  0.4523809524  0.4540000000  0.3888888889  0.6234939759  0.5903614458  0.5527108434  0.5240963855  0.3600000000  9.6000000000  0.0644139242  1.0361579835  0.0604872704  150           0.1741344500 
0.5040000000  0.4603174603  0.4400000000  0.3968253968  0.6521084337  0.6204819277  0.5135542169  0.5120481928  0.3366666667  12.800000000  0.0604504454  1.0174093282  0.0604872704  200           0.1788574648 
0.5640000000  0.5158730159  0.5620000000  0.4761904762  0.7560240964  0.6626506024  0.7605421687  0.7530120482  0.3600000000  16.000000000  0.0684017813  0.9896899772  0.0604872704  250           0.1753023148 
0.5700000000  0.5555555556  0.6000000000  0.5158730159  0.7665662651  0.6927710843  0.8117469880  0.7771084337  0.3833333333  19.200000000  0.0731089020  0.9559071827  0.0604872704  300           0.1770130014 
0.6480000000  0.5634920635  0.6320000000  0.5555555556  0.7620481928  0.7228915663  0.8268072289  0.7891566265  0.4500000000  22.400000000  0.0767484570  0.9155331373  0.0604872704  350           0.1718208599 
0.6220000000  0.5396825397  0.6100000000  0.5158730159  0.8057228916  0.7168674699  0.8448795181  0.8012048193  0.3733333333  25.600000000  0.0761029088  0.8820577383  0.0604872704  400           0.1794703245 
0.6020000000  0.5555555556  0.6160000000  0.5634920635  0.7951807229  0.7590361446  0.8433734940  0.7951807229  0.4500000000  28.800000000  0.0911072898  0.8368502700  0.0604977608  450           0.1766681147 
0.6320000000  0.5634920635  0.6480000000  0.5952380952  0.8102409639  0.7349397590  0.8524096386  0.8072289157  0.5700000000  32.000000000  0.0888720691  0.8086116612  0.0604977608  500           0.1718084383 
0.6620000000  0.6111111111  0.6780000000  0.5873015873  0.8117469880  0.7650602410  0.8780120482  0.8373493976  0.6166666667  35.200000000  0.0793210685  0.7661503053  0.0605115891  550           0.1784432554 
0.7320000000  0.6587301587  0.7220000000  0.6111111111  0.8162650602  0.7951807229  0.8132530120  0.8072289157  0.8566666667  38.400000000  0.0937234914  0.7269287455  0.0629401207  600           0.1724061060 
0.7000000000  0.6269841270  0.7060000000  0.5873015873  0.8298192771  0.7891566265  0.8825301205  0.8433734940  0.8766666667  41.600000000  0.0934886980  0.6966715527  0.0629401207  650           0.1711258793 
0.7140000000  0.6666666667  0.7180000000  0.6031746032  0.8659638554  0.8373493976  0.9111445783  0.9216867470  0.8100000000  44.800000000  0.1061824274  0.6702998555  0.0629401207  700           0.1797205305 
0.7320000000  0.6428571429  0.7220000000  0.5793650794  0.8554216867  0.8072289157  0.8719879518  0.8373493976  0.8533333333  48.000000000  0.1061550087  0.6398261237  0.0629401207  750           0.1737773466 
0.6720000000  0.6269841270  0.6960000000  0.5873015873  0.9006024096  0.8313253012  0.8704819277  0.8554216867  0.8033333333  51.200000000  0.1129563606  0.6185346413  0.0629401207  800           0.1817307329 
0.7140000000  0.6666666667  0.7480000000  0.5873015873  0.9036144578  0.8313253012  0.8855421687  0.8674698795  0.8766666667  54.400000000  0.0990558219  0.6019199073  0.0629401207  850           0.1683982801 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.5
	weight_decay: 0.0008
	weight_decay_d: 0.001
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.2171257138  1.1524477005  0.0539793968  0             0.4751117229 
0.4220000000  0.3888888889  0.3660000000  0.3412698413  0.5225903614  0.5240963855  0.4066265060  0.4216867470  0.3366666667  3.2000000000  0.1060797107  1.0984333825  0.0604619980  50            0.1732350540 
0.4120000000  0.3968253968  0.3800000000  0.3492063492  0.4759036145  0.4578313253  0.4412650602  0.4036144578  0.3500000000  6.4000000000  0.0817883563  1.0742896414  0.0605010986  100           0.1722121859 
0.4700000000  0.4365079365  0.4480000000  0.3809523810  0.5165662651  0.4879518072  0.4849397590  0.4337349398  0.3666666667  9.6000000000  0.0915830255  1.0573786759  0.0605010986  150           0.1756349850 
0.4740000000  0.4523809524  0.4280000000  0.3730158730  0.5542168675  0.5180722892  0.4487951807  0.4096385542  0.3533333333  12.800000000  0.0808386254  1.0508169627  0.0605149269  200           0.1736880684 
0.5080000000  0.4682539683  0.4620000000  0.4126984127  0.6596385542  0.6024096386  0.5677710843  0.5481927711  0.3533333333  16.000000000  0.0823502505  1.0392636228  0.0608668327  250           0.1763271666 
0.5240000000  0.5079365079  0.5040000000  0.4523809524  0.7304216867  0.6445783133  0.6521084337  0.6325301205  0.3533333333  19.200000000  0.0859263003  1.0218138647  0.0608668327  300           0.1702905512 
0.6240000000  0.5396825397  0.5640000000  0.4841269841  0.6912650602  0.7168674699  0.6867469880  0.6626506024  0.4166666667  22.400000000  0.0859286070  1.0039037919  0.0608668327  350           0.1693374634 
0.5460000000  0.5317460317  0.5180000000  0.4682539683  0.6897590361  0.6506024096  0.6536144578  0.6265060241  0.3400000000  25.600000000  0.0911969376  0.9902850020  0.0608668327  400           0.1741737032 
0.5820000000  0.5476190476  0.5900000000  0.5158730159  0.7846385542  0.7289156627  0.7394578313  0.7289156627  0.3800000000  28.800000000  0.0935609400  0.9652250600  0.0621132851  450           0.1691181087 
0.5860000000  0.5317460317  0.5840000000  0.5317460317  0.7771084337  0.7108433735  0.7756024096  0.7409638554  0.3866666667  32.000000000  0.0928120440  0.9525724781  0.0621132851  500           0.1719387770 
0.6060000000  0.5476190476  0.6040000000  0.5238095238  0.7936746988  0.7289156627  0.8478915663  0.8132530120  0.3733333333  35.200000000  0.0886763924  0.9267701292  0.0621132851  550           0.1728984404 
0.6560000000  0.5873015873  0.6640000000  0.5873015873  0.7771084337  0.7710843373  0.8162650602  0.8072289157  0.5733333333  38.400000000  0.0900281847  0.8968689454  0.0621132851  600           0.1720790625 
0.6540000000  0.6269841270  0.6760000000  0.5634920635  0.7951807229  0.7590361446  0.8750000000  0.8253012048  0.5833333333  41.600000000  0.1013460910  0.8770236146  0.0621132851  650           0.1716919088 
0.6740000000  0.6190476190  0.6740000000  0.5634920635  0.8072289157  0.7951807229  0.8765060241  0.8313253012  0.6166666667  44.800000000  0.1192552185  0.8528538287  0.0621132851  700           0.1724399519 
0.6420000000  0.6031746032  0.6700000000  0.5555555556  0.8207831325  0.7650602410  0.8509036145  0.8253012048  0.6400000000  48.000000000  0.1159027541  0.8241058314  0.0621132851  750           0.1809808826 
0.6340000000  0.5952380952  0.6540000000  0.5396825397  0.8584337349  0.7951807229  0.8569277108  0.8132530120  0.6200000000  51.200000000  0.1276216936  0.8024315619  0.0621132851  800           0.1718990374 
0.6260000000  0.5714285714  0.6500000000  0.5634920635  0.8509036145  0.7771084337  0.8659638554  0.8253012048  0.6300000000  54.400000000  0.1266025883  0.7754908741  0.0621132851  850           0.1700205374 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.25
	weight_decay: 0.0008
	weight_decay_d: 0.001
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1806747913  1.1524477005  0.0539793968  0             0.4998259544 
0.4200000000  0.3809523810  0.3680000000  0.3333333333  0.5271084337  0.5662650602  0.3930722892  0.3795180723  0.3466666667  3.2000000000  0.0869028419  1.0963992262  0.0604977608  50            0.1725910807 
0.4160000000  0.3809523810  0.3860000000  0.3492063492  0.4834337349  0.4759036145  0.4623493976  0.4277108434  0.3433333333  6.4000000000  0.0701803282  1.0696372223  0.0604977608  100           0.1721694565 
0.4740000000  0.4285714286  0.4400000000  0.3888888889  0.5361445783  0.5301204819  0.5271084337  0.4819277108  0.3566666667  9.6000000000  0.0768667340  1.0490536594  0.0604977608  150           0.1708654594 
0.5100000000  0.4603174603  0.4260000000  0.3968253968  0.6189759036  0.5722891566  0.5225903614  0.4879518072  0.3500000000  12.800000000  0.0699620977  1.0370637870  0.0605158806  200           0.1699568319 
0.5460000000  0.5000000000  0.5040000000  0.4603174603  0.7168674699  0.6385542169  0.6837349398  0.6385542169  0.3466666667  16.000000000  0.0759064406  1.0184017038  0.0605158806  250           0.1692523432 
0.5820000000  0.5317460317  0.5720000000  0.5238095238  0.7530120482  0.6867469880  0.7831325301  0.7590361446  0.3633333333  19.200000000  0.0813408256  0.9947535217  0.0605158806  300           0.1731899261 
0.6400000000  0.5396825397  0.6160000000  0.5555555556  0.7394578313  0.7650602410  0.7816265060  0.7530120482  0.4166666667  22.400000000  0.0808264866  0.9679258835  0.0624079704  350           0.1755135632 
0.5720000000  0.5476190476  0.5720000000  0.5238095238  0.7680722892  0.6746987952  0.7861445783  0.7710843373  0.3466666667  25.600000000  0.0845532507  0.9439076352  0.0624079704  400           0.1710456133 
0.5860000000  0.5396825397  0.6120000000  0.5476190476  0.7861445783  0.7349397590  0.8117469880  0.7771084337  0.4000000000  28.800000000  0.0929241270  0.9099491656  0.0624079704  450           0.1717729187 
0.5940000000  0.5476190476  0.6240000000  0.5793650794  0.8012048193  0.7469879518  0.8057228916  0.7650602410  0.4266666667  32.000000000  0.0907988429  0.8883389592  0.0624079704  500           0.1709664440 
0.6120000000  0.5634920635  0.6380000000  0.5634920635  0.8012048193  0.7228915663  0.8614457831  0.8192771084  0.3933333333  35.200000000  0.0909287795  0.8533505690  0.0624079704  550           0.1717486048 
0.7040000000  0.6111111111  0.7120000000  0.5952380952  0.7981927711  0.7831325301  0.8117469880  0.7891566265  0.7133333333  38.400000000  0.0918785796  0.8174048293  0.0624079704  600           0.1687307310 
0.6700000000  0.6190476190  0.6920000000  0.5634920635  0.8207831325  0.7891566265  0.8780120482  0.8373493976  0.7033333333  41.600000000  0.1007768005  0.7917348564  0.0624079704  650           0.1835339737 
0.7020000000  0.6587301587  0.6980000000  0.5714285714  0.8298192771  0.8253012048  0.8945783133  0.8915662651  0.6600000000  44.800000000  0.1166117251  0.7623201334  0.0624079704  700           0.1698696470 
0.6760000000  0.6190476190  0.6800000000  0.5714285714  0.8463855422  0.8072289157  0.8644578313  0.8313253012  0.7400000000  48.000000000  0.1154678506  0.7315498281  0.0624079704  750           0.1798054123 
0.6180000000  0.6031746032  0.6640000000  0.5634920635  0.8825301205  0.8313253012  0.8734939759  0.8433734940  0.6366666667  51.200000000  0.1247623771  0.7071014774  0.0624079704  800           0.1708941936 
0.6480000000  0.5793650794  0.6800000000  0.5793650794  0.8900602410  0.8132530120  0.8644578313  0.8313253012  0.7433333333  54.400000000  0.1152426243  0.6830805278  0.0624079704  850           0.1820645714 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.1
	weight_decay: 0.0008
	weight_decay_d: 0.001
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1588410586  1.1524477005  0.0539793968  0             0.4792087078 
0.4240000000  0.3968253968  0.3680000000  0.3333333333  0.5496987952  0.5361445783  0.4051204819  0.4036144578  0.3400000000  3.2000000000  0.0761945001  1.0952197075  0.0604391098  50            0.1693250990 
0.4080000000  0.3968253968  0.3820000000  0.3412698413  0.5165662651  0.4759036145  0.4834337349  0.4397590361  0.3466666667  6.4000000000  0.0646008063  1.0645215344  0.0604391098  100           0.1695158815 
0.5160000000  0.4523809524  0.4660000000  0.4047619048  0.6325301205  0.6144578313  0.5481927711  0.5301204819  0.3633333333  9.6000000000  0.0689764645  1.0424029827  0.0604391098  150           0.1735068750 
0.4900000000  0.4523809524  0.4260000000  0.3888888889  0.6310240964  0.5843373494  0.4939759036  0.4819277108  0.3366666667  12.800000000  0.0629328029  1.0263144326  0.0604667664  200           0.1692532349 
0.5580000000  0.5238095238  0.5400000000  0.4761904762  0.7424698795  0.6566265060  0.7334337349  0.7289156627  0.3633333333  16.000000000  0.0721016265  1.0020617998  0.0604667664  250           0.1714880896 
0.5780000000  0.5238095238  0.5840000000  0.5158730159  0.7545180723  0.7168674699  0.8042168675  0.7590361446  0.3766666667  19.200000000  0.0754215745  0.9743795168  0.0604667664  300           0.1724501610 
0.6360000000  0.5555555556  0.6280000000  0.5555555556  0.7605421687  0.7168674699  0.8072289157  0.7831325301  0.4333333333  22.400000000  0.0782970960  0.9399661493  0.0604968071  350           0.1737652588 
0.5940000000  0.5238095238  0.5980000000  0.5000000000  0.7936746988  0.7048192771  0.8388554217  0.7891566265  0.3600000000  25.600000000  0.0802455387  0.9113331795  0.0604968071  400           0.1702227020 
0.6060000000  0.5476190476  0.6180000000  0.5634920635  0.7966867470  0.7409638554  0.8328313253  0.7891566265  0.4300000000  28.800000000  0.0910664607  0.8717032719  0.0604968071  450           0.1686176395 
0.6240000000  0.5634920635  0.6400000000  0.5873015873  0.7981927711  0.7349397590  0.8524096386  0.8072289157  0.5300000000  32.000000000  0.0874859528  0.8446294069  0.0604968071  500           0.1698808479 
0.6380000000  0.6031746032  0.6640000000  0.5793650794  0.8072289157  0.7710843373  0.8825301205  0.8433734940  0.5333333333  35.200000000  0.0844674693  0.8051133859  0.0604968071  550           0.1714161444 
0.7260000000  0.6349206349  0.7340000000  0.5952380952  0.8162650602  0.8072289157  0.8057228916  0.7891566265  0.8200000000  38.400000000  0.0924181924  0.7675416815  0.0607957840  600           0.1726377106 
0.6860000000  0.6349206349  0.6960000000  0.5873015873  0.8268072289  0.7891566265  0.8840361446  0.8373493976  0.8166666667  41.600000000  0.0960442010  0.7390380788  0.0607957840  650           0.1737011099 
0.7020000000  0.6666666667  0.7140000000  0.5634920635  0.8448795181  0.8132530120  0.9126506024  0.9156626506  0.7466666667  44.800000000  0.1124468588  0.7088019228  0.0607957840  700           0.1724329424 
0.7220000000  0.6269841270  0.7080000000  0.5873015873  0.8614457831  0.8072289157  0.8734939759  0.8433734940  0.8133333333  48.000000000  0.1085857085  0.6787172818  0.0607957840  750           0.1791129971 
0.6680000000  0.6111111111  0.6960000000  0.5634920635  0.8900602410  0.8253012048  0.8900602410  0.8734939759  0.7400000000  51.200000000  0.1198398218  0.6555755007  0.0607957840  800           0.1729218102 
0.6980000000  0.6507936508  0.7260000000  0.5952380952  0.8900602410  0.8373493976  0.8855421687  0.8674698795  0.8633333333  54.400000000  0.1030870464  0.6349579847  0.0607957840  850           0.1736814165 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.05
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1515895724  1.1524477005  0.0539793968  0             0.4808483124 
0.4220000000  0.4206349206  0.3700000000  0.3333333333  0.5572289157  0.5421686747  0.4006024096  0.3855421687  0.3400000000  3.2000000000  0.0729439926  1.0944752622  0.0604977608  50            0.1673204899 
0.4240000000  0.4047619048  0.3900000000  0.3412698413  0.5376506024  0.5000000000  0.5000000000  0.4457831325  0.3433333333  6.4000000000  0.0618867241  1.0629199314  0.0604977608  100           0.1692197609 
0.5100000000  0.4682539683  0.4760000000  0.4285714286  0.6370481928  0.6204819277  0.5557228916  0.5361445783  0.3600000000  9.6000000000  0.0666598918  1.0392179656  0.0604977608  150           0.1702044964 
0.4860000000  0.4523809524  0.4220000000  0.3968253968  0.6475903614  0.5903614458  0.5030120482  0.4698795181  0.3366666667  12.800000000  0.0614045070  1.0218249357  0.0604977608  200           0.1703818607 
0.5620000000  0.5238095238  0.5680000000  0.4841269841  0.7469879518  0.6506024096  0.7620481928  0.7469879518  0.3633333333  16.000000000  0.0695237538  0.9954753292  0.0604977608  250           0.1699730778 
0.5920000000  0.5476190476  0.6100000000  0.5079365079  0.7515060241  0.7048192771  0.8057228916  0.7771084337  0.4133333333  19.200000000  0.0757423989  0.9646276939  0.0604977608  300           0.1744144869 
0.6460000000  0.5714285714  0.6360000000  0.5634920635  0.7545180723  0.7409638554  0.8072289157  0.7710843373  0.4600000000  22.400000000  0.0773012057  0.9274717450  0.0604977608  350           0.1713762188 
0.5960000000  0.5396825397  0.6040000000  0.5079365079  0.7665662651  0.6686746988  0.8569277108  0.8012048193  0.3766666667  25.600000000  0.0785741444  0.8956546772  0.0604977608  400           0.1733572531 
0.6080000000  0.5555555556  0.6220000000  0.5793650794  0.7936746988  0.7048192771  0.8463855422  0.8072289157  0.4700000000  28.800000000  0.0918947374  0.8531264150  0.0605201721  450           0.1705325937 
0.6340000000  0.5634920635  0.6540000000  0.5873015873  0.8087349398  0.7289156627  0.8478915663  0.8132530120  0.5600000000  32.000000000  0.0898851212  0.8248094571  0.0605201721  500           0.1743058205 
0.6440000000  0.5952380952  0.6720000000  0.5793650794  0.8012048193  0.7831325301  0.8780120482  0.8373493976  0.5600000000  35.200000000  0.0820721116  0.7840672684  0.0605201721  550           0.1666169453 
0.7240000000  0.6507936508  0.7280000000  0.5952380952  0.8117469880  0.8012048193  0.8072289157  0.7951807229  0.8433333333  38.400000000  0.0944027503  0.7455398250  0.0605382919  600           0.1714939165 
0.6880000000  0.6190476190  0.7040000000  0.6031746032  0.8373493976  0.7951807229  0.8795180723  0.8433734940  0.8266666667  41.600000000  0.0965229136  0.7162765682  0.0607099533  650           0.1712287283 
0.7040000000  0.6666666667  0.7200000000  0.5873015873  0.8614457831  0.8072289157  0.8975903614  0.8795180723  0.7933333333  44.800000000  0.1082375734  0.6884877121  0.0631051064  700           0.1722654724 
0.7160000000  0.6349206349  0.7140000000  0.5873015873  0.8554216867  0.8192771084  0.8750000000  0.8493975904  0.8300000000  48.000000000  0.1085753532  0.6585162330  0.0631051064  750           0.1829964304 
0.6660000000  0.6269841270  0.7020000000  0.5873015873  0.8855421687  0.8192771084  0.8975903614  0.8674698795  0.7833333333  51.200000000  0.1156742638  0.6367800784  0.0631051064  800           0.1714163399 
0.6940000000  0.6507936508  0.7360000000  0.5793650794  0.8975903614  0.8313253012  0.8990963855  0.8734939759  0.8633333333  54.400000000  0.1034697410  0.6205931723  0.0631051064  850           0.1867688036 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4792582989 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1696865511 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604391098  100           0.1704598284 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604529381  150           0.1699991274 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604977608  200           0.1680980062 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604977608  250           0.1660022831 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604977608  300           0.1678460598 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604977608  350           0.1715157127 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604977608  400           0.1700081491 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0608415604  450           0.1674731922 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0608415604  500           0.1709745073 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0608415604  550           0.1688326025 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0608415604  600           0.1719872952 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0608415604  650           0.1824947977 
0.7580000000  0.6746031746  0.7280000000  0.6111111111  0.8659638554  0.8253012048  0.9051204819  0.8975903614  0.8166666667  44.800000000  0.0976811235  0.5954426718  0.0608415604  700           0.1789132690 
0.7680000000  0.7142857143  0.7640000000  0.5873015873  0.8734939759  0.8433734940  0.8855421687  0.8674698795  0.8300000000  48.000000000  0.0963309417  0.5680015081  0.0608415604  750           0.1679167223 
0.7420000000  0.6587301587  0.7340000000  0.6031746032  0.9051204819  0.8373493976  0.8915662651  0.8795180723  0.9100000000  51.200000000  0.0966362268  0.5508705360  0.0608415604  800           0.1696509123 
0.7640000000  0.6746031746  0.7760000000  0.6031746032  0.9186746988  0.8554216867  0.8915662651  0.8795180723  0.8766666667  54.400000000  0.0854560664  0.5363318461  0.0608415604  850           0.1795275497 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.7
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1009088531  1.1524477005  0.0539793968  0             0.4812386036 
0.4280000000  0.4285714286  0.3760000000  0.3333333333  0.6069277108  0.5963855422  0.4427710843  0.4457831325  0.3333333333  3.2000000000  0.0482491369  1.0886421299  0.0604138374  50            0.1687919044 
0.4340000000  0.4365079365  0.3940000000  0.3571428571  0.5888554217  0.5361445783  0.5707831325  0.5240963855  0.3333333333  6.4000000000  0.0452354859  1.0489804339  0.0604519844  100           0.1707736063 
0.5320000000  0.4603174603  0.4700000000  0.4285714286  0.6671686747  0.6084337349  0.6340361446  0.5843373494  0.3366666667  9.6000000000  0.0502342197  1.0118608451  0.0604519844  150           0.1683352566 
0.5460000000  0.4682539683  0.4820000000  0.4444444444  0.7078313253  0.6265060241  0.7033132530  0.6807228916  0.3333333333  12.800000000  0.0509059880  0.9769147146  0.0604991913  200           0.1688982487 
0.6000000000  0.5396825397  0.6160000000  0.5476190476  0.7394578313  0.6807228916  0.8418674699  0.8012048193  0.4233333333  16.000000000  0.0574638521  0.9287342525  0.0604991913  250           0.1673020363 
0.6140000000  0.5238095238  0.6240000000  0.5476190476  0.7846385542  0.7289156627  0.8584337349  0.8192771084  0.4100000000  19.200000000  0.0638929661  0.8756836784  0.0604991913  300           0.1691479349 
0.6640000000  0.5873015873  0.6660000000  0.5952380952  0.7816265060  0.7650602410  0.8704819277  0.8313253012  0.5666666667  22.400000000  0.0660096878  0.8179906046  0.0605649948  350           0.1689963484 
0.6400000000  0.5634920635  0.6420000000  0.5714285714  0.8177710843  0.7530120482  0.8659638554  0.8373493976  0.4566666667  25.600000000  0.0678146262  0.7730029774  0.0605649948  400           0.1696984243 
0.6680000000  0.5873015873  0.6660000000  0.6031746032  0.8463855422  0.7831325301  0.8478915663  0.8012048193  0.7266666667  28.800000000  0.0821264224  0.7175650120  0.0605649948  450           0.1674133921 
0.6700000000  0.6031746032  0.6940000000  0.5952380952  0.8524096386  0.7831325301  0.8659638554  0.8253012048  0.8200000000  32.000000000  0.0748698243  0.6802400434  0.0605649948  500           0.1706304121 
0.6720000000  0.6349206349  0.6980000000  0.5952380952  0.8629518072  0.7891566265  0.8780120482  0.8373493976  0.8266666667  35.200000000  0.0674020449  0.6417942536  0.0605649948  550           0.1789860964 
0.7700000000  0.7301587302  0.7460000000  0.6111111111  0.8539156627  0.8373493976  0.8810240964  0.8855421687  0.8033333333  38.400000000  0.0809456355  0.6070661676  0.0605649948  600           0.1690923929 
0.7340000000  0.6904761905  0.7360000000  0.5714285714  0.8659638554  0.8132530120  0.8900602410  0.8734939759  0.9133333333  41.600000000  0.0714784490  0.5834313488  0.0605649948  650           0.1692674398 
0.7760000000  0.6984126984  0.7360000000  0.6269841270  0.8719879518  0.8373493976  0.9186746988  0.9156626506  0.7933333333  44.800000000  0.0866318603  0.5633204293  0.0605649948  700           0.1701882362 
0.7920000000  0.7539682540  0.7820000000  0.6111111111  0.8765060241  0.8554216867  0.8945783133  0.8915662651  0.8200000000  48.000000000  0.0904375534  0.5355756390  0.0605649948  750           0.1701539421 
0.7760000000  0.6746031746  0.7720000000  0.6111111111  0.9021084337  0.8373493976  0.9036144578  0.8915662651  0.9000000000  51.200000000  0.0870492925  0.5192636847  0.0605969429  800           0.1690518141 
0.8120000000  0.6746031746  0.7980000000  0.6349206349  0.9186746988  0.8554216867  0.9141566265  0.9096385542  0.8100000000  54.400000000  0.0766648044  0.5067802364  0.0605969429  850           0.1678955507 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.75
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1081058085  1.1524477005  0.0539793968  0             0.5227584839 
0.4260000000  0.4206349206  0.3740000000  0.3333333333  0.5828313253  0.5843373494  0.4593373494  0.4518072289  0.3300000000  3.2000000000  0.0519159329  1.0896185541  0.0604872704  50            0.1744244576 
0.4240000000  0.4206349206  0.3940000000  0.3571428571  0.5753012048  0.5180722892  0.5632530120  0.5301204819  0.3333333333  6.4000000000  0.0476947340  1.0511060739  0.0604977608  100           0.1710758781 
0.5280000000  0.4682539683  0.4660000000  0.4126984127  0.6521084337  0.6084337349  0.6009036145  0.5602409639  0.3366666667  9.6000000000  0.0524497345  1.0165190482  0.0605230331  150           0.1809718609 
0.5480000000  0.4682539683  0.4740000000  0.4365079365  0.7048192771  0.6385542169  0.6400602410  0.6325301205  0.3366666667  12.800000000  0.0519704255  0.9852680302  0.0605230331  200           0.1728671694 
0.5900000000  0.5476190476  0.6120000000  0.5317460317  0.7334337349  0.6927710843  0.8433734940  0.7951807229  0.4133333333  16.000000000  0.0588386866  0.9411118603  0.0605230331  250           0.1713329840 
0.6020000000  0.5158730159  0.6200000000  0.5476190476  0.7635542169  0.7048192771  0.8674698795  0.8313253012  0.3900000000  19.200000000  0.0652034685  0.8916935205  0.0605235100  300           0.1730981445 
0.6540000000  0.5873015873  0.6640000000  0.5793650794  0.7786144578  0.7530120482  0.8719879518  0.8373493976  0.5533333333  22.400000000  0.0680747312  0.8364753890  0.0605235100  350           0.1684327745 
0.6460000000  0.5317460317  0.6220000000  0.5555555556  0.8042168675  0.7228915663  0.8584337349  0.8313253012  0.4166666667  25.600000000  0.0699629036  0.7923306811  0.0608620644  400           0.1705899429 
0.6560000000  0.5793650794  0.6720000000  0.5873015873  0.8403614458  0.7710843373  0.8584337349  0.8192771084  0.6733333333  28.800000000  0.0843516183  0.7392036390  0.0608620644  450           0.1687251472 
0.6640000000  0.5873015873  0.6920000000  0.5793650794  0.8463855422  0.7710843373  0.8584337349  0.8192771084  0.7933333333  32.000000000  0.0775672522  0.7016191113  0.0608620644  500           0.1687259722 
0.6620000000  0.6269841270  0.6840000000  0.5873015873  0.8584337349  0.7951807229  0.8810240964  0.8373493976  0.7533333333  35.200000000  0.0700192308  0.6614120007  0.0608620644  550           0.1704976749 
0.7540000000  0.7301587302  0.7440000000  0.6190476190  0.8478915663  0.8373493976  0.8599397590  0.8614457831  0.8200000000  38.400000000  0.0827909848  0.6263167679  0.0608620644  600           0.1697802591 
0.7140000000  0.6746031746  0.7280000000  0.5714285714  0.8493975904  0.7951807229  0.8900602410  0.8734939759  0.9133333333  41.600000000  0.0747306369  0.6008046210  0.0608620644  650           0.1696462727 
0.7680000000  0.7063492063  0.7400000000  0.6111111111  0.8750000000  0.8493975904  0.9156626506  0.9156626506  0.8233333333  44.800000000  0.0909416084  0.5806927085  0.0608620644  700           0.1674281693 
0.7800000000  0.7222222222  0.7740000000  0.6111111111  0.8734939759  0.8554216867  0.8990963855  0.8975903614  0.8466666667  48.000000000  0.0935704114  0.5518749553  0.0608620644  750           0.1711334705 
0.7500000000  0.6587301587  0.7580000000  0.6111111111  0.9006024096  0.8433734940  0.9051204819  0.8975903614  0.9100000000  51.200000000  0.0924746838  0.5357717091  0.0608620644  800           0.1690764189 
0.7920000000  0.6746031746  0.7880000000  0.6269841270  0.9141566265  0.8493975904  0.9066265060  0.9036144578  0.8766666667  54.400000000  0.0813835748  0.5216556126  0.0608620644  850           0.1670430660 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.75
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  0.1398620903  1.1524477005  0.0539793968  0             0.3707592487 
0.3420000000  0.3492063492  0.3240000000  0.3174603175  0.3524096386  0.3373493976  0.4126506024  0.4096385542  0.2500000000  3.2000000000  0.0921543342  1.1342177689  0.0634140968  50            0.0250172424 
0.4120000000  0.4126984127  0.3940000000  0.3571428571  0.4472891566  0.4638554217  0.3825301205  0.3373493976  0.2633333333  6.4000000000  0.0576776505  1.1008907557  0.0634140968  100           0.0226041126 
0.4380000000  0.4126984127  0.3960000000  0.3809523810  0.4969879518  0.4939759036  0.3283132530  0.2771084337  0.2900000000  9.6000000000  0.0586135483  1.1023335755  0.0634140968  150           0.0214841270 
0.4180000000  0.3650793651  0.3920000000  0.3809523810  0.4924698795  0.4879518072  0.3117469880  0.2831325301  0.3466666667  12.800000000  0.0545350367  1.0917605639  0.0634140968  200           0.0224369621 
0.4080000000  0.3650793651  0.3940000000  0.3571428571  0.5090361446  0.4939759036  0.3253012048  0.2891566265  0.3600000000  16.000000000  0.0549275011  1.1014151275  0.0634140968  250           0.0218864107 
0.4060000000  0.3730158730  0.3640000000  0.3412698413  0.5030120482  0.4939759036  0.3569277108  0.3192771084  0.3566666667  19.200000000  0.0514676079  1.0868595839  0.0634140968  300           0.0221074152 
0.4060000000  0.3888888889  0.3540000000  0.3333333333  0.5090361446  0.4939759036  0.3825301205  0.3493975904  0.3433333333  22.400000000  0.0526285118  1.0770216584  0.0634140968  350           0.0226478720 
0.4140000000  0.3968253968  0.3580000000  0.3333333333  0.5286144578  0.5240963855  0.3855421687  0.3855421687  0.3466666667  25.600000000  0.0530541024  1.0654061556  0.0634140968  400           0.0227276278 
0.4200000000  0.4126984127  0.3640000000  0.3412698413  0.5421686747  0.5421686747  0.4051204819  0.3915662651  0.3466666667  28.800000000  0.0527422777  1.0746654868  0.0634140968  450           0.0215530634 
0.4320000000  0.4285714286  0.3740000000  0.3412698413  0.5587349398  0.5481927711  0.4036144578  0.3975903614  0.3500000000  32.000000000  0.0491171551  1.0615168333  0.0634140968  500           0.0216109085 
0.4180000000  0.4126984127  0.3720000000  0.3412698413  0.5286144578  0.5000000000  0.4216867470  0.4096385542  0.3433333333  35.200000000  0.0542736939  1.0671171188  0.0634140968  550           0.0218716192 
0.4240000000  0.4285714286  0.3740000000  0.3412698413  0.5512048193  0.5060240964  0.4292168675  0.4156626506  0.3533333333  38.400000000  0.0449564570  1.0850618780  0.0634140968  600           0.0213432026 
0.4180000000  0.4206349206  0.3720000000  0.3412698413  0.5331325301  0.4939759036  0.4683734940  0.4156626506  0.3400000000  41.600000000  0.0521355549  1.0632184744  0.0634140968  650           0.0219602346 
0.4220000000  0.4285714286  0.3820000000  0.3412698413  0.5481927711  0.5060240964  0.4789156627  0.4337349398  0.3400000000  44.800000000  0.0543923897  1.0650110543  0.0634140968  700           0.0220500422 
0.4500000000  0.4444444444  0.4140000000  0.3492063492  0.5813253012  0.5180722892  0.4969879518  0.4819277108  0.3433333333  48.000000000  0.0526877055  1.0577200890  0.0634140968  750           0.0215878487 
0.4740000000  0.4444444444  0.4420000000  0.3571428571  0.5933734940  0.5662650602  0.5210843373  0.5180722892  0.3433333333  51.200000000  0.0484628901  1.0543529987  0.0634140968  800           0.0210120201 
0.5080000000  0.4761904762  0.4660000000  0.3968253968  0.6144578313  0.6024096386  0.5376506024  0.5240963855  0.3600000000  54.400000000  0.0472087911  1.0601782560  0.0634140968  850           0.0215250874 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.9
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1298438013  1.1524477005  0.0539793968  0             0.4814686775 
0.4260000000  0.4206349206  0.3760000000  0.3333333333  0.5662650602  0.5783132530  0.4126506024  0.4096385542  0.3300000000  3.2000000000  0.0625528831  1.0923454475  0.0606074333  50            0.1729711390 
0.4100000000  0.3888888889  0.3780000000  0.3412698413  0.5361445783  0.4819277108  0.5090361446  0.4698795181  0.3366666667  6.4000000000  0.0545344210  1.0583648682  0.0606074333  100           0.1726073885 
0.5180000000  0.4682539683  0.4700000000  0.4285714286  0.6430722892  0.6204819277  0.5798192771  0.5361445783  0.3533333333  9.6000000000  0.0590729754  1.0305677748  0.0606074333  150           0.1723024893 
0.5160000000  0.4761904762  0.4360000000  0.4126984127  0.6536144578  0.6144578313  0.5316265060  0.5120481928  0.3366666667  12.800000000  0.0562893948  1.0080148566  0.0606074333  200           0.1728309584 
0.5780000000  0.5396825397  0.5980000000  0.5396825397  0.7304216867  0.6686746988  0.8087349398  0.7650602410  0.4066666667  16.000000000  0.0622414622  0.9765716755  0.0606074333  250           0.1725873661 
0.5860000000  0.5396825397  0.6140000000  0.5317460317  0.7620481928  0.7108433735  0.8388554217  0.7891566265  0.3966666667  19.200000000  0.0689588242  0.9377546310  0.0606074333  300           0.1697618246 
0.6440000000  0.5873015873  0.6540000000  0.5714285714  0.7560240964  0.7349397590  0.8418674699  0.8012048193  0.5066666667  22.400000000  0.0725082320  0.8911541224  0.0606074333  350           0.1715334082 
0.6300000000  0.5793650794  0.6180000000  0.5396825397  0.7801204819  0.7590361446  0.8689759036  0.8253012048  0.3900000000  25.600000000  0.0743983716  0.8539068651  0.0606074333  400           0.1700177240 
0.6280000000  0.5476190476  0.6400000000  0.5873015873  0.8283132530  0.7710843373  0.8463855422  0.8072289157  0.5566666667  28.800000000  0.0894348487  0.8037046576  0.0606074333  450           0.1710724974 
0.6520000000  0.5873015873  0.6700000000  0.6031746032  0.8328313253  0.7530120482  0.8478915663  0.8012048193  0.6866666667  32.000000000  0.0826740710  0.7695911229  0.0606203079  500           0.1710541582 
0.6480000000  0.6031746032  0.6640000000  0.5952380952  0.8388554217  0.7650602410  0.8704819277  0.8313253012  0.6133333333  35.200000000  0.0772921452  0.7267385101  0.0606203079  550           0.1710124636 
0.7520000000  0.6746031746  0.7340000000  0.6031746032  0.8388554217  0.8132530120  0.8328313253  0.8132530120  0.8000000000  38.400000000  0.0880752518  0.6888584113  0.0606660843  600           0.1710434723 
0.7120000000  0.6428571429  0.7240000000  0.6111111111  0.8418674699  0.8012048193  0.8810240964  0.8373493976  0.8933333333  41.600000000  0.0885729937  0.6589664626  0.0606660843  650           0.1740670156 
0.7420000000  0.6746031746  0.7280000000  0.6031746032  0.8659638554  0.8373493976  0.9006024096  0.8915662651  0.7866666667  44.800000000  0.1038602593  0.6326611733  0.0606660843  700           0.1739490747 
0.7420000000  0.6825396825  0.7420000000  0.6031746032  0.8674698795  0.8313253012  0.8885542169  0.8674698795  0.8300000000  48.000000000  0.1025773354  0.6029774678  0.0606660843  750           0.1734156418 
0.7060000000  0.6507936508  0.7180000000  0.5873015873  0.8915662651  0.8313253012  0.8930722892  0.8855421687  0.8566666667  51.200000000  0.1061971122  0.5847198308  0.0606660843  800           0.1725501537 
0.7440000000  0.6825396825  0.7500000000  0.5952380952  0.9096385542  0.8433734940  0.8870481928  0.8855421687  0.8666666667  54.400000000  0.0914446788  0.5684152651  0.0606660843  850           0.1725275993 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.85
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1225940883  1.1524477005  0.0539793968  0             0.4926512241 
0.4260000000  0.4285714286  0.3740000000  0.3333333333  0.5798192771  0.5963855422  0.4231927711  0.4156626506  0.3300000000  3.2000000000  0.0585273491  1.0916804028  0.0604391098  50            0.1769273853 
0.4180000000  0.4126984127  0.3840000000  0.3412698413  0.5542168675  0.5060240964  0.5256024096  0.5240963855  0.3333333333  6.4000000000  0.0521716252  1.0566684175  0.0604391098  100           0.1653558969 
0.5260000000  0.4682539683  0.4760000000  0.4206349206  0.6701807229  0.6566265060  0.6295180723  0.5903614458  0.3466666667  9.6000000000  0.0564484127  1.0269704497  0.0604872704  150           0.1666016531 
0.5120000000  0.4523809524  0.4500000000  0.4126984127  0.6822289157  0.6566265060  0.5632530120  0.5542168675  0.3366666667  12.800000000  0.0538758949  1.0004420686  0.0604872704  200           0.1675959206 
0.5780000000  0.5476190476  0.5960000000  0.5000000000  0.7500000000  0.6746987952  0.8147590361  0.7650602410  0.3766666667  16.000000000  0.0626490976  0.9646792090  0.0604872704  250           0.1647572279 
0.6000000000  0.5317460317  0.6120000000  0.5396825397  0.7620481928  0.7228915663  0.8478915663  0.8012048193  0.3766666667  19.200000000  0.0677489174  0.9224809217  0.0604872704  300           0.1635187387 
0.6540000000  0.5873015873  0.6500000000  0.5714285714  0.7725903614  0.7650602410  0.8493975904  0.8072289157  0.4933333333  22.400000000  0.0722911313  0.8729158974  0.0605201721  350           0.1632951784 
0.6380000000  0.5555555556  0.6280000000  0.5396825397  0.7891566265  0.7710843373  0.8689759036  0.8253012048  0.4000000000  25.600000000  0.0727514506  0.8327507865  0.0605292320  400           0.1669695759 
0.6320000000  0.5396825397  0.6480000000  0.5793650794  0.8253012048  0.7590361446  0.8463855422  0.8072289157  0.5800000000  28.800000000  0.0893790546  0.7812272501  0.0606026649  450           0.1678473473 
0.6580000000  0.5793650794  0.6800000000  0.5952380952  0.8313253012  0.7590361446  0.8599397590  0.8132530120  0.7333333333  32.000000000  0.0841213617  0.7476642251  0.0606026649  500           0.1620410395 
0.6580000000  0.6111111111  0.6920000000  0.5873015873  0.8328313253  0.7771084337  0.8810240964  0.8373493976  0.7333333333  35.200000000  0.0740944974  0.7043761325  0.0606026649  550           0.1659374523 
0.7440000000  0.6984126984  0.7380000000  0.6031746032  0.8388554217  0.8132530120  0.8448795181  0.8493975904  0.7900000000  38.400000000  0.0899355141  0.6668564856  0.0606145859  600           0.1665445089 
0.7080000000  0.6587301587  0.7220000000  0.5873015873  0.8373493976  0.7951807229  0.8885542169  0.8674698795  0.8966666667  41.600000000  0.0853596573  0.6384529507  0.0606145859  650           0.1662024260 
0.7520000000  0.6825396825  0.7220000000  0.6269841270  0.8659638554  0.8373493976  0.9081325301  0.9096385542  0.7966666667  44.800000000  0.0992459437  0.6150610685  0.0606145859  700           0.1628508806 
0.7500000000  0.6984126984  0.7660000000  0.6031746032  0.8704819277  0.8313253012  0.8900602410  0.8855421687  0.8100000000  48.000000000  0.0985481338  0.5874556255  0.0606145859  750           0.1633015823 
0.7060000000  0.6428571429  0.7400000000  0.5793650794  0.8990963855  0.8253012048  0.8945783133  0.8915662651  0.8900000000  51.200000000  0.0996472198  0.5680365133  0.0609445572  800           0.1673929596 
0.7440000000  0.6746031746  0.7740000000  0.6031746032  0.9111445783  0.8493975904  0.8885542169  0.8795180723  0.8600000000  54.400000000  0.0870342149  0.5533593392  0.0609445572  850           0.1649195766 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.5060913563 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604619980  50            0.1659287691 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604619980  100           0.1804553652 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604619980  150           0.1710127974 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604619980  200           0.1719639158 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604619980  250           0.1661587238 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605115891  300           0.1652922010 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605115891  350           0.1671500158 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605115891  400           0.1723026562 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605115891  450           0.1653194380 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605115891  500           0.1638396645 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0605115891  550           0.1713436651 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0605115891  600           0.1807670116 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0605115891  650           0.1691084290 
0.7580000000  0.6746031746  0.7280000000  0.6111111111  0.8659638554  0.8253012048  0.9051204819  0.8975903614  0.8166666667  44.800000000  0.0976811235  0.5954426718  0.0605115891  700           0.1635973406 
0.7680000000  0.7142857143  0.7640000000  0.5873015873  0.8734939759  0.8433734940  0.8855421687  0.8674698795  0.8300000000  48.000000000  0.0963309417  0.5680015081  0.0605282784  750           0.1661367083 
0.7420000000  0.6587301587  0.7340000000  0.6031746032  0.9051204819  0.8373493976  0.8915662651  0.8795180723  0.9100000000  51.200000000  0.0966362268  0.5508705360  0.0605282784  800           0.1678832197 
0.7640000000  0.6746031746  0.7760000000  0.6031746032  0.9186746988  0.8554216867  0.8915662651  0.8795180723  0.8766666667  54.400000000  0.0854560664  0.5363318461  0.0638594627  850           0.1732166386 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3260000000  0.3253968254  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1389091462  1.1461868286  0.0539793968  0             0.6601297855 
0.4180000000  0.3968253968  0.3720000000  0.3571428571  0.5768072289  0.5722891566  0.4487951807  0.4578313253  0.3333333333  3.2000000000  0.0577816913  1.0910441327  0.0620551109  50            0.1774727726 
0.4440000000  0.4365079365  0.3960000000  0.3730158730  0.6174698795  0.6024096386  0.5376506024  0.5240963855  0.3333333333  6.4000000000  0.0526598942  1.0530629539  0.0620551109  100           0.1709040880 
0.5440000000  0.5000000000  0.4980000000  0.4285714286  0.6882530120  0.6807228916  0.6265060241  0.6144578313  0.3500000000  9.6000000000  0.0542315772  1.0211289907  0.0620551109  150           0.1693817139 
0.5200000000  0.4682539683  0.4640000000  0.4047619048  0.6686746988  0.6265060241  0.6174698795  0.6144578313  0.3333333333  12.800000000  0.0544032620  0.9915045917  0.0620551109  200           0.1645704031 
0.5660000000  0.5158730159  0.5720000000  0.4920634921  0.7515060241  0.6807228916  0.8192771084  0.7951807229  0.3500000000  16.000000000  0.0589252647  0.9518905497  0.0621571541  250           0.1641186094 
0.5780000000  0.5317460317  0.5980000000  0.5317460317  0.7439759036  0.6867469880  0.8644578313  0.8192771084  0.3600000000  19.200000000  0.0614683421  0.9028758729  0.0621571541  300           0.1659311104 
0.6500000000  0.6111111111  0.6680000000  0.5634920635  0.7801204819  0.7831325301  0.8509036145  0.8132530120  0.5166666667  22.400000000  0.0724367888  0.8491637456  0.0621571541  350           0.1684110403 
0.6180000000  0.5873015873  0.6400000000  0.5714285714  0.7876506024  0.7530120482  0.8750000000  0.8373493976  0.4200000000  25.600000000  0.0706949811  0.8102228153  0.0621571541  400           0.1711887217 
0.6600000000  0.5873015873  0.6660000000  0.5634920635  0.8237951807  0.7530120482  0.8659638554  0.8253012048  0.6533333333  28.800000000  0.0861780410  0.7581182051  0.0621571541  450           0.1739627838 
0.6520000000  0.6031746032  0.6840000000  0.5873015873  0.8087349398  0.7530120482  0.8825301205  0.8433734940  0.6666666667  32.000000000  0.0791886436  0.7195463002  0.0621571541  500           0.1697273493 
0.6700000000  0.6190476190  0.6820000000  0.5714285714  0.8343373494  0.7951807229  0.8855421687  0.8433734940  0.6133333333  35.200000000  0.0790096459  0.6779166651  0.0621571541  550           0.1701500511 
0.7460000000  0.6825396825  0.7200000000  0.6428571429  0.8328313253  0.8132530120  0.8283132530  0.7951807229  0.7800000000  38.400000000  0.0922984341  0.6461274993  0.0621571541  600           0.1643237591 
0.7420000000  0.6587301587  0.7000000000  0.6111111111  0.8328313253  0.8012048193  0.8855421687  0.8554216867  0.7833333333  41.600000000  0.0836190512  0.6125263834  0.0621571541  650           0.1675656319 
0.7620000000  0.6825396825  0.7340000000  0.6666666667  0.8614457831  0.8554216867  0.9051204819  0.9096385542  0.6800000000  44.800000000  0.0927048952  0.5974167204  0.0621571541  700           0.1727696180 
0.7720000000  0.7380952381  0.7460000000  0.6349206349  0.8569277108  0.8373493976  0.8945783133  0.8795180723  0.7600000000  48.000000000  0.0952820605  0.5709014499  0.0631690025  750           0.1724691057 
0.7680000000  0.7142857143  0.7520000000  0.6349206349  0.9036144578  0.8433734940  0.9081325301  0.9096385542  0.7133333333  51.200000000  0.0944993661  0.5546504623  0.0631690025  800           0.1723666143 
0.8080000000  0.7301587302  0.7720000000  0.6507936508  0.9111445783  0.8734939759  0.9156626506  0.9156626506  0.7300000000  54.400000000  0.0882911419  0.5421111578  0.0631690025  850           0.1698063374 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1948, in update
    if self.update_count == self.hparams['irm_penalty_anneal_iters']:
KeyError: 'irm_penalty_anneal_iters'
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3320000000  0.3333333333  0.3293233083  0.3293413174  0.4437781109  0.4431137725  0.3200000000  0.0000000000  0.1073443443  1.1708735228  0.0563254356  0             0.5559675694 
0.4340000000  0.4365079365  0.3900000000  0.3412698413  0.5157894737  0.4970059880  0.4452773613  0.4491017964  0.3266666667  3.2000000000  0.0613206227  1.0832920051  0.0604529381  50            0.1693435717 
0.4900000000  0.4682539683  0.4260000000  0.3650793651  0.6240601504  0.6407185629  0.5097451274  0.4670658683  0.3433333333  6.4000000000  0.0476645623  1.0472809720  0.0604529381  100           0.1698087645 
0.5740000000  0.4920634921  0.5080000000  0.4365079365  0.6992481203  0.6766467066  0.6026986507  0.5988023952  0.3733333333  9.6000000000  0.0565004748  1.0198222673  0.0604548454  150           0.1739132118 
0.5420000000  0.5000000000  0.4780000000  0.4285714286  0.6045112782  0.6586826347  0.5832083958  0.5449101796  0.3433333333  12.800000000  0.0549045104  0.9909543169  0.0632834435  200           0.1702415609 
0.5900000000  0.5634920635  0.6140000000  0.5317460317  0.7819548872  0.7784431138  0.8185907046  0.8383233533  0.3900000000  16.000000000  0.0600118447  0.9472157764  0.0632834435  250           0.1700240278 
0.6320000000  0.5714285714  0.6280000000  0.5555555556  0.8015037594  0.7724550898  0.8215892054  0.8622754491  0.4366666667  19.200000000  0.0669793293  0.9038918447  0.0632834435  300           0.1680432034 
0.6700000000  0.6349206349  0.6600000000  0.5714285714  0.7834586466  0.7724550898  0.8740629685  0.8922155689  0.5433333333  22.400000000  0.0755195856  0.8476896453  0.0632834435  350           0.1776549864 
0.6400000000  0.5873015873  0.6500000000  0.5873015873  0.8526315789  0.8682634731  0.8140929535  0.8443113772  0.5333333333  25.600000000  0.0742680829  0.7999864185  0.0632834435  400           0.1844107866 
0.6780000000  0.6031746032  0.6920000000  0.6428571429  0.8631578947  0.8502994012  0.8680659670  0.8802395210  0.4933333333  28.800000000  0.0831559092  0.7450098991  0.0632834435  450           0.1769101334 
0.7240000000  0.6190476190  0.7240000000  0.6507936508  0.8481203008  0.8383233533  0.9130434783  0.9161676647  0.5933333333  32.000000000  0.0920260075  0.7120147991  0.0632834435  500           0.1648897266 
0.6920000000  0.6269841270  0.6940000000  0.6507936508  0.8766917293  0.8802395210  0.8185907046  0.8383233533  0.5700000000  35.200000000  0.1030389221  0.6676376057  0.0632834435  550           0.1795177078 
0.7700000000  0.6904761905  0.7300000000  0.6746031746  0.8526315789  0.8323353293  0.9070464768  0.9161676647  0.4966666667  38.400000000  0.0999247693  0.6265818453  0.0632834435  600           0.1767684555 
0.7480000000  0.6984126984  0.7440000000  0.6349206349  0.8917293233  0.9041916168  0.8935532234  0.8862275449  0.5200000000  41.600000000  0.0989942491  0.6014940524  0.0632834435  650           0.1695302677 
0.7920000000  0.7301587302  0.7500000000  0.6428571429  0.8406015038  0.8323353293  0.9535232384  0.9341317365  0.5500000000  44.800000000  0.0911915693  0.5799354398  0.0632834435  700           0.1702860689 
0.7440000000  0.6984126984  0.7640000000  0.6507936508  0.9127819549  0.9041916168  0.8800599700  0.8682634731  0.5000000000  48.000000000  0.0939576898  0.5539034295  0.0632834435  750           0.1738810730 
0.7900000000  0.7301587302  0.7500000000  0.6587301587  0.9142857143  0.9101796407  0.8920539730  0.8802395210  0.4500000000  51.200000000  0.0820473004  0.5413439536  0.0632834435  800           0.1690859222 
0.8320000000  0.7380952381  0.7640000000  0.6746031746  0.9127819549  0.9161676647  0.9040479760  0.8922155689  0.4066666667  54.400000000  0.0849095744  0.5161585522  0.0632834435  850           0.1646790457 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.5210731030 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1667499065 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604391098  100           0.1658203793 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604529381  150           0.1628730869 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604529381  200           0.1666533136 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604529381  250           0.1639678669 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605115891  300           0.1625308323 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605115891  350           0.1606382179 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605115891  400           0.1631147051 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605659485  450           0.1670995092 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605745316  500           0.1659683609 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0605745316  550           0.1674701643 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0605745316  600           0.1773259163 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0605745316  650           0.1690676975 
0.7580000000  0.6746031746  0.7280000000  0.6111111111  0.8659638554  0.8253012048  0.9051204819  0.8975903614  0.8166666667  44.800000000  0.0976811235  0.5954426718  0.0605745316  700           0.1705804586 
0.7680000000  0.7142857143  0.7640000000  0.5873015873  0.8734939759  0.8433734940  0.8855421687  0.8674698795  0.8300000000  48.000000000  0.0963309417  0.5680015081  0.0605745316  750           0.1737862587 
0.7420000000  0.6587301587  0.7340000000  0.6031746032  0.9051204819  0.8373493976  0.8915662651  0.8795180723  0.9100000000  51.200000000  0.0966362268  0.5508705360  0.0617108345  800           0.1713892651 
0.7640000000  0.6746031746  0.7760000000  0.6031746032  0.9186746988  0.8554216867  0.8915662651  0.8795180723  0.8766666667  54.400000000  0.0854560664  0.5363318461  0.0617108345  850           0.1698965025 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 650
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4437859058 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1676144505 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604391098  100           0.1665061092 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604724884  150           0.1668663788 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604977608  200           0.1660429287 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604977608  250           0.1714495277 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605907440  300           0.1669916439 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605907440  350           0.1746178675 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605907440  400           0.1640522051 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0620832443  450           0.1634031296 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0620832443  500           0.1621659803 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0620832443  550           0.1663841343 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0620832443  600           0.1680673695 
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 303, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1950, in update
    self.network.parameters(),
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'Transfer' object has no attribute 'network'
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 651
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4460437298 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0605001450  50            0.1640220881 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0605001450  100           0.1629804802 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605955124  150           0.1628116608 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605955124  200           0.1672574139 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605955124  250           0.1650355530 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605955124  300           0.1623614931 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605955124  350           0.1679813147 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605955124  400           0.1650592470 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605955124  450           0.1641291142 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605955124  500           0.1661792088 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0605955124  550           0.1797870922 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0605955124  600           0.1728155184 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0605955124  650           0.1746010780 
0.7380000000  0.6904761905  0.7480000000  0.6111111111  0.8509036145  0.8132530120  0.8945783133  0.8795180723  0.8900000000  44.800000000  0.0955199752  0.6051818383  0.0605955124  700           0.1737966251 
0.7260000000  0.6666666667  0.7300000000  0.5952380952  0.8644578313  0.7951807229  0.8885542169  0.8674698795  0.9066666667  48.000000000  0.0873676202  0.6004895055  0.0605955124  750           0.1691384363 
0.6880000000  0.6507936508  0.7060000000  0.6031746032  0.8825301205  0.8072289157  0.8825301205  0.8554216867  0.8700000000  51.200000000  0.0952406233  0.5982563329  0.0605955124  800           0.1682808971 
0.7060000000  0.6666666667  0.7320000000  0.6031746032  0.8674698795  0.7951807229  0.8885542169  0.8674698795  0.8966666667  54.400000000  0.0776794373  0.5976346040  0.0635290146  850           0.1823527145 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 625
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4504330158 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604529381  50            0.1670099545 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604529381  100           0.1653057671 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0608854294  150           0.1649570417 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0610723495  200           0.1649393082 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0613703728  250           0.1636494207 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0613703728  300           0.1665057468 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 325, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 625
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4521260262 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1681071138 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604977608  100           0.1668069267 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605940819  150           0.1671510744 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605940819  200           0.1668326187 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605940819  250           0.1686298227 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605940819  300           0.1658807945 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0606098175  350           0.1638606167 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0606098175  400           0.1639915991 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0606098175  450           0.1655117893 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0606527328  500           0.1643903303 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0606527328  550           0.1796021700 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0606527328  600           0.1812593412 
0.7080000000  0.6587301587  0.7240000000  0.6031746032  0.8554216867  0.7951807229  0.8975903614  0.8795180723  0.8533333333  41.600000000  0.0793561260  0.6220789754  0.0606527328  650           0.1665175152 
0.7380000000  0.6746031746  0.7380000000  0.6031746032  0.8509036145  0.8132530120  0.8945783133  0.8795180723  0.8433333333  44.800000000  0.0932877267  0.6176785219  0.0606527328  700           0.1630036879 
0.7300000000  0.6587301587  0.7320000000  0.6031746032  0.8509036145  0.8132530120  0.8930722892  0.8734939759  0.8700000000  48.000000000  0.0854759272  0.6131020129  0.0606527328  750           0.1664056540 
0.6920000000  0.6428571429  0.6940000000  0.5952380952  0.8704819277  0.7951807229  0.8840361446  0.8614457831  0.8333333333  51.200000000  0.0941965529  0.6106132317  0.0606527328  800           0.1741837788 
0.7060000000  0.6587301587  0.7100000000  0.5873015873  0.8629518072  0.8012048193  0.8930722892  0.8734939759  0.8700000000  54.400000000  0.0766377746  0.6092997348  0.0606527328  850           0.1645508242 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 635
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4609653950 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1677533579 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0624079704  100           0.1651174307 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0624079704  150           0.1633978844 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0624079704  200           0.1666883421 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0624079704  250           0.1654672098 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0624079704  300           0.1644580460 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0624079704  350           0.1653980494 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0624079704  400           0.1645672083 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0624079704  450           0.1672881985 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0624079704  500           0.1803021002 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0624079704  550           0.1652113676 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0624079704  600           0.1664590406 
0.6960000000  0.6587301587  0.7240000000  0.5952380952  0.8584337349  0.7951807229  0.8945783133  0.8674698795  0.8600000000  41.600000000  0.0805024618  0.6197684133  0.0624079704  650           0.1680133963 
0.7340000000  0.6666666667  0.7420000000  0.5952380952  0.8509036145  0.8132530120  0.8930722892  0.8734939759  0.8500000000  44.800000000  0.0957432853  0.6120227647  0.0624079704  700           0.1690575552 
0.7220000000  0.6587301587  0.7360000000  0.6031746032  0.8584337349  0.7951807229  0.8930722892  0.8734939759  0.8866666667  48.000000000  0.0872677133  0.6072122741  0.0624079704  750           0.1714198399 
0.6840000000  0.6428571429  0.6980000000  0.5873015873  0.8734939759  0.8072289157  0.8855421687  0.8674698795  0.8600000000  51.200000000  0.0949091060  0.6051357687  0.0624079704  800           0.1753226185 
0.7060000000  0.6666666667  0.7240000000  0.5873015873  0.8644578313  0.7951807229  0.8930722892  0.8734939759  0.8866666667  54.400000000  0.0775870666  0.6040862000  0.0634131432  850           0.1637810230 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 635
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4846591949 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0606617928  50            0.1684312820 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0606617928  100           0.1693493748 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0606617928  150           0.1679074717 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0607085228  200           0.1703333616 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0607085228  250           0.1673069668 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0607085228  300           0.1662858438 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0609669685  350           0.1677665901 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0609669685  400           0.1734142208 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0609669685  450           0.1660411024 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0609669685  500           0.1812262058 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0609669685  550           0.1788692904 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0609669685  600           0.1661310720 
0.7080000000  0.6507936508  0.7160000000  0.5952380952  0.8554216867  0.7951807229  0.8945783133  0.8674698795  0.8866666667  41.600000000  0.0801834480  0.6192514980  0.0609669685  650           0.1668484068 
0.7480000000  0.6746031746  0.7420000000  0.6031746032  0.8509036145  0.8132530120  0.8930722892  0.8734939759  0.8433333333  44.800000000  0.0959883338  0.6098685014  0.0609669685  700           0.1673036337 
0.7320000000  0.6666666667  0.7360000000  0.5952380952  0.8614457831  0.7951807229  0.8885542169  0.8674698795  0.9033333333  48.000000000  0.0883129675  0.6023487210  0.0609669685  750           0.1633979225 
0.6900000000  0.6507936508  0.7120000000  0.6031746032  0.8840361446  0.8132530120  0.8840361446  0.8614457831  0.8633333333  51.200000000  0.0958004210  0.5976275861  0.0609669685  800           0.1656875277 
0.7100000000  0.6587301587  0.7320000000  0.5873015873  0.8689759036  0.8012048193  0.8930722892  0.8734939759  0.8900000000  54.400000000  0.0784156508  0.5949110389  0.0609669685  850           0.1627027559 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 640
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4617130756 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604619980  50            0.1672114944 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604872704  100           0.1662366009 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604872704  150           0.1738453627 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605268478  200           0.1717273855 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0636296272  250           0.1774093771 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0636296272  300           0.1813031864 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0636296272  350           0.1763618326 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0636296272  400           0.1720326567 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0636296272  450           0.1772420311 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0636296272  500           0.1756761789 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0636296272  550           0.1711556196 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0636296272  600           0.1718650055 
0.6980000000  0.6587301587  0.7120000000  0.5952380952  0.8584337349  0.7951807229  0.8885542169  0.8554216867  0.8933333333  41.600000000  0.0801801752  0.6184643447  0.0636296272  650           0.1691669559 
0.7460000000  0.6825396825  0.7460000000  0.6031746032  0.8509036145  0.8132530120  0.8945783133  0.8795180723  0.8466666667  44.800000000  0.0960048144  0.6078794754  0.0636296272  700           0.1694646502 
0.7260000000  0.6666666667  0.7380000000  0.5952380952  0.8614457831  0.7951807229  0.8855421687  0.8554216867  0.9033333333  48.000000000  0.0881652830  0.6005261862  0.0636296272  750           0.1773197508 
0.6880000000  0.6507936508  0.7040000000  0.6111111111  0.8840361446  0.8132530120  0.8840361446  0.8614457831  0.8666666667  51.200000000  0.0960653058  0.5957117152  0.0636296272  800           0.1711264992 
0.7100000000  0.6666666667  0.7340000000  0.5873015873  0.8689759036  0.8012048193  0.8930722892  0.8734939759  0.9000000000  54.400000000  0.0784950769  0.5929955101  0.0636296272  850           0.1687951136 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 650
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4775826931 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0605235100  50            0.1670974207 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0605235100  100           0.1647640705 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0608415604  150           0.1775784731 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0608415604  200           0.1698344183 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0617418289  250           0.1677223063 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0617418289  300           0.1699999857 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0617418289  350           0.1702577972 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0617418289  400           0.1902928877 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0617418289  450           0.1847083044 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0617418289  500           0.1675059652 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0617418289  550           0.1642950106 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0617418289  600           0.1669542933 
0.7140000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8855421687  0.8433734940  0.9166666667  41.600000000  0.0791626382  0.6181048000  0.0617418289  650           0.1681936550 
0.7460000000  0.6984126984  0.7520000000  0.6031746032  0.8509036145  0.8132530120  0.8945783133  0.8795180723  0.8633333333  44.800000000  0.0952412998  0.6045129633  0.0617418289  700           0.1853593349 
0.7300000000  0.6666666667  0.7300000000  0.5952380952  0.8644578313  0.7951807229  0.8885542169  0.8674698795  0.9033333333  48.000000000  0.0885592522  0.5967634380  0.0617418289  750           0.1875919056 
0.6860000000  0.6507936508  0.7140000000  0.6111111111  0.8855421687  0.8072289157  0.8840361446  0.8614457831  0.8600000000  51.200000000  0.0956828425  0.5922679675  0.0617418289  800           0.1688954258 
0.7080000000  0.6666666667  0.7360000000  0.5952380952  0.8734939759  0.8072289157  0.8870481928  0.8734939759  0.9033333333  54.400000000  0.0785282367  0.5896865082  0.0617418289  850           0.1762922621 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 651
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4505021572 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1752014828 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604977608  100           0.1680095387 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604977608  150           0.1665316439 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604977608  200           0.1722303152 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604977608  250           0.1703477240 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604977608  300           0.1636692762 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605115891  350           0.1674140310 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605115891  400           0.1689395666 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605115891  450           0.1686356020 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605115891  500           0.1668986607 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0634126663  550           0.1772319984 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0634126663  600           0.1734854841 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0634126663  650           0.1717909050 
0.7500000000  0.6904761905  0.7420000000  0.5952380952  0.8509036145  0.8132530120  0.8945783133  0.8795180723  0.8633333333  44.800000000  0.0946708973  0.6040508497  0.0634126663  700           0.1713405085 
0.7300000000  0.6666666667  0.7320000000  0.5952380952  0.8614457831  0.7951807229  0.8855421687  0.8554216867  0.9000000000  48.000000000  0.0884278196  0.5959744334  0.0634126663  750           0.1643342924 
0.6860000000  0.6507936508  0.7080000000  0.5952380952  0.8825301205  0.8072289157  0.8840361446  0.8614457831  0.8633333333  51.200000000  0.0957203276  0.5917142081  0.0634126663  800           0.1734380198 
0.7080000000  0.6666666667  0.7340000000  0.5873015873  0.8734939759  0.8072289157  0.8840361446  0.8734939759  0.9033333333  54.400000000  0.0787269423  0.5889485455  0.0634126663  850           0.1627577162 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4740092754 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1840859222 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604529381  100           0.1633481979 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605416298  150           0.1702272272 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605416298  200           0.1679393244 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605416298  250           0.1755025434 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605416298  300           0.1670248747 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605416298  350           0.1740185213 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605416298  400           0.1741025114 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605416298  450           0.1798891211 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605416298  500           0.1709519482 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0605416298  550           0.1661075926 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0605416298  600           0.1653547573 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0605416298  650           0.1666803169 
0.7620000000  0.6825396825  0.7400000000  0.5952380952  0.8704819277  0.8192771084  0.8840361446  0.8493975904  0.8466666667  44.800000000  0.0948345526  0.5982132900  0.0605416298  700           0.1748307657 
0.7400000000  0.6825396825  0.7460000000  0.6031746032  0.8599397590  0.8012048193  0.8810240964  0.8373493976  0.8966666667  48.000000000  0.0883775530  0.5868503654  0.0605416298  750           0.1792060232 
0.7040000000  0.6666666667  0.7220000000  0.5793650794  0.8870481928  0.8132530120  0.8765060241  0.8433734940  0.8833333333  51.200000000  0.0966549126  0.5826313043  0.0605416298  800           0.1698947382 
0.7180000000  0.6666666667  0.7480000000  0.5873015873  0.8810240964  0.8132530120  0.8825301205  0.8674698795  0.9100000000  54.400000000  0.0794968675  0.5805077434  0.0625395775  850           0.1746046638 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 660
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.6426150799 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0605459213  50            0.1715409803 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0605459213  100           0.1760911703 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605459213  150           0.1670163345 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605459213  200           0.1806871796 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605459213  250           0.1713586903 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0620260239  300           0.1714362574 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0620260239  350           0.1719870853 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0620260239  400           0.1719934368 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0620260239  450           0.1707238865 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0620260239  500           0.1757655907 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0620260239  550           0.1757915640 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0620260239  600           0.1833503771 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0620260239  650           0.1693137693 
0.7540000000  0.6904761905  0.7420000000  0.5952380952  0.8584337349  0.8192771084  0.8930722892  0.8734939759  0.8633333333  44.800000000  0.0942350857  0.6011184561  0.0620260239  700           0.1755425453 
0.7340000000  0.6825396825  0.7380000000  0.6031746032  0.8629518072  0.8132530120  0.8855421687  0.8554216867  0.9100000000  48.000000000  0.0867931212  0.5930474091  0.0620260239  750           0.1672252083 
0.6940000000  0.6587301587  0.7140000000  0.5952380952  0.8870481928  0.8132530120  0.8795180723  0.8554216867  0.8800000000  51.200000000  0.0957729321  0.5882263684  0.0620260239  800           0.1743906593 
0.7140000000  0.6666666667  0.7360000000  0.5952380952  0.8734939759  0.8072289157  0.8870481928  0.8734939759  0.9033333333  54.400000000  0.0789399721  0.5856813669  0.0620260239  850           0.1684317970 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 670
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.5142922401 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604872704  50            0.1712941170 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604872704  100           0.1693968201 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604872704  150           0.1768661642 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604872704  200           0.1680910587 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604872704  250           0.1758856583 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604872704  300           0.1711327362 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604872704  350           0.1714600658 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0617585182  400           0.1630359316 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0617585182  450           0.1648837996 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0617585182  500           0.1664122009 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0617585182  550           0.1659256697 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0617585182  600           0.1634982300 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0617585182  650           0.1670881414 
0.7560000000  0.6746031746  0.7400000000  0.5952380952  0.8629518072  0.8132530120  0.8840361446  0.8493975904  0.8566666667  44.800000000  0.0949974404  0.5984846663  0.0617585182  700           0.1662070608 
0.7380000000  0.6825396825  0.7460000000  0.6031746032  0.8599397590  0.8012048193  0.8840361446  0.8493975904  0.9066666667  48.000000000  0.0882709023  0.5880927372  0.0617585182  750           0.1688441849 
0.7020000000  0.6587301587  0.7260000000  0.5873015873  0.8870481928  0.8132530120  0.8765060241  0.8554216867  0.8800000000  51.200000000  0.0968243971  0.5839586937  0.0617585182  800           0.1750217867 
0.7180000000  0.6666666667  0.7460000000  0.5873015873  0.8795180723  0.8072289157  0.8855421687  0.8674698795  0.9100000000  54.400000000  0.0791895489  0.5820061421  0.0629539490  850           0.1691870975 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 655
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4741280079 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604619980  50            0.1712419891 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604872704  100           0.1655143929 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605125427  150           0.1677757931 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605125427  200           0.1653949738 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605125427  250           0.1700211430 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605125427  300           0.1650351334 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605125427  350           0.1639719820 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605125427  400           0.1691217184 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605125427  450           0.1655003834 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605125427  500           0.1862673807 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0630469322  550           0.1779960442 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0630722046  600           0.1724184465 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0630722046  650           0.1671777105 
0.7520000000  0.6984126984  0.7400000000  0.5952380952  0.8539156627  0.8132530120  0.8945783133  0.8795180723  0.8666666667  44.800000000  0.0946571967  0.6027193058  0.0630722046  700           0.1890398836 
0.7320000000  0.6666666667  0.7360000000  0.6031746032  0.8599397590  0.8012048193  0.8855421687  0.8554216867  0.9033333333  48.000000000  0.0884411405  0.5941815019  0.0630722046  750           0.1785168791 
0.6900000000  0.6507936508  0.7140000000  0.6031746032  0.8855421687  0.8072289157  0.8795180723  0.8554216867  0.8633333333  51.200000000  0.0963111616  0.5896860838  0.0630722046  800           0.1839729166 
0.7120000000  0.6666666667  0.7360000000  0.5873015873  0.8765060241  0.8072289157  0.8870481928  0.8734939759  0.9033333333  54.400000000  0.0787792527  0.5872651970  0.0630722046  850           0.1717389536 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 655
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.5246968269 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0608897209  50            0.1753048420 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0608897209  100           0.1678591871 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0608897209  150           0.1778985548 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0608897209  200           0.1748121452 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0608897209  250           0.1681944132 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0608897209  300           0.1642818546 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0608897209  350           0.1630233097 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0608897209  400           0.1823342848 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0608897209  450           0.1677307892 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0608897209  500           0.1738676310 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0608897209  550           0.1666617441 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0608897209  600           0.1758625412 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0608897209  650           0.1705299997 
0.7440000000  0.6984126984  0.7540000000  0.5952380952  0.8539156627  0.8132530120  0.8900602410  0.8734939759  0.8933333333  44.800000000  0.0944062836  0.6037739027  0.0608897209  700           0.1684334183 
0.7240000000  0.6666666667  0.7320000000  0.5952380952  0.8629518072  0.7891566265  0.8855421687  0.8554216867  0.9033333333  48.000000000  0.0870621740  0.5987663877  0.0608897209  750           0.1771983767 
0.6860000000  0.6507936508  0.7120000000  0.6031746032  0.8870481928  0.8132530120  0.8825301205  0.8554216867  0.8700000000  51.200000000  0.0954094493  0.5962754893  0.0608897209  800           0.1707807350 
0.7040000000  0.6666666667  0.7300000000  0.5952380952  0.8689759036  0.8012048193  0.8885542169  0.8674698795  0.9000000000  54.400000000  0.0778621862  0.5957037210  0.0608897209  850           0.1728036833 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4642519951 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0605597496  50            0.1655163479 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0605597496  100           0.1646760130 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0605597496  150           0.1635104799 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0605597496  200           0.1677963877 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0605597496  250           0.1628967142 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0606269836  300           0.1654839087 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0606269836  350           0.1650831747 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0606269836  400           0.1652225971 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0606269836  450           0.1665438986 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0649123192  500           0.1755399132 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0649123192  550           0.1747086477 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0649123192  600           0.1668880653 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0649123192  650           0.1742308092 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0649123192  700           0.1662078476 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0649123192  750           0.1654795027 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0649123192  800           0.1676213884 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0649123192  850           0.1727415419 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4667692184 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1653203917 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604391098  100           0.1680624199 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604529381  150           0.1660775614 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604529381  200           0.1707891846 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604529381  250           0.1660272026 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0605144501  300           0.1710427141 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0605144501  350           0.1693160057 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0605144501  400           0.1711491585 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0630636215  450           0.1707911301 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0630636215  500           0.1681977987 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0630636215  550           0.1658414078 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0630636215  600           0.1744394398 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0630636215  650           0.1774965763 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0630636215  700           0.1726371479 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0630636215  750           0.1659850502 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0630636215  800           0.1643445539 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0630636215  850           0.1648456335 
0.7580000000  0.7063492063  0.7520000000  0.6031746032  0.8780120482  0.8012048193  0.8825301205  0.8433734940  0.8866666667  57.600000000  0.0818604607  0.5774209511  0.0630636215  900           0.1641894341 
0.7160000000  0.6666666667  0.7360000000  0.5952380952  0.8855421687  0.8192771084  0.8750000000  0.8493975904  0.9166666667  60.800000000  0.0876796415  0.5786991888  0.0630636215  950           0.1658708143 
0.7120000000  0.6666666667  0.7320000000  0.5952380952  0.8945783133  0.8192771084  0.8780120482  0.8614457831  0.9033333333  64.000000000  0.0860080941  0.5797076142  0.0630636215  1000          0.1625731659 
0.7600000000  0.7142857143  0.7600000000  0.6031746032  0.8810240964  0.8012048193  0.8810240964  0.8614457831  0.8733333333  67.200000000  0.0859669662  0.5719465160  0.0630636215  1050          0.1633001757 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 353, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4153697491 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1357776308 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1332691431 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1374696159 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1348269606 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604138374  250           0.1525186539 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604138374  300           0.1391125584 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604138374  350           0.1465123081 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604138374  400           0.1456608868 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0604138374  450           0.1508343315 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0604138374  500           0.1472699213 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0604138374  550           0.1404897928 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0604138374  600           0.1408612156 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0604138374  650           0.1483940744 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0604138374  700           0.1453857136 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0604138374  750           0.1560511303 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0604138374  800           0.1486399508 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0604138374  850           0.1450869417 
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4309134483 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1374670553 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1396246386 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1411965418 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1385528326 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604138374  250           0.1378927517 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604138374  300           0.1505689335 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604138374  350           0.1466640329 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604138374  400           0.1524642658 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0604138374  450           0.1459175968 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0604138374  500           0.1445012951 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0604138374  550           0.1533667231 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0604138374  600           0.1466988182 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0604138374  650           0.1435361242 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0604138374  700           0.1487799835 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0604138374  750           0.1449576330 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0604138374  800           0.1487825966 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0604138374  850           0.1472070122 
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4978528023 
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4678759575 
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4927613735 
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 82, in <module>
    for trails in range(10):
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4267854691 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 2
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 3
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 4
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 5
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 6
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 7
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 8
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 9
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4774048328 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Python 3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
Type 'copyright', 'credits' or 'license' for more information
IPython 7.16.1 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.16.1

Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 296, in <module>
    for step in range(start_step, n_steps):
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4158239365 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3200000000  0.3253968254  0.3320000000  0.3333333333  0.3388554217  0.3313253012  0.4412650602  0.4397590361  0.3133333333  0.0000000000  0.0947492644  1.1284960508  0.0560245514  0             0.1468708515 
trails: 2
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3571428571  0.3300000000  0.3253968254  0.3388554217  0.3313253012  0.4412650602  0.4397590361  0.2900000000  0.0000000000  0.0860699639  1.1067736149  0.0584316254  0             0.1489851475 
trails: 3
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3571428571  0.3320000000  0.3333333333  0.3373493976  0.3253012048  0.4382530120  0.4397590361  0.2800000000  0.0000000000  0.0793299675  1.0869255066  0.0584316254  0             0.1339488029 
trails: 4
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3420000000  0.3571428571  0.3280000000  0.3095238095  0.3388554217  0.3192771084  0.4337349398  0.4337349398  0.2733333333  0.0000000000  0.0731806755  1.0692367554  0.0584316254  0             0.1492278576 
trails: 5
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3540000000  0.3492063492  0.3380000000  0.3333333333  0.3554216867  0.3253012048  0.4352409639  0.4397590361  0.2666666667  0.0000000000  0.0721005425  1.0528841019  0.0584316254  0             0.1563358307 
trails: 6
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 193, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 477, in construct_domain
    Cx, Cy, numC = PU(self.dir, task='[pu1]', data_num=2, test=True).get_files()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 331, in get_files
    data1, lab1 = self.data_load(path1, name=name1, label=int(k))
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 343, in data_load
    fl = loadmat(filename)[name]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio.py", line 224, in loadmat
    matfile_dict = MR.get_variables(variable_names)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio5.py", line 333, in get_variables
    res = self.read_var_array(hdr, process)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/io/matlab/mio5.py", line 293, in read_var_array
    return self._matrix_reader.array_from_header(header, process)
  File "mio5_utils.pyx", line 671, in scipy.io.matlab.mio5_utils.VarReader5.array_from_header
  File "mio5_utils.pyx", line 719, in scipy.io.matlab.mio5_utils.VarReader5.array_from_header
  File "mio5_utils.pyx", line 966, in scipy.io.matlab.mio5_utils.VarReader5.read_struct
  File "mio5_utils.pyx", line 669, in scipy.io.matlab.mio5_utils.VarReader5.read_mi_matrix
  File "mio5_utils.pyx", line 719, in scipy.io.matlab.mio5_utils.VarReader5.array_from_header
  File "mio5_utils.pyx", line 966, in scipy.io.matlab.mio5_utils.VarReader5.read_struct
  File "mio5_utils.pyx", line 669, in scipy.io.matlab.mio5_utils.VarReader5.read_mi_matrix
  File "mio5_utils.pyx", line 713, in scipy.io.matlab.mio5_utils.VarReader5.array_from_header
  File "mio5_utils.pyx", line 845, in scipy.io.matlab.mio5_utils.VarReader5.read_char
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4305489063 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1519024229 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1445926046 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1508886576 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1443878317 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604138374  250           0.1459514427 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604138374  300           0.1495577717 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604138374  350           0.1488586378 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604138374  400           0.1515874004 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0604138374  450           0.1431232262 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0604138374  500           0.1428089905 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0604138374  550           0.1483454275 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0604138374  600           0.1386121368 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0604138374  650           0.1390439463 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0604138374  700           0.1448412800 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0604138374  750           0.1530886269 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0604138374  800           0.1377401876 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0604138374  850           0.1486464262 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.7280000000  0.6587301587  0.7400000000  0.5793650794  0.8614457831  0.7951807229  0.8795180723  0.8433734940  0.9200000000  0.0000000000  0.1269052476  0.5891765356  0.0604138374  0             0.1381509304 
0.7780000000  0.6984126984  0.7380000000  0.5714285714  0.8629518072  0.8373493976  0.8795180723  0.8674698795  0.8266666667  3.2000000000  0.0891679531  0.5764502931  0.0604367256  50            0.1459419394 
0.7380000000  0.6587301587  0.7300000000  0.5634920635  0.8960843373  0.8132530120  0.8960843373  0.8734939759  0.8966666667  6.4000000000  0.0862034992  0.5515031791  0.0604367256  100           0.1401554489 
0.8040000000  0.7222222222  0.7620000000  0.6190476190  0.9036144578  0.8313253012  0.9171686747  0.9096385542  0.7700000000  9.6000000000  0.0940450239  0.5298872393  0.0604367256  150           0.1431967783 
0.7560000000  0.6746031746  0.7600000000  0.6190476190  0.9051204819  0.8373493976  0.9111445783  0.8975903614  0.8666666667  12.800000000  0.0978210882  0.5203735465  0.0604367256  200           0.1394028664 
0.8080000000  0.7063492063  0.7900000000  0.6111111111  0.9201807229  0.8614457831  0.9021084337  0.8975903614  0.8166666667  16.000000000  0.0916100917  0.5036166507  0.0604367256  250           0.1409826422 
0.8260000000  0.7698412698  0.8080000000  0.6190476190  0.9246987952  0.8674698795  0.9322289157  0.9216867470  0.7466666667  19.200000000  0.0939321345  0.4838506114  0.0604367256  300           0.1388929462 
0.8460000000  0.7777777778  0.8080000000  0.6190476190  0.9277108434  0.8674698795  0.9367469880  0.9156626506  0.7333333333  22.400000000  0.0902432395  0.4730128855  0.0604367256  350           0.1388992023 
0.8180000000  0.7222222222  0.8240000000  0.6190476190  0.9277108434  0.8674698795  0.9457831325  0.9397590361  0.7866666667  25.600000000  0.0937807224  0.4699030834  0.0604367256  400           0.1470303822 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4317781925 
trails:trails:  11

Args:Args:

	algorithm: Transfer	algorithm: Transfer

	checkpoint_freq: None	checkpoint_freq: None

	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/

	dataset: Bearing	dataset: Bearing

	holdout_fraction: 0.2	holdout_fraction: 0.2

	hparams: None	hparams: None

	hparams_seed: 0	hparams_seed: 0

	normlizetype: 0-1	normlizetype: 0-1

	output_dir: train_output	output_dir: train_output

	save_model_every_checkpoint: False	save_model_every_checkpoint: False

	seed: 0	seed: 0

	skip_model_save: False	skip_model_save: False

	steps: None	steps: None

	task: domain_generalization	task: domain_generalization

	test_envs: [4]	test_envs: [4]

	trial_seed: 0	trial_seed: 0

	uda_holdout_fraction: 0	uda_holdout_fraction: 0

HParams:HParams:

	batch_size: 32	batch_size: 32

	beta1: 0.5	beta1: 0.5

	class_balanced: False	class_balanced: False

	d_steps_per_g: 10	d_steps_per_g: 10

	data_augmentation: True	data_augmentation: True

	delta: 2	delta: 2

	gda: False	gda: False

	lr: 1e-05	lr: 1e-05

	lr_d: 5e-05	lr_d: 5e-05

	lr_iter: 675	lr_iter: 675

	nonlinear_classifier: False	nonlinear_classifier: False

	resnet18: False	resnet18: False

	resnet_dropout: 0.0	resnet_dropout: 0.0

	t_lambda: 0.8	t_lambda: 0.8

	weight_decay: 0.0008	weight_decay: 0.0008

	weight_decay_d: 0.0008	weight_decay_d: 0.0008

Load Data.Load Data.

data 2data 2

Start Training.Start Training.

env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time     

0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.15496349330.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1549634933  

trails:trails:trails:   222


Args:Args:Args:


	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer


	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None


	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/


	dataset: Bearing	dataset: Bearing	dataset: Bearing


	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2


	hparams: None	hparams: None	hparams: None


	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0


	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1


	output_dir: train_output	output_dir: train_output	output_dir: train_output


	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False


	seed: 0	seed: 0	seed: 0


	skip_model_save: False	skip_model_save: False	skip_model_save: False


	steps: None	steps: None	steps: None


	task: domain_generalization	task: domain_generalization	task: domain_generalization


	test_envs: [4]	test_envs: [4]	test_envs: [4]


	trial_seed: 0	trial_seed: 0	trial_seed: 0


	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0


HParams:HParams:HParams:


	batch_size: 32	batch_size: 32	batch_size: 32


	beta1: 0.5	beta1: 0.5	beta1: 0.5


	class_balanced: False	class_balanced: False	class_balanced: False


	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10


	data_augmentation: True	data_augmentation: True	data_augmentation: True


	delta: 2	delta: 2	delta: 2


	gda: False	gda: False	gda: False


	lr: 1e-05	lr: 1e-05	lr: 1e-05


	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05


	lr_iter: 675	lr_iter: 675	lr_iter: 675


	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False


	resnet18: False	resnet18: False	resnet18: False


	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0


	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8


	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008


	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008


Load Data.Load Data.Load Data.


data 2data 2data 2


Start Training.Start Training.Start Training.


env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time      


0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14313220980.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14313220980.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1431322098   


trails:trails:trails:trails:    3333



Args:Args:Args:Args:



	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer



	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None



	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/



	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing



	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2



	hparams: None	hparams: None	hparams: None	hparams: None



	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0



	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1



	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output



	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False



	seed: 0	seed: 0	seed: 0	seed: 0



	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False



	steps: None	steps: None	steps: None	steps: None



	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization



	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]



	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0



	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0



HParams:HParams:HParams:HParams:



	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32



	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5



	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False



	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10



	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True



	delta: 2	delta: 2	delta: 2	delta: 2



	gda: False	gda: False	gda: False	gda: False



	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05



	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05



	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675



	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False



	resnet18: False	resnet18: False	resnet18: False	resnet18: False



	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0



	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8



	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008



	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008



Load Data.Load Data.Load Data.Load Data.



data 2data 2data 2data 2



Start Training.Start Training.Start Training.Start Training.



env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time       



0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14573264120.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14573264120.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14573264120.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1457326412    



trails:trails:trails:trails:trails:     44444




Args:Args:Args:Args:Args:




	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer




	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None




	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/




	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing




	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2




	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None




	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0




	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1




	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output




	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False




	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0




	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False




	steps: None	steps: None	steps: None	steps: None	steps: None




	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization




	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]




	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0




	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0




HParams:HParams:HParams:HParams:HParams:




	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32




	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5




	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False




	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10




	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True




	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2




	gda: False	gda: False	gda: False	gda: False	gda: False




	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05




	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05




	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675




	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False




	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False




	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0




	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8




	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008




	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008




Load Data.Load Data.Load Data.Load Data.Load Data.




data 2data 2data 2data 2data 2




Start Training.Start Training.Start Training.Start Training.Start Training.




env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time        




0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.16962504390.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.16962504390.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.16962504390.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.16962504390.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1696250439     




trails:trails:trails:trails:trails:trails:      555555





Args:Args:Args:Args:Args:Args:





	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer





	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None





	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/





	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing





	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2





	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None





	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0





	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1





	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output





	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False





	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0





	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False





	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None





	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization





	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]





	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0





	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0





HParams:HParams:HParams:HParams:HParams:HParams:





	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32





	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5





	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False





	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10





	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True





	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2





	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False





	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05





	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05





	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675





	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False





	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False





	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0





	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8





	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008





	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008





Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.





data 2data 2data 2data 2data 2data 2





Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.





env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time         





0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.13260126110.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.13260126110.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.13260126110.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.13260126110.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.13260126110.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1326012611      





trails:trails:trails:trails:trails:trails:trails:       6666666






Args:Args:Args:Args:Args:Args:Args:






	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer






	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None






	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/






	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing






	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2






	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None






	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0






	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1






	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output






	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False






	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0






	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False






	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None






	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization






	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]






	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0






	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0






HParams:HParams:HParams:HParams:HParams:HParams:HParams:






	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32






	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5






	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False






	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10






	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True






	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2






	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False






	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05






	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05






	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675






	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False






	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False






	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0






	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8






	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008






	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008






Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.






data 2data 2data 2data 2data 2data 2data 2






Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.






env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time          






0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.14949369430.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.1494936943       






trails:trails:trails:trails:trails:trails:trails:trails:        77777777







Args:Args:Args:Args:Args:Args:Args:Args:







	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer







	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None







	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/







	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing	dataset: Bearing







	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2







	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None	hparams: None







	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0







	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1







	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output	output_dir: train_output







	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False







	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0	seed: 0







	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False	skip_model_save: False







	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None	steps: None







	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization	task: domain_generalization







	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]	test_envs: [4]







	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0	trial_seed: 0







	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0







HParams:HParams:HParams:HParams:HParams:HParams:HParams:HParams:







	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32	batch_size: 32







	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5	beta1: 0.5







	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False	class_balanced: False







	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10







	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True	data_augmentation: True







	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2	delta: 2







	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False	gda: False







	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05	lr: 1e-05







	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05







	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675	lr_iter: 675







	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False







	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False	resnet18: False







	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0







	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8







	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008







	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008







Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.Load Data.







data 2data 2data 2data 2data 2data 2data 2data 2







Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.Start Training.







Process Process-998:
Process Process-998:
Process Process-998:
Process Process-998:
Process Process-998:
Process Process-998:
Process Process-998:
Process Process-998:
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 251, in _bootstrap
    util._run_after_forkers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 132, in _run_after_forkers
    func(obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/_atfork.py", line 10, in wrapper
    func()
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
KeyboardInterrupt
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <module>
                                for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]







  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 232, in <listcomp>
                                for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]for env in mtedatalist]







  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 41, in __init__
                                batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)batch_sampler=_InfiniteSampler(batch_sampler)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
                                return self._get_iterator()return self._get_iterator()return self._get_iterator()return self._get_iterator()return self._get_iterator()return self._get_iterator()return self._get_iterator()return self._get_iterator()







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
                                return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)return _MultiProcessingDataLoaderIter(self)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
                                w.start()w.start()w.start()w.start()w.start()w.start()w.start()w.start()







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
                                self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)self._popen = self._Popen(self)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
                                return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)return _default_context.get_context().Process._Popen(process_obj)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
                                return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)return Popen(process_obj)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
                                self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)self._launch(process_obj)







  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
                                self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()self.pid = os.fork()







KeyboardInterruptKeyboardInterruptKeyboardInterruptKeyboardInterruptKeyboardInterruptKeyboardInterruptKeyboardInterruptKeyboardInterrupt







trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4175088406 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1393715620 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1450148726 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1411599398 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1400211382 
trails:trails:  11

Args:Args:

	algorithm: Transfer	algorithm: Transfer

	checkpoint_freq: None	checkpoint_freq: None

	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/

	dataset: Bearing	dataset: Bearing

	holdout_fraction: 0.2	holdout_fraction: 0.2

	hparams: None	hparams: None

	hparams_seed: 0	hparams_seed: 0

	normlizetype: 0-1	normlizetype: 0-1

	output_dir: train_output	output_dir: train_output

	save_model_every_checkpoint: False	save_model_every_checkpoint: False

	seed: 0	seed: 0

	skip_model_save: False	skip_model_save: False

	steps: None	steps: None

	task: domain_generalization	task: domain_generalization

	test_envs: [4]	test_envs: [4]

	trial_seed: 0	trial_seed: 0

	uda_holdout_fraction: 0	uda_holdout_fraction: 0

HParams:HParams:

	batch_size: 32	batch_size: 32

	beta1: 0.5	beta1: 0.5

	class_balanced: False	class_balanced: False

	d_steps_per_g: 10	d_steps_per_g: 10

	data_augmentation: True	data_augmentation: True

	delta: 2	delta: 2

	gda: False	gda: False

	lr: 1e-05	lr: 1e-05

	lr_d: 5e-05	lr_d: 5e-05

	lr_iter: 675	lr_iter: 675

	nonlinear_classifier: False	nonlinear_classifier: False

	resnet18: False	resnet18: False

	resnet_dropout: 0.0	resnet_dropout: 0.0

	t_lambda: 0.8	t_lambda: 0.8

	weight_decay: 0.0008	weight_decay: 0.0008

	weight_decay_d: 0.0008	weight_decay_d: 0.0008

Load Data.Load Data.

data 2data 2

Start Training.Start Training.

env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time     

0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.15166354180.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.1516635418  

0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.14167316440.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1416731644  

0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.14507294180.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1450729418  

0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.14385129930.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1438512993  

0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.14437395570.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1443739557  

trails:trails:trails:   222


Args:Args:Args:


	algorithm: Transfer	algorithm: Transfer	algorithm: Transfer


	checkpoint_freq: None	checkpoint_freq: None	checkpoint_freq: None


	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/	data_dir: /home/yfy/Desktop/Dataset/


	dataset: Bearing	dataset: Bearing	dataset: Bearing


	holdout_fraction: 0.2	holdout_fraction: 0.2	holdout_fraction: 0.2


	hparams: None	hparams: None	hparams: None


	hparams_seed: 0	hparams_seed: 0	hparams_seed: 0


	normlizetype: 0-1	normlizetype: 0-1	normlizetype: 0-1


	output_dir: train_output	output_dir: train_output	output_dir: train_output


	save_model_every_checkpoint: False	save_model_every_checkpoint: False	save_model_every_checkpoint: False


	seed: 0	seed: 0	seed: 0


	skip_model_save: False	skip_model_save: False	skip_model_save: False


	steps: None	steps: None	steps: None


	task: domain_generalization	task: domain_generalization	task: domain_generalization


	test_envs: [4]	test_envs: [4]	test_envs: [4]


	trial_seed: 0	trial_seed: 0	trial_seed: 0


	uda_holdout_fraction: 0	uda_holdout_fraction: 0	uda_holdout_fraction: 0


HParams:HParams:HParams:


	batch_size: 32	batch_size: 32	batch_size: 32


	beta1: 0.5	beta1: 0.5	beta1: 0.5


	class_balanced: False	class_balanced: False	class_balanced: False


	d_steps_per_g: 10	d_steps_per_g: 10	d_steps_per_g: 10


	data_augmentation: True	data_augmentation: True	data_augmentation: True


	delta: 2	delta: 2	delta: 2


	gda: False	gda: False	gda: False


	lr: 1e-05	lr: 1e-05	lr: 1e-05


	lr_d: 5e-05	lr_d: 5e-05	lr_d: 5e-05


	lr_iter: 675	lr_iter: 675	lr_iter: 675


	nonlinear_classifier: False	nonlinear_classifier: False	nonlinear_classifier: False


	resnet18: False	resnet18: False	resnet18: False


	resnet_dropout: 0.0	resnet_dropout: 0.0	resnet_dropout: 0.0


	t_lambda: 0.8	t_lambda: 0.8	t_lambda: 0.8


	weight_decay: 0.0008	weight_decay: 0.0008	weight_decay: 0.0008


	weight_decay_d: 0.0008	weight_decay_d: 0.0008	weight_decay_d: 0.0008


Load Data.Load Data.Load Data.


data 2data 2data 2


Start Training.Start Training.Start Training.


env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time   env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time      


0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.13428902630.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.13428902630.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.1342890263   


Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
            step_vals = algorithm.update(minibatches_device, uda_device)   # loss step_vals = algorithm.update(minibatches_device, uda_device)   # loss step_vals = algorithm.update(minibatches_device, uda_device)   # loss 


  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
            gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)


  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
            p = model.adv_classifier(model.featurizer(x))p = model.adv_classifier(model.featurizer(x))p = model.adv_classifier(model.featurizer(x))


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
            result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)


  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 289, in forward
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 289, in forward
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 289, in forward
            x = self.layer5(x)x = self.layer5(x)x = self.layer5(x)


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
            result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
            input = module(input)input = module(input)input = module(input)


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
            result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)result = self.forward(*input, **kwargs)


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
            return F.linear(input, self.weight, self.bias)return F.linear(input, self.weight, self.bias)return F.linear(input, self.weight, self.bias)


  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
            return torch._C._nn.linear(input, weight, bias)return torch._C._nn.linear(input, weight, bias)return torch._C._nn.linear(input, weight, bias)


KeyboardInterruptKeyboardInterruptKeyboardInterrupt


trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Python 3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
Type 'copyright', 'credits' or 'license' for more information
IPython 7.16.1 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.16.1

Out[1]: 
OrderedDict([('1.weight',
              tensor([[-7.3964e-02, -1.2180e-01,  2.8733e-02, -2.5520e-02, -8.1872e-02,
                       -7.7038e-02, -2.6399e-02, -1.0484e-01, -1.4803e-01, -2.6703e-01,
                       -1.7082e-01,  7.2087e-02, -1.9460e-04, -1.6849e-01, -1.9825e-01,
                       -5.5558e-02, -1.3151e-01, -1.8959e-02,  4.2384e-02, -2.6726e-01,
                        2.2546e-01,  1.4339e-01,  1.1453e-01, -1.7775e-01, -2.7700e-02,
                       -1.0265e-01,  2.7291e-01, -2.7402e-01,  6.1149e-02, -2.9327e-02,
                       -2.2730e-01,  2.9350e-01,  8.6397e-02,  1.4656e-01, -2.8968e-01,
                        3.2326e-03, -4.2451e-02,  1.4671e-01,  2.8928e-01, -1.6631e-01,
                        5.2638e-02, -4.1800e-02,  1.1625e-01, -1.0496e-01, -1.4456e-01,
                       -2.5217e-01,  7.8750e-02, -7.0599e-02, -1.3910e-02, -1.7017e-01,
                        7.7035e-02,  6.3568e-02,  1.7138e-01,  2.0675e-01, -2.2282e-01,
                       -1.6674e-01,  2.2982e-01, -4.4715e-02, -1.4319e-02,  1.4108e-01,
                        2.4344e-01, -1.0725e-01, -4.6594e-02, -1.8728e-01],
                      [ 8.2008e-02,  2.2982e-01, -1.2747e-01,  2.7519e-01, -1.3342e-01,
                       -9.4691e-02,  2.0271e-01, -2.5325e-01,  2.6904e-01,  2.5494e-01,
                       -9.9558e-02, -1.5172e-01,  6.3038e-02, -6.9862e-02, -2.5015e-01,
                        6.6430e-02, -5.4798e-02,  1.5023e-01, -2.1591e-01,  2.2969e-01,
                       -1.1362e-01, -1.2601e-01,  1.4503e-01, -3.4392e-02,  1.3909e-01,
                       -2.7747e-01,  2.7503e-01, -1.1924e-01,  3.7811e-03,  2.9331e-01,
                        2.1480e-02,  5.9856e-02,  9.4549e-02, -1.0308e-01, -1.2180e-01,
                        2.8664e-01,  2.5183e-01, -9.7166e-02,  1.6074e-01,  2.5744e-01,
                        4.7841e-02, -2.7125e-01, -1.2824e-01,  1.8589e-01, -3.5395e-02,
                        2.9404e-01,  2.4259e-01,  1.3029e-01,  2.4282e-01,  7.7295e-02,
                        2.6918e-01, -1.7082e-02,  1.6835e-01, -1.6206e-01,  1.2029e-01,
                        8.6593e-02, -4.2670e-02,  1.3636e-01,  1.0343e-01, -2.3009e-01,
                       -2.8414e-01, -3.1959e-02,  2.7659e-01,  1.3820e-01],
                      [ 6.7931e-02,  5.5194e-02,  6.3321e-02, -1.7147e-01, -2.3239e-01,
                       -1.7361e-01, -1.4019e-01, -1.2462e-01,  2.2765e-01, -2.0949e-01,
                        2.0713e-01,  1.5523e-01, -1.8404e-01,  2.4167e-01, -6.8765e-02,
                        2.5464e-02,  2.4168e-01,  1.5352e-01, -8.4952e-02, -1.8353e-01,
                        7.9964e-02, -1.0595e-01,  1.7531e-01, -2.3718e-01, -9.8751e-02,
                       -2.8991e-02,  1.6636e-01,  2.3008e-01,  7.8119e-02, -4.3354e-02,
                       -5.8632e-02,  1.3471e-01, -3.0563e-02, -5.0967e-02, -2.3368e-01,
                        2.4713e-01, -2.8476e-01, -1.3565e-01, -2.3852e-01, -1.2995e-01,
                       -3.8004e-02,  1.0892e-01, -3.7318e-03,  3.4630e-02, -1.5073e-01,
                        1.8041e-01, -1.8232e-01, -1.8529e-01,  2.0603e-01, -3.5812e-02,
                        1.7296e-01, -1.6454e-01, -1.0682e-01, -2.4043e-01, -1.8921e-01,
                        2.7053e-01,  2.0273e-01,  2.0972e-01,  2.5700e-01,  1.5026e-02,
                       -2.3216e-01,  2.8131e-01,  7.0534e-02, -2.6416e-02]])),
             ('1.bias', tensor([0.0100, 0.0100, 0.0100]))])
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             9.1333298683 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1696979952 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604777336  100           0.1711614990 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604777336  150           0.1716387129 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604777336  200           0.1666243029 
Out[2]: 
OrderedDict([('1.weight',
              tensor([[-0.0735, -0.1220,  0.0281, -0.0252, -0.0823, -0.0793, -0.0265, -0.1027,
                       -0.1504, -0.2682, -0.1701,  0.0718,  0.0012, -0.1686, -0.1975, -0.0540,
                       -0.1301, -0.0190,  0.0423, -0.2684,  0.2275,  0.1422,  0.1158, -0.1783,
                       -0.0276, -0.1019,  0.2734, -0.2731,  0.0600, -0.0295, -0.2266,  0.2948,
                        0.0868,  0.1485, -0.2898,  0.0034, -0.0420,  0.1458,  0.2905, -0.1659,
                        0.0536, -0.0429,  0.1148, -0.1055, -0.1437, -0.2528,  0.0788, -0.0726,
                       -0.0146, -0.1712,  0.0773,  0.0652,  0.1697,  0.2058, -0.2230, -0.1660,
                        0.2311, -0.0468, -0.0144,  0.1425,  0.2454, -0.1065, -0.0474, -0.1874],
                      [ 0.0829,  0.2289, -0.1265,  0.2748, -0.1329, -0.0933,  0.2027, -0.2549,
                        0.2717,  0.2564, -0.1001, -0.1508,  0.0618, -0.0686, -0.2517,  0.0652,
                       -0.0554,  0.1504, -0.2151,  0.2304, -0.1141, -0.1250,  0.1445, -0.0332,
                        0.1386, -0.2764,  0.2755, -0.1183,  0.0039,  0.2937,  0.0221,  0.0599,
                        0.0945, -0.1047, -0.1221,  0.2866,  0.2513, -0.0968,  0.1623,  0.2566,
                        0.0475, -0.2716, -0.1267,  0.1862, -0.0357,  0.2944,  0.2430,  0.1318,
                        0.2427,  0.0772,  0.2676, -0.0174,  0.1681, -0.1618,  0.1197,  0.0859,
                       -0.0424,  0.1379,  0.1041, -0.2310, -0.2849, -0.0326,  0.2775,  0.1378],
                      [ 0.0661,  0.0563,  0.0631, -0.1714, -0.2315, -0.1723, -0.1401, -0.1253,
                        0.2267, -0.2101,  0.2068,  0.1544, -0.1844,  0.2405, -0.0676,  0.0244,
                        0.2403,  0.1532, -0.0843, -0.1828,  0.0778, -0.1056,  0.1740, -0.2379,
                       -0.0983, -0.0307,  0.1650,  0.2288,  0.0790, -0.0438, -0.0602,  0.1331,
                       -0.0311, -0.0515, -0.2329,  0.2466, -0.2845, -0.1351, -0.2412, -0.1293,
                       -0.0388,  0.1103, -0.0040,  0.0350, -0.1510,  0.1808, -0.1828, -0.1851,
                        0.2059, -0.0346,  0.1726, -0.1662, -0.1058, -0.2395, -0.1880,  0.2699,
                        0.2010,  0.2098,  0.2555,  0.0143, -0.2336,  0.2810,  0.0703, -0.0256]],
                     device='cuda:0')),
             ('1.bias', tensor([0.0101, 0.0108, 0.0090], device='cuda:0'))])
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Out[3]: 
OrderedDict([('1.weight',
              tensor([[-0.0735, -0.1220,  0.0281, -0.0252, -0.0823, -0.0793, -0.0265, -0.1027,
                       -0.1504, -0.2682, -0.1701,  0.0718,  0.0012, -0.1686, -0.1975, -0.0540,
                       -0.1301, -0.0190,  0.0423, -0.2684,  0.2275,  0.1422,  0.1158, -0.1783,
                       -0.0276, -0.1019,  0.2734, -0.2731,  0.0600, -0.0295, -0.2266,  0.2948,
                        0.0868,  0.1485, -0.2898,  0.0034, -0.0420,  0.1458,  0.2905, -0.1659,
                        0.0536, -0.0429,  0.1148, -0.1055, -0.1437, -0.2528,  0.0788, -0.0726,
                       -0.0146, -0.1712,  0.0773,  0.0652,  0.1697,  0.2058, -0.2230, -0.1660,
                        0.2311, -0.0468, -0.0144,  0.1425,  0.2454, -0.1065, -0.0474, -0.1874],
                      [ 0.0829,  0.2289, -0.1265,  0.2748, -0.1329, -0.0933,  0.2027, -0.2549,
                        0.2717,  0.2564, -0.1001, -0.1508,  0.0618, -0.0686, -0.2517,  0.0652,
                       -0.0554,  0.1504, -0.2151,  0.2304, -0.1141, -0.1250,  0.1445, -0.0332,
                        0.1386, -0.2764,  0.2755, -0.1183,  0.0039,  0.2937,  0.0221,  0.0599,
                        0.0945, -0.1047, -0.1221,  0.2866,  0.2513, -0.0968,  0.1623,  0.2566,
                        0.0475, -0.2716, -0.1267,  0.1862, -0.0357,  0.2944,  0.2430,  0.1318,
                        0.2427,  0.0772,  0.2676, -0.0174,  0.1681, -0.1618,  0.1197,  0.0859,
                       -0.0424,  0.1379,  0.1041, -0.2310, -0.2849, -0.0326,  0.2775,  0.1378],
                      [ 0.0661,  0.0563,  0.0631, -0.1714, -0.2315, -0.1723, -0.1401, -0.1253,
                        0.2267, -0.2101,  0.2068,  0.1544, -0.1844,  0.2405, -0.0676,  0.0244,
                        0.2403,  0.1532, -0.0843, -0.1828,  0.0778, -0.1056,  0.1740, -0.2379,
                       -0.0983, -0.0307,  0.1650,  0.2288,  0.0790, -0.0438, -0.0602,  0.1331,
                       -0.0311, -0.0515, -0.2329,  0.2466, -0.2845, -0.1351, -0.2412, -0.1293,
                       -0.0388,  0.1103, -0.0040,  0.0350, -0.1510,  0.1808, -0.1828, -0.1851,
                        0.2059, -0.0346,  0.1726, -0.1662, -0.1058, -0.2395, -0.1880,  0.2699,
                        0.2010,  0.2098,  0.2555,  0.0143, -0.2336,  0.2810,  0.0703, -0.0256]],
                     device='cuda:0')),
             ('1.bias', tensor([0.0101, 0.0108, 0.0090], device='cuda:0'))])
Out[4]: 
OrderedDict([('1.weight',
              tensor([[-7.3964e-02, -1.2180e-01,  2.8733e-02, -2.5520e-02, -8.1872e-02,
                       -7.7038e-02, -2.6399e-02, -1.0484e-01, -1.4803e-01, -2.6703e-01,
                       -1.7082e-01,  7.2087e-02, -1.9460e-04, -1.6849e-01, -1.9825e-01,
                       -5.5558e-02, -1.3151e-01, -1.8959e-02,  4.2384e-02, -2.6726e-01,
                        2.2546e-01,  1.4339e-01,  1.1453e-01, -1.7775e-01, -2.7700e-02,
                       -1.0265e-01,  2.7291e-01, -2.7402e-01,  6.1149e-02, -2.9327e-02,
                       -2.2730e-01,  2.9350e-01,  8.6397e-02,  1.4656e-01, -2.8968e-01,
                        3.2326e-03, -4.2451e-02,  1.4671e-01,  2.8928e-01, -1.6631e-01,
                        5.2638e-02, -4.1800e-02,  1.1625e-01, -1.0496e-01, -1.4456e-01,
                       -2.5217e-01,  7.8750e-02, -7.0599e-02, -1.3910e-02, -1.7017e-01,
                        7.7035e-02,  6.3568e-02,  1.7138e-01,  2.0675e-01, -2.2282e-01,
                       -1.6674e-01,  2.2982e-01, -4.4715e-02, -1.4319e-02,  1.4108e-01,
                        2.4344e-01, -1.0725e-01, -4.6594e-02, -1.8728e-01],
                      [ 8.2008e-02,  2.2982e-01, -1.2747e-01,  2.7519e-01, -1.3342e-01,
                       -9.4691e-02,  2.0271e-01, -2.5325e-01,  2.6904e-01,  2.5494e-01,
                       -9.9558e-02, -1.5172e-01,  6.3038e-02, -6.9862e-02, -2.5015e-01,
                        6.6430e-02, -5.4798e-02,  1.5023e-01, -2.1591e-01,  2.2969e-01,
                       -1.1362e-01, -1.2601e-01,  1.4503e-01, -3.4392e-02,  1.3909e-01,
                       -2.7747e-01,  2.7503e-01, -1.1924e-01,  3.7811e-03,  2.9331e-01,
                        2.1480e-02,  5.9856e-02,  9.4549e-02, -1.0308e-01, -1.2180e-01,
                        2.8664e-01,  2.5183e-01, -9.7166e-02,  1.6074e-01,  2.5744e-01,
                        4.7841e-02, -2.7125e-01, -1.2824e-01,  1.8589e-01, -3.5395e-02,
                        2.9404e-01,  2.4259e-01,  1.3029e-01,  2.4282e-01,  7.7295e-02,
                        2.6918e-01, -1.7082e-02,  1.6835e-01, -1.6206e-01,  1.2029e-01,
                        8.6593e-02, -4.2670e-02,  1.3636e-01,  1.0343e-01, -2.3009e-01,
                       -2.8414e-01, -3.1959e-02,  2.7659e-01,  1.3820e-01],
                      [ 6.7931e-02,  5.5194e-02,  6.3321e-02, -1.7147e-01, -2.3239e-01,
                       -1.7361e-01, -1.4019e-01, -1.2462e-01,  2.2765e-01, -2.0949e-01,
                        2.0713e-01,  1.5523e-01, -1.8404e-01,  2.4167e-01, -6.8765e-02,
                        2.5464e-02,  2.4168e-01,  1.5352e-01, -8.4952e-02, -1.8353e-01,
                        7.9964e-02, -1.0595e-01,  1.7531e-01, -2.3718e-01, -9.8751e-02,
                       -2.8991e-02,  1.6636e-01,  2.3008e-01,  7.8119e-02, -4.3354e-02,
                       -5.8632e-02,  1.3471e-01, -3.0563e-02, -5.0967e-02, -2.3368e-01,
                        2.4713e-01, -2.8476e-01, -1.3565e-01, -2.3852e-01, -1.2995e-01,
                       -3.8004e-02,  1.0892e-01, -3.7318e-03,  3.4630e-02, -1.5073e-01,
                        1.8041e-01, -1.8232e-01, -1.8529e-01,  2.0603e-01, -3.5812e-02,
                        1.7296e-01, -1.6454e-01, -1.0682e-01, -2.4043e-01, -1.8921e-01,
                        2.7053e-01,  2.0273e-01,  2.0972e-01,  2.5700e-01,  1.5026e-02,
                       -2.3216e-01,  2.8131e-01,  7.0534e-02, -2.6416e-02]])),
             ('1.bias', tensor([0.0100, 0.0100, 0.0100]))])
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1973, in update
    self.adv_classifier = self.proj(self.hparams['delta'], self.adv_classifier, self.classifier)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1923, in proj
    dist = self.distance(adv_h, h)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1916, in distance
    h1_param, h2_param = h1.state_dict()[param], h2.state_dict()[param]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1076, in state_dict
    module.state_dict(destination, prefix + name + '.', keep_vars=keep_vars)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1073, in state_dict
    self._save_to_state_dict(destination, prefix, keep_vars)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1034, in _save_to_state_dict
    destination[prefix + name] = param if keep_vars else param.detach()
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 193, in <module>
    train_x, train_y, tr_num = dataset.construct_domain()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/datasets.py", line 477, in construct_domain
    Cx, Cy, numC = PU(self.dir, task='[pu1]', data_num=2, test=True).get_files()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 331, in get_files
    data1, lab1 = self.data_load(path1, name=name1, label=int(k))
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/bearings_datasets.py", line 346, in data_load
    fl = signal.resample_poly(fl, self.down_f, self.frequency, axis=1)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/signal/signaltools.py", line 3125, in resample_poly
    h = firwin(2 * half_len + 1, f_c, window=window)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/scipy/signal/fir_filter_design.py", line 399, in firwin
    if np.any(np.diff(cutoff) <= 0):
  File "<__array_function__ internals>", line 6, in any
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/numpy/core/fromnumeric.py", line 2330, in any
    return _wrapreduction(a, np.logical_or, 'any', axis, None, out, keepdims=keepdims)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4268403053 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1420152760 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1431165171 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1403143930 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1393837214 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.5560000000  0.4761904762  0.4960000000  0.4682539683  0.6927710843  0.6265060241  0.7033132530  0.6686746988  0.3366666667  0.0000000000  0.0662383065  0.9648166299  0.0604138374  0             0.1270573139 
0.5680000000  0.5396825397  0.5780000000  0.5079365079  0.7243975904  0.6686746988  0.8358433735  0.7891566265  0.3733333333  3.2000000000  0.0526280225  0.9475367284  0.0604367256  50            0.1412730837 
0.5640000000  0.5238095238  0.5580000000  0.4920634921  0.7409638554  0.6506024096  0.8584337349  0.8192771084  0.3600000000  6.4000000000  0.0626831992  0.9030480671  0.0604367256  100           0.1417251158 
0.5820000000  0.5238095238  0.6020000000  0.5317460317  0.7469879518  0.6626506024  0.8704819277  0.8313253012  0.3966666667  9.6000000000  0.0684292635  0.8540319324  0.0604367256  150           0.1414635611 
0.6040000000  0.5079365079  0.5960000000  0.5317460317  0.7816265060  0.7048192771  0.8614457831  0.8192771084  0.3933333333  12.800000000  0.0731488889  0.8148443544  0.0604367256  200           0.1403839111 
trails: 2
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.6040000000  0.5396825397  0.6320000000  0.5634920635  0.7560240964  0.6746987952  0.8810240964  0.8373493976  0.4400000000  0.0000000000  0.0940226093  0.7670024633  0.0604367256  0             0.1450698376 
0.6420000000  0.5793650794  0.6780000000  0.6190476190  0.7906626506  0.7891566265  0.8463855422  0.8192771084  0.6766666667  3.2000000000  0.0705874387  0.7679342055  0.0604672432  50            0.1335159206 
0.6160000000  0.5396825397  0.6380000000  0.5793650794  0.8177710843  0.7409638554  0.8765060241  0.8554216867  0.5233333333  6.4000000000  0.0774160349  0.7274337709  0.0604672432  100           0.1394880581 
0.6640000000  0.5952380952  0.6900000000  0.5793650794  0.8207831325  0.7650602410  0.8825301205  0.8433734940  0.7600000000  9.6000000000  0.0830952950  0.6867663240  0.0604672432  150           0.1373306513 
0.6400000000  0.5793650794  0.6660000000  0.5793650794  0.8373493976  0.7590361446  0.8960843373  0.8734939759  0.6800000000  12.800000000  0.0843717049  0.6612374771  0.0604672432  200           0.1405482531 
trails: 3
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.6720000000  0.6031746032  0.7040000000  0.5952380952  0.8117469880  0.7771084337  0.8825301205  0.8433734940  0.8200000000  0.0000000000  0.1174208671  0.6136903763  0.0604672432  0             0.2000648975 
0.7300000000  0.6428571429  0.7220000000  0.6031746032  0.8237951807  0.8012048193  0.8885542169  0.8674698795  0.8433333333  3.2000000000  0.0818716151  0.6313661921  0.0604672432  50            0.1424010944 
0.7000000000  0.5873015873  0.6900000000  0.5793650794  0.8659638554  0.7771084337  0.8900602410  0.8614457831  0.8266666667  6.4000000000  0.0837087581  0.6032025445  0.0604901314  100           0.1421247482 
0.7340000000  0.6746031746  0.7340000000  0.5952380952  0.8388554217  0.8012048193  0.8960843373  0.8734939759  0.8566666667  9.6000000000  0.0861481242  0.5936817503  0.0604901314  150           0.1511952448 
0.6880000000  0.5873015873  0.6820000000  0.5793650794  0.8704819277  0.7831325301  0.8945783133  0.8674698795  0.7700000000  12.800000000  0.0862042066  0.5977129543  0.0604901314  200           0.1438016033 
trails: 4
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.7080000000  0.6031746032  0.7140000000  0.5952380952  0.8584337349  0.7951807229  0.9021084337  0.8734939759  0.8600000000  0.0000000000  0.1095616370  0.5580351353  0.0604901314  0             0.1470823288 
0.7540000000  0.6507936508  0.7380000000  0.6111111111  0.8373493976  0.8313253012  0.8840361446  0.8734939759  0.8133333333  3.2000000000  0.0875904576  0.5823483968  0.0604901314  50            0.1494099808 
0.7340000000  0.6269841270  0.7220000000  0.5873015873  0.8870481928  0.7891566265  0.9126506024  0.8915662651  0.8633333333  6.4000000000  0.0856183553  0.5606485808  0.0604901314  100           0.1455020666 
0.8060000000  0.7222222222  0.7740000000  0.6349206349  0.8569277108  0.8373493976  0.9246987952  0.9036144578  0.8333333333  9.6000000000  0.0904363634  0.5415631169  0.0604901314  150           0.1533237123 
0.7460000000  0.6507936508  0.7580000000  0.6269841270  0.8945783133  0.8192771084  0.9231927711  0.8975903614  0.8966666667  12.800000000  0.0959997033  0.5303291059  0.0604901314  200           0.1451502466 
trails: 5
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.7780000000  0.6666666667  0.7840000000  0.6349206349  0.8750000000  0.8373493976  0.9111445783  0.8975903614  0.8633333333  0.0000000000  0.1230253205  0.4824772477  0.0604901314  0             0.1676890850 
0.8260000000  0.7380952381  0.7820000000  0.6666666667  0.8765060241  0.8915662651  0.9156626506  0.9036144578  0.7266666667  3.2000000000  0.0893070033  0.5121339262  0.0604901314  50            0.1438557625 
0.7860000000  0.6746031746  0.7880000000  0.6190476190  0.9006024096  0.8192771084  0.9277108434  0.9156626506  0.9100000000  6.4000000000  0.0885649702  0.4961954671  0.0604901314  100           0.1480763721 
0.8300000000  0.7539682540  0.7920000000  0.6428571429  0.9081325301  0.8855421687  0.9472891566  0.9457831325  0.7266666667  9.6000000000  0.0924292000  0.4809039360  0.0604901314  150           0.1500502586 
0.8020000000  0.7063492063  0.8040000000  0.6507936508  0.9246987952  0.8795180723  0.9397590361  0.9277108434  0.8766666667  12.800000000  0.0946386858  0.4742328304  0.0604901314  200           0.1463290548 
trails: 6
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.8460000000  0.7142857143  0.8140000000  0.6587301587  0.9111445783  0.8855421687  0.9397590361  0.9397590361  0.8400000000  0.0000000000  0.1149121076  0.4235762656  0.0604901314  0             0.1387410164 
0.8580000000  0.7698412698  0.8420000000  0.6587301587  0.9021084337  0.8975903614  0.9337349398  0.9277108434  0.7100000000  3.2000000000  0.0901619586  0.4580962348  0.0604901314  50            0.1615120983 
0.8200000000  0.7063492063  0.8000000000  0.6269841270  0.9111445783  0.8373493976  0.9427710843  0.9277108434  0.8733333333  6.4000000000  0.0915094616  0.4433891928  0.0604901314  100           0.1490758324 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4206030369 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1398735619 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1381125546 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1383870792 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1372630644 
trails: 1
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.1369931698 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1423672199 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1432826328 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1403517199 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1387184906 
trails: 2
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.1374175549 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1380853987 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1398904848 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1389583158 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1416636038 
trails: 3
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0604138374  0             0.1635081768 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1602623558 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1476220274 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1434521818 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1475533819 
trails: 4
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Exception ignored in: <bound method _MultiProcessingDataLoaderIter.__del__ of <torch.utils.data.dataloader._MultiProcessingDataLoaderIter object at 0x7f821038d898>>
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1324, in __del__
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1297, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 47, in wait
    if not wait([self.sentinel], timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt: 
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 299, in <module>
    for x, y in next(train_minibatches_iterator)]
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 46, in __iter__
    yield next(self._infinite_iterator)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 999, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str)) from e
RuntimeError: DataLoader worker (pid(s) 762118, 762130, 762142, 762154, 762155, 762178, 762190, 762191) exited unexpectedly
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4257478714 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604138374  50            0.1446583700 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604138374  100           0.1388005352 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604138374  150           0.1501345205 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604138374  200           0.1453209305 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604138374  250           0.1365496683 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604138374  300           0.1515479231 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604138374  350           0.1433704472 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604138374  400           0.1387845802 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0604138374  450           0.1371951532 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0604138374  500           0.1502278185 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0604138374  550           0.1497313309 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0604138374  600           0.1409459782 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0604138374  650           0.1470247078 
0.7620000000  0.7142857143  0.7400000000  0.5952380952  0.8584337349  0.8313253012  0.8780120482  0.8493975904  0.8500000000  44.800000000  0.0954304945  0.5999648404  0.0604138374  700           0.1435942078 
0.7500000000  0.6904761905  0.7400000000  0.6031746032  0.8614457831  0.8192771084  0.8765060241  0.8433734940  0.8600000000  48.000000000  0.0849803666  0.5961652458  0.0604138374  750           0.1438086939 
0.7060000000  0.6587301587  0.7300000000  0.5873015873  0.8765060241  0.8192771084  0.8704819277  0.8433734940  0.8900000000  51.200000000  0.0946747354  0.5950860572  0.0604138374  800           0.1475439739 
0.7300000000  0.6666666667  0.7280000000  0.5952380952  0.8614457831  0.8072289157  0.8795180723  0.8433734940  0.8900000000  54.400000000  0.0776386957  0.5965849268  0.0604138374  850           0.1504636383 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3260000000  0.3015873016  0.3240000000  0.3333333333  0.3328313253  0.3313253012  0.3233333333  0.0000000000  0.0666318908  1.1075783968  0.0449552536  0             0.4491288662 
0.5280000000  0.5317460317  0.5180000000  0.4841269841  0.6159638554  0.6445783133  0.3466666667  3.2000000000  0.0398731258  1.0774918389  0.0479736328  50            0.1236379433 
0.5920000000  0.6031746032  0.5560000000  0.5158730159  0.7243975904  0.6927710843  0.3566666667  6.4000000000  0.0345792910  1.0289589489  0.0479736328  100           0.1244705248 
0.6420000000  0.6190476190  0.6180000000  0.5793650794  0.7831325301  0.7710843373  0.4200000000  9.6000000000  0.0397558370  0.9894521224  0.0479736328  150           0.1243880701 
0.6620000000  0.6507936508  0.6380000000  0.6269841270  0.7951807229  0.7710843373  0.4500000000  12.800000000  0.0417296585  0.9299118769  0.0479736328  200           0.1234639072 
0.6700000000  0.6349206349  0.6600000000  0.6428571429  0.8268072289  0.8253012048  0.4966666667  16.000000000  0.0562962878  0.8620748937  0.0479736328  250           0.1241644478 
0.6720000000  0.6666666667  0.6700000000  0.6428571429  0.8268072289  0.8132530120  0.5966666667  19.200000000  0.0483843079  0.8016374052  0.0479736328  300           0.1217453957 
0.7000000000  0.6825396825  0.7080000000  0.6825396825  0.8117469880  0.8012048193  0.6766666667  22.400000000  0.0619347068  0.7520417798  0.0479736328  350           0.1234290314 
0.7100000000  0.7063492063  0.7300000000  0.7222222222  0.7996987952  0.7891566265  0.6600000000  25.600000000  0.0636444865  0.6958542943  0.0479736328  400           0.1289956141 
0.7480000000  0.7142857143  0.7240000000  0.6746031746  0.8509036145  0.8734939759  0.7266666667  28.800000000  0.0790942192  0.6551821482  0.0479736328  450           0.1231318331 
0.8040000000  0.7936507937  0.7560000000  0.7063492063  0.8960843373  0.9216867470  0.7033333333  32.000000000  0.0619164402  0.6189255214  0.0479736328  500           0.1208914709 
0.8020000000  0.7460317460  0.7740000000  0.7777777778  0.9246987952  0.9397590361  0.7866666667  35.200000000  0.0760912109  0.5836398757  0.0479736328  550           0.1235257053 
0.8320000000  0.7222222222  0.8100000000  0.7460317460  0.8614457831  0.8915662651  0.5666666667  38.400000000  0.0782507998  0.5519640839  0.0479736328  600           0.1212914515 
0.8520000000  0.7936507937  0.8280000000  0.7301587302  0.9487951807  0.9397590361  0.8066666667  41.600000000  0.0753995668  0.5316725069  0.0479736328  650           0.1211187983 
0.8360000000  0.7857142857  0.8340000000  0.7460317460  0.9623493976  0.9698795181  0.7933333333  44.800000000  0.0694411097  0.4954079455  0.0479736328  700           0.1246608591 
0.8340000000  0.7857142857  0.8380000000  0.7380952381  0.9503012048  0.9698795181  0.7033333333  48.000000000  0.0650558955  0.4935248613  0.0479736328  750           0.1346036863 
0.8440000000  0.7857142857  0.8340000000  0.7539682540  0.9307228916  0.9638554217  0.6333333333  51.200000000  0.0812333736  0.4880961561  0.0479736328  800           0.1215811491 
0.8360000000  0.7936507937  0.8380000000  0.7380952381  0.9563253012  0.9698795181  0.7566666667  54.400000000  0.0765553094  0.4970065719  0.0479736328  850           0.1268017244 
trails: 0
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3280000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3283720016 
0.5060000000  0.5079365079  0.4440000000  0.4047619048  0.7153614458  0.6807228916  0.3266666667  3.2000000000  1.0764351964  0.0465354919  50            0.0187919331 
0.5260000000  0.5158730159  0.4580000000  0.4523809524  0.8433734940  0.8433734940  0.3366666667  6.4000000000  1.0022918439  0.0465354919  100           0.0189371443 
0.6580000000  0.6349206349  0.5940000000  0.6349206349  0.7846385542  0.7891566265  0.3700000000  9.6000000000  0.9195937121  0.0465354919  150           0.0202674532 
0.6620000000  0.6666666667  0.6440000000  0.6428571429  0.7996987952  0.7891566265  0.4366666667  12.800000000  0.8240561581  0.0465354919  200           0.0198520517 
0.6920000000  0.6984126984  0.6800000000  0.6587301587  0.7635542169  0.7650602410  0.5700000000  16.000000000  0.7392039871  0.0465354919  250           0.0205697250 
0.7100000000  0.6825396825  0.6920000000  0.6587301587  0.7033132530  0.7048192771  0.6533333333  19.200000000  0.6527095723  0.0465354919  300           0.0195411539 
0.7560000000  0.7301587302  0.7400000000  0.6825396825  0.7334337349  0.7530120482  0.7666666667  22.400000000  0.5844006705  0.0465354919  350           0.0198546982 
0.7620000000  0.7380952381  0.7320000000  0.7142857143  0.7424698795  0.7650602410  0.7566666667  25.600000000  0.5366876566  0.0465354919  400           0.0194685698 
0.8600000000  0.7698412698  0.8300000000  0.7380952381  0.7605421687  0.7891566265  0.7766666667  28.800000000  0.5132747614  0.0465354919  450           0.0197802639 
0.8560000000  0.7936507937  0.7840000000  0.7301587302  0.7861445783  0.8072289157  0.7733333333  32.000000000  0.4680325198  0.0465354919  500           0.0199479055 
0.8840000000  0.8095238095  0.7960000000  0.7380952381  0.7801204819  0.7951807229  0.7200000000  35.200000000  0.4419413805  0.0465354919  550           0.0203240633 
0.9060000000  0.8571428571  0.8500000000  0.7619047619  0.7876506024  0.8132530120  0.6966666667  38.400000000  0.4116312194  0.0465354919  600           0.0196478748 
0.8940000000  0.8571428571  0.8120000000  0.7301587302  0.8237951807  0.8493975904  0.7800000000  41.600000000  0.3883142519  0.0465354919  650           0.0189709425 
0.9200000000  0.8809523810  0.8320000000  0.7619047619  0.7936746988  0.8253012048  0.6766666667  44.800000000  0.3590379751  0.0465354919  700           0.0196492434 
0.9480000000  0.9047619048  0.8620000000  0.7857142857  0.7861445783  0.8072289157  0.6033333333  48.000000000  0.3426186234  0.0465354919  750           0.0189929152 
0.9560000000  0.9285714286  0.8940000000  0.7857142857  0.7921686747  0.8192771084  0.6166666667  51.200000000  0.3174968088  0.0465354919  800           0.0193451405 
0.9660000000  0.9206349206  0.8840000000  0.8015873016  0.7921686747  0.8072289157  0.5966666667  54.400000000  0.2902512771  0.0465354919  850           0.0201143312 
trails: 0
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.0005
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3412698413  0.3500000000  0.3333333333  0.5978915663  0.5722891566  0.3333333333  0.0000000000  1.1289460659  0.0402302742  0             0.3204040527 
0.8600000000  0.8174603175  0.7740000000  0.6984126984  0.9352409639  0.8975903614  0.5566666667  3.2000000000  0.4268348470  0.0465354919  50            0.0203323460 
0.9940000000  0.9761904762  0.9680000000  0.9444444444  0.5075301205  0.4638554217  0.3766666667  6.4000000000  0.1205254655  0.0465354919  100           0.0207595968 
0.9560000000  0.9206349206  0.9060000000  0.7698412698  0.9864457831  0.9698795181  0.7733333333  9.6000000000  0.0529191596  0.0465354919  150           0.0204811525 
1.0000000000  0.9920634921  0.9940000000  0.9365079365  0.7093373494  0.7168674699  0.5700000000  12.800000000  0.0554661920  0.0465354919  200           0.0198262691 
0.9980000000  0.9761904762  0.9920000000  0.8968253968  0.9774096386  0.9819277108  0.7033333333  16.000000000  0.0174377707  0.0465354919  250           0.0159856319 
1.0000000000  0.9682539683  1.0000000000  0.9761904762  0.7756024096  0.7530120482  0.6766666667  19.200000000  0.0157823142  0.0465354919  300           0.0199081755 
1.0000000000  0.9761904762  1.0000000000  0.9444444444  0.8734939759  0.8674698795  0.7366666667  22.400000000  0.0116568643  0.0465354919  350           0.0204087782 
1.0000000000  0.9682539683  0.9960000000  0.9206349206  0.9111445783  0.8975903614  0.7833333333  25.600000000  0.0090472945  0.0465354919  400           0.0204644251 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.6807228916  0.6506024096  0.3833333333  28.800000000  0.0150124786  0.0465354919  450           0.0200825024 
1.0000000000  0.9444444444  0.9960000000  0.9365079365  0.8900602410  0.8975903614  0.7133333333  32.000000000  0.0065325802  0.0465354919  500           0.0207499313 
0.9960000000  0.9603174603  0.9980000000  0.9206349206  0.9081325301  0.9096385542  0.6600000000  35.200000000  0.0092868169  0.0465354919  550           0.0205195236 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  0.9066265060  0.8795180723  0.6833333333  38.400000000  0.0077517223  0.0465354919  600           0.0205072880 
0.9980000000  0.9841269841  0.9960000000  0.9523809524  0.7349397590  0.6385542169  0.4400000000  41.600000000  0.0111372762  0.0465354919  650           0.0216630840 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  0.8825301205  0.8554216867  0.6733333333  44.800000000  0.0100178122  0.0465354919  700           0.0187071896 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  0.8825301205  0.8674698795  0.7166666667  48.000000000  0.0025142175  0.0465354919  750           0.0215230799 
0.9940000000  0.9682539683  0.9980000000  0.9523809524  0.6566265060  0.6265060241  0.4000000000  51.200000000  0.0039135321  0.0465354919  800           0.0187887859 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  0.7469879518  0.7710843373  0.6100000000  54.400000000  0.0207180564  0.0465354919  850           0.0214643764 
trails: 0
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 1e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2079, in update
    self.q[i] *= (self.hparams["groupdro_eta"] * losses[i].data).exp()
KeyError: 'groupdro_eta'
trails: 0
Args:
	algorithm: DROMMD
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 1e-05
	mmd_gamma: 1.5
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	sd_reg: 0.1
	weight_decay: 0.0008
Load Data.
data 3
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_test_ac  epoch         loss          mem_gb        penalty       step          step_time    
0.3280000000  0.3333333333  0.3300000000  0.3333333333  0.3328313253  0.3313253012  0.3333333333  0.0000000000  1.1289460659  0.0402369499  0.0032207281  0             0.3214659691 
0.5100000000  0.4841269841  0.4500000000  0.4047619048  0.7274096386  0.6927710843  0.3266666667  3.2000000000  1.0771132898  0.0465407372  0.0031316217  50            0.0219533587 
0.5320000000  0.5158730159  0.4580000000  0.4841269841  0.8418674699  0.8614457831  0.3366666667  6.4000000000  1.0040477300  0.0465407372  0.0036435019  100           0.0222350216 
0.6520000000  0.6190476190  0.6140000000  0.6190476190  0.8358433735  0.8253012048  0.3900000000  9.6000000000  0.9226035976  0.0465407372  0.0041372979  150           0.0232496643 
0.6640000000  0.6428571429  0.6400000000  0.6507936508  0.8373493976  0.8313253012  0.4500000000  12.800000000  0.8284900725  0.0465407372  0.0043849770  200           0.0229676199 
0.6800000000  0.6746031746  0.6900000000  0.6904761905  0.7906626506  0.7891566265  0.6033333333  16.000000000  0.7442613769  0.0465407372  0.0046357891  250           0.0218207216 
0.7120000000  0.6904761905  0.7020000000  0.6507936508  0.7108433735  0.7349397590  0.6500000000  19.200000000  0.6581711543  0.0465407372  0.0056653527  300           0.0217369747 
0.7560000000  0.7380952381  0.7420000000  0.6904761905  0.7319277108  0.7590361446  0.7733333333  22.400000000  0.5907351911  0.0465407372  0.0071700244  350           0.0215809155 
0.7620000000  0.7539682540  0.7380000000  0.7142857143  0.7379518072  0.7590361446  0.7433333333  25.600000000  0.5453278327  0.0465407372  0.0086524309  400           0.0220691919 
0.8520000000  0.7698412698  0.8360000000  0.7380952381  0.7560240964  0.7831325301  0.7866666667  28.800000000  0.5233579057  0.0465407372  0.0103584752  450           0.0227829742 
0.8460000000  0.7936507937  0.7980000000  0.7301587302  0.7876506024  0.8012048193  0.7766666667  32.000000000  0.4808126158  0.0465407372  0.0117916417  500           0.0221169233 
0.8640000000  0.7936507937  0.8040000000  0.7380952381  0.7801204819  0.7951807229  0.7533333333  35.200000000  0.4577186137  0.0465407372  0.0131465201  550           0.0231489468 
0.9000000000  0.8571428571  0.8620000000  0.7777777778  0.7906626506  0.8253012048  0.7366666667  38.400000000  0.4282913947  0.0465407372  0.0149773227  600           0.0215512562 
0.8920000000  0.8253968254  0.8160000000  0.7142857143  0.8373493976  0.8674698795  0.8033333333  41.600000000  0.4065637630  0.0465407372  0.0153961506  650           0.0217749453 
0.9080000000  0.8492063492  0.8400000000  0.7698412698  0.8102409639  0.8433734940  0.7300000000  44.800000000  0.3787663817  0.0465407372  0.0157849722  700           0.0223468637 
0.9480000000  0.8968253968  0.8680000000  0.7857142857  0.7906626506  0.8132530120  0.6800000000  48.000000000  0.3625608194  0.0465407372  0.0162791535  750           0.0217323637 
0.9500000000  0.9126984127  0.9000000000  0.8015873016  0.8147590361  0.8493975904  0.7000000000  51.200000000  0.3380630994  0.0465407372  0.0160598620  800           0.0228770351 
0.9620000000  0.9206349206  0.8940000000  0.8095238095  0.8117469880  0.8373493976  0.7200000000  54.400000000  0.3104318261  0.0465407372  0.0160447401  850           0.0228148651 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 263, in <module>
    algorithm = algorithm_class(dataset.input_shape, dataset.num_classes, domain_num, hparams)  # 
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [3]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env3_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3730158730  0.3340000000  0.3333333333  0.2740963855  0.2289156627  0.2250000000  0.2166666667  0.3445783133  0.0000000000  0.1338703185  1.1511734724  0.0563254356  0             0.4593358040 
0.3700000000  0.3730158730  0.4160000000  0.3333333333  0.3780120482  0.3795180723  0.5375000000  0.4166666667  0.2843373494  6.6666666667  0.0548067217  1.1096583843  0.0606265068  50            0.1773186207 
0.4980000000  0.5555555556  0.5640000000  0.5317460317  0.4909638554  0.5180722892  0.6000000000  0.5833333333  0.3493975904  13.333333333  0.0495111938  1.0742967343  0.0620565414  100           0.1702319193 
0.5700000000  0.5714285714  0.6280000000  0.6031746032  0.6024096386  0.6144578313  0.8500000000  0.8500000000  0.3108433735  20.000000000  0.0513294953  1.0445183134  0.0620565414  150           0.1701689005 
0.6040000000  0.5873015873  0.6620000000  0.6111111111  0.7108433735  0.7469879518  0.9291666667  0.9500000000  0.3879518072  26.666666666  0.0518343828  1.0116160214  0.0620565414  200           0.1756187487 
0.6140000000  0.5714285714  0.6620000000  0.6111111111  0.7575301205  0.7530120482  0.9375000000  0.9500000000  0.4602409639  33.333333333  0.0524557858  0.9755749500  0.0620565414  250           0.1708178425 
0.6560000000  0.6111111111  0.7400000000  0.6031746032  0.7635542169  0.7289156627  0.9583333333  0.9666666667  0.5156626506  40.000000000  0.0589948617  0.9334275496  0.0620565414  300           0.1818293571 
0.6260000000  0.6031746032  0.7120000000  0.6111111111  0.8253012048  0.7951807229  0.9833333333  0.9666666667  0.5614457831  46.666666666  0.0646337807  0.8786513758  0.0620565414  350           0.1717285681 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 299, in <module>
    for x, y in next(train_minibatches_iterator)]
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/fast_data_loader.py", line 46, in __iter__
    yield next(self._infinite_iterator)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/reduction.py", line 182, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/reduction.py", line 153, in recvfds
    msg, ancdata, flags, addr = sock.recvmsg(1, socket.CMSG_SPACE(bytes_size))
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4957375526 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604391098  50            0.1729667568 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0604391098  100           0.1756910086 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0604529381  150           0.1742176104 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0604529381  200           0.1750558281 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0604529381  250           0.1688572836 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0604529381  300           0.1690734911 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0604529381  350           0.1715261507 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0604529381  400           0.1729524565 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0605115891  450           0.1745876312 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0605115891  500           0.1699744797 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0605115891  550           0.1758301115 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0605115891  600           0.1747830153 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0605115891  650           0.1721547651 
0.7620000000  0.6904761905  0.7420000000  0.5952380952  0.8704819277  0.8192771084  0.8825301205  0.8433734940  0.8466666667  44.800000000  0.0948590854  0.5989579999  0.0605115891  700           0.1790128946 
0.7420000000  0.6666666667  0.7440000000  0.6031746032  0.8674698795  0.7951807229  0.8810240964  0.8373493976  0.8866666667  48.000000000  0.0873626529  0.5903342068  0.0605115891  750           0.1693417645 
0.7000000000  0.6587301587  0.7200000000  0.5873015873  0.8810240964  0.8132530120  0.8765060241  0.8433734940  0.8866666667  51.200000000  0.0964536997  0.5875166976  0.0605115891  800           0.1663946629 
0.7120000000  0.6666666667  0.7420000000  0.5873015873  0.8765060241  0.8192771084  0.8734939759  0.8554216867  0.9166666667  54.400000000  0.0786854373  0.5873849201  0.0605115891  850           0.1683769655 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 357, in <module>
    with open(os.path.join(args.output_dir, 'done'), 'w') as f:
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 675
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 0.8
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3233333333  0.0000000000  0.1153592095  1.1524477005  0.0539793968  0             0.4729552269 
0.4260000000  0.4206349206  0.3680000000  0.3333333333  0.5888554217  0.5843373494  0.4427710843  0.4698795181  0.3333333333  3.2000000000  0.0551645175  1.0905285311  0.0604724884  50            0.1724451685 
0.4240000000  0.4285714286  0.3900000000  0.3571428571  0.5692771084  0.5180722892  0.5542168675  0.5301204819  0.3333333333  6.4000000000  0.0501998803  1.0537479258  0.0625157356  100           0.1735579300 
0.5320000000  0.4603174603  0.4680000000  0.4365079365  0.6641566265  0.6325301205  0.6219879518  0.5722891566  0.3433333333  9.6000000000  0.0542389170  1.0215329599  0.0625157356  150           0.1722917032 
0.5260000000  0.4682539683  0.4600000000  0.4206349206  0.6897590361  0.6506024096  0.5783132530  0.5662650602  0.3366666667  12.800000000  0.0527770853  0.9922067916  0.0625157356  200           0.1716124058 
0.5780000000  0.5317460317  0.6120000000  0.5396825397  0.7454819277  0.6686746988  0.8343373494  0.7951807229  0.4033333333  16.000000000  0.0612762495  0.9525618899  0.0625157356  250           0.1717157412 
0.5940000000  0.5317460317  0.6120000000  0.5555555556  0.7756024096  0.7168674699  0.8584337349  0.8072289157  0.4000000000  19.200000000  0.0664075876  0.9070874238  0.0625157356  300           0.1715441561 
0.6660000000  0.5952380952  0.6620000000  0.5714285714  0.7650602410  0.7590361446  0.8629518072  0.8253012048  0.5466666667  22.400000000  0.0694702320  0.8546362436  0.0625157356  350           0.1694937181 
0.6400000000  0.5555555556  0.6360000000  0.5476190476  0.8012048193  0.7349397590  0.8644578313  0.8313253012  0.4233333333  25.600000000  0.0718728535  0.8117775357  0.0625157356  400           0.1720334768 
0.6560000000  0.5873015873  0.6740000000  0.5952380952  0.8328313253  0.7650602410  0.8569277108  0.8132530120  0.6633333333  28.800000000  0.0868337996  0.7586268890  0.0625157356  450           0.1715214443 
0.6680000000  0.5873015873  0.6860000000  0.5952380952  0.8403614458  0.7710843373  0.8614457831  0.8192771084  0.7600000000  32.000000000  0.0802829899  0.7229212809  0.0625157356  500           0.1689419985 
0.6640000000  0.6269841270  0.6760000000  0.5793650794  0.8524096386  0.7831325301  0.8719879518  0.8373493976  0.6966666667  35.200000000  0.0729571413  0.6814961445  0.0625157356  550           0.1695517302 
0.7580000000  0.6984126984  0.7460000000  0.6111111111  0.8403614458  0.8313253012  0.8554216867  0.8433734940  0.8233333333  38.400000000  0.0857536697  0.6457765770  0.0625157356  600           0.1765485382 
0.7200000000  0.6587301587  0.7180000000  0.5793650794  0.8509036145  0.7891566265  0.8870481928  0.8493975904  0.9233333333  41.600000000  0.0791626287  0.6181048000  0.0625157356  650           0.1719964933 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 357, in <module>
    with open(os.path.join(args.output_dir, 'done'), 'w') as f:
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 0.0001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1483, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1948, in update
    if self.update_count == self.hparams['lr_iter']:
KeyError: 'lr_iter'
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 0.0001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3300000000  0.3333333333  0.3358433735  0.3313253012  0.4427710843  0.4457831325  0.3444444444  0.0000000000  0.3645455837  1.1524477005  0.0539793968  0             0.4800069332 
0.4040000000  0.3730158730  0.3720000000  0.3492063492  0.4804216867  0.4879518072  0.3734939759  0.3373493976  0.4238095238  3.2000000000  0.1772725463  1.1033680630  0.0604581833  50            0.1758490467 
0.4320000000  0.4047619048  0.4100000000  0.3650793651  0.4427710843  0.4337349398  0.3900602410  0.3433734940  0.4206349206  6.4000000000  0.1304577231  1.0841080713  0.0621070862  100           0.1678208590 
0.4400000000  0.4206349206  0.4620000000  0.4126984127  0.4563253012  0.4277108434  0.4186746988  0.3975903614  0.4507936508  9.6000000000  0.1407905489  1.0746172523  0.0621070862  150           0.1700340462 
0.4880000000  0.4523809524  0.4860000000  0.4365079365  0.5150602410  0.5301204819  0.3960843373  0.3674698795  0.4523809524  12.800000000  0.1265559703  1.0719041204  0.0621070862  200           0.1696376801 
0.4840000000  0.4444444444  0.4480000000  0.3888888889  0.5572289157  0.5662650602  0.4307228916  0.4216867470  0.4571428571  16.000000000  0.1207760394  1.0675013399  0.0621070862  250           0.1692400932 
0.5120000000  0.5158730159  0.5040000000  0.4206349206  0.6204819277  0.5903614458  0.5542168675  0.5060240964  0.4841269841  19.200000000  0.1272573054  1.0592082524  0.0621070862  300           0.1681482506 
0.5000000000  0.4920634921  0.4640000000  0.3968253968  0.5753012048  0.5783132530  0.5105421687  0.5000000000  0.4777777778  22.400000000  0.1165877104  1.0529104376  0.0631141663  350           0.1685716867 
0.4800000000  0.4523809524  0.4320000000  0.3650793651  0.5271084337  0.5542168675  0.4713855422  0.4518072289  0.4634920635  25.600000000  0.1185866594  1.0500988293  0.0631141663  400           0.1707474327 
0.5100000000  0.4920634921  0.4480000000  0.3650793651  0.5286144578  0.5240963855  0.4548192771  0.4216867470  0.4571428571  28.800000000  0.1212382197  1.0405656123  0.0631141663  450           0.1718748331 
0.5500000000  0.5158730159  0.5120000000  0.4126984127  0.6114457831  0.6144578313  0.6114457831  0.6144578313  0.5079365079  32.000000000  0.1116123408  1.0420798230  0.0636305809  500           0.1715052128 
0.5780000000  0.5476190476  0.5140000000  0.4047619048  0.5557228916  0.5843373494  0.6852409639  0.6325301205  0.5365079365  35.200000000  0.0964395463  1.0382253671  0.0636305809  550           0.1799438763 
0.5960000000  0.5317460317  0.5800000000  0.5238095238  0.6701807229  0.7048192771  0.7003012048  0.7048192771  0.5126984127  38.400000000  0.0977869481  1.0296067739  0.0636305809  600           0.1703337288 
0.6420000000  0.5634920635  0.5800000000  0.4682539683  0.6626506024  0.6987951807  0.6987951807  0.6987951807  0.5619047619  41.600000000  0.1002508342  1.0272022057  0.0636305809  650           0.1696608829 
0.6300000000  0.5793650794  0.5940000000  0.5000000000  0.7259036145  0.7469879518  0.7560240964  0.7228915663  0.5857142857  44.800000000  0.0994685173  1.0250438499  0.0636305809  700           0.1820913839 
0.5640000000  0.5158730159  0.5640000000  0.5238095238  0.7575301205  0.7409638554  0.7319277108  0.7349397590  0.5285714286  48.000000000  0.1070968807  1.0183532834  0.0636305809  750           0.1719291496 
0.5640000000  0.5158730159  0.5800000000  0.5158730159  0.7725903614  0.8012048193  0.7846385542  0.7650602410  0.5412698413  51.200000000  0.1047965288  1.0114959550  0.0636305809  800           0.1739820576 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 0.0001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3740000000  0.3650793651  0.3480000000  0.3412698413  0.6746987952  0.6506024096  0.5436746988  0.5240963855  0.3968253968  0.0000000000  0.4677224159  1.1524477005  0.0539793968  0             0.4819576740 
0.5600000000  0.5158730159  0.4760000000  0.4603174603  0.8057228916  0.7771084337  0.7680722892  0.7228915663  0.4968253968  3.2000000000  0.1724725336  1.0238350058  0.0604619980  50            0.1692136621 
0.5700000000  0.5793650794  0.6460000000  0.5476190476  0.7198795181  0.6987951807  0.8855421687  0.8554216867  0.6285714286  6.4000000000  0.2133689201  0.7992190742  0.0605201721  100           0.1728954887 
0.7360000000  0.6825396825  0.6840000000  0.5714285714  0.8072289157  0.7469879518  0.8584337349  0.8313253012  0.7936507937  9.6000000000  0.2937957740  0.6140127623  0.0605340004  150           0.1672303295 
0.7700000000  0.7857142857  0.6920000000  0.5396825397  0.9216867470  0.8915662651  0.8237951807  0.8012048193  0.7523809524  12.800000000  0.2993899462  0.5418152189  0.0605649948  200           0.1730755234 
0.7440000000  0.7063492063  0.7520000000  0.6269841270  0.8765060241  0.8915662651  0.8704819277  0.8313253012  0.5841269841  16.000000000  0.2975358251  0.4993305999  0.0605649948  250           0.1652656698 
0.8280000000  0.8492063492  0.7360000000  0.6746031746  0.8945783133  0.8674698795  0.7966867470  0.8012048193  0.8063492063  19.200000000  0.2305131897  0.4693784475  0.0634727478  300           0.1697721529 
0.7800000000  0.8015873016  0.8300000000  0.7380952381  0.6867469880  0.6626506024  0.7816265060  0.7771084337  0.6888888889  22.400000000  0.2278430471  0.4321727586  0.0634727478  350           0.1687175322 
0.8560000000  0.8730158730  0.8700000000  0.7222222222  0.9367469880  0.9036144578  0.8057228916  0.8373493976  0.7984126984  25.600000000  0.2315711018  0.4154955357  0.0634727478  400           0.1700402784 
0.8060000000  0.7380952381  0.8540000000  0.7460317460  0.8855421687  0.8915662651  0.9593373494  0.9457831325  0.7063492063  28.800000000  0.2738550451  0.3907812816  0.0634727478  450           0.1649496317 
0.8300000000  0.8412698413  0.8340000000  0.7380952381  0.9548192771  0.9518072289  0.8780120482  0.9096385542  0.8698412698  32.000000000  0.2264085618  0.3474361616  0.0634727478  500           0.1791144991 
0.8840000000  0.8968253968  0.8900000000  0.7936507937  0.8885542169  0.8554216867  0.8403614458  0.8554216867  0.7507936508  35.200000000  0.2419313052  0.3252618343  0.0634727478  550           0.1771834755 
0.9100000000  0.9365079365  0.8640000000  0.7936507937  0.8750000000  0.8614457831  0.9713855422  0.9578313253  0.4380952381  38.400000000  0.2657356302  0.2643318608  0.0634727478  600           0.1709328651 
0.9660000000  0.9365079365  0.9920000000  0.9047619048  0.8885542169  0.9036144578  1.0000000000  1.0000000000  0.4761904762  41.600000000  0.2468533722  0.2249038902  0.0634727478  650           0.1710577679 
0.9660000000  0.9841269841  0.9880000000  0.9126984127  0.9021084337  0.9216867470  1.0000000000  1.0000000000  0.7047619048  44.800000000  0.2122929779  0.1698070164  0.0634727478  700           0.1720533323 
0.9940000000  0.9761904762  0.9720000000  0.9047619048  0.9774096386  0.9578313253  0.9984939759  0.9939759036  0.6349206349  48.000000000  0.2187857401  0.1379998183  0.0634727478  750           0.1689365292 
0.9820000000  0.9285714286  0.9680000000  0.8968253968  0.9713855422  0.9578313253  1.0000000000  1.0000000000  0.7222222222  51.200000000  0.1668119029  0.0998963351  0.0634727478  800           0.1703975153 
0.9920000000  0.9603174603  0.9960000000  0.9523809524  1.0000000000  1.0000000000  0.9819277108  0.9879518072  0.5555555556  54.400000000  0.2008272351  0.1009549861  0.0634727478  850           0.1725297642 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 0.0001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3196803197  0.3227091633  0.3216783217  0.3067729084  0.3313253012  0.3132530120  0.4472891566  0.4518072289  0.3133333333  0.0000000000  0.1675339937  1.1414088011  0.0563254356  0             0.4852242470 
0.4975024975  0.4900398406  0.4475524476  0.4023904382  0.6054216867  0.6024096386  0.5000000000  0.4337349398  0.3600000000  2.4096385542  0.0620769286  1.0939854240  0.0604677200  50            0.1710882473 
0.5034965035  0.4701195219  0.4545454545  0.4342629482  0.6551204819  0.6325301205  0.6370481928  0.5963855422  0.3300000000  4.8192771084  0.0542645812  1.0619654870  0.0604677200  100           0.1693056679 
0.6143856144  0.6175298805  0.5394605395  0.5219123506  0.6460843373  0.6686746988  0.5768072289  0.5361445783  0.3566666667  7.2289156627  0.0491653025  1.0423572040  0.0604677200  150           0.1680047417 
0.6183816184  0.6175298805  0.5584415584  0.5498007968  0.7213855422  0.7289156627  0.6506024096  0.6385542169  0.3433333333  9.6385542169  0.0565540588  1.0156699026  0.0604677200  200           0.1669559765 
0.6223776224  0.6055776892  0.5874125874  0.5856573705  0.7771084337  0.7590361446  0.7439759036  0.7228915663  0.3533333333  12.048192771  0.0616402423  0.9816597128  0.0604677200  250           0.1692041731 
0.6013986014  0.6015936255  0.6063936064  0.5936254980  0.7891566265  0.7590361446  0.8027108434  0.7530120482  0.4300000000  14.457831325  0.0593532407  0.9487410975  0.0604677200  300           0.1670482635 
0.6133866134  0.6135458167  0.6183816184  0.5816733068  0.7951807229  0.7590361446  0.8027108434  0.7650602410  0.5166666667  16.867469879  0.0648273718  0.9118193233  0.0604677200  350           0.1678779888 
0.6183816184  0.6015936255  0.6263736264  0.5856573705  0.8403614458  0.8192771084  0.7966867470  0.7650602410  0.5533333333  19.277108433  0.0830983710  0.8630394840  0.0604677200  400           0.1687502003 
0.6363636364  0.6055776892  0.6213786214  0.6215139442  0.8418674699  0.8253012048  0.8328313253  0.8132530120  0.5200000000  21.686746988  0.0832394040  0.8186666238  0.0604677200  450           0.1674095821 
0.6613386613  0.6494023904  0.6333666334  0.6215139442  0.8388554217  0.8132530120  0.8162650602  0.7831325301  0.6666666667  24.096385542  0.0938627267  0.7819272685  0.0604677200  500           0.1707144451 
0.6693306693  0.6454183267  0.6513486513  0.6215139442  0.8207831325  0.7891566265  0.8192771084  0.8072289157  0.7300000000  26.506024096  0.0978231990  0.7543165946  0.0604677200  550           0.1663511515 
0.7052947053  0.6772908367  0.6783216783  0.6533864542  0.8750000000  0.8855421687  0.8253012048  0.7951807229  0.7500000000  28.915662650  0.0969898844  0.7135290325  0.0616831779  600           0.1723279428 
0.7402597403  0.6892430279  0.6823176823  0.6494023904  0.8659638554  0.8493975904  0.7981927711  0.7710843373  0.7300000000  31.325301204  0.1012286603  0.6862568128  0.0616831779  650           0.1690439844 
0.7042957043  0.6613545817  0.6833166833  0.6294820717  0.8945783133  0.8674698795  0.8614457831  0.8433734940  0.7766666667  33.734939759  0.1166398549  0.6607170272  0.0616831779  700           0.1690295410 
0.6843156843  0.6533864542  0.6643356643  0.6095617530  0.8750000000  0.8614457831  0.8659638554  0.8373493976  0.7300000000  36.144578313  0.0968558753  0.6444861782  0.0616831779  750           0.1680777931 
0.7792207792  0.7529880478  0.7282717283  0.6972111554  0.8825301205  0.8554216867  0.8629518072  0.8614457831  0.6866666667  38.554216867  0.1039576280  0.6209038031  0.0616831779  800           0.1735079956 
0.8111888112  0.7649402390  0.7482517483  0.7211155378  0.8780120482  0.8493975904  0.8403614458  0.8554216867  0.6433333333  40.963855421  0.1074834943  0.5970651329  0.0616831779  850           0.1706045389 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3196803197  0.3227091633  0.3216783217  0.3067729084  0.3313253012  0.3132530120  0.4472891566  0.4518072289  0.3133333333  0.0000000000  0.1673783064  1.1414088011  0.0563254356  0             0.4744570255 
0.4905094905  0.4741035857  0.4475524476  0.3984063745  0.6189759036  0.6445783133  0.4984939759  0.4518072289  0.3600000000  2.4096385542  0.0622799337  1.0936319304  0.0604391098  50            0.1699674416 
0.5384615385  0.5179282869  0.4705294705  0.4621513944  0.6566265060  0.6506024096  0.5978915663  0.5843373494  0.3300000000  4.8192771084  0.0544016540  1.0612244225  0.0624542236  100           0.1675826740 
0.6203796204  0.6175298805  0.5514485514  0.5179282869  0.6551204819  0.6686746988  0.5707831325  0.5481927711  0.3533333333  7.2289156627  0.0500579083  1.0411592174  0.0624542236  150           0.1669967937 
0.6183816184  0.6215139442  0.5564435564  0.5657370518  0.7289156627  0.7349397590  0.6566265060  0.6626506024  0.3400000000  9.6385542169  0.0574160469  1.0141906130  0.0624542236  200           0.1691241169 
0.6263736264  0.6015936255  0.6023976024  0.6215139442  0.7801204819  0.7710843373  0.7500000000  0.7108433735  0.3500000000  12.048192771  0.0628925681  0.9788167906  0.0624542236  250           0.1715812588 
0.5954045954  0.5896414343  0.5944055944  0.5816733068  0.7936746988  0.7891566265  0.8012048193  0.7469879518  0.4100000000  14.457831325  0.0591640544  0.9455639553  0.0624542236  300           0.1692959070 
0.6043956044  0.5896414343  0.6243756244  0.5856573705  0.7951807229  0.7710843373  0.8072289157  0.7710843373  0.4800000000  16.867469879  0.0653958964  0.9074121332  0.0624542236  350           0.1686121321 
0.6103896104  0.5976095618  0.6313686314  0.5976095618  0.8207831325  0.7891566265  0.7906626506  0.7650602410  0.5366666667  19.277108433  0.0843550587  0.8598374951  0.0624542236  400           0.1700988626 
0.6163836164  0.6135458167  0.6193806194  0.6175298805  0.8117469880  0.7650602410  0.8283132530  0.8072289157  0.5133333333  21.686746988  0.0823076546  0.8167867887  0.0624542236  450           0.1694515753 
0.6623376623  0.6533864542  0.6523476523  0.6294820717  0.8222891566  0.7831325301  0.8042168675  0.7710843373  0.6700000000  24.096385542  0.0941854417  0.7813036084  0.0624542236  500           0.1718285894 
0.6593406593  0.6494023904  0.6453546454  0.6175298805  0.7996987952  0.7650602410  0.8087349398  0.7771084337  0.7233333333  26.506024096  0.0954940426  0.7565467727  0.0624542236  550           0.1699286652 
0.7042957043  0.6613545817  0.6733266733  0.6613545817  0.8734939759  0.8795180723  0.8207831325  0.8012048193  0.7533333333  28.915662650  0.0983538222  0.7154179013  0.0624542236  600           0.1672762442 
0.7362637363  0.6972111554  0.6833166833  0.6693227092  0.8644578313  0.8433734940  0.7876506024  0.7530120482  0.7333333333  31.325301204  0.0995683408  0.6885707271  0.0624542236  650           0.1714515066 
0.6713286713  0.6494023904  0.6603396603  0.6254980080  0.8885542169  0.8433734940  0.8674698795  0.8433734940  0.7266666667  33.734939759  0.1166061157  0.6636526549  0.0624542236  700           0.1692717600 
0.6943056943  0.6533864542  0.6703296703  0.6254980080  0.8825301205  0.8674698795  0.8674698795  0.8313253012  0.7566666667  36.144578313  0.0971807921  0.6449788845  0.0625214577  750           0.1697677279 
0.7772227772  0.7569721116  0.7252747253  0.6972111554  0.8900602410  0.8734939759  0.8659638554  0.8734939759  0.7033333333  38.554216867  0.1041373557  0.6212679303  0.0625214577  800           0.1706448221 
0.7992007992  0.7808764940  0.7412587413  0.7131474104  0.8734939759  0.8554216867  0.8313253012  0.8433734940  0.7033333333  40.963855421  0.1054217863  0.5991172934  0.0625214577  850           0.1805838490 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta1: 0.5
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3260000000  0.3333333333  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3200000000  0.0000000000  0.1715644598  1.1550736427  0.0563254356  0             0.4940085411 
0.4260000000  0.4126984127  0.3900000000  0.3730158730  0.5261044177  0.4979919679  0.5030120482  0.5301204819  0.3533333333  3.2000000000  0.0769456959  1.0858169794  0.0604238510  50            0.1673324060 
0.4800000000  0.4682539683  0.3980000000  0.3968253968  0.6606425703  0.6706827309  0.6425702811  0.7068273092  0.3600000000  6.4000000000  0.0599788952  1.0565502930  0.0605592728  100           0.1769099712 
0.5520000000  0.5793650794  0.4840000000  0.4761904762  0.6516064257  0.6586345382  0.5491967871  0.5983935743  0.3966666667  9.6000000000  0.0697413278  1.0255072773  0.0605592728  150           0.1683305311 
0.5840000000  0.5238095238  0.5020000000  0.4920634921  0.7560240964  0.7590361446  0.7429718876  0.7510040161  0.3966666667  12.800000000  0.0689855671  1.0013243806  0.0605664253  200           0.1705332136 
0.5980000000  0.5476190476  0.5740000000  0.5555555556  0.8544176707  0.8594377510  0.7991967871  0.8273092369  0.4100000000  16.000000000  0.0688970530  0.9639494812  0.0617918968  250           0.1670552015 
0.6200000000  0.5396825397  0.5640000000  0.5555555556  0.8042168675  0.7951807229  0.8544176707  0.8473895582  0.4066666667  19.200000000  0.0750255489  0.9302761698  0.0617918968  300           0.1683008146 
0.6440000000  0.5793650794  0.6080000000  0.5952380952  0.8242971888  0.8353413655  0.8815261044  0.8955823293  0.4566666667  22.400000000  0.0765758121  0.8833554947  0.0617918968  350           0.1709631491 
0.6720000000  0.6111111111  0.6720000000  0.6349206349  0.8674698795  0.8554216867  0.8604417671  0.8955823293  0.5300000000  25.600000000  0.0744796729  0.8449894714  0.0617918968  400           0.1684330797 
0.6760000000  0.6349206349  0.6740000000  0.6269841270  0.8614457831  0.8433734940  0.8825301205  0.9156626506  0.5100000000  28.800000000  0.0936236107  0.8096906567  0.0617918968  450           0.1712781382 
0.7240000000  0.6349206349  0.6860000000  0.6349206349  0.8815261044  0.8594377510  0.8674698795  0.9036144578  0.6033333333  32.000000000  0.0821275806  0.7677347231  0.0617918968  500           0.1728518820 
0.7280000000  0.6269841270  0.7280000000  0.6666666667  0.8975903614  0.8674698795  0.8604417671  0.9076305221  0.6366666667  35.200000000  0.0878834438  0.7300632954  0.0617918968  550           0.1747468281 
0.6860000000  0.6428571429  0.7080000000  0.6349206349  0.8935742972  0.8835341365  0.9387550201  0.9558232932  0.6300000000  38.400000000  0.1046813011  0.6877776670  0.0617918968  600           0.1693377542 
0.7420000000  0.6904761905  0.7260000000  0.6904761905  0.9086345382  0.8835341365  0.9066265060  0.9518072289  0.5900000000  41.600000000  0.0987493348  0.6564924002  0.0617918968  650           0.1671805668 
0.7800000000  0.7142857143  0.7660000000  0.6746031746  0.8995983936  0.8594377510  0.9026104418  0.9437751004  0.5200000000  44.800000000  0.1097981369  0.6372250283  0.0617918968  700           0.1689657593 
0.8080000000  0.7301587302  0.7820000000  0.6825396825  0.9347389558  0.8995983936  0.9006024096  0.9397590361  0.4733333333  48.000000000  0.0928329772  0.6174942398  0.0617918968  750           0.1685697842 
0.8580000000  0.7539682540  0.8020000000  0.7222222222  0.9447791165  0.9076305221  0.8584337349  0.8915662651  0.4133333333  51.200000000  0.1078399146  0.5829264367  0.0617918968  800           0.1685946560 
0.7840000000  0.6984126984  0.7100000000  0.6825396825  0.9016064257  0.8875502008  0.9658634538  0.9799196787  0.6366666667  54.400000000  0.1037736452  0.5593924487  0.0617918968  850           0.1791828299 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3809523810  0.3300000000  0.3809523810  0.3624497992  0.3453815261  0.4929718876  0.4618473896  0.2233333333  0.0000000000  0.1364098787  1.1550736427  0.0563254356  0             0.4647393227 
0.6560000000  0.6111111111  0.6260000000  0.5952380952  0.6606425703  0.6465863454  0.6435742972  0.6787148594  0.5233333333  3.2000000000  0.0746688342  1.0312928283  0.0604138374  50            0.1653036928 
0.7220000000  0.6428571429  0.6480000000  0.6190476190  0.8714859438  0.8514056225  0.8744979920  0.8875502008  0.5433333333  6.4000000000  0.0845994246  0.8745613754  0.0604977608  100           0.1716713142 
0.8100000000  0.7539682540  0.7320000000  0.6746031746  0.9317269076  0.9236947791  0.7198795181  0.7349397590  0.3600000000  9.6000000000  0.1096951729  0.6726492631  0.0604977608  150           0.1685678101 
0.8440000000  0.7142857143  0.7760000000  0.7222222222  0.9437751004  0.9116465863  0.8614457831  0.8915662651  0.5133333333  12.800000000  0.1132939178  0.5649059969  0.0605330467  200           0.1690565872 
0.8320000000  0.7301587302  0.7660000000  0.6904761905  0.9628514056  0.9437751004  0.9769076305  0.9959839357  0.6900000000  16.000000000  0.1369276470  0.4966310960  0.0605731010  250           0.1663739157 
0.9440000000  0.8650793651  0.8660000000  0.7777777778  0.9467871486  0.9236947791  0.8895582329  0.8875502008  0.4166666667  19.200000000  0.1252767766  0.4335823512  0.0605731010  300           0.1689832115 
0.9500000000  0.8412698413  0.9100000000  0.8095238095  0.9819277108  0.9518072289  0.9698795181  0.9879518072  0.4466666667  22.400000000  0.1219657737  0.3761431199  0.0605731010  350           0.1698472548 
0.9760000000  0.9206349206  0.9320000000  0.8333333333  0.9909638554  0.9759036145  0.9698795181  0.9879518072  0.3600000000  25.600000000  0.0996123055  0.3235502708  0.0605731010  400           0.1701390505 
0.9740000000  0.9444444444  0.9280000000  0.8333333333  0.9969879518  0.9879518072  0.9728915663  0.9879518072  0.3800000000  28.800000000  0.1161768970  0.2764071476  0.0605731010  450           0.1801145697 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-06
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3280000000  0.3333333333  0.3260000000  0.3333333333  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3266666667  0.0000000000  0.1816500425  1.1550736427  0.0563254356  0             0.4902822971 
0.3860000000  0.3809523810  0.3640000000  0.3888888889  0.4518072289  0.4457831325  0.4317269076  0.4538152610  0.3600000000  3.2000000000  0.0884978342  1.1014169741  0.0604138374  50            0.1690801096 
0.4320000000  0.4444444444  0.3860000000  0.3968253968  0.5612449799  0.5622489960  0.4879518072  0.5421686747  0.3633333333  6.4000000000  0.0623199463  1.0755548096  0.0604391098  100           0.1700736141 
0.4660000000  0.4682539683  0.4060000000  0.4047619048  0.5933734940  0.6024096386  0.4849397590  0.5060240964  0.3766666667  9.6000000000  0.0691905403  1.0593588781  0.0604891777  150           0.1671946669 
0.4720000000  0.4603174603  0.4120000000  0.4047619048  0.6415662651  0.6024096386  0.5522088353  0.5863453815  0.3866666667  12.800000000  0.0677050698  1.0507334924  0.0604891777  200           0.1713902187 
0.5260000000  0.5079365079  0.4760000000  0.4523809524  0.7379518072  0.7469879518  0.6154618474  0.6465863454  0.3866666667  16.000000000  0.0628118980  1.0309126353  0.0604891777  250           0.1658980083 
0.5180000000  0.5000000000  0.4480000000  0.4206349206  0.6807228916  0.6867469880  0.6716867470  0.6746987952  0.3866666667  19.200000000  0.0659033096  1.0228429413  0.0604891777  300           0.1820999336 
0.5580000000  0.5238095238  0.4820000000  0.4603174603  0.7359437751  0.7670682731  0.7078313253  0.6987951807  0.3900000000  22.400000000  0.0683336902  1.0002004802  0.0604891777  350           0.1828975821 
0.6000000000  0.5238095238  0.5500000000  0.5476190476  0.8102409639  0.8313253012  0.7419678715  0.7550200803  0.4033333333  25.600000000  0.0621966970  0.9911912882  0.0604891777  400           0.1790447855 
0.6180000000  0.5476190476  0.5500000000  0.5396825397  0.7991967871  0.8032128514  0.7630522088  0.7670682731  0.4266666667  28.800000000  0.0714296329  0.9767364132  0.0617823601  450           0.1708343840 
0.6500000000  0.5634920635  0.5900000000  0.5634920635  0.8172690763  0.8152610442  0.7771084337  0.7951807229  0.4733333333  32.000000000  0.0682840109  0.9591014361  0.0617823601  500           0.1746704483 
0.6420000000  0.5634920635  0.5760000000  0.5476190476  0.8082329317  0.7911646586  0.8062248996  0.8112449799  0.4466666667  35.200000000  0.0655348754  0.9435653436  0.0617823601  550           0.1784346485 
0.6400000000  0.5396825397  0.5980000000  0.5714285714  0.8202811245  0.8152610442  0.8714859438  0.8634538153  0.4766666667  38.400000000  0.0795434463  0.9223329961  0.0617823601  600           0.1847458935 
0.6580000000  0.5396825397  0.5900000000  0.5714285714  0.8202811245  0.8152610442  0.8704819277  0.8795180723  0.4466666667  41.600000000  0.0753280830  0.8986552620  0.0617823601  650           0.1770011854 
0.6380000000  0.5555555556  0.5940000000  0.5873015873  0.8263052209  0.8393574297  0.9036144578  0.8915662651  0.4866666667  44.800000000  0.0796276820  0.8863340616  0.0617823601  700           0.1764912701 
0.6740000000  0.6190476190  0.6460000000  0.6190476190  0.8232931727  0.8152610442  0.8825301205  0.8915662651  0.5300000000  48.000000000  0.0729318905  0.8652763724  0.0617823601  750           0.1710009670 
0.6680000000  0.6269841270  0.6720000000  0.6428571429  0.8835341365  0.8634538153  0.8564257028  0.8755020080  0.5700000000  51.200000000  0.0804598105  0.8403411925  0.0617823601  800           0.1763429928 
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
KeyboardInterrupt
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3260000000  0.3333333333  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3200000000  0.0000000000  0.3444969654  1.1550736427  0.0563254356  0             0.4864802361 
0.4040000000  0.3650793651  0.3760000000  0.4047619048  0.4487951807  0.4457831325  0.4688755020  0.4859437751  0.3566666667  3.2000000000  0.1527852774  1.0940928626  0.0605478287  50            0.1682171535 
0.4600000000  0.4365079365  0.3980000000  0.4047619048  0.5632530120  0.5662650602  0.4809236948  0.5220883534  0.3566666667  6.4000000000  0.1130266094  1.0769051743  0.0605478287  100           0.1712866402 
0.4980000000  0.4920634921  0.4280000000  0.4841269841  0.5983935743  0.5702811245  0.4658634538  0.4497991968  0.3733333333  9.6000000000  0.1247446012  1.0632141185  0.0605478287  150           0.1678060198 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    Traceback (most recent call last):
p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 63, in handler
    def handler(signum, frame):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1083571) is killed by signal: Terminated. 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3260000000  0.3333333333  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3200000000  0.0000000000  0.3444969654  1.1550736427  0.0563254356  0             0.4937045574 
0.4040000000  0.3650793651  0.3760000000  0.4047619048  0.4487951807  0.4457831325  0.4688755020  0.4859437751  0.3566666667  3.2000000000  0.1527852774  1.0940928626  0.0604391098  50            0.1655555487 
0.4600000000  0.4365079365  0.3980000000  0.4047619048  0.5632530120  0.5662650602  0.4809236948  0.5220883534  0.3566666667  6.4000000000  0.1130266094  1.0769051743  0.0634641647  100           0.1679472828 
0.4980000000  0.4920634921  0.4280000000  0.4841269841  0.5983935743  0.5702811245  0.4658634538  0.4497991968  0.3733333333  9.6000000000  0.1247446012  1.0632141185  0.0634641647  150           0.1672233486 
0.5300000000  0.4920634921  0.4380000000  0.4126984127  0.6445783133  0.6385542169  0.5100401606  0.5140562249  0.3900000000  12.800000000  0.1180599499  1.0540717149  0.0634641647  200           0.1700997686 
0.5760000000  0.5238095238  0.5040000000  0.4920634921  0.7279116466  0.6907630522  0.6295180723  0.6385542169  0.3866666667  16.000000000  0.1132598805  1.0370143151  0.0634641647  250           0.1780515385 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3260000000  0.3333333333  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3200000000  0.0000000000  0.3444969654  1.1550736427  0.0563254356  0             0.4747941494 
0.4040000000  0.3650793651  0.3760000000  0.4047619048  0.4487951807  0.4457831325  0.4688755020  0.4859437751  0.3566666667  3.2000000000  0.1527852774  1.0940928626  0.0604391098  50            0.1652697277 
0.4600000000  0.4365079365  0.3980000000  0.4047619048  0.5632530120  0.5662650602  0.4809236948  0.5220883534  0.3566666667  6.4000000000  0.1130266094  1.0769051743  0.0604391098  100           0.1692002296 
0.4980000000  0.4920634921  0.4280000000  0.4841269841  0.5983935743  0.5702811245  0.4658634538  0.4497991968  0.3733333333  9.6000000000  0.1247446012  1.0632141185  0.0606102943  150           0.1766087770 
0.5300000000  0.4920634921  0.4380000000  0.4126984127  0.6445783133  0.6385542169  0.5100401606  0.5140562249  0.3900000000  12.800000000  0.1180599499  1.0540717149  0.0606102943  200           0.1708467340 
0.5760000000  0.5238095238  0.5040000000  0.4920634921  0.7279116466  0.6907630522  0.6295180723  0.6385542169  0.3866666667  16.000000000  0.1132598805  1.0370143151  0.0606102943  250           0.1780093145 
0.5720000000  0.5317460317  0.4860000000  0.4523809524  0.7349397590  0.7590361446  0.6907630522  0.7188755020  0.3866666667  19.200000000  0.1156532502  1.0281369960  0.0606102943  300           0.1705729103 
0.6100000000  0.5317460317  0.5460000000  0.5238095238  0.7811244980  0.8032128514  0.7128514056  0.7510040161  0.3800000000  22.400000000  0.1124027491  1.0112325799  0.0606102943  350           0.1707822561 
0.6220000000  0.5238095238  0.5840000000  0.5714285714  0.7941767068  0.7871485944  0.7359437751  0.7429718876  0.4200000000  25.600000000  0.1050440454  1.0037719214  0.0606102943  400           0.1773015547 
0.6120000000  0.5238095238  0.5500000000  0.5317460317  0.7650602410  0.7710843373  0.7811244980  0.7911646586  0.3900000000  28.800000000  0.1163552356  0.9917334580  0.0606102943  450           0.1733048248 
0.6420000000  0.5634920635  0.5960000000  0.5634920635  0.7740963855  0.7831325301  0.7449799197  0.7550200803  0.4566666667  32.000000000  0.1105352187  0.9791684449  0.0606102943  500           0.1743548441 
0.6620000000  0.5793650794  0.6240000000  0.5952380952  0.7901606426  0.7791164659  0.7851405622  0.7991967871  0.5000000000  35.200000000  0.1129028511  0.9637389934  0.0606102943  550           0.1690404749 
0.6620000000  0.5714285714  0.6240000000  0.6111111111  0.8303212851  0.8112449799  0.8524096386  0.8554216867  0.4866666667  38.400000000  0.1288950539  0.9458218443  0.0606102943  600           0.1666533709 
0.6780000000  0.6031746032  0.5960000000  0.5714285714  0.8333333333  0.8232931727  0.8192771084  0.8433734940  0.4766666667  41.600000000  0.1193754864  0.9252360618  0.0606102943  650           0.1696547413 
0.6360000000  0.5793650794  0.6260000000  0.6269841270  0.8654618474  0.8514056225  0.8574297189  0.8955823293  0.5066666667  44.800000000  0.1297489452  0.9175755811  0.0606102943  700           0.1775726461 
0.6900000000  0.5873015873  0.6560000000  0.6269841270  0.8574297189  0.8232931727  0.8493975904  0.8674698795  0.5100000000  48.000000000  0.1242289186  0.8986713684  0.0606102943  750           0.1724664450 
0.6840000000  0.6269841270  0.6500000000  0.6190476190  0.9136546185  0.8634538153  0.8222891566  0.8313253012  0.5166666667  51.200000000  0.1326216793  0.8732932711  0.0606102943  800           0.1781508255 
0.6540000000  0.5793650794  0.6080000000  0.5793650794  0.8855421687  0.8554216867  0.9277108434  0.9397590361  0.4266666667  54.400000000  0.1384009075  0.8586404955  0.0629987717  850           0.1738087034 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3200000000  0.3015873016  0.3180000000  0.3174603175  0.3353413655  0.3333333333  0.3353413655  0.3333333333  0.3500000000  0.0000000000  0.2128233910  1.1550736427  0.0563235283  0             0.4794232845 
0.8140000000  0.8174603175  0.6960000000  0.6587301587  0.9267068273  0.8835341365  0.9046184739  0.9116465863  0.4233333333  3.2000000000  0.1133275825  0.7544938654  0.0604491234  50            0.1696023560 
0.7040000000  0.6666666667  0.7000000000  0.6666666667  0.7931726908  0.7670682731  0.8383534137  0.8152610442  0.3433333333  6.4000000000  0.1312323186  0.4391820198  0.0604491234  100           0.1704621172 
0.9340000000  0.9365079365  0.9100000000  0.8730158730  0.9708835341  0.9598393574  0.9889558233  0.9839357430  0.3500000000  9.6000000000  0.1399956082  0.2547068250  0.0604891777  150           0.1760313082 
0.9800000000  0.9841269841  0.9920000000  0.9365079365  0.9979919679  0.9959839357  1.0000000000  1.0000000000  0.3433333333  12.800000000  0.1049004813  0.1294045541  0.0604891777  200           0.1750417042 
1.0000000000  0.9920634921  0.9920000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3666666667  16.000000000  0.0670268775  0.0684638517  0.0604977608  250           0.1705217838 
0.9980000000  0.9761904762  0.9960000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4200000000  19.200000000  0.0511640242  0.0341366892  0.0604977608  300           0.1721552229 
0.9980000000  0.9682539683  0.9960000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4000000000  22.400000000  0.0310303739  0.0235013240  0.0604977608  350           0.1765728855 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3500000000  25.600000000  0.0198647489  0.0110602359  0.0604977608  400           0.1739450550 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3800000000  28.800000000  0.0144379759  0.0063295543  0.0604977608  450           0.1703019142 
0.9980000000  0.9523809524  0.9980000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4300000000  32.000000000  0.0293294504  0.0196935082  0.0605564117  500           0.1681432247 
1.0000000000  0.9841269841  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3433333333  35.200000000  0.0162045787  0.0070000395  0.0605564117  550           0.1674969292 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3633333333  38.400000000  0.0221586797  0.0105956237  0.0605564117  600           0.1778901529 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1171, in _next_data
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1297, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 47, in wait
    if not wait([self.sentinel], timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0001
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3960000000  0.3888888889  0.3560000000  0.3888888889  0.4578313253  0.4698795181  0.5542168675  0.5301204819  0.3233333333  0.0000000000  0.1091594696  1.1550736427  0.0563254356  0             0.5160245895 
0.6480000000  0.5952380952  0.6120000000  0.6031746032  0.8483935743  0.8232931727  0.8644578313  0.8554216867  0.4966666667  3.2000000000  0.0784874165  0.9693584597  0.0604977608  50            0.1728200817 
0.7320000000  0.7063492063  0.6620000000  0.6349206349  0.9106425703  0.8995983936  0.9678714859  0.9839357430  0.4400000000  6.4000000000  0.1138469493  0.6611544627  0.0604977608  100           0.1759360456 
0.8900000000  0.7936507937  0.8380000000  0.7777777778  0.8835341365  0.8755020080  0.7580321285  0.7871485944  0.2200000000  9.6000000000  0.1185290569  0.5066725606  0.0604977608  150           0.1681249332 
0.9340000000  0.8809523810  0.8800000000  0.7698412698  0.9538152610  0.9196787149  0.9246987952  0.9277108434  0.4200000000  12.800000000  0.1260589537  0.4217985684  0.0619921684  200           0.1680919266 
0.9660000000  0.8809523810  0.9460000000  0.8492063492  0.9738955823  0.9839357430  0.9909638554  0.9879518072  0.4200000000  16.000000000  0.1171728942  0.3167620403  0.0619921684  250           0.1695704794 
0.9860000000  0.9444444444  0.9480000000  0.8888888889  0.9979919679  0.9959839357  0.9809236948  0.9919678715  0.3866666667  19.200000000  0.1261753070  0.2418444985  0.0619921684  300           0.1689522219 
0.9880000000  0.9444444444  0.9660000000  0.9206349206  0.9879518072  0.9879518072  0.9799196787  0.9839357430  0.4000000000  22.400000000  0.0992879097  0.1830921760  0.0632801056  350           0.1746065521 
0.9960000000  0.9603174603  0.9880000000  0.9285714286  0.9979919679  0.9959839357  0.9949799197  0.9959839357  0.3433333333  25.600000000  0.0860674778  0.1312491977  0.0632801056  400           0.1691884708 
0.9920000000  0.9603174603  0.9820000000  0.8968253968  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3533333333  28.800000000  0.0860060997  0.1016151083  0.0632801056  450           0.1782735157 
0.9980000000  0.9523809524  0.9880000000  0.9365079365  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3500000000  32.000000000  0.0727598479  0.0789707555  0.0640048981  500           0.1751136827 
0.9980000000  0.9682539683  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3433333333  35.200000000  0.0629584792  0.0685899685  0.0640048981  550           0.1717049170 
1.0000000000  0.9682539683  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4066666667  38.400000000  0.0554633674  0.0514999637  0.0640048981  600           0.1654676580 
1.0000000000  0.9761904762  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4033333333  41.600000000  0.0423953369  0.0406959035  0.0640048981  650           0.1698899031 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3533333333  44.800000000  0.0474763981  0.0403874706  0.0640048981  700           0.1768295050 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3700000000  48.000000000  0.0324766844  0.0298204855  0.0640048981  750           0.1734258223 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3433333333  51.200000000  0.0304299570  0.0234704010  0.0640048981  800           0.1780367184 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 287, in forward
    x = self.layer4(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/pooling.py", line 991, in forward
    return F.adaptive_max_pool1d(input, self.output_size, self.return_indices)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/_jit_internal.py", line 365, in fn
    return if_false(*args, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 912, in _adaptive_max_pool1d
    return adaptive_max_pool1d_with_indices(input, output_size)[0]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 903, in adaptive_max_pool1d_with_indices
    return torch.adaptive_max_pool1d(input, output_size)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0001
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3960000000  0.3888888889  0.3560000000  0.3888888889  0.4578313253  0.4698795181  0.5542168675  0.5301204819  0.4126984127  0.0000000000  0.1091594696  1.1550736427  0.0563254356  0             0.4804131985 
0.6480000000  0.5952380952  0.6120000000  0.6031746032  0.8483935743  0.8232931727  0.8644578313  0.8554216867  0.5238095238  3.2000000000  0.0784874165  0.9693584597  0.0605177879  50            0.1762990379 
0.7320000000  0.7063492063  0.6620000000  0.6349206349  0.9106425703  0.8995983936  0.9678714859  0.9839357430  0.5920634921  6.4000000000  0.1138469493  0.6611544627  0.0605177879  100           0.1808906746 
0.8900000000  0.7936507937  0.8380000000  0.7777777778  0.8835341365  0.8755020080  0.7580321285  0.7871485944  0.5777777778  9.6000000000  0.1185290569  0.5066725606  0.0605926514  150           0.1676208687 
0.9340000000  0.8809523810  0.8800000000  0.7698412698  0.9538152610  0.9196787149  0.9246987952  0.9277108434  0.6190476190  12.800000000  0.1260589537  0.4217985684  0.0605926514  200           0.1673081732 
0.9660000000  0.8809523810  0.9460000000  0.8492063492  0.9738955823  0.9839357430  0.9909638554  0.9879518072  0.5333333333  16.000000000  0.1171728942  0.3167620403  0.0605926514  250           0.1687667227 
0.9860000000  0.9444444444  0.9480000000  0.8888888889  0.9979919679  0.9959839357  0.9809236948  0.9919678715  0.5825396825  19.200000000  0.1261753070  0.2418444985  0.0605926514  300           0.1696059799 
0.9880000000  0.9444444444  0.9660000000  0.9206349206  0.9879518072  0.9879518072  0.9799196787  0.9839357430  0.5841269841  22.400000000  0.0992879097  0.1830921760  0.0606570244  350           0.1710609436 
0.9960000000  0.9603174603  0.9880000000  0.9285714286  0.9979919679  0.9959839357  0.9949799197  0.9959839357  0.4206349206  25.600000000  0.0860674778  0.1312491977  0.0606570244  400           0.1698118734 
0.9920000000  0.9603174603  0.9820000000  0.8968253968  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4761904762  28.800000000  0.0860060997  0.1016151083  0.0606570244  450           0.1713569403 
0.9980000000  0.9523809524  0.9880000000  0.9365079365  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4253968254  32.000000000  0.0727598479  0.0789707555  0.0606570244  500           0.1745675516 
0.9980000000  0.9682539683  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3761904762  35.200000000  0.0629584792  0.0685899685  0.0606570244  550           0.1746339273 
1.0000000000  0.9682539683  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4126984127  38.400000000  0.0554633674  0.0514999637  0.0606570244  600           0.1743811798 
1.0000000000  0.9761904762  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4285714286  41.600000000  0.0423953369  0.0406959035  0.0606570244  650           0.1637063408 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3793650794  44.800000000  0.0474763981  0.0403874706  0.0606570244  700           0.1695105410 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3555555556  48.000000000  0.0324766844  0.0298204855  0.0606570244  750           0.1734589291 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2825396825  51.200000000  0.0304299570  0.0234704010  0.0606570244  800           0.1663201809 
1.0000000000  0.9603174603  1.0000000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4428571429  54.400000000  0.0222833528  0.0182600954  0.0606570244  850           0.1743752718 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0001
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4360000000  0.4047619048  0.3900000000  0.3650793651  0.4397590361  0.4216867470  0.5542168675  0.5060240964  0.4301587302  0.0000000000  0.0382839441  1.1431634426  0.0563254356  0             0.4791231155 
0.5800000000  0.5555555556  0.5060000000  0.4841269841  0.8283132530  0.7831325301  0.8750000000  0.8253012048  0.4063492063  3.2000000000  0.0808793843  0.9587211621  0.0605545044  50            0.1757976532 
0.7400000000  0.6587301587  0.7180000000  0.6190476190  0.8328313253  0.7891566265  0.9126506024  0.8795180723  0.5444444444  6.4000000000  0.1313747144  0.6558227456  0.0605649948  100           0.1758933210 
0.8440000000  0.7619047619  0.8040000000  0.6984126984  0.9231927711  0.8734939759  0.9186746988  0.9036144578  0.5793650794  9.6000000000  0.1364997196  0.4942262459  0.0605788231  150           0.1689146519 
0.8780000000  0.7777777778  0.8160000000  0.6746031746  0.8975903614  0.8433734940  0.9036144578  0.8915662651  0.6333333333  12.800000000  0.1340415615  0.4113256228  0.0605788231  200           0.1703687143 
0.9580000000  0.9047619048  0.9600000000  0.8650793651  0.9894578313  0.9698795181  0.9578313253  0.9518072289  0.5761904762  16.000000000  0.1343558773  0.3232872260  0.0605788231  250           0.1713459063 
0.9840000000  0.9603174603  0.9540000000  0.8650793651  0.9954819277  0.9698795181  0.9894578313  0.9819277108  0.5523809524  19.200000000  0.1098289306  0.2413559422  0.0605788231  300           0.1751110697 
0.9940000000  0.9761904762  0.9900000000  0.8888888889  0.9894578313  0.9698795181  0.9984939759  0.9939759036  0.4682539683  22.400000000  0.0966742259  0.1750926676  0.0606131554  350           0.1761778975 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 379, in select
    for fd, event in fd_event_list:
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3420000000  0.3333333333  0.3380000000  0.3412698413  0.4728915663  0.4698795181  0.4789156627  0.4337349398  0.3539682540  0.0000000000  0.1466314793  1.1431634426  0.0539793968  0             0.4869034290 
0.7740000000  0.7222222222  0.8060000000  0.7539682540  0.9096385542  0.9036144578  0.8990963855  0.9216867470  0.5793650794  3.2000000000  0.1270492619  0.7174333179  0.0604720116  50            0.1752992821 
0.8960000000  0.8968253968  0.8860000000  0.8253968254  0.9292168675  0.9216867470  0.9834337349  0.9698795181  0.5111111111  6.4000000000  0.1444511065  0.3963040662  0.0604720116  100           0.1834147692 
0.9620000000  0.8809523810  0.9160000000  0.9047619048  0.9472891566  0.8855421687  0.9397590361  0.9277108434  0.5095238095  9.6000000000  0.1193037912  0.2105834173  0.0604720116  150           0.1748267508 
0.9840000000  0.9523809524  0.9600000000  0.9365079365  0.9879518072  0.9759036145  0.9367469880  0.9397590361  0.3555555556  12.800000000  0.0868481719  0.1124093944  0.0606536865  200           0.1732822323 
1.0000000000  0.9920634921  0.9980000000  0.9761904762  0.9924698795  0.9819277108  0.9879518072  0.9638554217  0.3380952381  16.000000000  0.0696092729  0.0730004333  0.0606536865  250           0.1761488533 
1.0000000000  0.9920634921  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3269841270  19.200000000  0.0434563266  0.0404929850  0.0617017746  300           0.1758798838 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1171, in _next_data
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1297, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 47, in wait
    if not wait([self.sentinel], timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3420000000  0.3333333333  0.3380000000  0.3412698413  0.4728915663  0.4698795181  0.4789156627  0.4337349398  0.3539682540  0.0000000000  0.1466314793  1.1431634426  0.0539793968  0             0.4903757572 
0.7740000000  0.7222222222  0.8060000000  0.7539682540  0.9096385542  0.9036144578  0.8990963855  0.9216867470  0.5793650794  3.2000000000  0.1270492619  0.7174333179  0.0604138374  50            0.1683365059 
0.8960000000  0.8968253968  0.8860000000  0.8253968254  0.9292168675  0.9216867470  0.9834337349  0.9698795181  0.5111111111  6.4000000000  0.1444511065  0.3963040662  0.0605196953  100           0.1697143221 
0.9620000000  0.8809523810  0.9160000000  0.9047619048  0.9472891566  0.8855421687  0.9397590361  0.9277108434  0.5095238095  9.6000000000  0.1193037912  0.2105834173  0.0605196953  150           0.1780152893 
0.9840000000  0.9523809524  0.9600000000  0.9365079365  0.9879518072  0.9759036145  0.9367469880  0.9397590361  0.3555555556  12.800000000  0.0868481719  0.1124093944  0.0605196953  200           0.1787620211 
1.0000000000  0.9920634921  0.9980000000  0.9761904762  0.9924698795  0.9819277108  0.9879518072  0.9638554217  0.3380952381  16.000000000  0.0696092729  0.0730004333  0.0605196953  250           0.1750435877 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
KeyboardInterrupt
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)

During handling of the above exception, another exception occurred:

KeyboardInterrupt
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)
Traceback (most recent call last):
KeyboardInterrupt
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 292, in _on_run
    r = self.sock.recv(1024)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
KeyboardInterrupt

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 296, in _on_run
    self.handle_except()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
Traceback (most recent call last):
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'

During handling of the above exception, another exception occurred:

  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
Traceback (most recent call last):
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 218, in run
    self._on_run()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1846, in _on_run
    return ReaderThread._on_run(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 328, in _on_run
    self.handle_except()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/pydevd.py", line 1849, in handle_except
    ReaderThread.handle_except(self)
  File "/usr/pycharm/pycharm-2021.3.1/plugins/python/helpers/pydev/_pydevd_bundle/pydevd_comm.py", line 332, in handle_except
    self.global_debugger_holder.global_dbg.finish_debugging_session()
AttributeError: 'NoneType' object has no attribute 'finish_debugging_session'
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1229759) is killed by signal: Terminated. 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3680000000  0.3412698413  0.3640000000  0.3333333333  0.5963855422  0.5421686747  0.5391566265  0.5180722892  0.3825396825  0.0000000000  0.0916504860  1.1432409286  0.0539793968  0             0.4709527493 
0.6760000000  0.6746031746  0.6340000000  0.6111111111  0.8734939759  0.8313253012  0.8569277108  0.8012048193  0.6412698413  3.2000000000  0.1300939614  0.7448823810  0.0604138374  50            0.1479215908 
0.8620000000  0.7460317460  0.8080000000  0.7539682540  0.8313253012  0.7590361446  0.8509036145  0.8012048193  0.6015873016  6.4000000000  0.1587059748  0.4305159247  0.0604138374  100           0.1577915144 
0.9900000000  0.9682539683  0.9540000000  0.9444444444  0.9879518072  0.9759036145  0.9984939759  0.9819277108  0.4539682540  9.6000000000  0.1121114105  0.2279154013  0.0604138374  150           0.1491105652 
0.9380000000  0.8968253968  0.9340000000  0.8412698413  0.9879518072  0.9879518072  0.9939759036  0.9759036145  0.5936507937  12.800000000  0.1042091869  0.1271342549  0.0604138374  200           0.1541746521 
0.9920000000  0.9841269841  0.9960000000  0.9682539683  0.9954819277  0.9698795181  0.9457831325  0.9277108434  0.3047619048  16.000000000  0.0920327482  0.0909624556  0.0604138374  250           0.1627126312 
1.0000000000  0.9841269841  0.9980000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3476190476  19.200000000  0.0636734217  0.0502103566  0.0604138374  300           0.1470326424 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3111111111  22.400000000  0.0364050377  0.0251478961  0.0604138374  350           0.1620165968 
1.0000000000  0.9603174603  0.9980000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4507936508  25.600000000  0.0196212344  0.0148364694  0.0604138374  400           0.1554186296 
0.9940000000  0.9841269841  0.9940000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3603174603  28.800000000  0.0358979748  0.0175282262  0.0604138374  450           0.1499091482 
0.9980000000  0.9761904762  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2142857143  32.000000000  0.0208136468  0.0130586206  0.0604138374  500           0.1477275085 
1.0000000000  0.9682539683  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3015873016  35.200000000  0.0204504118  0.0104527848  0.0604138374  550           0.1521562338 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3365079365  38.400000000  0.0246732632  0.0084403387  0.0604138374  600           0.1508225584 
1.0000000000  0.9603174603  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2349206349  41.600000000  0.0133579405  0.0072020504  0.0604138374  650           0.1479887629 
1.0000000000  0.9682539683  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4428571429  44.800000000  0.0178170446  0.0082847744  0.0604138374  700           0.1585853767 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  0.9759036145  1.0000000000  1.0000000000  0.2825396825  48.000000000  0.0105451421  0.0044064228  0.0604138374  750           0.1436075735 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2507936508  51.200000000  0.0058272690  0.0032015902  0.0604138374  800           0.1487165880 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3420000000  0.3492063492  0.3380000000  0.3412698413  0.4066265060  0.3975903614  0.4563253012  0.4397590361  0.3523809524  0.0000000000  0.1400960684  1.1398540735  0.0563254356  0             0.4790461063 
0.8060000000  0.8174603175  0.6940000000  0.6587301587  0.9563253012  0.9216867470  0.8283132530  0.8674698795  0.7492063492  3.2000000000  0.1320286173  0.7479575390  0.0604138374  50            0.1422404051 
0.8920000000  0.8333333333  0.8420000000  0.7619047619  0.8855421687  0.8313253012  0.9954819277  0.9939759036  0.5428571429  6.4000000000  0.1453288677  0.4005599165  0.0604138374  100           0.1493099308 
0.9860000000  0.9285714286  0.9660000000  0.9523809524  0.9849397590  0.9759036145  0.9969879518  0.9879518072  0.5190476190  9.6000000000  0.1269756703  0.2343869692  0.0604138374  150           0.1462691927 
0.9840000000  0.9365079365  0.9580000000  0.9047619048  0.9668674699  0.9156626506  0.9713855422  0.9457831325  0.5142857143  12.800000000  0.0856747839  0.1233632739  0.0604138374  200           0.1418095589 
0.9980000000  0.9682539683  0.9980000000  0.9761904762  0.9879518072  0.9638554217  0.9864457831  0.9578313253  0.3920634921  16.000000000  0.0755084849  0.0757443154  0.0604138374  250           0.1461021996 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1171, in _next_data
    self._shutdown_workers()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1297, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 124, in join
    res = self._popen.wait(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 47, in wait
    if not wait([self.sentinel], timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3900000000  0.3253968254  0.3880000000  0.3412698413  0.5346385542  0.5240963855  0.5602409639  0.5301204819  0.3952380952  0.0000000000  0.1044825315  1.1402245760  0.0539793968  0             0.4264569283 
0.8480000000  0.8333333333  0.7200000000  0.6349206349  0.9307228916  0.9036144578  0.8509036145  0.8614457831  0.7126984127  3.2000000000  0.1250787532  0.7582214844  0.0604138374  50            0.1430538225 
0.8140000000  0.7777777778  0.8220000000  0.7777777778  0.8915662651  0.8433734940  0.9924698795  0.9819277108  0.5555555556  6.4000000000  0.1585914344  0.4753439975  0.0604138374  100           0.1445462322 
0.9340000000  0.9444444444  0.8620000000  0.7936507937  0.9487951807  0.9397590361  0.9864457831  0.9578313253  0.6682539683  9.6000000000  0.1203069469  0.2837793887  0.0604138374  150           0.1456263924 
0.9440000000  0.8888888889  0.9080000000  0.8492063492  0.9743975904  0.9457831325  0.9337349398  0.9277108434  0.5793650794  12.800000000  0.1256050923  0.1672208780  0.0604138374  200           0.1546815157 
0.9960000000  0.9603174603  0.9980000000  0.9682539683  0.9984939759  0.9939759036  0.9894578313  0.9698795181  0.4015873016  16.000000000  0.0934861064  0.1235245869  0.0604138374  250           0.1484396887 
0.9980000000  0.9603174603  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4190476190  19.200000000  0.0464759446  0.0452705247  0.0604138374  300           0.1532996798 
0.9980000000  0.9444444444  0.9960000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2793650794  22.400000000  0.0295084525  0.0261649487  0.0604138374  350           0.1547349930 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3960000000  0.3412698413  0.3840000000  0.3253968254  0.6912650602  0.6325301205  0.6731927711  0.6566265060  0.3888888889  0.0000000000  0.5898034573  1.1402245760  0.0539793968  0             0.4795978069 
0.3720000000  0.3888888889  0.3700000000  0.3333333333  0.5150602410  0.5180722892  0.5858433735  0.5963855422  0.2380952381  3.2000000000  0.2686637568  1.0903795505  0.0604138374  50            0.1544174862 
0.4580000000  0.4047619048  0.4800000000  0.5476190476  0.6852409639  0.7048192771  0.5512048193  0.5662650602  0.3777777778  6.4000000000  0.0837631345  1.0891028976  0.0604138374  100           0.1536038399 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  9.6000000000  0.0169704080  1.0970689273  0.0604138374  150           0.1422866964 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  12.800000000  0.0103761315  1.0984530210  0.0604138374  200           0.1388503170 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  16.000000000  0.0052217603  1.0986599684  0.0604138374  250           0.1416991806 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3900000000  0.3492063492  0.3820000000  0.3412698413  0.6219879518  0.6204819277  0.6114457831  0.5662650602  0.3873015873  0.0000000000  0.2260196209  1.1402245760  0.0539793968  0             0.4531011581 
0.5620000000  0.5555555556  0.5180000000  0.4841269841  0.8237951807  0.7530120482  0.8750000000  0.8614457831  0.5492063492  3.2000000000  0.1629511905  0.9822911119  0.0604138374  50            0.1484952497 
0.6700000000  0.6825396825  0.6540000000  0.6746031746  0.9548192771  0.9156626506  0.9337349398  0.9156626506  0.6777777778  6.4000000000  0.2312112987  0.6894249249  0.0604138374  100           0.1472547960 
0.8000000000  0.8253968254  0.7020000000  0.6746031746  0.9186746988  0.8433734940  0.8855421687  0.8674698795  0.7444444444  9.6000000000  0.2316034102  0.5442179489  0.0604138374  150           0.1562084579 
0.7100000000  0.7301587302  0.6560000000  0.6111111111  0.8539156627  0.7891566265  0.8780120482  0.8855421687  0.7047619048  12.800000000  0.2118628561  0.4901302755  0.0604138374  200           0.1538233614 
0.8660000000  0.7936507937  0.8440000000  0.8809523810  0.9277108434  0.8674698795  0.9954819277  0.9939759036  0.5349206349  16.000000000  0.2201141119  0.4594999343  0.0604138374  250           0.1469225502 
0.9040000000  0.8492063492  0.8880000000  0.8412698413  0.9231927711  0.9337349398  0.9412650602  0.9216867470  0.5746031746  19.200000000  0.1776855969  0.3529032689  0.0604138374  300           0.1471663761 
0.9340000000  0.9047619048  0.9280000000  0.8809523810  0.9969879518  0.9759036145  0.9638554217  0.9397590361  0.7190476190  22.400000000  0.2116717517  0.2403810439  0.0604138374  350           0.1554314280 
0.9740000000  0.8968253968  0.9620000000  0.9365079365  0.9698795181  0.9397590361  0.9969879518  1.0000000000  0.4396825397  25.600000000  0.2161869997  0.1992404613  0.0604138374  400           0.1564831209 
0.9860000000  0.9682539683  0.9680000000  0.9047619048  0.9503012048  0.9096385542  0.9653614458  0.9457831325  0.4857142857  28.800000000  0.1597330850  0.1247567932  0.0604138374  450           0.1536501360 
0.9900000000  0.9603174603  0.9820000000  0.9444444444  1.0000000000  0.9879518072  0.9984939759  0.9939759036  0.3285714286  32.000000000  0.1275785628  0.0778965180  0.0604138374  500           0.1492746305 
0.9920000000  0.9603174603  0.9880000000  0.9523809524  1.0000000000  0.9879518072  0.9939759036  0.9759036145  0.4380952381  35.200000000  0.1013555117  0.0526932336  0.0604138374  550           0.1441961908 
0.9980000000  0.9761904762  0.9940000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3174603175  38.400000000  0.1027977660  0.0412348116  0.0604138374  600           0.1558346367 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1966, in update
    self.optimizer.step()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/optim/optimizer.py", line 89, in wrapper
    return func(*args, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/optim/adam.py", line 119, in step
    group['eps'])
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/optim/_functional.py", line 81, in adam
    grad = grad.add(param, alpha=weight_decay)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3300000000  0.3174603175  0.3358433735  0.3313253012  0.3343373494  0.3373493976  0.3444444444  0.0000000000  0.2950944901  1.1402245760  0.0539793968  0             0.4474899769 
0.4060000000  0.3888888889  0.3860000000  0.4126984127  0.4789156627  0.4939759036  0.3930722892  0.4156626506  0.4253968254  3.2000000000  0.1597785735  1.0986987948  0.0604138374  50            0.1434293079 
0.4640000000  0.4285714286  0.4280000000  0.3571428571  0.5707831325  0.5722891566  0.5466867470  0.5481927711  0.4444444444  6.4000000000  0.1278539538  1.0773768687  0.0604138374  100           0.1498193026 
0.4980000000  0.4126984127  0.4460000000  0.3888888889  0.5090361446  0.5060240964  0.4397590361  0.4337349398  0.4523809524  9.6000000000  0.1197087288  1.0647300768  0.0604138374  150           0.1585418367 
0.5280000000  0.4682539683  0.4820000000  0.4603174603  0.6325301205  0.6385542169  0.6174698795  0.6144578313  0.4698412698  12.800000000  0.1083339548  1.0564800286  0.0604138374  200           0.1565072632 
0.5140000000  0.4682539683  0.4580000000  0.4444444444  0.6686746988  0.6265060241  0.6445783133  0.6265060241  0.4317460317  16.000000000  0.1153152800  1.0474985623  0.0604138374  250           0.1526859236 
0.5860000000  0.5158730159  0.5120000000  0.4523809524  0.6340361446  0.6325301205  0.6792168675  0.6566265060  0.4920634921  19.200000000  0.1202252150  1.0324910736  0.0604138374  300           0.1542987871 
0.6460000000  0.5238095238  0.5580000000  0.4920634921  0.7138554217  0.6867469880  0.7259036145  0.6746987952  0.4841269841  22.400000000  0.1074811983  1.0247036803  0.0604138374  350           0.1510572815 
0.6380000000  0.5317460317  0.5740000000  0.5158730159  0.6837349398  0.6626506024  0.7500000000  0.7228915663  0.4761904762  25.600000000  0.0940344477  1.0176409841  0.0604138374  400           0.1589394665 
0.6380000000  0.5396825397  0.5740000000  0.4841269841  0.7183734940  0.7048192771  0.8207831325  0.7530120482  0.4841269841  28.800000000  0.1061431956  1.0027343285  0.0604138374  450           0.1518081665 
0.6420000000  0.5317460317  0.5900000000  0.4920634921  0.7168674699  0.6746987952  0.8328313253  0.7771084337  0.4904761905  32.000000000  0.1079079270  0.9890611660  0.0604138374  500           0.1493210125 
0.6300000000  0.5476190476  0.5440000000  0.4761904762  0.6746987952  0.6626506024  0.8147590361  0.7530120482  0.4825396825  35.200000000  0.0978844666  0.9795469141  0.0604138374  550           0.1449448776 
0.6640000000  0.5555555556  0.6300000000  0.5555555556  0.7951807229  0.7831325301  0.8313253012  0.7951807229  0.5206349206  38.400000000  0.1131920075  0.9565145218  0.0604138374  600           0.1530701256 
0.6700000000  0.5714285714  0.6740000000  0.6031746032  0.8373493976  0.8433734940  0.8463855422  0.8072289157  0.5412698413  41.600000000  0.1167403793  0.9422741723  0.0604138374  650           0.1506577730 
0.6580000000  0.6269841270  0.6400000000  0.5634920635  0.8403614458  0.8554216867  0.8704819277  0.8313253012  0.5285714286  44.800000000  0.1269130373  0.9231424642  0.0604138374  700           0.1544602346 
0.6660000000  0.6349206349  0.6280000000  0.5873015873  0.8704819277  0.8915662651  0.8900602410  0.8132530120  0.5285714286  48.000000000  0.1373403239  0.9052247775  0.0604138374  750           0.1425877285 
0.6300000000  0.5793650794  0.6080000000  0.5873015873  0.8810240964  0.8614457831  0.9141566265  0.8493975904  0.5079365079  51.200000000  0.1170381236  0.8865825605  0.0604138374  800           0.1516633129 
0.6720000000  0.5952380952  0.6180000000  0.6031746032  0.8644578313  0.8072289157  0.8900602410  0.8493975904  0.5269841270  54.400000000  0.1318274283  0.8749829245  0.0604138374  850           0.1519926071 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 5e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3730158730  0.3560000000  0.3333333333  0.3644578313  0.3493975904  0.4563253012  0.4397590361  0.4095238095  0.0000000000  0.1437211037  1.1402245760  0.0563254356  0             0.4410164356 
0.4680000000  0.4285714286  0.4200000000  0.4047619048  0.5888554217  0.5843373494  0.6566265060  0.6506024096  0.3666666667  3.2000000000  0.1289782667  1.0573076487  0.0604138374  50            0.1510956669 
0.5540000000  0.5396825397  0.4980000000  0.5238095238  0.7500000000  0.7590361446  0.8177710843  0.8012048193  0.4539682540  6.4000000000  0.1247508931  0.9942338836  0.0604138374  100           0.1450191879 
0.6120000000  0.5476190476  0.5360000000  0.5158730159  0.7515060241  0.7289156627  0.8388554217  0.7771084337  0.5158730159  9.6000000000  0.1254325294  0.9027596700  0.0604138374  150           0.1450635767 
0.6760000000  0.6507936508  0.6440000000  0.6190476190  0.9066265060  0.8915662651  0.8524096386  0.8433734940  0.5888888889  12.800000000  0.1888565254  0.7624891949  0.0604138374  200           0.1498554277 
0.7180000000  0.6507936508  0.7220000000  0.6428571429  0.9548192771  0.9156626506  0.8614457831  0.8795180723  0.5412698413  16.000000000  0.2266881514  0.6664916515  0.0604138374  250           0.1532727528 
0.8460000000  0.8095238095  0.7220000000  0.6507936508  0.9216867470  0.8795180723  0.9518072289  0.9397590361  0.7650793651  19.200000000  0.1957989419  0.5870766085  0.0604138374  300           0.1568305922 
0.8880000000  0.8253968254  0.7960000000  0.7301587302  0.9322289157  0.8734939759  0.9593373494  0.9457831325  0.6619047619  22.400000000  0.2006712914  0.5451991069  0.0604138374  350           0.1485000467 
0.9060000000  0.8412698413  0.7900000000  0.6904761905  0.9909638554  0.9638554217  0.9713855422  0.9698795181  0.7253968254  25.600000000  0.1953601313  0.4959296775  0.0604138374  400           0.1518663692 
0.8620000000  0.7936507937  0.8120000000  0.8095238095  0.9608433735  0.9036144578  0.9954819277  0.9939759036  0.5666666667  28.800000000  0.2128229511  0.4450131482  0.0604138374  450           0.1567783737 
0.9460000000  0.8650793651  0.9160000000  0.8730158730  0.9608433735  0.9277108434  0.9849397590  0.9879518072  0.5761904762  32.000000000  0.2123840225  0.4088594925  0.0604138374  500           0.1443792582 
0.9740000000  0.9126984127  0.9260000000  0.8492063492  0.9623493976  0.9216867470  0.9984939759  0.9939759036  0.6444444444  35.200000000  0.1842051256  0.3585647666  0.0604138374  550           0.1606699467 
0.9740000000  0.9126984127  0.9520000000  0.9047619048  0.9789156627  0.9638554217  0.9984939759  0.9939759036  0.5809523810  38.400000000  0.2067822838  0.3252381498  0.0604138374  600           0.1601949358 
0.9880000000  0.9365079365  0.9700000000  0.9365079365  0.9969879518  0.9879518072  0.9939759036  0.9759036145  0.5317460317  41.600000000  0.1916424543  0.2709563938  0.0604138374  650           0.1518154192 
0.9720000000  0.8888888889  0.9440000000  0.8333333333  0.9623493976  0.9216867470  0.9894578313  0.9698795181  0.6555555556  44.800000000  0.1728372976  0.2279766238  0.0604138374  700           0.1506450605 
0.9820000000  0.9523809524  0.9600000000  0.9047619048  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.5857142857  48.000000000  0.2118863949  0.2091573182  0.0604138374  750           0.1559474230 
0.9820000000  0.9365079365  0.9360000000  0.8571428571  0.9984939759  0.9939759036  0.9969879518  0.9759036145  0.4984126984  51.200000000  0.1679996383  0.1719335873  0.0604138374  800           0.1529610062 
0.9960000000  0.9444444444  0.9880000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5047619048  54.400000000  0.1593707705  0.1505355462  0.0604138374  850           0.1526620626 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3730158730  0.3560000000  0.3333333333  0.3644578313  0.3493975904  0.4563253012  0.4397590361  0.4095238095  0.0000000000  0.1435551643  1.1402245760  0.0563254356  0             0.4572508335 
0.5080000000  0.4603174603  0.5080000000  0.5158730159  0.7259036145  0.7349397590  0.7018072289  0.6626506024  0.4761904762  3.2000000000  0.1338149905  1.0568006921  0.0604138374  50            0.1430349255 
0.6860000000  0.6349206349  0.6380000000  0.6269841270  0.8072289157  0.8072289157  0.7033132530  0.7048192771  0.6142857143  6.4000000000  0.1215285754  0.9869460595  0.0604138374  100           0.1502101135 
0.6280000000  0.5714285714  0.5820000000  0.5793650794  0.7710843373  0.7469879518  0.8629518072  0.8493975904  0.5507936508  9.6000000000  0.1578865933  0.8742427111  0.0604138374  150           0.1545720863 
0.6720000000  0.6507936508  0.5960000000  0.5476190476  0.9006024096  0.8795180723  0.8298192771  0.8493975904  0.6444444444  12.800000000  0.1775094199  0.7404181755  0.0604138374  200           0.1506674671 
0.7200000000  0.6428571429  0.6960000000  0.6269841270  0.9533132530  0.9216867470  0.9096385542  0.9036144578  0.6507936508  16.000000000  0.2131712401  0.6415945685  0.0604138374  250           0.1576261473 
0.8320000000  0.7539682540  0.7340000000  0.5952380952  0.9262048193  0.9216867470  0.9246987952  0.9036144578  0.6730158730  19.200000000  0.1973297274  0.5599698353  0.0604138374  300           0.1546133423 
0.8700000000  0.7936507937  0.8380000000  0.7301587302  0.9231927711  0.8734939759  0.9924698795  0.9939759036  0.6412698413  22.400000000  0.2098354137  0.5150846291  0.0604138374  350           0.1497810459 
0.8900000000  0.8174603175  0.8100000000  0.7142857143  0.9683734940  0.9457831325  0.9939759036  0.9879518072  0.7142857143  25.600000000  0.2087385404  0.4716429061  0.0604138374  400           0.1447135353 
0.9320000000  0.9047619048  0.8980000000  0.8015873016  0.9623493976  0.9216867470  0.9969879518  1.0000000000  0.6746031746  28.800000000  0.2335458159  0.4210898292  0.0604138374  450           0.1426598024 
0.9500000000  0.8809523810  0.9180000000  0.8253968254  0.9834337349  0.9819277108  0.9728915663  0.9638554217  0.5587301587  32.000000000  0.1969141811  0.3795664638  0.0604138374  500           0.1480302477 
0.9700000000  0.8968253968  0.9160000000  0.8095238095  0.9337349398  0.8674698795  0.9924698795  0.9698795181  0.6317460317  35.200000000  0.2036935002  0.3345391518  0.0604138374  550           0.1591541433 
0.9700000000  0.9047619048  0.9560000000  0.8888888889  0.9909638554  0.9759036145  1.0000000000  1.0000000000  0.4460317460  38.400000000  0.2057697707  0.2940789926  0.0604138374  600           0.1490071917 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-05
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3920000000  0.3412698413  0.3640000000  0.3650793651  0.3674698795  0.3373493976  0.4171686747  0.4036144578  0.4396825397  0.0000000000  0.1964917183  1.1402245760  0.0539793968  0             0.4255232811 
0.5660000000  0.4761904762  0.5200000000  0.5317460317  0.7454819277  0.7530120482  0.7213855422  0.7048192771  0.4444444444  3.2000000000  0.1382453442  1.0615639019  0.0604138374  50            0.0936476421 
0.6800000000  0.6746031746  0.6200000000  0.5873015873  0.6370481928  0.6445783133  0.6626506024  0.6506024096  0.5666666667  6.4000000000  0.1309667897  0.9783737111  0.0604138374  100           0.0890267086 
0.5560000000  0.5079365079  0.5980000000  0.6111111111  0.8147590361  0.8012048193  0.9503012048  0.8975903614  0.5428571429  9.6000000000  0.1416475177  0.8817739165  0.0604138374  150           0.0890995932 
0.6300000000  0.5952380952  0.5900000000  0.5634920635  0.8765060241  0.8674698795  0.8493975904  0.8192771084  0.6380952381  12.800000000  0.2112835145  0.7439128733  0.0604138374  200           0.0936120796 
0.7400000000  0.6587301587  0.7200000000  0.6825396825  0.9503012048  0.9337349398  0.9051204819  0.9216867470  0.6555555556  16.000000000  0.1992761564  0.6429908407  0.0604138374  250           0.0928478098 
0.8620000000  0.7539682540  0.7580000000  0.6507936508  0.9759036145  0.9638554217  0.8373493976  0.8192771084  0.6952380952  19.200000000  0.1852102125  0.5699206936  0.0604138374  300           0.0895335627 
0.8820000000  0.8015873016  0.8640000000  0.8095238095  0.9728915663  0.9397590361  0.8840361446  0.8734939759  0.5793650794  22.400000000  0.1992887020  0.5175483620  0.0604138374  350           0.0870765924 
0.9340000000  0.8571428571  0.8440000000  0.7698412698  0.9789156627  0.9759036145  0.9789156627  0.9759036145  0.6222222222  25.600000000  0.1836605334  0.4705404913  0.0604138374  400           0.0878255463 
0.9040000000  0.8492063492  0.8280000000  0.7619047619  0.9834337349  0.9698795181  0.9804216867  0.9819277108  0.5968253968  28.800000000  0.2406570792  0.4368426239  0.0604138374  450           0.0916098118 
0.8940000000  0.8571428571  0.8360000000  0.7380952381  0.9924698795  0.9939759036  0.9879518072  0.9759036145  0.6031746032  32.000000000  0.2073099256  0.3910197312  0.0604138374  500           0.0881448746 
0.9420000000  0.9047619048  0.9040000000  0.8174603175  0.9774096386  0.9457831325  0.9984939759  0.9939759036  0.6857142857  35.200000000  0.1891711193  0.3589383301  0.0604138374  550           0.0877883291 
0.9620000000  0.8968253968  0.9080000000  0.8333333333  0.9563253012  0.9216867470  0.9954819277  0.9819277108  0.4936507937  38.400000000  0.1900830960  0.3174202883  0.0604138374  600           0.0861873341 
0.9740000000  0.9206349206  0.9740000000  0.8968253968  0.9819277108  0.9759036145  0.9879518072  0.9638554217  0.3793650794  41.600000000  0.1802116841  0.2638390806  0.0604138374  650           0.0877019882 
0.9680000000  0.9285714286  0.9400000000  0.8492063492  0.9969879518  0.9759036145  0.9924698795  0.9819277108  0.6063492063  44.800000000  0.1815940320  0.2322754586  0.0604138374  700           0.0859383917 
0.9820000000  0.9365079365  0.9920000000  0.9285714286  0.9969879518  0.9879518072  0.9969879518  0.9879518072  0.4920634921  48.000000000  0.1664741144  0.1936478934  0.0604138374  750           0.0923047400 
0.9880000000  0.9603174603  0.9720000000  0.8968253968  1.0000000000  1.0000000000  0.9969879518  0.9879518072  0.4904761905  51.200000000  0.1591817385  0.1588109401  0.0604138374  800           0.0925804853 
0.9900000000  0.9365079365  0.9880000000  0.9444444444  0.9819277108  0.9759036145  0.9969879518  0.9759036145  0.4301587302  54.400000000  0.1351062003  0.1371142939  0.0604138374  850           0.0915871000 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3730158730  0.3560000000  0.3333333333  0.3644578313  0.3493975904  0.4563253012  0.4397590361  0.4095238095  0.0000000000  0.1435146332  1.1402245760  0.0563254356  0             0.4388589859 
0.4720000000  0.3968253968  0.4220000000  0.4206349206  0.7093373494  0.6927710843  0.6822289157  0.6325301205  0.4079365079  3.2000000000  0.1317685390  1.0599247241  0.0604138374  50            0.1465965700 
0.6080000000  0.5396825397  0.5840000000  0.5714285714  0.7484939759  0.7650602410  0.7259036145  0.7108433735  0.5746031746  6.4000000000  0.1275287938  0.9894031072  0.0604138374  100           0.1453966045 
0.6160000000  0.5396825397  0.5460000000  0.5238095238  0.8463855422  0.8072289157  0.8358433735  0.8253012048  0.5253968254  9.6000000000  0.1546275806  0.8758492756  0.0604138374  150           0.1467075777 
0.6460000000  0.5952380952  0.6240000000  0.5714285714  0.9337349398  0.9036144578  0.9186746988  0.8795180723  0.6349206349  12.800000000  0.1837946725  0.7522898245  0.0604138374  200           0.1567633438 
0.7620000000  0.6746031746  0.7100000000  0.6428571429  0.9036144578  0.8795180723  0.9427710843  0.9277108434  0.6063492063  16.000000000  0.1958505797  0.6386151361  0.0604138374  250           0.1528118372 
0.8620000000  0.8015873016  0.7100000000  0.6031746032  0.9021084337  0.8855421687  0.8900602410  0.8855421687  0.7174603175  19.200000000  0.2019479513  0.5613373995  0.0604138374  300           0.1476942015 
0.8500000000  0.7857142857  0.7640000000  0.6825396825  0.9352409639  0.8975903614  0.9036144578  0.8915662651  0.6222222222  22.400000000  0.2018362784  0.5356503993  0.0604138374  350           0.1524432945 
0.8560000000  0.8333333333  0.7640000000  0.6825396825  0.9819277108  0.9397590361  0.9834337349  0.9819277108  0.7174603175  25.600000000  0.1962602675  0.4809840673  0.0604138374  400           0.1421687937 
0.9080000000  0.8412698413  0.8460000000  0.7460317460  0.8930722892  0.8734939759  0.9924698795  0.9819277108  0.6253968254  28.800000000  0.2367138386  0.4231016129  0.0604138374  450           0.1497041273 
0.9020000000  0.8412698413  0.8460000000  0.7936507937  0.9849397590  0.9277108434  0.9563253012  0.9698795181  0.5428571429  32.000000000  0.2078251535  0.3882333934  0.0604138374  500           0.1455594206 
0.9760000000  0.9365079365  0.9040000000  0.8333333333  0.9427710843  0.8795180723  0.9954819277  0.9819277108  0.6460317460  35.200000000  0.1955185449  0.3466649997  0.0604138374  550           0.1474125004 
0.9860000000  0.9444444444  0.9580000000  0.9047619048  0.9804216867  0.9698795181  0.9954819277  0.9939759036  0.4793650794  38.400000000  0.2061245710  0.3136436003  0.0604138374  600           0.1491371202 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 5e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3730158730  0.3560000000  0.3333333333  0.3644578313  0.3493975904  0.4563253012  0.4397590361  0.4095238095  0.0000000000  0.1435210705  1.1402245760  0.0563254356  0             0.4709146023 
0.4780000000  0.4365079365  0.4180000000  0.4047619048  0.6746987952  0.6867469880  0.7364457831  0.7048192771  0.4095238095  3.2000000000  0.1303685188  1.0573531604  0.0604138374  50            0.1529791737 
0.5880000000  0.5158730159  0.5280000000  0.4682539683  0.7831325301  0.7951807229  0.8524096386  0.8433734940  0.5603174603  6.4000000000  0.1145772290  0.9941297710  0.0604138374  100           0.1543611908 
0.6060000000  0.5317460317  0.5960000000  0.5238095238  0.7394578313  0.7289156627  0.8780120482  0.8493975904  0.5333333333  9.6000000000  0.1495742846  0.8802617872  0.0604138374  150           0.1547675133 
0.6820000000  0.6587301587  0.6600000000  0.6111111111  0.9412650602  0.8975903614  0.7635542169  0.7650602410  0.6285714286  12.800000000  0.1784780955  0.7433791685  0.0604138374  200           0.1487333488 
0.7660000000  0.7698412698  0.7320000000  0.6269841270  0.9578313253  0.9397590361  0.8810240964  0.8975903614  0.6746031746  16.000000000  0.2038120329  0.6403384578  0.0604138374  250           0.1555934334 
0.8240000000  0.7460317460  0.7540000000  0.6746031746  0.9246987952  0.9036144578  0.9081325301  0.8855421687  0.6809523810  19.200000000  0.1983220375  0.5615479648  0.0604138374  300           0.1663343430 
0.8920000000  0.7857142857  0.8540000000  0.7222222222  0.9608433735  0.9397590361  0.9593373494  0.9698795181  0.6333333333  22.400000000  0.1937315667  0.5241411960  0.0604138374  350           0.1456356239 
0.9140000000  0.8253968254  0.8140000000  0.7301587302  0.9759036145  0.9518072289  0.9804216867  0.9819277108  0.6492063492  25.600000000  0.2018977165  0.4749916190  0.0604138374  400           0.1440422630 
0.8580000000  0.7698412698  0.8360000000  0.7857142857  0.9533132530  0.9216867470  0.9713855422  0.9819277108  0.5507936508  28.800000000  0.2125601375  0.4176300746  0.0604138374  450           0.1476220560 
0.9280000000  0.8174603175  0.9100000000  0.8809523810  0.9849397590  0.9638554217  0.9487951807  0.9759036145  0.4523809524  32.000000000  0.2086365569  0.3897167915  0.0604138374  500           0.1566574717 
0.9400000000  0.9126984127  0.9120000000  0.8333333333  0.9969879518  0.9879518072  0.9819277108  0.9879518072  0.6904761905  35.200000000  0.2115395087  0.3327490467  0.0604138374  550           0.1558715296 
0.9740000000  0.9285714286  0.9340000000  0.8650793651  0.9969879518  0.9879518072  0.9984939759  0.9939759036  0.5873015873  38.400000000  0.1972350419  0.2937844056  0.0604138374  600           0.1521806383 
0.9940000000  0.9126984127  0.9780000000  0.9285714286  0.9879518072  0.9879518072  0.9984939759  0.9939759036  0.4539682540  41.600000000  0.1745455861  0.2402269182  0.0604138374  650           0.1558598518 
0.9720000000  0.8809523810  0.9560000000  0.8888888889  0.9849397590  0.9518072289  0.9879518072  0.9879518072  0.6333333333  44.800000000  0.1785007900  0.2101508376  0.0604138374  700           0.1581935263 
0.9980000000  0.9444444444  0.9800000000  0.9682539683  0.9879518072  0.9759036145  0.9728915663  0.9397590361  0.5190476190  48.000000000  0.2021274149  0.1874705225  0.0604138374  750           0.1537609243 
0.9920000000  0.9365079365  0.9660000000  0.9444444444  1.0000000000  1.0000000000  0.9864457831  0.9698795181  0.5333333333  51.200000000  0.1457635012  0.1568359694  0.0604138374  800           0.1554224491 
0.9980000000  0.9444444444  0.9900000000  0.9761904762  0.9909638554  1.0000000000  1.0000000000  1.0000000000  0.5031746032  54.400000000  0.1441607174  0.1300588724  0.0604138374  850           0.1616304111 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 1
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3780000000  0.3730158730  0.3560000000  0.3333333333  0.3644578313  0.3493975904  0.4563253012  0.4397590361  0.4095238095  0.0000000000  0.1435146332  1.1402245760  0.0563254356  0             0.4706325531 
0.4720000000  0.3968253968  0.4220000000  0.4206349206  0.7093373494  0.6927710843  0.6822289157  0.6325301205  0.4079365079  3.2000000000  0.1317685390  1.0599247241  0.0604138374  50            0.1509873724 
0.6080000000  0.5396825397  0.5840000000  0.5714285714  0.7484939759  0.7650602410  0.7259036145  0.7108433735  0.5746031746  6.4000000000  0.1275287938  0.9894031072  0.0604138374  100           0.1542243004 
0.6160000000  0.5396825397  0.5460000000  0.5238095238  0.8463855422  0.8072289157  0.8358433735  0.8253012048  0.5253968254  9.6000000000  0.1546275806  0.8758492756  0.0604138374  150           0.1539590168 
0.6460000000  0.5952380952  0.6240000000  0.5714285714  0.9337349398  0.9036144578  0.9186746988  0.8795180723  0.6349206349  12.800000000  0.1837946725  0.7522898245  0.0604138374  200           0.1509529781 
0.7620000000  0.6746031746  0.7100000000  0.6428571429  0.9036144578  0.8795180723  0.9427710843  0.9277108434  0.6063492063  16.000000000  0.1958505797  0.6386151361  0.0604138374  250           0.1521212435 
0.8620000000  0.8015873016  0.7100000000  0.6031746032  0.9021084337  0.8855421687  0.8900602410  0.8855421687  0.7174603175  19.200000000  0.2019479513  0.5613373995  0.0604138374  300           0.1542913008 
0.8500000000  0.7857142857  0.7640000000  0.6825396825  0.9352409639  0.8975903614  0.9036144578  0.8915662651  0.6222222222  22.400000000  0.2018362784  0.5356503993  0.0604138374  350           0.1555138350 
0.8560000000  0.8333333333  0.7640000000  0.6825396825  0.9819277108  0.9397590361  0.9834337349  0.9819277108  0.7174603175  25.600000000  0.1962602675  0.4809840673  0.0604138374  400           0.1421602201 
0.9080000000  0.8412698413  0.8460000000  0.7460317460  0.8930722892  0.8734939759  0.9924698795  0.9819277108  0.6253968254  28.800000000  0.2367138386  0.4231016129  0.0604138374  450           0.1412912178 
0.9020000000  0.8412698413  0.8460000000  0.7936507937  0.9849397590  0.9277108434  0.9563253012  0.9698795181  0.5428571429  32.000000000  0.2078251535  0.3882333934  0.0604138374  500           0.1490568256 
0.9760000000  0.9365079365  0.9040000000  0.8333333333  0.9427710843  0.8795180723  0.9954819277  0.9819277108  0.6460317460  35.200000000  0.1955185449  0.3466649997  0.0604138374  550           0.1498833513 
0.9860000000  0.9444444444  0.9580000000  0.9047619048  0.9804216867  0.9698795181  0.9954819277  0.9939759036  0.4793650794  38.400000000  0.2061245710  0.3136436003  0.0604138374  600           0.1458483076 
0.9900000000  0.9444444444  0.9820000000  0.9365079365  1.0000000000  1.0000000000  0.9939759036  0.9879518072  0.5253968254  41.600000000  0.1954324108  0.2570366830  0.0604138374  650           0.1429389048 
0.9700000000  0.9047619048  0.9420000000  0.8333333333  0.9412650602  0.8975903614  0.9518072289  0.9277108434  0.6380952381  44.800000000  0.1808530140  0.2304435644  0.0604138374  700           0.1523337221 
0.9920000000  0.9365079365  0.9660000000  0.9365079365  0.9969879518  0.9879518072  0.9909638554  0.9879518072  0.5587301587  48.000000000  0.2311296895  0.2097534043  0.0604138374  750           0.1591183949 
0.9740000000  0.9285714286  0.9780000000  0.9126984127  1.0000000000  0.9879518072  0.9623493976  0.9457831325  0.5238095238  51.200000000  0.1619051993  0.1678950943  0.0604138374  800           0.1652871323 
0.9960000000  0.9444444444  0.9820000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5015873016  54.400000000  0.1501043385  0.1366431560  0.0604138374  850           0.1545627880 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3720000000  0.4206349206  0.3480000000  0.3095238095  0.3554216867  0.3253012048  0.4322289157  0.4156626506  0.4126984127  0.0000000000  0.3843432665  1.1402245760  0.0563254356  0             0.4781448841 
0.4000000000  0.3571428571  0.3540000000  0.3571428571  0.4382530120  0.4397590361  0.4382530120  0.4397590361  0.3952380952  3.2000000000  0.3100752711  1.0837886381  0.0604138374  50            0.1457196856 
0.5240000000  0.5079365079  0.5320000000  0.4761904762  0.5677710843  0.5963855422  0.4427710843  0.4457831325  0.4825396825  6.4000000000  0.2349005103  1.0663380289  0.0604138374  100           0.1515548277 
0.5880000000  0.5158730159  0.5560000000  0.5634920635  0.5647590361  0.5722891566  0.5873493976  0.5662650602  0.5301587302  9.6000000000  0.1816186070  1.0583945870  0.0604138374  150           0.1472744513 
0.5260000000  0.4920634921  0.4820000000  0.5238095238  0.7259036145  0.7349397590  0.6611445783  0.6807228916  0.4936507937  12.800000000  0.1523807764  1.0612335920  0.0604138374  200           0.1597439241 
0.5160000000  0.4920634921  0.4800000000  0.4920634921  0.7695783133  0.6927710843  0.7710843373  0.7590361446  0.4460317460  16.000000000  0.1366636157  1.0522778845  0.0604138374  250           0.1604561520 
0.4140000000  0.3888888889  0.4400000000  0.4126984127  0.5572289157  0.4819277108  0.4292168675  0.4156626506  0.3682539683  19.200000000  0.1236087561  1.0528011060  0.0604138374  300           0.1542247534 
0.5900000000  0.4603174603  0.5700000000  0.5476190476  0.6069277108  0.5963855422  0.5813253012  0.6144578313  0.5777777778  22.400000000  0.1174425840  1.0511510205  0.0604138374  350           0.1453528643 
0.5380000000  0.4920634921  0.6220000000  0.6111111111  0.6099397590  0.6325301205  0.5828313253  0.5963855422  0.5269841270  25.600000000  0.1109675884  1.0502922082  0.0604138374  400           0.1482806635 
0.6340000000  0.6031746032  0.6100000000  0.5793650794  0.7334337349  0.6686746988  0.5406626506  0.5963855422  0.6507936508  28.800000000  0.1145957589  1.0446265125  0.0604138374  450           0.1515702057 
0.7140000000  0.6984126984  0.6280000000  0.6031746032  0.6566265060  0.6746987952  0.4668674699  0.4819277108  0.6380952381  32.000000000  0.1113725305  1.0456240869  0.0604138374  500           0.1478036690 
0.6300000000  0.6190476190  0.6040000000  0.5476190476  0.6837349398  0.6506024096  0.5783132530  0.6265060241  0.6460317460  35.200000000  0.1066104889  1.0428983808  0.0604138374  550           0.1553487539 
0.6380000000  0.6666666667  0.5820000000  0.5714285714  0.7003012048  0.6566265060  0.6777108434  0.6746987952  0.5650793651  38.400000000  0.0991765976  1.0452881455  0.0604138374  600           0.1491165447 
0.6760000000  0.6428571429  0.6300000000  0.6269841270  0.5888554217  0.5240963855  0.5542168675  0.5783132530  0.5746031746  41.600000000  0.0647860885  1.0599560905  0.0604138374  650           0.1573280954 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
    return torch._C._nn.linear(input, weight, bias)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3920000000  0.3571428571  0.3680000000  0.3333333333  0.3930722892  0.3915662651  0.4804216867  0.4638554217  0.4238095238  0.0000000000  0.0679998398  1.1402245760  0.0563254356  0             0.4910290241 
0.5320000000  0.4841269841  0.5120000000  0.5555555556  0.8147590361  0.7650602410  0.8659638554  0.8493975904  0.4269841270  3.2000000000  0.0741347551  0.9989422488  0.0604138374  50            0.1541992378 
0.6480000000  0.5555555556  0.6400000000  0.6190476190  0.8448795181  0.7891566265  0.9457831325  0.9036144578  0.5396825397  6.4000000000  0.1217549711  0.7442030311  0.0604138374  100           0.1552152824 
0.8100000000  0.8015873016  0.7160000000  0.6428571429  0.8810240964  0.8253012048  0.9879518072  0.9638554217  0.6682539683  9.6000000000  0.1183194363  0.5585741514  0.0604138374  150           0.1562956333 
0.8460000000  0.7777777778  0.7860000000  0.7142857143  0.9503012048  0.9096385542  0.8734939759  0.8554216867  0.6238095238  12.800000000  0.1185960364  0.4653730732  0.0604138374  200           0.1458232880 
0.9360000000  0.8095238095  0.9040000000  0.7857142857  0.9774096386  0.9698795181  0.9081325301  0.8855421687  0.5126984127  16.000000000  0.1392255819  0.3806472594  0.0604138374  250           0.1408567095 
0.9840000000  0.9206349206  0.9240000000  0.8412698413  0.9759036145  0.9518072289  0.9713855422  0.9578313253  0.5571428571  19.200000000  0.1177077058  0.3154133552  0.0604138374  300           0.1464071369 
0.9940000000  0.9206349206  0.9760000000  0.9365079365  0.9984939759  0.9819277108  0.9774096386  0.9578313253  0.4571428571  22.400000000  0.0999490353  0.2352299339  0.0604138374  350           0.1451575994 
0.9900000000  0.9047619048  0.9720000000  0.8888888889  0.9984939759  0.9819277108  0.9909638554  0.9759036145  0.5555555556  25.600000000  0.0775914687  0.1840467416  0.0604138374  400           0.1488253164 
0.9980000000  0.9365079365  0.9920000000  0.9365079365  0.9879518072  0.9879518072  1.0000000000  1.0000000000  0.4682539683  28.800000000  0.0908041240  0.1488576256  0.0604138374  450           0.1462927818 
0.9900000000  0.9047619048  0.9800000000  0.9365079365  0.9969879518  0.9879518072  0.9984939759  0.9939759036  0.4015873016  32.000000000  0.0723264921  0.1197381186  0.0604138374  500           0.1508392620 
0.9960000000  0.9365079365  0.9920000000  0.9523809524  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5158730159  35.200000000  0.0667534775  0.0967187111  0.0604138374  550           0.1537611866 
1.0000000000  0.9523809524  0.9940000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.4126984127  38.400000000  0.0684617227  0.0738511947  0.0604138374  600           0.1559866810 
1.0000000000  0.9523809524  0.9980000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3920634921  41.600000000  0.0551401598  0.0658267450  0.0604138374  650           0.1505330753 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/reduction.py", line 182, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/reduction.py", line 153, in recvfds
    msg, ancdata, flags, addr = sock.recvmsg(1, socket.CMSG_SPACE(bytes_size))
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3760000000  0.3888888889  0.3580000000  0.3174603175  0.3614457831  0.3373493976  0.4503012048  0.4397590361  0.4095238095  0.0000000000  0.1827314496  1.1402245760  0.0563254356  0             0.4372987747 
0.4800000000  0.4365079365  0.4580000000  0.4444444444  0.5978915663  0.5963855422  0.6566265060  0.6626506024  0.3888888889  3.2000000000  0.1721567899  1.0650235534  0.0604138374  50            0.1494991589 
0.5580000000  0.4523809524  0.5200000000  0.5000000000  0.7274096386  0.7409638554  0.7951807229  0.8192771084  0.4396825397  6.4000000000  0.1392850071  1.0179027104  0.0604138374  100           0.1480651569 
0.6120000000  0.5634920635  0.5220000000  0.4920634921  0.8659638554  0.8253012048  0.8388554217  0.8493975904  0.5238095238  9.6000000000  0.1450422883  0.9530910397  0.0604138374  150           0.1552719879 
0.6720000000  0.6349206349  0.6040000000  0.4841269841  0.7921686747  0.7710843373  0.8102409639  0.7951807229  0.6031746032  12.800000000  0.1924157077  0.8662118936  0.0604138374  200           0.1467198944 
0.6900000000  0.6666666667  0.6980000000  0.6507936508  0.8418674699  0.8373493976  0.8569277108  0.8373493976  0.5730158730  16.000000000  0.2213779211  0.7683903730  0.0604138374  250           0.1505240488 
0.7480000000  0.6031746032  0.6440000000  0.5873015873  0.9442771084  0.8975903614  0.8885542169  0.8795180723  0.6746031746  19.200000000  0.2088338256  0.6891600335  0.0604138374  300           0.1484746790 
0.8140000000  0.7063492063  0.7480000000  0.7063492063  0.9397590361  0.9036144578  0.9231927711  0.9337349398  0.6571428571  22.400000000  0.2209564114  0.6286545563  0.0604138374  350           0.1454752541 
0.8420000000  0.7460317460  0.7300000000  0.6825396825  0.9548192771  0.9397590361  0.9457831325  0.9518072289  0.7126984127  25.600000000  0.2514338934  0.5670170784  0.0604138374  400           0.1514484453 
0.7440000000  0.7380952381  0.7080000000  0.6904761905  0.9367469880  0.9036144578  0.9578313253  0.9759036145  0.6095238095  28.800000000  0.2470684630  0.5277785194  0.0604138374  450           0.1523268986 
0.8940000000  0.7936507937  0.8120000000  0.7380952381  0.9819277108  0.9638554217  0.9216867470  0.9277108434  0.5952380952  32.000000000  0.2657839030  0.4999173856  0.0604138374  500           0.1533725309 
0.9080000000  0.8650793651  0.8080000000  0.7380952381  0.9638554217  0.9397590361  0.9834337349  0.9819277108  0.6777777778  35.200000000  0.2326972008  0.4609987438  0.0604138374  550           0.1580684662 
0.9500000000  0.8730158730  0.9380000000  0.8492063492  0.9578313253  0.9397590361  0.9457831325  0.9518072289  0.4539682540  38.400000000  0.2435252708  0.4204108477  0.0604138374  600           0.1449830675 
0.9120000000  0.8730158730  0.9100000000  0.8253968254  0.9774096386  0.9698795181  0.9292168675  0.9096385542  0.5158730159  41.600000000  0.2445063767  0.3871025705  0.0604138374  650           0.1446809053 
0.9600000000  0.9047619048  0.9440000000  0.8333333333  0.9864457831  0.9698795181  0.9984939759  0.9939759036  0.6603174603  44.800000000  0.2347894233  0.3633558667  0.0604138374  700           0.1478000212 
0.9760000000  0.9365079365  0.9460000000  0.8333333333  0.9864457831  0.9819277108  0.9774096386  0.9578313253  0.6142857143  48.000000000  0.2697978845  0.3364992577  0.0604138374  750           0.1549976301 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 287, in forward
    x = self.layer4(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 263, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 260, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 8e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 1.5
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3860000000  0.3571428571  0.3640000000  0.3253968254  0.3750000000  0.3554216867  0.4623493976  0.4518072289  0.4126984127  0.0000000000  0.1052024961  1.1402245760  0.0563254356  0             0.4593517780 
0.5280000000  0.4761904762  0.5320000000  0.5714285714  0.7048192771  0.6626506024  0.7063253012  0.6807228916  0.4238095238  3.2000000000  0.1016099077  1.0379289842  0.0604138374  50            0.1516500664 
0.6220000000  0.5555555556  0.5740000000  0.5476190476  0.8659638554  0.8493975904  0.8177710843  0.8132530120  0.5682539683  6.4000000000  0.1413159478  0.8937717021  0.0604138374  100           0.1517745495 
0.7040000000  0.6507936508  0.6500000000  0.5555555556  0.9006024096  0.8433734940  0.9126506024  0.9156626506  0.6365079365  9.6000000000  0.1688626027  0.7197432685  0.0604138374  150           0.1572740078 
0.7540000000  0.7063492063  0.7140000000  0.6269841270  0.8915662651  0.8674698795  0.8132530120  0.8192771084  0.6428571429  12.800000000  0.1859491470  0.6032008660  0.0604138374  200           0.1464993477 
0.8200000000  0.7222222222  0.8200000000  0.7301587302  0.9412650602  0.9337349398  0.9126506024  0.9036144578  0.5920634921  16.000000000  0.1913425523  0.5223243356  0.0604138374  250           0.1487760830 
0.9140000000  0.8333333333  0.8200000000  0.7380952381  0.9051204819  0.8614457831  0.9789156627  0.9397590361  0.6873015873  19.200000000  0.1576910472  0.4616013438  0.0604138374  300           0.1472541285 
0.9480000000  0.8412698413  0.9280000000  0.8333333333  0.9864457831  0.9578313253  0.9668674699  0.9759036145  0.6380952381  22.400000000  0.1682952034  0.4081159079  0.0604138374  350           0.1483686113 
0.9660000000  0.8809523810  0.9180000000  0.8492063492  0.9939759036  0.9879518072  0.9969879518  0.9879518072  0.6349206349  25.600000000  0.1579523979  0.3437454170  0.0604138374  400           0.1498695564 
0.9800000000  0.8571428571  0.9680000000  0.9206349206  0.9533132530  0.9457831325  0.9834337349  0.9939759036  0.4698412698  28.800000000  0.1684919246  0.2937576920  0.0604138374  450           0.1512877798 
0.9740000000  0.8730158730  0.9800000000  0.9603174603  0.9834337349  0.9819277108  0.9819277108  0.9879518072  0.4666666667  32.000000000  0.1554099794  0.2440204701  0.0604138374  500           0.1528351259 
0.9980000000  0.9365079365  0.9720000000  0.9523809524  1.0000000000  1.0000000000  0.9894578313  0.9698795181  0.5507936508  35.200000000  0.1305371135  0.2016175091  0.0604138374  550           0.1514117432 
1.0000000000  0.9523809524  0.9900000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4730158730  38.400000000  0.1304491252  0.1628683208  0.0604138374  600           0.1510793686 
0.9980000000  0.9444444444  0.9920000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4714285714  41.600000000  0.1134218264  0.1318831436  0.0604138374  650           0.1413500023 
0.9980000000  0.9206349206  0.9900000000  0.9206349206  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.5444444444  44.800000000  0.1103328150  0.1117047025  0.0604138374  700           0.1454719830 
0.9980000000  0.9285714286  0.9940000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5349206349  48.000000000  0.1315007574  0.1075054873  0.0604138374  750           0.1454355001 
1.0000000000  0.9523809524  0.9720000000  0.9047619048  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4460317460  51.200000000  0.0974511542  0.0773371116  0.0604138374  800           0.1472579718 
1.0000000000  0.9523809524  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4095238095  54.400000000  0.0972006726  0.0743970929  0.0604138374  850           0.1578657293 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3240000000  0.3253968254  0.3300000000  0.3174603175  0.3358433735  0.3313253012  0.3343373494  0.3373493976  0.3444444444  0.0000000000  0.2945559025  1.1402245760  0.0539793968  0             0.4637911320 
0.4060000000  0.3968253968  0.3780000000  0.3968253968  0.4743975904  0.4759036145  0.3704819277  0.3855421687  0.4190476190  3.2000000000  0.1591893721  1.0986169052  0.0604138374  50            0.1439761972 
0.4540000000  0.4285714286  0.4180000000  0.3650793651  0.5768072289  0.5722891566  0.5753012048  0.5903614458  0.4317460317  6.4000000000  0.1280986881  1.0757550502  0.0604138374  100           0.1400295401 
0.4940000000  0.4365079365  0.4500000000  0.4126984127  0.5120481928  0.4819277108  0.4593373494  0.4518072289  0.4460317460  9.6000000000  0.1240530014  1.0624217200  0.0604138374  150           0.1479521847 
0.5380000000  0.4523809524  0.4860000000  0.4603174603  0.6234939759  0.6024096386  0.5963855422  0.5783132530  0.4777777778  12.800000000  0.1066098809  1.0557695627  0.0604138374  200           0.1511635685 
0.5100000000  0.4444444444  0.4640000000  0.4603174603  0.7033132530  0.6686746988  0.6762048193  0.6566265060  0.4301587302  16.000000000  0.1156935763  1.0467229855  0.0604138374  250           0.1501907444 
0.5900000000  0.5158730159  0.5240000000  0.4682539683  0.6325301205  0.6265060241  0.6641566265  0.6686746988  0.5142857143  19.200000000  0.1208191848  1.0312741673  0.0604138374  300           0.1513744068 
0.6400000000  0.5634920635  0.5520000000  0.4761904762  0.7274096386  0.6927710843  0.6852409639  0.6445783133  0.4952380952  22.400000000  0.1072407150  1.0230786669  0.0604138374  350           0.1478234959 
0.6420000000  0.5714285714  0.5620000000  0.4682539683  0.6716867470  0.6506024096  0.7048192771  0.6987951807  0.4984126984  25.600000000  0.0948841047  1.0171601987  0.0604138374  400           0.1449450827 
0.6120000000  0.5158730159  0.5640000000  0.4841269841  0.7168674699  0.6867469880  0.8087349398  0.7409638554  0.4777777778  28.800000000  0.1067180943  1.0032351685  0.0604138374  450           0.1469498920 
0.6160000000  0.5158730159  0.5700000000  0.4841269841  0.7093373494  0.6807228916  0.8192771084  0.7469879518  0.4746031746  32.000000000  0.1084433103  0.9901205349  0.0604138374  500           0.1498264694 
0.6140000000  0.5158730159  0.5320000000  0.4761904762  0.7153614458  0.6927710843  0.8117469880  0.7289156627  0.4888888889  35.200000000  0.1018700266  0.9786862195  0.0604138374  550           0.1441669035 
0.6700000000  0.5714285714  0.6240000000  0.5793650794  0.7891566265  0.7710843373  0.8388554217  0.8132530120  0.5206349206  38.400000000  0.1088174891  0.9559753478  0.0604138374  600           0.1451623678 
0.6740000000  0.5952380952  0.6620000000  0.5952380952  0.8313253012  0.8072289157  0.8614457831  0.7951807229  0.5349206349  41.600000000  0.1166515040  0.9414745963  0.0604138374  650           0.1505052376 
0.6660000000  0.6111111111  0.6240000000  0.5476190476  0.8478915663  0.8493975904  0.8795180723  0.8313253012  0.5190476190  44.800000000  0.1284985900  0.9230567825  0.0604138374  700           0.1506554842 
0.6640000000  0.5873015873  0.6240000000  0.5793650794  0.8915662651  0.8915662651  0.8734939759  0.8072289157  0.5158730159  48.000000000  0.1406250954  0.9036704099  0.0604138374  750           0.1424604893 
0.6160000000  0.5476190476  0.6020000000  0.5793650794  0.8975903614  0.8674698795  0.9231927711  0.8493975904  0.4888888889  51.200000000  0.1200249863  0.8835862851  0.0604138374  800           0.1570303440 
0.6700000000  0.5793650794  0.6140000000  0.5873015873  0.8704819277  0.8192771084  0.8945783133  0.8313253012  0.5063492063  54.400000000  0.1303576088  0.8717808485  0.0604138374  850           0.1432782841 
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2176, in update
    index = np.random.permutation(self.num_train_domain)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'FC' object has no attribute 'num_train_domain'
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2193, in update
    loss_main = self.ce_loss(pred_a, y_subset_a)  # ce_loss eq.1
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'FC' object has no attribute 'ce_loss'
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2221, in update
    theta_updated_old[k] = v - self.hparams['alpha'] * grad_theta[k]
KeyError: 'alpha'
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2239, in update
    temp_new_featurizer = networks.CNN(pretrained=False, in_channel=self.input_shape[0], out_channel=self.num_classes).cuda()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'FC' object has no attribute 'num_classes'
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py:418: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.
  if param.grad is not None:
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  3.4540843964  0.1006202698  0             0.3588078022 
0.4220000000  0.4126984127  0.3840000000  0.3888888889  0.5993975904  0.5783132530  0.7635542169  0.7168674699  0.4047619048  3.2000000000  3.2510795927  0.2653427124  50            0.0513244534 
0.4440000000  0.4047619048  0.4020000000  0.4365079365  0.7289156627  0.6746987952  0.8704819277  0.8313253012  0.3920634921  6.4000000000  3.0395209742  0.2653427124  100           0.0515662956 
0.4500000000  0.4126984127  0.4020000000  0.4365079365  0.7951807229  0.7469879518  0.9111445783  0.8855421687  0.3984126984  9.6000000000  2.7635952330  0.2653427124  150           0.0516690683 
0.5240000000  0.4365079365  0.4680000000  0.5000000000  0.8509036145  0.8373493976  0.9457831325  0.9156626506  0.4365079365  12.800000000  2.6152676678  0.2653427124  200           0.0515627050 
0.5620000000  0.4841269841  0.4800000000  0.4920634921  0.8674698795  0.8313253012  0.9668674699  0.9397590361  0.4539682540  16.000000000  2.3630528212  0.2653427124  250           0.0522759914 
0.6280000000  0.5634920635  0.5400000000  0.5317460317  0.8780120482  0.8734939759  0.9518072289  0.9638554217  0.4809523810  19.200000000  2.1526991987  0.2653427124  300           0.0509145784 
0.6420000000  0.6111111111  0.5580000000  0.5079365079  0.8765060241  0.8433734940  0.9713855422  0.9819277108  0.5000000000  22.400000000  1.9191293859  0.2653427124  350           0.0524271965 
0.6760000000  0.6428571429  0.6340000000  0.5952380952  0.9277108434  0.8915662651  0.9201807229  0.9216867470  0.5539682540  25.600000000  1.7871415186  0.2653427124  400           0.0537150478 
0.6860000000  0.6507936508  0.6560000000  0.5793650794  0.9141566265  0.8975903614  0.9487951807  0.9638554217  0.5650793651  28.800000000  1.6772548842  0.2653427124  450           0.0505853701 
0.7060000000  0.6825396825  0.6720000000  0.6031746032  0.9216867470  0.9036144578  0.9231927711  0.9216867470  0.5698412698  32.000000000  1.5481916308  0.2653427124  500           0.0503266287 
0.7040000000  0.7063492063  0.6660000000  0.6031746032  0.9322289157  0.9216867470  0.9503012048  0.9578313253  0.5634920635  35.200000000  1.3860749221  0.2653427124  550           0.0495685148 
0.7440000000  0.7063492063  0.7060000000  0.6587301587  0.9548192771  0.9397590361  0.8855421687  0.8795180723  0.6222222222  38.400000000  1.3155314183  0.2653427124  600           0.0523714399 
0.7480000000  0.7142857143  0.7040000000  0.6507936508  0.9533132530  0.9337349398  0.8915662651  0.8915662651  0.6174603175  41.600000000  1.2358191478  0.2653427124  650           0.0545948553 
0.7540000000  0.7301587302  0.7200000000  0.6746031746  0.9472891566  0.9216867470  0.8825301205  0.8915662651  0.6142857143  44.800000000  1.1717712009  0.2653427124  700           0.0513314629 
0.7560000000  0.7222222222  0.7300000000  0.6507936508  0.9668674699  0.9518072289  0.9292168675  0.9096385542  0.6031746032  48.000000000  1.1351069796  0.2653427124  750           0.0521671915 
0.7460000000  0.7380952381  0.7140000000  0.6190476190  0.9713855422  0.9698795181  0.9548192771  0.9518072289  0.5984126984  51.200000000  1.0567427218  0.2653427124  800           0.0526431370 
0.8260000000  0.7857142857  0.7780000000  0.6587301587  0.9623493976  0.9457831325  0.9262048193  0.9216867470  0.6333333333  54.400000000  1.0263239169  0.2653427124  850           0.0511038876 
trails: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 1e-05
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 2
Start Training.
/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py:418: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.
  if param.grad is not None:
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  3.5450096130  0.1006202698  0             0.3527565002 
0.4180000000  0.3888888889  0.3840000000  0.3650793651  0.5677710843  0.5602409639  0.5888554217  0.5843373494  0.4206349206  3.2000000000  3.2809309387  0.2653427124  50            0.0490479183 
0.4340000000  0.4206349206  0.4180000000  0.3888888889  0.6581325301  0.6204819277  0.7951807229  0.7590361446  0.4476190476  6.4000000000  3.0869251204  0.2653427124  100           0.0503170490 
0.4280000000  0.3968253968  0.4200000000  0.4126984127  0.6867469880  0.6385542169  0.8614457831  0.8192771084  0.4317460317  9.6000000000  2.8688037300  0.2653427124  150           0.0500516367 
0.5200000000  0.4682539683  0.4720000000  0.4603174603  0.7469879518  0.7349397590  0.8629518072  0.8132530120  0.5047619048  12.800000000  2.7194832468  0.2653427124  200           0.0497691584 
0.5360000000  0.4682539683  0.5140000000  0.4841269841  0.7274096386  0.7289156627  0.8765060241  0.8433734940  0.5396825397  16.000000000  2.4750214100  0.2653427124  250           0.0492592764 
0.5720000000  0.5317460317  0.5540000000  0.5079365079  0.7545180723  0.7530120482  0.8795180723  0.8554216867  0.5952380952  19.200000000  2.2715089989  0.2653427124  300           0.0498338938 
0.5820000000  0.5634920635  0.6000000000  0.5238095238  0.8057228916  0.8012048193  0.8885542169  0.8554216867  0.6238095238  22.400000000  2.0755483460  0.2653427124  350           0.0497150326 
0.6160000000  0.5873015873  0.6560000000  0.6111111111  0.8192771084  0.8072289157  0.8825301205  0.8433734940  0.6539682540  25.600000000  1.9110168839  0.2653427124  400           0.0498633337 
0.6520000000  0.6111111111  0.6720000000  0.5793650794  0.8207831325  0.8132530120  0.8810240964  0.8373493976  0.6634920635  28.800000000  1.8308122253  0.2653427124  450           0.0495575428 
0.6920000000  0.6507936508  0.6880000000  0.5873015873  0.8268072289  0.8132530120  0.8478915663  0.8253012048  0.6777777778  32.000000000  1.6576128125  0.2653427124  500           0.0501073599 
0.6640000000  0.6269841270  0.6820000000  0.5873015873  0.8599397590  0.8614457831  0.9036144578  0.8795180723  0.6825396825  35.200000000  1.5333180523  0.2653427124  550           0.0504029512 
0.7260000000  0.6507936508  0.7180000000  0.5952380952  0.8584337349  0.8674698795  0.8795180723  0.8674698795  0.6968253968  38.400000000  1.4688107300  0.2653427124  600           0.0501960707 
0.7480000000  0.6746031746  0.7120000000  0.5952380952  0.8689759036  0.8734939759  0.9156626506  0.9277108434  0.7079365079  41.600000000  1.3778218269  0.2653427124  650           0.0507468843 
0.7420000000  0.6904761905  0.7280000000  0.6031746032  0.8750000000  0.8734939759  0.9337349398  0.9397590361  0.7015873016  44.800000000  1.3130380630  0.2653427124  700           0.0506112337 
0.7500000000  0.6746031746  0.7360000000  0.5873015873  0.8810240964  0.8734939759  0.9457831325  0.9518072289  0.7095238095  48.000000000  1.2865975070  0.2653427124  750           0.0498963022 
0.7400000000  0.6746031746  0.7040000000  0.5873015873  0.8810240964  0.8614457831  0.9759036145  0.9759036145  0.6968253968  51.200000000  1.2129706609  0.2653427124  800           0.0502011728 
0.8120000000  0.7380952381  0.7520000000  0.5873015873  0.8795180723  0.8674698795  0.9683734940  0.9698795181  0.7095238095  54.400000000  1.1831862259  0.2653427124  850           0.0506265068 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-06
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3253968254  0.3620000000  0.3174603175  0.5451807229  0.5421686747  0.5496987952  0.5240963855  0.3396825397  0.0000000000  0.5171928406  1.1402245760  0.0539793968  0             0.4500350952 
0.6160000000  0.6111111111  0.5080000000  0.5238095238  0.8810240964  0.8855421687  0.5090361446  0.5180722892  0.6492063492  3.2000000000  0.1906008482  0.9230827093  0.0604138374  50            0.1441571712 
0.6780000000  0.7142857143  0.6560000000  0.6825396825  0.8885542169  0.8433734940  0.7334337349  0.7409638554  0.6841269841  6.4000000000  0.2277852619  0.6758640695  0.0604138374  100           0.1534555292 
0.7400000000  0.7460317460  0.5880000000  0.5714285714  0.9608433735  0.9397590361  0.9578313253  0.9397590361  0.7825396825  9.6000000000  0.2081484878  0.5360568070  0.0604138374  150           0.1416439009 
0.7240000000  0.7619047619  0.7140000000  0.6746031746  0.7033132530  0.7289156627  0.6551204819  0.6445783133  0.6920634921  12.800000000  0.2143403745  0.5047326010  0.0604138374  200           0.1444689226 
0.7260000000  0.7063492063  0.7480000000  0.7301587302  0.8674698795  0.8433734940  0.7740963855  0.7831325301  0.5428571429  16.000000000  0.2298989272  0.4609863931  0.0604138374  250           0.1477456808 
0.9440000000  0.9126984127  0.8980000000  0.8650793651  0.9819277108  0.9759036145  0.9683734940  0.9698795181  0.6063492063  19.200000000  0.1999306661  0.3541663948  0.0604138374  300           0.1482047033 
0.9520000000  0.9365079365  0.8900000000  0.8809523810  0.9487951807  0.9156626506  0.9924698795  0.9819277108  0.6222222222  22.400000000  0.2172897398  0.2644060385  0.0604138374  350           0.1608788013 
0.9740000000  0.9206349206  0.9520000000  0.9285714286  0.9638554217  0.9518072289  0.9939759036  1.0000000000  0.5730158730  25.600000000  0.1921496868  0.2033266416  0.0604138374  400           0.1486654282 
0.9880000000  0.9444444444  0.9780000000  0.9206349206  0.9141566265  0.9216867470  0.9713855422  0.9457831325  0.4095238095  28.800000000  0.1532773082  0.1333165444  0.0604138374  450           0.1470475388 
0.9720000000  0.9444444444  0.9540000000  0.9206349206  0.9909638554  0.9638554217  0.9653614458  0.9698795181  0.4841269841  32.000000000  0.1381856780  0.0939259271  0.0604138374  500           0.1467350054 
0.9960000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3698412698  35.200000000  0.1198073827  0.0709913233  0.0604138374  550           0.1471590710 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 0.001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3253968254  0.3620000000  0.3174603175  0.5451807229  0.5421686747  0.5496987952  0.5240963855  0.3396825397  0.0000000000  0.5307328701  1.1402245760  0.0539793968  0             0.4449574947 
0.5860000000  0.6111111111  0.5740000000  0.6111111111  0.6400602410  0.6084337349  0.6867469880  0.6867469880  0.5650793651  3.2000000000  0.2064370918  0.9077325082  0.0604138374  50            0.1470734596 
0.7420000000  0.7619047619  0.6260000000  0.6746031746  0.8313253012  0.8072289157  0.9397590361  0.9036144578  0.7031746032  6.4000000000  0.3001446474  0.6909642732  0.0604138374  100           0.1447569752 
0.7500000000  0.8015873016  0.7360000000  0.7142857143  0.7138554217  0.6987951807  0.8900602410  0.8855421687  0.6619047619  9.6000000000  0.2569018614  0.5564811170  0.0604138374  150           0.1440432072 
0.8000000000  0.8015873016  0.7120000000  0.6666666667  0.9367469880  0.9518072289  0.8659638554  0.8493975904  0.7857142857  12.800000000  0.2382823837  0.4901993817  0.0604138374  200           0.1415246582 
0.7440000000  0.7142857143  0.7860000000  0.7539682540  0.8433734940  0.7710843373  0.8719879518  0.8855421687  0.5365079365  16.000000000  0.2605650151  0.4317847663  0.0604138374  250           0.1529407501 
0.8660000000  0.8174603175  0.9160000000  0.8492063492  0.9322289157  0.9096385542  0.9774096386  0.9698795181  0.5476190476  19.200000000  0.2192294145  0.3570265034  0.0604138374  300           0.1440814924 
0.9380000000  0.9126984127  0.9640000000  0.9523809524  0.9563253012  0.9337349398  0.9819277108  0.9759036145  0.3253968254  22.400000000  0.2360027617  0.2491633084  0.0604138374  350           0.1440189648 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 5
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 0.001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3500000000  0.3253968254  0.3560000000  0.3095238095  0.5737951807  0.5843373494  0.5617469880  0.5481927711  0.3428571429  0.0000000000  0.5596879721  1.1402245760  0.0539793968  0             0.3821151257 
0.6380000000  0.6825396825  0.5560000000  0.5714285714  0.6265060241  0.5783132530  0.8659638554  0.8373493976  0.5746031746  3.2000000000  0.1760161400  0.9652446342  0.0604138374  50            0.0842450571 
0.7120000000  0.7063492063  0.6880000000  0.6825396825  0.9698795181  0.9638554217  0.8554216867  0.8433734940  0.6952380952  6.4000000000  0.1870770240  0.6895692265  0.0604138374  100           0.0833828354 
0.7680000000  0.7539682540  0.6960000000  0.6507936508  0.7515060241  0.6807228916  0.7530120482  0.7710843373  0.5460317460  9.6000000000  0.2227355254  0.5316910762  0.0604138374  150           0.0868060923 
0.7640000000  0.7777777778  0.7240000000  0.6904761905  0.6656626506  0.6987951807  0.7454819277  0.7650602410  0.7444444444  12.800000000  0.2637433934  0.4797655737  0.0604138374  200           0.0870687819 
0.8880000000  0.8809523810  0.8060000000  0.7301587302  0.9472891566  0.9457831325  0.9246987952  0.9277108434  0.5904761905  16.000000000  0.2180751646  0.4289189345  0.0604138374  250           0.0830626440 
0.9560000000  0.9523809524  0.9220000000  0.9126984127  0.9427710843  0.9397590361  0.9864457831  0.9819277108  0.3587301587  19.200000000  0.2240717942  0.3465516299  0.0604138374  300           0.0836670637 
0.9680000000  0.9523809524  0.9600000000  0.9206349206  0.9849397590  0.9759036145  0.9894578313  0.9819277108  0.3507936508  22.400000000  0.2279184797  0.2348737216  0.0604138374  350           0.0849238300 
0.9800000000  0.9523809524  0.9300000000  0.8968253968  0.9879518072  0.9879518072  0.9924698795  0.9939759036  0.5666666667  25.600000000  0.2093499565  0.1919919679  0.0604138374  400           0.0851325512 
0.9660000000  0.9444444444  0.9680000000  0.9206349206  0.9804216867  0.9698795181  0.9969879518  1.0000000000  0.5063492063  28.800000000  0.1777465715  0.1505155374  0.0604138374  450           0.0833155537 
0.9940000000  0.9444444444  0.9640000000  0.9523809524  0.9969879518  0.9759036145  0.9698795181  0.9397590361  0.2095238095  32.000000000  0.1498692994  0.0967941293  0.0604138374  500           0.0850105333 
0.9980000000  0.9761904762  0.9900000000  0.9523809524  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.3301587302  35.200000000  0.1201148664  0.0615151910  0.0604138374  550           0.0864543533 
0.9960000000  0.9682539683  0.9960000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3142857143  38.400000000  0.0966081688  0.0373084687  0.0604138374  600           0.0827296591 
0.9920000000  0.9603174603  0.9940000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3222222222  41.600000000  0.0923236280  0.0480485240  0.0604138374  650           0.0821822596 
0.9780000000  0.9603174603  0.9980000000  0.9365079365  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.3746031746  44.800000000  0.0826135160  0.0299751225  0.0604138374  700           0.0842263269 
1.0000000000  0.9603174603  1.0000000000  0.9444444444  0.9969879518  1.0000000000  1.0000000000  1.0000000000  0.3841269841  48.000000000  0.0577806101  0.0160189991  0.0604138374  750           0.0834449005 
1.0000000000  0.9682539683  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3396825397  51.200000000  0.0457306604  0.0104974955  0.0604138374  800           0.0846961975 
1.0000000000  0.9841269841  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2031746032  54.400000000  0.0597641472  0.0117553120  0.0604138374  850           0.0849740124 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 0.001
	lr_iter: 10000
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3253968254  0.3620000000  0.3174603175  0.5451807229  0.5421686747  0.5496987952  0.5240963855  0.3396825397  0.0000000000  0.5307328701  1.1402245760  0.0539793968  0             0.4494383335 
0.5860000000  0.6111111111  0.5740000000  0.6111111111  0.6400602410  0.6084337349  0.6867469880  0.6867469880  0.5650793651  3.2000000000  0.2064370918  0.9077325082  0.0604138374  50            0.1602891588 
0.7420000000  0.7619047619  0.6260000000  0.6746031746  0.8313253012  0.8072289157  0.9397590361  0.9036144578  0.7031746032  6.4000000000  0.3001446474  0.6909642732  0.0604138374  100           0.1450407076 
0.7500000000  0.8015873016  0.7360000000  0.7142857143  0.7138554217  0.6987951807  0.8900602410  0.8855421687  0.6619047619  9.6000000000  0.2569018614  0.5564811170  0.0604138374  150           0.1438554668 
0.8000000000  0.8015873016  0.7120000000  0.6666666667  0.9367469880  0.9518072289  0.8659638554  0.8493975904  0.7857142857  12.800000000  0.2382823837  0.4901993817  0.0604138374  200           0.1483962727 
0.7440000000  0.7142857143  0.7860000000  0.7539682540  0.8433734940  0.7710843373  0.8719879518  0.8855421687  0.5365079365  16.000000000  0.2605650151  0.4317847663  0.0604138374  250           0.1510522652 
0.8660000000  0.8174603175  0.9160000000  0.8492063492  0.9322289157  0.9096385542  0.9774096386  0.9698795181  0.5476190476  19.200000000  0.2192294145  0.3570265034  0.0604138374  300           0.1506893969 
0.9380000000  0.9126984127  0.9640000000  0.9523809524  0.9563253012  0.9337349398  0.9819277108  0.9759036145  0.3253968254  22.400000000  0.2360027617  0.2491633084  0.0604138374  350           0.1417152214 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	groupdro_eta: 0.06
	lr: 0.001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3560000000  0.3412698413  0.3380000000  0.3333333333  0.3990963855  0.4156626506  0.3900602410  0.3674698795  0.3571428571  0.0000000000  1.1312252283  0.0521492958  0             0.3660619259 
0.7980000000  0.7380952381  0.7460000000  0.6984126984  0.9969879518  0.9879518072  0.9954819277  0.9939759036  0.4888888889  3.2000000000  0.4140796775  0.0584545135  50            0.0244071484 
0.9780000000  0.9285714286  0.9720000000  0.9285714286  0.9759036145  0.9638554217  0.9668674699  0.9759036145  0.5142857143  6.4000000000  0.1080714212  0.0584545135  100           0.0245520735 
0.9800000000  0.9365079365  0.9800000000  0.9444444444  0.9608433735  0.9277108434  0.8674698795  0.9036144578  0.5047619048  9.6000000000  0.0333633567  0.0584545135  150           0.0253495836 
0.8520000000  0.7777777778  0.8820000000  0.8809523810  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4380952381  12.800000000  0.0265752552  0.0584545135  200           0.0248189974 
0.9000000000  0.7936507937  0.9300000000  0.8730158730  0.9969879518  0.9879518072  0.9819277108  0.9879518072  0.4698412698  16.000000000  0.0221869221  0.0584545135  250           0.0251008797 
1.0000000000  0.9682539683  1.0000000000  0.9603174603  0.9427710843  0.9277108434  0.8463855422  0.8915662651  0.3380952381  19.200000000  0.0186826525  0.0584545135  300           0.0246166420 
0.9960000000  0.9761904762  0.9720000000  0.9365079365  0.9503012048  0.9216867470  0.8885542169  0.9156626506  0.3936507937  22.400000000  0.0095910541  0.0584545135  350           0.0247870445 
1.0000000000  0.9603174603  0.9980000000  0.9444444444  0.9578313253  0.9397590361  0.9382530120  0.9337349398  0.3793650794  25.600000000  0.0065322014  0.0584545135  400           0.0241555262 
0.9020000000  0.8253968254  0.8860000000  0.8809523810  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4333333333  28.800000000  0.0099937834  0.0584545135  450           0.0251710463 
1.0000000000  0.9603174603  0.9940000000  0.9682539683  0.9774096386  0.9698795181  0.9006024096  0.9277108434  0.4206349206  32.000000000  0.0075441930  0.0584545135  500           0.0247680187 
1.0000000000  0.9682539683  1.0000000000  0.9920634921  0.9879518072  0.9759036145  0.9216867470  0.9397590361  0.4142857143  35.200000000  0.0047193197  0.0584545135  550           0.0242339468 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  0.9924698795  0.9819277108  0.3333333333  38.400000000  0.0025867561  0.0584545135  600           0.0257516909 
1.0000000000  0.9761904762  1.0000000000  0.9682539683  0.9849397590  0.9759036145  0.9503012048  0.9578313253  0.3825396825  41.600000000  0.0084957646  0.0584545135  650           0.0234569740 
1.0000000000  0.9603174603  1.0000000000  0.9682539683  0.9939759036  0.9879518072  0.9623493976  0.9819277108  0.4015873016  44.800000000  0.0083846425  0.0584545135  700           0.0245342398 
0.9940000000  0.9761904762  0.9780000000  0.9047619048  0.8599397590  0.8734939759  0.8870481928  0.8975903614  0.2857142857  48.000000000  0.0031532708  0.0584545135  750           0.0252635908 
0.9920000000  0.9761904762  0.9740000000  0.9126984127  0.9186746988  0.9156626506  0.9292168675  0.9096385542  0.2809523810  51.200000000  0.0162153843  0.0584545135  800           0.0244472647 
0.9900000000  0.9523809524  0.9780000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4031746032  54.400000000  0.0139933784  0.0584545135  850           0.0249893522 
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 201
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3253968254  0.3620000000  0.3174603175  0.5451807229  0.5421686747  0.5496987952  0.5240963855  0.3396825397  0.0000000000  0.5173771381  1.1402245760  0.0539793968  0             0.4388504028 
0.5240000000  0.5317460317  0.5700000000  0.5793650794  0.8599397590  0.8493975904  0.8147590361  0.8253012048  0.5349206349  3.2000000000  0.1756491709  0.9184266794  0.0604138374  50            0.1420273447 
0.6160000000  0.6666666667  0.6160000000  0.6746031746  0.8373493976  0.7831325301  0.9563253012  0.9337349398  0.6539682540  6.4000000000  0.2127940714  0.6524300408  0.0604138374  100           0.1434918880 
0.7700000000  0.7936507937  0.6880000000  0.6666666667  0.9111445783  0.9096385542  0.9292168675  0.9457831325  0.7936507937  9.6000000000  0.2139558542  0.5434176320  0.0604138374  150           0.1425613451 
0.7720000000  0.7936507937  0.7260000000  0.6825396825  0.7605421687  0.7168674699  0.6671686747  0.6686746988  0.7174603175  12.800000000  0.2003829730  0.4779676771  0.0604138374  200           0.1419717646 
0.8340000000  0.7777777778  0.8000000000  0.6904761905  0.9789156627  0.9879518072  0.9759036145  0.9759036145  0.6063492063  16.000000000  0.2028900683  0.4256669950  0.0604138374  250           0.1461510372 
0.8600000000  0.8015873016  0.8320000000  0.7222222222  0.9789156627  0.9879518072  0.9608433735  0.9397590361  0.6904761905  19.200000000  0.1667358220  0.4141631138  0.0604138374  300           0.1457695580 
0.8800000000  0.8571428571  0.8560000000  0.7380952381  0.9774096386  0.9819277108  0.9849397590  0.9759036145  0.6825396825  22.400000000  0.1615296805  0.3991738296  0.0604138374  350           0.1418548727 
0.9080000000  0.8809523810  0.8720000000  0.8095238095  0.9819277108  0.9879518072  0.9954819277  0.9819277108  0.7095238095  25.600000000  0.1512047207  0.3881119406  0.0604138374  400           0.1448403502 
0.9260000000  0.8650793651  0.9040000000  0.8412698413  0.9743975904  0.9819277108  0.9909638554  0.9879518072  0.5841269841  28.800000000  0.1713650060  0.3571661937  0.0604138374  450           0.1500967121 
0.9480000000  0.8730158730  0.9460000000  0.8968253968  0.9909638554  0.9879518072  0.9774096386  0.9698795181  0.4396825397  32.000000000  0.1600196034  0.3395353884  0.0604138374  500           0.1468323851 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 15
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 201
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3333333333  0.3600000000  0.3174603175  0.5271084337  0.5301204819  0.5512048193  0.5180722892  0.3412698413  0.0000000000  0.4513552189  1.1402245760  0.0539793968  0             0.5113992691 
0.5220000000  0.5158730159  0.5880000000  0.6111111111  0.7605421687  0.6927710843  0.8463855422  0.8433734940  0.5269841270  3.2000000000  0.1905383563  0.9134056139  0.0604138374  50            0.2179531479 
0.5340000000  0.5952380952  0.6000000000  0.6111111111  0.8328313253  0.8493975904  0.9834337349  0.9819277108  0.5428571429  6.4000000000  0.2191180205  0.6820532036  0.0604138374  100           0.2073316956 
0.7660000000  0.7777777778  0.6800000000  0.6349206349  0.9171686747  0.9216867470  0.8915662651  0.8915662651  0.7650793651  9.6000000000  0.2069854605  0.5576868063  0.0604138374  150           0.2187916803 
0.7460000000  0.7698412698  0.6860000000  0.6507936508  0.6731927711  0.6927710843  0.7439759036  0.7349397590  0.6984126984  12.800000000  0.1791396403  0.5023320740  0.0604138374  200           0.2165245390 
0.7980000000  0.7460317460  0.7920000000  0.7142857143  0.9608433735  0.9156626506  0.9653614458  0.9578313253  0.5920634921  16.000000000  0.1907131267  0.4561929500  0.0604138374  250           0.2170925617 
0.8300000000  0.8253968254  0.8080000000  0.7619047619  0.9683734940  0.9457831325  0.9698795181  0.9638554217  0.4952380952  19.200000000  0.1410014021  0.4447978801  0.0604138374  300           0.2053623533 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 8
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 201
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3460000000  0.3412698413  0.3440000000  0.3412698413  0.6701807229  0.6204819277  0.4533132530  0.4638554217  0.3523809524  0.0000000000  0.4658387899  1.1380815506  0.0539793968  0             0.4265644550 
0.7280000000  0.7539682540  0.6560000000  0.6984126984  0.8117469880  0.8012048193  0.7018072289  0.7228915663  0.5650793651  3.2000000000  0.2329429460  0.8312391591  0.0604138374  50            0.1207611656 
0.7300000000  0.8015873016  0.7360000000  0.7301587302  0.7951807229  0.7831325301  0.8599397590  0.8493975904  0.6523809524  6.4000000000  0.2512622464  0.5909649861  0.0604138374  100           0.1219551229 
0.7920000000  0.7619047619  0.7880000000  0.7857142857  0.9518072289  0.9518072289  0.9593373494  0.9096385542  0.6238095238  9.6000000000  0.2313555741  0.5175139636  0.0604138374  150           0.1228144169 
0.7320000000  0.7380952381  0.7340000000  0.6507936508  0.9518072289  0.8915662651  0.8237951807  0.7891566265  0.5888888889  12.800000000  0.2315778273  0.4279921293  0.0604138374  200           0.1180488682 
0.8880000000  0.8968253968  0.8980000000  0.8253968254  0.9728915663  0.9638554217  0.8780120482  0.8614457831  0.4253968254  16.000000000  0.1865174937  0.3863745648  0.0604138374  250           0.1204687786 
0.9460000000  0.9523809524  0.9000000000  0.8253968254  0.9533132530  0.9337349398  0.9774096386  0.9578313253  0.3158730159  19.200000000  0.1983934677  0.3437888640  0.0604138374  300           0.1205791235 
0.9560000000  0.9682539683  0.9160000000  0.8412698413  0.9834337349  0.9698795181  0.9804216867  0.9578313253  0.4317460317  22.400000000  0.2235470259  0.2864093721  0.0604138374  350           0.1202589655 
0.9780000000  0.9603174603  0.9540000000  0.8809523810  0.9623493976  0.9096385542  0.9924698795  0.9939759036  0.4873015873  25.600000000  0.1736822438  0.2575041503  0.0604138374  400           0.1191584396 
0.9920000000  0.9761904762  0.9580000000  0.8888888889  0.9909638554  0.9759036145  0.9939759036  0.9759036145  0.4682539683  28.800000000  0.1950662228  0.2151628104  0.0604138374  450           0.1175688219 
0.9940000000  0.9761904762  0.9440000000  0.8412698413  0.9909638554  1.0000000000  0.9879518072  0.9638554217  0.2365079365  32.000000000  0.1931690988  0.1917138183  0.0604138374  500           0.1177008247 
0.9920000000  0.9761904762  0.9700000000  0.8730158730  0.9849397590  0.9879518072  0.9954819277  0.9819277108  0.4619047619  35.200000000  0.1735273749  0.1637265611  0.0604138374  550           0.1200713158 
0.9940000000  0.9841269841  0.9560000000  0.8412698413  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3158730159  38.400000000  0.1679104397  0.1413458970  0.0604138374  600           0.1195340776 
0.9960000000  0.9761904762  0.9720000000  0.8730158730  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.2698412698  41.600000000  0.1663336006  0.1252706495  0.0604138374  650           0.1183927393 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 11
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 201
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3440000000  0.3412698413  0.3420000000  0.3412698413  0.6536144578  0.6024096386  0.4442771084  0.4518072289  0.3523809524  0.0000000000  0.5583988428  1.1380815506  0.0539793968  0             0.4872305393 
0.6780000000  0.7063492063  0.6400000000  0.6666666667  0.7650602410  0.6987951807  0.7996987952  0.8012048193  0.5666666667  3.2000000000  0.1928835464  0.8609593439  0.0604138374  50            0.1561808825 
0.8440000000  0.8174603175  0.7700000000  0.7698412698  0.8012048193  0.7831325301  0.9533132530  0.9457831325  0.4476190476  6.4000000000  0.2912698483  0.5843452060  0.0604138374  100           0.1569272041 
0.7300000000  0.6904761905  0.7240000000  0.6349206349  0.9096385542  0.8795180723  0.9939759036  0.9879518072  0.6825396825  9.6000000000  0.2385787070  0.5081329948  0.0604138374  150           0.1538652229 
0.7820000000  0.8174603175  0.8280000000  0.8015873016  0.9171686747  0.9096385542  0.9623493976  0.9096385542  0.5793650794  12.800000000  0.2037046731  0.4608198029  0.0604138374  200           0.1519056749 
0.9080000000  0.8888888889  0.9040000000  0.8253968254  0.9864457831  0.9819277108  0.9533132530  0.8975903614  0.5476190476  16.000000000  0.1729462838  0.4116961205  0.0604138374  250           0.1601498270 
0.9380000000  0.9206349206  0.9100000000  0.8253968254  0.9698795181  0.9638554217  0.9789156627  0.9759036145  0.3920634921  19.200000000  0.1720601559  0.3802961832  0.0604138374  300           0.1539021301 
0.9700000000  0.9603174603  0.9400000000  0.8650793651  0.9743975904  0.9698795181  0.9924698795  0.9819277108  0.5444444444  22.400000000  0.1773277962  0.3373506880  0.0604138374  350           0.1633171225 
0.9680000000  0.9444444444  0.9340000000  0.8253968254  0.9743975904  0.9578313253  0.9984939759  0.9939759036  0.5730158730  25.600000000  0.1614783901  0.3116719839  0.0604138374  400           0.1557321548 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 201
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3200000000  0.3333333333  0.3360000000  0.3253968254  0.3358433735  0.3313253012  0.3343373494  0.3373493976  0.3444444444  0.0000000000  0.3203234673  1.1380815506  0.0539793968  0             0.4760167599 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1969, in update
    self.adv_opt.zero_grad()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/optim/optimizer.py", line 206, in zero_grad
    with torch.autograd.profiler.record_function(self._zero_grad_profile_name):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/profiler.py", line 616, in __enter__
    self.handle = torch.ops.profiler._record_function_enter(self.name)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3200000000  0.3333333333  0.3360000000  0.3253968254  0.3358433735  0.3313253012  0.3343373494  0.3373493976  0.3444444444  0.0000000000  0.3203234673  1.1380815506  0.0539793968  0             0.4499220848 
0.3860000000  0.3888888889  0.4020000000  0.3888888889  0.4623493976  0.4638554217  0.4141566265  0.4397590361  0.4222222222  3.2000000000  0.1638490605  1.0962319636  0.0604138374  50            0.1511940956 
0.4480000000  0.4365079365  0.4380000000  0.4365079365  0.6114457831  0.5662650602  0.5301204819  0.5421686747  0.4317460317  6.4000000000  0.1196897888  1.0675963473  0.0604138374  100           0.1375630283 
0.5140000000  0.4603174603  0.4980000000  0.4761904762  0.6129518072  0.6204819277  0.5060240964  0.5180722892  0.4412698413  9.6000000000  0.1259655571  1.0524104929  0.0604138374  150           0.1422188520 
0.5140000000  0.4920634921  0.4780000000  0.4682539683  0.6054216867  0.6144578313  0.5783132530  0.5783132530  0.4206349206  12.800000000  0.1070432544  1.0420644236  0.0604138374  200           0.1417443514 
0.5580000000  0.5079365079  0.5100000000  0.5238095238  0.7484939759  0.7289156627  0.7560240964  0.7228915663  0.4222222222  16.000000000  0.1231468797  1.0315756345  0.0604138374  250           0.1492449665 
0.6380000000  0.5714285714  0.5600000000  0.5238095238  0.6656626506  0.6506024096  0.6912650602  0.6807228916  0.4460317460  19.200000000  0.1293115044  1.0137161601  0.0604138374  300           0.1426012850 
0.7420000000  0.6507936508  0.6280000000  0.5714285714  0.7394578313  0.7409638554  0.7756024096  0.7650602410  0.4460317460  22.400000000  0.1183153415  0.9938857090  0.0604138374  350           0.1410936642 
0.6880000000  0.6269841270  0.6140000000  0.5873015873  0.7530120482  0.7228915663  0.8253012048  0.7831325301  0.4365079365  25.600000000  0.1141765952  0.9882293582  0.0604138374  400           0.1493410206 
0.6840000000  0.6111111111  0.6020000000  0.5634920635  0.7545180723  0.7168674699  0.8478915663  0.8132530120  0.4365079365  28.800000000  0.1043272281  0.9704839802  0.0604138374  450           0.1567727566 
0.7260000000  0.6587301587  0.6600000000  0.5634920635  0.7168674699  0.6746987952  0.8569277108  0.8132530120  0.4650793651  32.000000000  0.1190507221  0.9570284736  0.0604138374  500           0.1475189018 
0.6480000000  0.5793650794  0.6040000000  0.5079365079  0.6731927711  0.6445783133  0.8358433735  0.7771084337  0.4888888889  35.200000000  0.1152015138  0.9417307079  0.0604138374  550           0.1413289118 
0.7700000000  0.7460317460  0.7060000000  0.5634920635  0.8057228916  0.8012048193  0.8539156627  0.8373493976  0.4619047619  38.400000000  0.1264727616  0.9156484163  0.0604138374  600           0.1424576473 
0.7680000000  0.7301587302  0.7440000000  0.6349206349  0.8825301205  0.8433734940  0.8433734940  0.8313253012  0.4746031746  41.600000000  0.1341659069  0.8970117068  0.0604138374  650           0.1424918079 
0.7260000000  0.6746031746  0.6940000000  0.6111111111  0.8780120482  0.8614457831  0.9367469880  0.8795180723  0.4666666667  44.800000000  0.1439159393  0.8736007822  0.0604138374  700           0.1452653456 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 286, in forward
    x = self.layer3(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 263, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 260, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3940000000  0.3809523810  0.3480000000  0.4206349206  0.3569277108  0.3192771084  0.4563253012  0.4518072289  0.4238095238  0.0000000000  0.2222423553  1.1380815506  0.0563254356  0             0.4776365757 
0.4420000000  0.4285714286  0.4420000000  0.4603174603  0.5256024096  0.5240963855  0.6475903614  0.6385542169  0.3793650794  3.2000000000  0.1338679528  1.0622735429  0.0604138374  50            0.1517386770 
0.6800000000  0.6428571429  0.5920000000  0.5634920635  0.7936746988  0.7771084337  0.7439759036  0.7228915663  0.5000000000  6.4000000000  0.1176901531  1.0044870269  0.0604138374  100           0.1418619013 
0.6860000000  0.6746031746  0.6460000000  0.5714285714  0.8117469880  0.8132530120  0.8463855422  0.8313253012  0.5047619048  9.6000000000  0.1396605659  0.9206298876  0.0604138374  150           0.1425143766 
0.6840000000  0.6507936508  0.6820000000  0.6349206349  0.9141566265  0.9457831325  0.8945783133  0.8674698795  0.4761904762  12.800000000  0.1522512102  0.8132315660  0.0604138374  200           0.1421198320 
0.7500000000  0.7063492063  0.7140000000  0.6666666667  0.8915662651  0.8554216867  0.9367469880  0.9156626506  0.5079365079  16.000000000  0.1912782860  0.7100018680  0.0604138374  250           0.1394408941 
0.8280000000  0.7857142857  0.7820000000  0.7142857143  0.9021084337  0.8614457831  0.9503012048  0.9337349398  0.4634920635  19.200000000  0.1862605679  0.6199855888  0.0604138374  300           0.1422126055 
0.8700000000  0.8650793651  0.8140000000  0.7142857143  0.9367469880  0.9156626506  0.9186746988  0.9277108434  0.5031746032  22.400000000  0.2218014050  0.5582012284  0.0604138374  350           0.1440823650 
0.7980000000  0.8174603175  0.8040000000  0.6666666667  0.9487951807  0.9277108434  0.9743975904  0.9698795181  0.4809523810  25.600000000  0.2149333751  0.5269296122  0.0604138374  400           0.1454317427 
0.8560000000  0.7777777778  0.7940000000  0.7222222222  0.9487951807  0.9036144578  0.9743975904  0.9819277108  0.5031746032  28.800000000  0.2321143854  0.4745969504  0.0604138374  450           0.1468515539 
0.9300000000  0.9365079365  0.8540000000  0.7936507937  0.9668674699  0.9277108434  0.9277108434  0.9156626506  0.4412698413  32.000000000  0.2190364468  0.4441369843  0.0604138374  500           0.1545018530 
0.9080000000  0.8888888889  0.8240000000  0.7539682540  0.9141566265  0.8855421687  0.9924698795  0.9939759036  0.4539682540  35.200000000  0.2104781079  0.4168298095  0.0604138374  550           0.1543688869 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1970, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1938, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/networks.py", line 289, in forward
    x = self.layer5(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/linear.py", line 94, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1753, in linear
    return torch._C._nn.linear(input, weight, bias)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3520000000  0.3571428571  0.3660000000  0.3492063492  0.6219879518  0.5963855422  0.5707831325  0.5361445783  0.3746031746  0.0000000000  0.2882378101  1.1390783787  0.0539793968  0             0.4618327618 
0.5980000000  0.5952380952  0.6260000000  0.6904761905  0.8825301205  0.8313253012  0.8524096386  0.8313253012  0.4761904762  3.2000000000  0.1964716220  0.8683650839  0.0604138374  50            0.1395222425 
0.8040000000  0.8253968254  0.7840000000  0.7857142857  0.8192771084  0.7710843373  0.9111445783  0.8975903614  0.5079365079  6.4000000000  0.2775510776  0.6001405907  0.0604138374  100           0.1400312853 
0.7820000000  0.8095238095  0.7760000000  0.7698412698  0.9638554217  0.9518072289  0.9231927711  0.9216867470  0.5063492063  9.6000000000  0.2536882281  0.5099256074  0.0604138374  150           0.1469262505 
0.9560000000  0.9682539683  0.8780000000  0.8492063492  0.9111445783  0.8855421687  0.9834337349  0.9819277108  0.3857142857  12.800000000  0.2193585694  0.4135908222  0.0604138374  200           0.1536575222 
0.8460000000  0.8571428571  0.8920000000  0.8095238095  0.9698795181  0.9518072289  0.9096385542  0.8915662651  0.4650793651  16.000000000  0.2240048826  0.3348268878  0.0604138374  250           0.1521810770 
0.9660000000  0.9682539683  0.9740000000  0.8968253968  0.9668674699  0.9518072289  0.9864457831  0.9819277108  0.5190476190  19.200000000  0.1987471509  0.2504575837  0.0604138374  300           0.1422605276 
0.9960000000  1.0000000000  0.9700000000  0.8809523810  0.9743975904  0.9457831325  0.9909638554  0.9879518072  0.5190476190  22.400000000  0.1905665889  0.1636559030  0.0604138374  350           0.1381346893 
0.9980000000  1.0000000000  0.9860000000  0.9126984127  0.9954819277  0.9819277108  1.0000000000  1.0000000000  0.5682539683  25.600000000  0.1327410021  0.1005210567  0.0604138374  400           0.1393519306 
0.9900000000  1.0000000000  0.9780000000  0.8730158730  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5825396825  28.800000000  0.1161775818  0.0653149689  0.0604138374  450           0.1486450577 
1.0000000000  1.0000000000  0.9940000000  0.9047619048  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.2571428571  32.000000000  0.1030865399  0.0471817823  0.0604138374  500           0.1445409679 
1.0000000000  1.0000000000  0.9820000000  0.8809523810  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4857142857  35.200000000  0.0594794059  0.0255106535  0.0604138374  550           0.1548891592 
1.0000000000  1.0000000000  0.9980000000  0.9206349206  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3396825397  38.400000000  0.0664014798  0.0214480254  0.0604138374  600           0.1486998558 
1.0000000000  1.0000000000  1.0000000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3174603175  41.600000000  0.0557726546  0.0169549538  0.0604138374  650           0.1437267733 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/multiprocessing/reductions.py", line 282, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 487, in Client
    c = SocketClient(address)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 614, in SocketClient
    s.connect(address)
KeyboardInterrupt
trails: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 0.0008
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3420000000  0.3333333333  0.5195783133  0.5240963855  0.4849397590  0.4939759036  0.3539682540  0.0000000000  7.6442675591  1.1390783787  0.0539793968  0             0.4718642235 
0.6860000000  0.6746031746  0.6220000000  0.6825396825  0.6641566265  0.6686746988  0.7786144578  0.7771084337  0.4952380952  3.2000000000  0.2271473217  1.0659501386  0.0604138374  50            0.1550419474 
0.6360000000  0.6904761905  0.6020000000  0.7142857143  0.7710843373  0.7469879518  0.9503012048  0.9578313253  0.5015873016  6.4000000000  0.2098755693  0.7778425586  0.0604138374  100           0.1466404200 
0.7340000000  0.8095238095  0.6900000000  0.6666666667  0.6174698795  0.6144578313  0.6295180723  0.6626506024  0.5365079365  9.6000000000  0.2313938904  0.6512531483  0.0604138374  150           0.1464413834 
0.8160000000  0.8333333333  0.7920000000  0.8174603175  0.7078313253  0.7469879518  0.8689759036  0.8132530120  0.4825396825  12.800000000  0.2603824854  0.5505055940  0.0604138374  200           0.1475563240 
0.7480000000  0.7619047619  0.6720000000  0.6904761905  0.7243975904  0.7048192771  0.6099397590  0.6325301205  0.4111111111  16.000000000  0.2509079742  0.5142946672  0.0604138374  250           0.1488174629 
0.7640000000  0.8095238095  0.6820000000  0.6428571429  0.7740963855  0.7831325301  0.9292168675  0.9096385542  0.4158730159  19.200000000  0.2064413726  0.5060868192  0.0604138374  300           0.1469987297 
0.6880000000  0.6825396825  0.6960000000  0.6746031746  0.6626506024  0.7108433735  0.8840361446  0.8855421687  0.5904761905  22.400000000  0.2452995992  0.4789595485  0.0604138374  350           0.1439398050 
0.8220000000  0.8412698413  0.8060000000  0.7222222222  0.7816265060  0.7771084337  0.9066265060  0.8915662651  0.5111111111  25.600000000  0.2766348636  0.4745545673  0.0604138374  400           0.1526919889 
0.8000000000  0.8492063492  0.7820000000  0.6904761905  0.8915662651  0.8674698795  0.9382530120  0.8975903614  0.4063492063  28.800000000  0.2586232209  0.4647768432  0.0604138374  450           0.1488590956 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1971, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: FC
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 0.0005
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py:418: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.
  if param.grad is not None:
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3400000000  0.3333333333  0.3360000000  0.3333333333  0.2981927711  0.3132530120  0.4111445783  0.4036144578  0.3428571429  0.0000000000  3.4443881512  0.1006202698  0             0.3928208351 
0.9200000000  0.9444444444  0.7900000000  0.7539682540  0.9894578313  0.9819277108  0.9156626506  0.9156626506  0.4253968254  3.2000000000  1.4970257515  0.2653427124  50            0.0538122368 
1.0000000000  0.9841269841  0.8920000000  0.8492063492  0.9909638554  0.9879518072  0.9728915663  0.9759036145  0.4650793651  6.4000000000  0.4499553226  0.2653427124  100           0.0535105467 
0.9960000000  1.0000000000  0.8280000000  0.8015873016  1.0000000000  1.0000000000  0.9834337349  0.9819277108  0.4380952381  9.6000000000  0.2027381428  0.2653427124  150           0.0513534832 
0.9960000000  0.9841269841  0.9020000000  0.8571428571  0.9864457831  0.9698795181  0.9864457831  0.9819277108  0.4301587302  12.800000000  0.1767722243  0.2653427124  200           0.0550663662 
0.9960000000  0.9841269841  0.9700000000  0.8809523810  0.9849397590  0.9638554217  0.9457831325  0.9518072289  0.4841269841  16.000000000  0.1947118220  0.2653427124  250           0.0527456713 
1.0000000000  1.0000000000  0.9580000000  0.8492063492  0.9728915663  0.9638554217  0.8765060241  0.9277108434  0.4206349206  19.200000000  0.2535665524  0.2653427124  300           0.0507679605 
1.0000000000  0.9761904762  0.9380000000  0.8650793651  1.0000000000  1.0000000000  0.9969879518  1.0000000000  0.4349206349  22.400000000  0.1303788497  0.2653427124  350           0.0515813160 
1.0000000000  0.9920634921  0.9900000000  0.8730158730  0.9969879518  0.9879518072  0.9743975904  0.9698795181  0.4698412698  25.600000000  0.0869135370  0.2653427124  400           0.0523464584 
1.0000000000  1.0000000000  0.9940000000  0.8730158730  0.9683734940  0.9096385542  0.8719879518  0.8975903614  0.3809523810  28.800000000  0.0542012167  0.2653427124  450           0.0505200338 
1.0000000000  1.0000000000  0.9820000000  0.8888888889  1.0000000000  1.0000000000  0.9969879518  1.0000000000  0.4476190476  32.000000000  0.0319131223  0.2653427124  500           0.0503979588 
trails: 0
Args:
	algorithm: FC
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	beta: 1.0
	class_balanced: False
	data_augmentation: True
	heldout_p: 100
	lr: 0.00018486359452623148
	lr_omega: 0.0005
	meta_step: 1
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0008
Load Data.
data 4
Start Training.
/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py:418: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.
  if param.grad is not None:
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.4580000000  0.4761904762  0.4320000000  0.4603174603  0.4141566265  0.4036144578  0.4804216867  0.4879518072  0.4095238095  0.0000000000  3.4443881512  0.1006202698  0             0.3651752472 
0.8620000000  0.8809523810  0.7640000000  0.7539682540  0.8930722892  0.8734939759  0.9457831325  0.9518072289  0.4539682540  3.2000000000  2.0332840204  0.2653427124  50            0.0497171974 
0.9800000000  0.9761904762  0.7920000000  0.7857142857  0.8689759036  0.8734939759  0.7093373494  0.7409638554  0.4111111111  6.4000000000  0.8481648278  0.2653427124  100           0.0523507500 
0.9880000000  0.9841269841  0.7800000000  0.7380952381  0.9969879518  0.9879518072  0.9683734940  0.9337349398  0.4079365079  9.6000000000  0.4085992020  0.2653427124  150           0.0505352449 
0.9980000000  0.9920634921  0.8200000000  0.7936507937  1.0000000000  1.0000000000  0.9789156627  0.9638554217  0.3888888889  12.800000000  0.3162471712  0.2653427124  200           0.0503276968 
1.0000000000  0.9841269841  0.9520000000  0.8412698413  0.9984939759  0.9819277108  0.9894578313  0.9819277108  0.4571428571  16.000000000  0.2417885749  0.2653427124  250           0.0515857697 
0.9980000000  0.9682539683  0.9260000000  0.8253968254  0.9834337349  0.9457831325  1.0000000000  1.0000000000  0.4619047619  19.200000000  0.2133342912  0.2653427124  300           0.0527265120 
1.0000000000  0.9920634921  0.9800000000  0.8730158730  1.0000000000  1.0000000000  0.9819277108  0.9759036145  0.4507936508  22.400000000  0.1289365110  0.2653427124  350           0.0520496655 
1.0000000000  0.9920634921  0.9940000000  0.8809523810  0.9909638554  0.9759036145  0.9548192771  0.9518072289  0.4682539683  25.600000000  0.1222389211  0.2653427124  400           0.0514440775 
1.0000000000  1.0000000000  0.9400000000  0.8333333333  1.0000000000  1.0000000000  0.9924698795  0.9939759036  0.4095238095  28.800000000  0.0686995194  0.2653427124  450           0.0517909861 
1.0000000000  0.9920634921  0.9940000000  0.8809523810  1.0000000000  1.0000000000  0.9804216867  0.9698795181  0.4634920635  32.000000000  0.0573292056  0.2653427124  500           0.0514830542 
trails: 0
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.00018486359452623148
	mldg_beta: 0.2733254999483027
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 2.812885384798702e-06
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.4240000000  0.4365079365  0.3960000000  0.4206349206  0.3855421687  0.3493975904  0.4111445783  0.4036144578  0.3682539683  0.0000000000  1.4275736511  0.0312581062  0             0.3754343987 
0.3580000000  0.3571428571  0.3560000000  0.3650793651  0.3825301205  0.3855421687  0.5391566265  0.5421686747  0.3333333333  3.2000000000  0.7476676356  0.0354609489  50            0.0672742796 
0.5400000000  0.5476190476  0.4500000000  0.4603174603  0.4819277108  0.4939759036  0.5692771084  0.5542168675  0.3380952381  6.4000000000  0.2537660506  0.0354609489  100           0.0654699326 
0.6540000000  0.6507936508  0.5860000000  0.6190476190  0.6475903614  0.6385542169  0.6611445783  0.6566265060  0.4793650794  9.6000000000  0.1179344574  0.0354609489  150           0.0634555197 
0.6560000000  0.6507936508  0.5460000000  0.6111111111  0.5722891566  0.5662650602  0.6400602410  0.6204819277  0.4206349206  12.800000000  0.0742138526  0.0354609489  200           0.0622255468 
0.6660000000  0.6666666667  0.5820000000  0.6190476190  0.6430722892  0.6325301205  0.6641566265  0.6566265060  0.4444444444  16.000000000  0.0409896710  0.0354609489  250           0.0654742432 
0.6680000000  0.6666666667  0.6680000000  0.6428571429  0.6611445783  0.6566265060  0.6656626506  0.6626506024  0.5206349206  19.200000000  0.0336440257  0.0354609489  300           0.0623434925 
0.6680000000  0.6666666667  0.6540000000  0.6349206349  0.6415662651  0.6385542169  0.6641566265  0.6445783133  0.5063492063  22.400000000  0.0248982571  0.0354609489  350           0.0635562706 
0.6640000000  0.6666666667  0.6120000000  0.6190476190  0.5692771084  0.5662650602  0.6325301205  0.6144578313  0.4523809524  25.600000000  0.0175940477  0.0354609489  400           0.0657700157 
0.6660000000  0.6666666667  0.6320000000  0.6269841270  0.6129518072  0.6084337349  0.6611445783  0.6445783133  0.4793650794  28.800000000  0.0142947977  0.0354609489  450           0.0617828512 
0.6680000000  0.6666666667  0.6640000000  0.6428571429  0.6626506024  0.6626506024  0.6656626506  0.6626506024  0.4873015873  32.000000000  0.0107729964  0.0354609489  500           0.0641942024 
trails: 0
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 6
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 0.00018486359452623148
	mldg_beta: 0.2733254999483027
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 2.812885384798702e-06
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.4740000000  0.4365079365  0.4360000000  0.4444444444  0.3915662651  0.3855421687  0.3162650602  0.3253012048  0.3809523810  0.0000000000  1.4347232878  0.0312581062  0             0.3727762699 
0.5540000000  0.5158730159  0.4820000000  0.5158730159  0.5030120482  0.5060240964  0.5873493976  0.6024096386  0.4174603175  3.2000000000  0.6890781122  0.0354609489  50            0.0624030972 
0.6540000000  0.6428571429  0.6340000000  0.5793650794  0.6385542169  0.6385542169  0.6566265060  0.6506024096  0.4873015873  6.4000000000  0.2558965249  0.0354609489  100           0.0624846697 
0.6580000000  0.6428571429  0.6500000000  0.6269841270  0.6581325301  0.6566265060  0.6656626506  0.6506024096  0.4253968254  9.6000000000  0.1284423733  0.0354609489  150           0.0650987816 
0.6640000000  0.6507936508  0.6520000000  0.6269841270  0.6581325301  0.6445783133  0.6626506024  0.6626506024  0.4539682540  12.800000000  0.0812488766  0.0354609489  200           0.0616569662 
0.6640000000  0.6507936508  0.6520000000  0.6111111111  0.6641566265  0.6566265060  0.6656626506  0.6626506024  0.5047619048  16.000000000  0.0572565322  0.0354609489  250           0.0612089920 
0.6680000000  0.6666666667  0.6640000000  0.6428571429  0.6581325301  0.6566265060  0.6626506024  0.6506024096  0.3920634921  19.200000000  0.0356543428  0.0354609489  300           0.0678738880 
0.6620000000  0.6507936508  0.6300000000  0.5873015873  0.6370481928  0.6325301205  0.6611445783  0.6566265060  0.4904761905  22.400000000  0.0258490892  0.0354609489  350           0.0614063025 
0.6660000000  0.6507936508  0.6520000000  0.5873015873  0.6581325301  0.6566265060  0.6656626506  0.6626506024  0.4920634921  25.600000000  0.0160795930  0.0354609489  400           0.0638382912 
0.6660000000  0.6666666667  0.6640000000  0.6269841270  0.6656626506  0.6626506024  0.6656626506  0.6626506024  0.4222222222  28.800000000  0.0120854926  0.0354609489  450           0.0628736496 
0.6660000000  0.6666666667  0.6620000000  0.6269841270  0.6656626506  0.6626506024  0.6656626506  0.6626506024  0.4634920635  32.000000000  0.0099539687  0.0354609489  500           0.0690309525 
trails: 0
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 1921077036
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	class_balanced: False
	data_augmentation: True
	lr: 0.00018486359452623148
	mldg_beta: 0.2733254999483027
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.812885384798702e-06
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3809523810  0.4040000000  0.3968253968  0.3177710843  0.3313253012  0.3765060241  0.4457831325  0.3936507937  0.0000000000  1.4087518081  0.0293335915  0             0.3733747005 
0.3460000000  0.3571428571  0.3420000000  0.3571428571  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3460317460  2.7000000000  0.7128691724  0.0335364342  50            0.0637736702 
0.4120000000  0.4206349206  0.3680000000  0.3650793651  0.5828313253  0.5722891566  0.4728915663  0.4578313253  0.3698412698  5.4000000000  0.2787206101  0.0335364342  100           0.0626243973 
0.5820000000  0.5714285714  0.4820000000  0.4920634921  0.7424698795  0.7168674699  0.6671686747  0.6325301205  0.3984126984  8.1000000000  0.1497642757  0.0335364342  150           0.0614100218 
0.5040000000  0.4603174603  0.4000000000  0.4047619048  0.6174698795  0.6265060241  0.5677710843  0.5602409639  0.3873015873  10.800000000  0.0802192811  0.0335364342  200           0.0650993109 
0.5480000000  0.5079365079  0.4980000000  0.4682539683  0.6611445783  0.6566265060  0.6084337349  0.5662650602  0.5206349206  13.500000000  0.0558685339  0.0335364342  250           0.0679894686 
0.6460000000  0.6428571429  0.6040000000  0.6190476190  0.7289156627  0.7108433735  0.7289156627  0.6626506024  0.5984126984  16.200000000  0.0435177909  0.0335364342  300           0.0649151897 
0.6700000000  0.6666666667  0.6700000000  0.6666666667  0.5722891566  0.5903614458  0.6746987952  0.6265060241  0.6380952381  18.900000000  0.0293888794  0.0335364342  350           0.0649971962 
0.6680000000  0.6666666667  0.7160000000  0.6666666667  0.6219879518  0.6325301205  0.7003012048  0.6686746988  0.6253968254  21.600000000  0.0341280217  0.0335364342  400           0.0614289045 
0.6680000000  0.6666666667  0.6820000000  0.6666666667  0.5647590361  0.5843373494  0.7153614458  0.6566265060  0.6317460317  24.300000000  0.0177762125  0.0335364342  450           0.0653578949 
0.6560000000  0.6507936508  0.6320000000  0.6507936508  0.6400602410  0.6566265060  0.7243975904  0.6325301205  0.6126984127  27.000000000  0.0143810129  0.0335364342  500           0.0667155266 
trails: 0
Args:
	algorithm: MLDG
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 1921077036
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	class_balanced: False
	data_augmentation: True
	lr: 0.00018486359452623148
	mldg_beta: 0.2733254999483027
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.812885384798702e-06
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3740000000  0.3809523810  0.4040000000  0.3968253968  0.3177710843  0.3313253012  0.3765060241  0.4457831325  0.3936507937  0.0000000000  1.4087518081  0.0293335915  0             0.4437932968 
0.3460000000  0.3571428571  0.3420000000  0.3571428571  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3460317460  2.7000000000  0.7128691724  0.0335364342  50            0.0650450993 
0.4120000000  0.4206349206  0.3680000000  0.3650793651  0.5828313253  0.5722891566  0.4728915663  0.4578313253  0.3698412698  5.4000000000  0.2787206101  0.0335364342  100           0.0616966486 
0.5820000000  0.5714285714  0.4820000000  0.4920634921  0.7424698795  0.7168674699  0.6671686747  0.6325301205  0.3984126984  8.1000000000  0.1497642757  0.0335364342  150           0.0633892870 
0.5040000000  0.4603174603  0.4000000000  0.4047619048  0.6174698795  0.6265060241  0.5677710843  0.5602409639  0.3873015873  10.800000000  0.0802192811  0.0335364342  200           0.0624591017 
0.5480000000  0.5079365079  0.4980000000  0.4682539683  0.6611445783  0.6566265060  0.6084337349  0.5662650602  0.5206349206  13.500000000  0.0558685339  0.0335364342  250           0.0631047440 
0.6460000000  0.6428571429  0.6040000000  0.6190476190  0.7289156627  0.7108433735  0.7289156627  0.6626506024  0.5984126984  16.200000000  0.0435177909  0.0335364342  300           0.0632272720 
0.6700000000  0.6666666667  0.6700000000  0.6666666667  0.5722891566  0.5903614458  0.6746987952  0.6265060241  0.6380952381  18.900000000  0.0293888794  0.0335364342  350           0.0659111404 
0.6680000000  0.6666666667  0.7160000000  0.6666666667  0.6219879518  0.6325301205  0.7003012048  0.6686746988  0.6253968254  21.600000000  0.0341280217  0.0335364342  400           0.0660603333 
0.6680000000  0.6666666667  0.6820000000  0.6666666667  0.5647590361  0.5843373494  0.7153614458  0.6566265060  0.6317460317  24.300000000  0.0177762125  0.0335364342  450           0.0628310299 
0.6560000000  0.6507936508  0.6320000000  0.6507936508  0.6400602410  0.6566265060  0.7243975904  0.6325301205  0.6126984127  27.000000000  0.0143810129  0.0335364342  500           0.0631782770 
0.6700000000  0.6507936508  0.6420000000  0.6587301587  0.6611445783  0.6686746988  0.7319277108  0.6385542169  0.6158730159  29.700000000  0.0117738155  0.0335364342  550           0.0634615946 
0.6680000000  0.6666666667  0.6700000000  0.6666666667  0.5557228916  0.5602409639  0.5722891566  0.5903614458  0.6126984127  32.400000000  0.0115565640  0.0335364342  600           0.0647467756 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5572289157  0.5783132530  0.6204819277  0.6144578313  0.6396825397  35.100000000  0.0100737853  0.0335364342  650           0.0633094454 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5557228916  0.5722891566  0.6349206349  37.800000000  0.0095671027  0.0335364342  700           0.0624108839 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5722891566  0.5933734940  0.5903614458  0.6428571429  40.500000000  0.0075724126  0.0335364342  750           0.0629726505 
0.6680000000  0.6666666667  0.6900000000  0.6666666667  0.5753012048  0.5783132530  0.6280120482  0.6204819277  0.6301587302  43.200000000  0.0111411726  0.0335364342  800           0.0631258345 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.4563253012  0.4518072289  0.5195783133  0.5361445783  0.4095238095  45.900000000  0.0077254576  0.0335364342  850           0.0625284815 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5692771084  0.5903614458  0.6460317460  48.600000000  0.0044821032  0.0335364342  900           0.0630113411 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5225903614  0.5361445783  0.5527108434  0.5602409639  0.5047619048  51.300000000  0.0032429876  0.0335364342  950           0.0636375761 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.4367469880  0.4337349398  0.4804216867  0.4759036145  0.3936507937  54.000000000  0.0054910315  0.0335364342  1000          0.0652207947 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5557228916  0.5722891566  0.6222222222  56.700000000  0.0036849674  0.0335364342  1050          0.0651916075 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5557228916  0.5722891566  0.5903614458  0.5903614458  0.6444444444  59.400000000  0.0024734215  0.0335364342  1100          0.0652508783 
0.6680000000  0.6666666667  0.6700000000  0.6666666667  0.5466867470  0.5481927711  0.5587349398  0.5602409639  0.5587301587  62.100000000  0.0036064641  0.0335364342  1150          0.0652890873 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5557228916  0.5722891566  0.6114457831  0.6024096386  0.6460317460  64.800000000  0.0020144355  0.0335364342  1200          0.0639536285 
0.6680000000  0.6666666667  0.6620000000  0.6666666667  0.5557228916  0.5722891566  0.6310240964  0.5843373494  0.6428571429  67.500000000  0.0026329020  0.0335364342  1250          0.0640636206 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5617469880  0.5722891566  0.5936507937  70.200000000  0.0025362734  0.0335364342  1300          0.0640607786 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5617469880  0.5722891566  0.6047619048  72.900000000  0.0021062877  0.0335364342  1350          0.0628899717 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5527108434  0.5602409639  0.5707831325  0.5722891566  0.6349206349  75.600000000  0.0028224158  0.0335364342  1400          0.0623001623 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.5391566265  0.5421686747  0.5587349398  0.5602409639  0.5095238095  78.300000000  0.0036972934  0.0335364342  1450          0.0634317541 
0.6680000000  0.6666666667  0.6680000000  0.6666666667  0.4894578313  0.4879518072  0.5451807229  0.5542168675  0.4301587302  81.000000000  0.0016337708  0.0335364342  1500          0.0620158291 
trails: 0
Args:
	algorithm: FC
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 1921077036
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	beta: 0.21089057757054216
	class_balanced: False
	data_augmentation: True
	heldout_p: 0.29672674627824636
	lr: 0.00018486359452623148
	lr_omega: 0.0030320989088642196
	meta_step: 800
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	weight_decay: 2.812885384798702e-06
Load Data.
data 4
Start Training.
/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py:418: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.
  if param.grad is not None:
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         loss          mem_gb        step          step_time    
0.3860000000  0.4523809524  0.4120000000  0.4126984127  0.2575301205  0.2951807229  0.3027108434  0.3192771084  0.3920634921  0.0000000000  3.2278273106  0.0862493515  0             0.3620846272 
0.9380000000  0.9365079365  0.7880000000  0.8015873016  0.9081325301  0.9457831325  0.9186746988  0.9277108434  0.4015873016  2.7000000000  1.8673290920  0.2279167175  50            0.0519646072 
0.9940000000  0.9841269841  0.8500000000  0.8333333333  0.9457831325  0.9397590361  0.9021084337  0.8614457831  0.3746031746  5.4000000000  0.8468154454  0.2279167175  100           0.0525984144 
0.9900000000  0.9841269841  0.8500000000  0.7936507937  0.9969879518  0.9879518072  1.0000000000  0.9879518072  0.4142857143  8.1000000000  0.4809619644  0.2279167175  150           0.0518590736 
0.9940000000  1.0000000000  0.9620000000  0.8730158730  0.9698795181  0.9397590361  0.9503012048  0.9096385542  0.4682539683  10.800000000  0.3226128271  0.2279167175  200           0.0521142101 
0.9980000000  1.0000000000  0.9260000000  0.8809523810  0.9969879518  0.9879518072  0.9774096386  0.9698795181  0.4333333333  13.500000000  0.2670542651  0.2279167175  250           0.0519550610 
1.0000000000  1.0000000000  0.9480000000  0.8095238095  0.9969879518  1.0000000000  0.9969879518  0.9759036145  0.4523809524  16.200000000  0.1315676977  0.2279167175  300           0.0525855923 
1.0000000000  1.0000000000  0.9500000000  0.8253968254  0.9954819277  0.9939759036  0.9984939759  0.9819277108  0.4158730159  18.900000000  0.1066953446  0.2279167175  350           0.0524198627 
1.0000000000  1.0000000000  0.9780000000  0.8333333333  0.9849397590  0.9879518072  0.9939759036  0.9759036145  0.4539682540  21.600000000  0.0912249211  0.2279167175  400           0.0514457369 
1.0000000000  1.0000000000  0.9580000000  0.8095238095  1.0000000000  0.9879518072  1.0000000000  0.9879518072  0.4269841270  24.300000000  0.0843799684  0.2279167175  450           0.0505693150 
1.0000000000  1.0000000000  0.9720000000  0.8253968254  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4317460317  27.000000000  0.0697163316  0.2279167175  500           0.0526327896 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 2226, in update
    meta_train_loss_dg.backward(create_graph=True)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 6
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 1921077036
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 27
	class_balanced: False
	d_steps_per_g: 2
	data_augmentation: True
	delta: 2.1458260446338375
	gda: True
	lr: 0.00018486359452623148
	lr_d: 0.0009658011483823038
	lr_iter: 1750
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.1
	t_lambda: 0.018069222822422647
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.004128658159026448
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3760000000  0.4444444444  0.3940000000  0.4047619048  0.3087349398  0.2951807229  0.3644578313  0.3855421687  0.4158730159  0.0000000000  0.0013825141  1.1269991398  0.0460433960  0             0.3563694954 
0.3800000000  0.4365079365  0.3760000000  0.3888888889  0.3569277108  0.3313253012  0.3569277108  0.3554216867  0.3904761905  2.7000000000  0.0017421755  1.1296171474  0.0473690033  50            0.0469785833 
0.3800000000  0.4444444444  0.3820000000  0.3968253968  0.3659638554  0.3313253012  0.3569277108  0.3554216867  0.3904761905  5.4000000000  0.0017076984  1.1287303901  0.0473690033  100           0.0477090025 
0.3760000000  0.4365079365  0.3780000000  0.3968253968  0.3659638554  0.3313253012  0.3569277108  0.3554216867  0.3888888889  8.1000000000  0.0018180110  1.1277460217  0.0473690033  150           0.0472452450 
0.3800000000  0.4444444444  0.3840000000  0.3888888889  0.3554216867  0.3253012048  0.3554216867  0.3614457831  0.3888888889  10.800000000  0.0018391959  1.1236993742  0.0473690033  200           0.0465572643 
0.3780000000  0.4365079365  0.3800000000  0.3888888889  0.3614457831  0.3253012048  0.3569277108  0.3554216867  0.3888888889  13.500000000  0.0016848482  1.1287977576  0.0473690033  250           0.0531356764 
0.3780000000  0.4365079365  0.3820000000  0.3888888889  0.3629518072  0.3313253012  0.3569277108  0.3554216867  0.3873015873  16.200000000  0.0018186959  1.1303045654  0.0473690033  300           0.0489244127 
0.3800000000  0.4365079365  0.3780000000  0.3888888889  0.3629518072  0.3313253012  0.3569277108  0.3554216867  0.3873015873  18.900000000  0.0016330733  1.1277164221  0.0473690033  350           0.0468928385 
0.3800000000  0.4365079365  0.3800000000  0.3968253968  0.3674698795  0.3253012048  0.3599397590  0.3554216867  0.3904761905  21.600000000  0.0017448398  1.1283692193  0.0473690033  400           0.0503125334 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4220000000  0.4285714286  0.4200000000  0.4126984127  0.4307228916  0.4216867470  0.3975903614  0.3493975904  0.3920634921  0.0000000000  0.1656672955  1.1390783787  0.0563254356  0             0.4550609589 
0.6700000000  0.6746031746  0.6120000000  0.5793650794  0.7304216867  0.7168674699  0.7228915663  0.7228915663  0.3984126984  3.2000000000  0.1676231742  0.9686174405  0.0604138374  50            0.1495557261 
0.7060000000  0.7380952381  0.7420000000  0.7222222222  0.8117469880  0.7530120482  0.9638554217  0.9638554217  0.4682539683  6.4000000000  0.2180404305  0.7057227159  0.0604138374  100           0.1424991560 
0.7360000000  0.7539682540  0.7600000000  0.7301587302  0.9563253012  0.9337349398  0.9111445783  0.9096385542  0.5238095238  9.6000000000  0.2459663701  0.5662443882  0.0604138374  150           0.1457694674 
0.7460000000  0.7698412698  0.7340000000  0.6746031746  0.9021084337  0.8493975904  0.8870481928  0.8855421687  0.5619047619  12.800000000  0.2044426429  0.4943182439  0.0604138374  200           0.1385909891 
0.8820000000  0.8492063492  0.8740000000  0.7460317460  0.9262048193  0.9216867470  0.8840361446  0.8855421687  0.4317460317  16.000000000  0.2070493710  0.4323450571  0.0604138374  250           0.1502553463 
0.8180000000  0.8095238095  0.7680000000  0.6904761905  0.9638554217  0.9156626506  0.9578313253  0.9518072289  0.4682539683  19.200000000  0.2137275559  0.3765219033  0.0604138374  300           0.1472314501 
0.9060000000  0.8650793651  0.9340000000  0.7698412698  0.9774096386  0.9698795181  0.9774096386  0.9578313253  0.5428571429  22.400000000  0.2211116534  0.3164446121  0.0604138374  350           0.1455507374 
0.9880000000  0.9761904762  0.9540000000  0.8492063492  0.9683734940  0.9337349398  1.0000000000  1.0000000000  0.4714285714  25.600000000  0.2096048152  0.2632490355  0.0604138374  400           0.1417589331 
0.9940000000  0.9841269841  0.9600000000  0.8492063492  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.5126984127  28.800000000  0.2110600501  0.2024817765  0.0604138374  450           0.1487008429 
1.0000000000  1.0000000000  0.9620000000  0.8174603175  0.9984939759  0.9939759036  0.9638554217  0.9518072289  0.2984126984  32.000000000  0.1617138642  0.1516375209  0.0604138374  500           0.1549079227 
0.9980000000  0.9920634921  0.9600000000  0.8412698413  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.4888888889  35.200000000  0.1445219243  0.1126124957  0.0604138374  550           0.1610116816 
1.0000000000  1.0000000000  0.9760000000  0.8492063492  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4142857143  38.400000000  0.1335671796  0.0843852957  0.0604138374  600           0.1521929455 
1.0000000000  0.9920634921  0.9960000000  0.8968253968  0.9984939759  0.9819277108  0.9984939759  0.9939759036  0.3031746032  41.600000000  0.1195218369  0.0738593995  0.0604138374  650           0.1533553457 
1.0000000000  1.0000000000  0.9900000000  0.8650793651  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4365079365  44.800000000  0.0845729472  0.0529092216  0.0604138374  700           0.1522929955 
1.0000000000  1.0000000000  1.0000000000  0.9047619048  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4190476190  48.000000000  0.0807113191  0.0380713692  0.0604138374  750           0.1482781887 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1972, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1941, in loss_gap
    loss = F.cross_entropy(p, y)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 2693, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 2388, in nll_loss
    ret = torch._C._nn.nll_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4195804196  0.3984063745  0.4115884116  0.4023904382  0.5090361446  0.5542168675  0.6310240964  0.6325301205  0.3984126984  0.0000000000  0.1141326427  1.1302961111  0.0563254356  0             0.4918835163 
0.6723276723  0.6693227092  0.6653346653  0.6693227092  0.4262048193  0.4277108434  0.4698795181  0.4457831325  0.6269841270  2.4096385542  0.1775742722  0.9180821335  0.0604138374  50            0.1638919258 
0.6353646354  0.6135458167  0.6783216783  0.6135458167  0.9503012048  0.9337349398  0.9503012048  0.9216867470  0.6619047619  4.8192771084  0.2004043055  0.7136713159  0.0604138374  100           0.1521826601 
0.7562437562  0.7490039841  0.7662337662  0.7171314741  0.9879518072  0.9879518072  0.9352409639  0.9578313253  0.5317460317  7.2289156627  0.2288132226  0.5662545592  0.0604138374  150           0.1544016457 
0.7792207792  0.7848605578  0.7692307692  0.7091633466  0.9472891566  0.8975903614  0.9623493976  0.9698795181  0.4730158730  9.6385542169  0.2039151967  0.5058084333  0.0604138374  200           0.1530977154 
0.9090909091  0.9243027888  0.8621378621  0.8087649402  0.9804216867  0.9578313253  0.9864457831  0.9819277108  0.5349206349  12.048192771  0.2319542146  0.4561036634  0.0604138374  250           0.1416146994 
0.9130869131  0.8804780876  0.8691308691  0.7808764940  0.8689759036  0.8373493976  0.9759036145  0.9759036145  0.5984126984  14.457831325  0.2063019180  0.4282515693  0.0604138374  300           0.1543628359 
0.8791208791  0.8525896414  0.8501498501  0.8446215139  0.9683734940  0.9578313253  0.8689759036  0.8975903614  0.4349206349  16.867469879  0.2172259128  0.3789118081  0.0604138374  350           0.1506562090 
0.8991008991  0.8645418327  0.9180819181  0.8804780876  0.9924698795  0.9819277108  0.9849397590  0.9638554217  0.5253968254  19.277108433  0.2285943216  0.3244904655  0.0604138374  400           0.1485332870 
0.9630369630  0.9601593625  0.9560439560  0.9163346614  0.9472891566  0.8855421687  0.9909638554  0.9879518072  0.5714285714  21.686746988  0.1824359286  0.2571875355  0.0604138374  450           0.1503411865 
0.9940059940  0.9880478088  0.9630369630  0.9362549801  0.9608433735  0.9156626506  0.9894578313  0.9939759036  0.5349206349  24.096385542  0.1988609529  0.2189771637  0.0604138374  500           0.1559151125 
0.9680319680  0.9521912351  0.9440559441  0.8804780876  0.9969879518  1.0000000000  0.9984939759  0.9939759036  0.5936507937  26.506024096  0.1829683736  0.1795538083  0.0604138374  550           0.1457471323 
0.9880119880  0.9840637450  0.9790209790  0.9482071713  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5841269841  28.915662650  0.1363704273  0.1343536817  0.0604138374  600           0.1444512081 
0.9980019980  0.9960159363  0.9920079920  0.9521912351  0.9984939759  0.9939759036  0.9984939759  0.9819277108  0.6190476190  31.325301204  0.1470264971  0.0965115902  0.0604138374  650           0.1559161758 
0.9990009990  1.0000000000  0.9900099900  0.9282868526  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.5952380952  33.734939759  0.1157245889  0.0781426533  0.0604138374  700           0.1523149920 
0.9990009990  1.0000000000  0.9930069930  0.9243027888  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6063492063  36.144578313  0.0862085786  0.0575294013  0.0604138374  750           0.1413760996 
0.9960039960  0.9960159363  0.9980019980  0.9760956175  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5158730159  38.554216867  0.0773921842  0.0404171570  0.0604138374  800           0.1563465929 
0.9990009990  1.0000000000  0.9890109890  0.9362549801  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5761904762  40.963855421  0.0581203431  0.0316860025  0.0604138374  850           0.1449538422 
1.0000000000  1.0000000000  0.9890109890  0.9203187251  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5761904762  43.373493975  0.0575679408  0.0271270869  0.0604138374  900           0.1441286230 
1.0000000000  1.0000000000  1.0000000000  0.9721115538  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5523809524  45.783132530  0.0503124965  0.0217987226  0.0604138374  950           0.1463667917 
1.0000000000  1.0000000000  1.0000000000  0.9721115538  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5428571429  48.192771084  0.0447854027  0.0177312549  0.0604138374  1000          0.1503258228 
1.0000000000  1.0000000000  1.0000000000  0.9601593625  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5984126984  50.602409638  0.0326657977  0.0135644519  0.0604138374  1050          0.1528330183 
1.0000000000  1.0000000000  1.0000000000  0.9601593625  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5825396825  53.012048192  0.0279349382  0.0103900227  0.0604138374  1100          0.1594899368 
1.0000000000  1.0000000000  1.0000000000  0.9760956175  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4650793651  55.421686747  0.0190972978  0.0088452268  0.0604138374  1150          0.1501037073 
1.0000000000  1.0000000000  1.0000000000  0.9800796813  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5476190476  57.831325301  0.0418339687  0.0087793842  0.0604138374  1200          0.1470284462 
1.0000000000  1.0000000000  1.0000000000  0.9601593625  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5841269841  60.240963855  0.0201858408  0.0074462430  0.0604138374  1250          0.1481566381 
1.0000000000  1.0000000000  1.0000000000  0.9681274900  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5000000000  62.650602409  0.0144233142  0.0045325897  0.0604138374  1300          0.1554430294 
1.0000000000  1.0000000000  1.0000000000  0.9521912351  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5714285714  65.060240963  0.0169225846  0.0038099822  0.0604138374  1350          0.1559367275 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4220000000  0.4285714286  0.4200000000  0.4126984127  0.4307228916  0.4216867470  0.3975903614  0.3493975904  0.3920634921  0.0000000000  0.1656672955  1.1390783787  0.0563254356  0             0.4804353714 
0.6700000000  0.6746031746  0.6120000000  0.5793650794  0.7304216867  0.7168674699  0.7228915663  0.7228915663  0.3984126984  3.2000000000  0.1676231742  0.9686174405  0.0604138374  50            0.1528336716 
0.7060000000  0.7380952381  0.7420000000  0.7222222222  0.8117469880  0.7530120482  0.9638554217  0.9638554217  0.4682539683  6.4000000000  0.2180404305  0.7057227159  0.0604138374  100           0.1510768080 
0.7360000000  0.7539682540  0.7600000000  0.7301587302  0.9563253012  0.9337349398  0.9111445783  0.9096385542  0.5238095238  9.6000000000  0.2459663701  0.5662443882  0.0604138374  150           0.1503185558 
0.7460000000  0.7698412698  0.7340000000  0.6746031746  0.9021084337  0.8493975904  0.8870481928  0.8855421687  0.5619047619  12.800000000  0.2044426429  0.4943182439  0.0604138374  200           0.1494601440 
0.8820000000  0.8492063492  0.8740000000  0.7460317460  0.9262048193  0.9216867470  0.8840361446  0.8855421687  0.4317460317  16.000000000  0.2070493710  0.4323450571  0.0604138374  250           0.1447931767 
0.8180000000  0.8095238095  0.7680000000  0.6904761905  0.9638554217  0.9156626506  0.9578313253  0.9518072289  0.4682539683  19.200000000  0.2137275559  0.3765219033  0.0604138374  300           0.1535245419 
0.9060000000  0.8650793651  0.9340000000  0.7698412698  0.9774096386  0.9698795181  0.9774096386  0.9578313253  0.5428571429  22.400000000  0.2211116534  0.3164446121  0.0604138374  350           0.1469962883 
0.9880000000  0.9761904762  0.9540000000  0.8492063492  0.9683734940  0.9337349398  1.0000000000  1.0000000000  0.4714285714  25.600000000  0.2096048152  0.2632490355  0.0604138374  400           0.1478484201 
0.9940000000  0.9841269841  0.9600000000  0.8492063492  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.5126984127  28.800000000  0.2110600501  0.2024817765  0.0604138374  450           0.1483247375 
1.0000000000  1.0000000000  0.9620000000  0.8174603175  0.9984939759  0.9939759036  0.9638554217  0.9518072289  0.2984126984  32.000000000  0.1617138642  0.1516375209  0.0604138374  500           0.1471530628 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1977, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.5328842402  1.1761227846  0.1868000031  0             0.8592066765 
0.8540000000  0.8253968254  0.7860000000  0.7936507937  0.8900602410  0.8373493976  0.8403614458  0.8674698795  0.5222222222  3.2000000000  0.1875065625  0.7076409096  0.2336974144  50            0.5581402111 
0.9580000000  0.9841269841  0.8900000000  0.7698412698  0.9563253012  0.9216867470  0.8418674699  0.8132530120  0.4730158730  6.4000000000  0.1989596558  0.3673924574  0.2336974144  100           0.5236227846 
0.9840000000  0.9682539683  0.9680000000  0.8968253968  0.9819277108  0.9759036145  0.9909638554  0.9759036145  0.4047619048  9.6000000000  0.1953085233  0.1819285882  0.2336974144  150           0.5281745481 
0.9960000000  0.9920634921  0.9860000000  0.8888888889  0.9969879518  0.9879518072  0.9954819277  0.9819277108  0.3650793651  12.800000000  0.1216138843  0.0789726541  0.2336974144  200           0.5334937382 
1.0000000000  0.9920634921  0.9960000000  0.9126984127  0.9984939759  0.9819277108  1.0000000000  1.0000000000  0.5349206349  16.000000000  0.0728640442  0.0381753597  0.2336974144  250           0.5669741964 
1.0000000000  1.0000000000  0.9980000000  0.9365079365  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4396825397  19.200000000  0.0340974865  0.0166349777  0.2336974144  300           0.5748388767 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1983, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.2340044975  1.1761227846  0.1868000031  0             0.8480410576 
0.8320000000  0.7619047619  0.7900000000  0.7222222222  0.7936746988  0.6927710843  0.7906626506  0.7530120482  0.3984126984  3.2000000000  0.1436529517  0.9166507089  0.2336974144  50            0.5370423651 
0.9260000000  0.8888888889  0.8700000000  0.8095238095  0.8012048193  0.7228915663  0.7981927711  0.7951807229  0.4174603175  6.4000000000  0.1314734840  0.7200747871  0.2336974144  100           0.5377088690 
0.9560000000  0.9206349206  0.8940000000  0.8095238095  0.8719879518  0.8132530120  0.9036144578  0.8674698795  0.4444444444  9.6000000000  0.1856247497  0.5304418916  0.2336974144  150           0.5334977674 
0.9820000000  0.9603174603  0.9340000000  0.8571428571  0.9698795181  0.8915662651  0.8870481928  0.8734939759  0.4428571429  12.800000000  0.1554523098  0.3811627758  0.2336974144  200           0.5331728601 
0.9800000000  0.9523809524  0.9340000000  0.8174603175  0.9653614458  0.9096385542  0.9819277108  0.9638554217  0.4619047619  16.000000000  0.1828778857  0.2722676602  0.2336974144  250           0.5329915380 
0.9900000000  0.9841269841  0.9760000000  0.8333333333  0.9864457831  0.9698795181  0.9774096386  0.9578313253  0.4730158730  19.200000000  0.1704335022  0.1754037789  0.2336974144  300           0.5365290451 
0.9980000000  0.9920634921  0.9960000000  0.8809523810  0.9924698795  0.9698795181  0.9954819277  0.9939759036  0.4380952381  22.400000000  0.1179018199  0.1127958962  0.2336974144  350           0.5324099016 
1.0000000000  0.9920634921  0.9980000000  0.9285714286  0.9984939759  0.9698795181  1.0000000000  1.0000000000  0.2857142857  25.600000000  0.1104960053  0.0802888122  0.2336974144  400           0.5344513559 
0.9980000000  0.9841269841  0.9940000000  0.8571428571  0.9954819277  0.9578313253  1.0000000000  1.0000000000  0.5555555556  28.800000000  0.0825111730  0.0493402867  0.2336974144  450           0.5373920250 
1.0000000000  0.9841269841  1.0000000000  0.8968253968  0.9984939759  0.9578313253  1.0000000000  1.0000000000  0.4571428571  32.000000000  0.0684663720  0.0353909890  0.2336974144  500           0.5314470434 
1.0000000000  1.0000000000  1.0000000000  0.8650793651  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4158730159  35.200000000  0.0435637877  0.0184773414  0.2336974144  550           0.5201728535 
1.0000000000  0.9920634921  1.0000000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3666666667  38.400000000  0.0317065101  0.0138537611  0.2336974144  600           0.5310836935 
1.0000000000  0.9841269841  1.0000000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3349206349  41.600000000  0.0269370272  0.0102177780  0.2336974144  650           0.5388280869 
1.0000000000  0.9920634921  1.0000000000  0.8730158730  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4603174603  44.800000000  0.0251448853  0.0074256727  0.2336974144  700           0.5607833910 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1982, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1950, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/Resnet1d.py", line 164, in forward
    x = self.layer4(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/Resnet1d.py", line 50, in forward
    out = self.conv2(out)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 263, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 260, in _conv_forward
    self.padding, self.dilation, self.groups)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 2
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.4427710843  0.4457831325  0.3333333333  0.0000000000  0.2992001772  1.1716780663  0.1868000031  0             0.8978974819 
0.6900000000  0.6507936508  0.6420000000  0.5396825397  0.6837349398  0.6024096386  0.7816265060  0.7289156627  0.7809523810  3.2000000000  0.1480190611  0.9360180414  0.2336974144  50            0.5411185265 
0.7620000000  0.7063492063  0.7780000000  0.6428571429  0.7951807229  0.7349397590  0.8388554217  0.7771084337  0.8793650794  6.4000000000  0.1411808968  0.7634939265  0.2336974144  100           0.5746765280 
0.9140000000  0.8492063492  0.8640000000  0.7142857143  0.8192771084  0.7349397590  0.9186746988  0.8554216867  0.7365079365  9.6000000000  0.1954718828  0.6325887859  0.2336974144  150           0.5422020674 
0.9000000000  0.8571428571  0.9120000000  0.7460317460  0.8569277108  0.8012048193  0.9578313253  0.9156626506  0.7349206349  12.800000000  0.1578109396  0.5098323709  0.2336974144  200           0.5437310886 
0.9600000000  0.9285714286  0.9620000000  0.8174603175  0.9307228916  0.8554216867  0.9367469880  0.8915662651  0.6730158730  16.000000000  0.1964745140  0.3843667394  0.2336974144  250           0.5790160084 
1.0000000000  0.9841269841  0.9900000000  0.8730158730  0.9578313253  0.9156626506  0.9548192771  0.9036144578  0.5936507937  19.200000000  0.1864674342  0.2765826336  0.2336974144  300           0.5837172699 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1982, in update
    gap = -self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1950, in loss_gap
    p = model.adv_classifier(model.featurizer(x))
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/Resnet1d.py", line 164, in forward
    x = self.layer4(x)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/Resnet1d.py", line 57, in forward
    out = self.relu(out)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/nn/functional.py", line 1204, in relu
    result = torch.relu_(input)
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-06
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.3779644966  1.1670693159  0.1868000031  0             0.9472744465 
0.3580000000  0.3412698413  0.3800000000  0.3492063492  0.4006024096  0.3855421687  0.3659638554  0.3554216867  0.4031746032  3.2000000000  0.1846203017  1.1098774791  0.2336974144  50            0.5325714111 
0.5140000000  0.5396825397  0.5060000000  0.5158730159  0.5527108434  0.5000000000  0.4578313253  0.3855421687  0.6317460317  6.4000000000  0.1498897457  1.0378432071  0.2336974144  100           0.5286289310 
0.6200000000  0.6031746032  0.5740000000  0.5714285714  0.6219879518  0.6084337349  0.5391566265  0.4698795181  0.6460317460  9.6000000000  0.1138282108  0.9951408660  0.2336974144  150           0.5302548170 
0.6880000000  0.6349206349  0.6340000000  0.6190476190  0.6566265060  0.5903614458  0.6129518072  0.5843373494  0.5730158730  12.800000000  0.0985464120  0.9705084252  0.2336974144  200           0.5328542757 
0.6760000000  0.6111111111  0.6140000000  0.5555555556  0.7349397590  0.6987951807  0.6596385542  0.6385542169  0.5190476190  16.000000000  0.1084069562  0.9496855962  0.2336974144  250           0.5301204824 
0.7500000000  0.6746031746  0.6720000000  0.6428571429  0.7530120482  0.6987951807  0.7018072289  0.6626506024  0.5349206349  19.200000000  0.0978425288  0.9256192875  0.2336974144  300           0.5350030994 
0.8120000000  0.7142857143  0.7500000000  0.6746031746  0.7891566265  0.7951807229  0.7424698795  0.7409638554  0.4317460317  22.400000000  0.0992337847  0.9039785171  0.2336974144  350           0.5309448957 
0.8260000000  0.7777777778  0.7680000000  0.6746031746  0.8177710843  0.7048192771  0.7725903614  0.7650602410  0.4634920635  25.600000000  0.1123175645  0.8824952376  0.2336974144  400           0.5690663147 
0.8160000000  0.7222222222  0.7300000000  0.6587301587  0.8750000000  0.8253012048  0.8012048193  0.8192771084  0.4571428571  28.800000000  0.0925455165  0.8673748863  0.2336974144  450           0.5388818359 
0.8640000000  0.7857142857  0.7740000000  0.7460317460  0.8283132530  0.7710843373  0.7891566265  0.8072289157  0.4746031746  32.000000000  0.0957183003  0.8421080053  0.2336974144  500           0.5240818405 
0.8840000000  0.7539682540  0.7900000000  0.7301587302  0.8750000000  0.8373493976  0.8388554217  0.8132530120  0.4809523810  35.200000000  0.0948388481  0.8200788832  0.2336974144  550           0.5237261772 
0.8880000000  0.7936507937  0.8100000000  0.7301587302  0.8599397590  0.7530120482  0.8569277108  0.8132530120  0.4619047619  38.400000000  0.1110542893  0.8005409539  0.2336974144  600           0.5745049047 
0.8840000000  0.7857142857  0.8100000000  0.7222222222  0.8750000000  0.7891566265  0.8403614458  0.8192771084  0.5047619048  41.600000000  0.1047400045  0.7824681175  0.2336974144  650           0.5873079824 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1975, in update
    gap = self.hparams['t_lambda'] * self.loss_gap(minibatches, self, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1947, in loss_gap
    max_env_loss, min_env_loss = torch.tensor([-float('inf')], device=device), torch.tensor([float('inf')],
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-06
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4560000000  0.4285714286  0.4260000000  0.4206349206  0.3614457831  0.3493975904  0.3328313253  0.3433734940  0.1015873016  0.0000000000  0.0341467857  1.1063636541  0.1887979507  0             0.9578118324 
0.5020000000  0.5000000000  0.4760000000  0.4603174603  0.4427710843  0.4337349398  0.4503012048  0.4277108434  0.6111111111  3.2000000000  0.0264038897  1.0913588405  0.2373423576  50            0.5911426210 
0.3860000000  0.3809523810  0.3740000000  0.3809523810  0.4789156627  0.4939759036  0.5873493976  0.5180722892  0.5015873016  6.4000000000  0.0290729618  1.0742957544  0.2373423576  100           0.5782101583 
0.3820000000  0.3571428571  0.3600000000  0.3650793651  0.4834337349  0.4879518072  0.5978915663  0.5120481928  0.5301587302  9.6000000000  0.0416147614  1.0596776772  0.2373423576  150           0.5550901985 
0.4080000000  0.4047619048  0.4080000000  0.3888888889  0.5828313253  0.5240963855  0.6415662651  0.6385542169  0.4523809524  12.800000000  0.0473356295  1.0473895288  0.2373423576  200           0.5520979452 
0.4200000000  0.4206349206  0.4280000000  0.4206349206  0.5873493976  0.5421686747  0.6641566265  0.6807228916  0.4555555556  16.000000000  0.0515580320  1.0330781531  0.2373423576  250           0.5493895483 
0.4800000000  0.4444444444  0.4560000000  0.4523809524  0.6972891566  0.6445783133  0.7153614458  0.7289156627  0.3904761905  19.200000000  0.0539863992  1.0219326496  0.2373423576  300           0.5552059889 
0.5280000000  0.4761904762  0.5540000000  0.5317460317  0.7349397590  0.6626506024  0.7364457831  0.7409638554  0.3825396825  22.400000000  0.0533066320  1.0023480248  0.2373423576  350           0.5503764200 
0.5860000000  0.5238095238  0.5640000000  0.5714285714  0.7183734940  0.6204819277  0.6972891566  0.6927710843  0.4380952381  25.600000000  0.0639206648  0.9821582782  0.2373423576  400           0.5748960972 
0.7360000000  0.6269841270  0.6780000000  0.6428571429  0.8042168675  0.7228915663  0.7756024096  0.7650602410  0.4079365079  28.800000000  0.0587357879  0.9657117105  0.2373423576  450           0.6003546429 
0.7720000000  0.6904761905  0.6980000000  0.6666666667  0.8448795181  0.7530120482  0.8177710843  0.8132530120  0.4126984127  32.000000000  0.0681049800  0.9388092506  0.2373423576  500           0.5555226660 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-06
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4520000000  0.4285714286  0.4100000000  0.4047619048  0.3524096386  0.3373493976  0.3358433735  0.3433734940  0.1142857143  0.0000000000  0.0377535820  1.1063636541  0.1887979507  0             0.8388786316 
0.3340000000  0.3412698413  0.3300000000  0.3333333333  0.3418674699  0.3433734940  0.3448795181  0.3554216867  0.3253968254  3.2000000000  0.0316284609  1.1008909035  0.2373423576  50            0.5535918903 
0.3320000000  0.3333333333  0.3120000000  0.3492063492  0.3448795181  0.3433734940  0.3644578313  0.3493975904  0.3285714286  6.4000000000  0.0257068443  1.0966066337  0.2373423576  100           0.5482124281 
0.4400000000  0.3968253968  0.4360000000  0.4444444444  0.3734939759  0.3614457831  0.3765060241  0.3734939759  0.4666666667  9.6000000000  0.0237965059  1.0922187400  0.2373423576  150           0.5475241947 
0.5040000000  0.5158730159  0.4980000000  0.5000000000  0.4141566265  0.3915662651  0.4472891566  0.4036144578  0.5412698413  12.800000000  0.0179365063  1.0889776587  0.2373423576  200           0.5485473585 
0.4540000000  0.4285714286  0.4560000000  0.4761904762  0.4623493976  0.5000000000  0.4518072289  0.4096385542  0.5682539683  16.000000000  0.0213234138  1.0853910637  0.2373423576  250           0.5372483063 
0.4180000000  0.4126984127  0.4160000000  0.4126984127  0.4834337349  0.5361445783  0.4653614458  0.4156626506  0.5365079365  19.200000000  0.0247070503  1.0830943465  0.2373423576  300           0.5530293751 
0.4220000000  0.4047619048  0.4020000000  0.3968253968  0.4759036145  0.4698795181  0.4337349398  0.4216867470  0.5269841270  22.400000000  0.0239771271  1.0777917409  0.2373423576  350           0.5539798212 
0.4060000000  0.4047619048  0.3900000000  0.3809523810  0.5060240964  0.5060240964  0.5030120482  0.4337349398  0.5063492063  25.600000000  0.0300325298  1.0752173662  0.2373423576  400           0.5560084629 
0.3960000000  0.3968253968  0.3880000000  0.3968253968  0.5316265060  0.5361445783  0.5286144578  0.4879518072  0.4555555556  28.800000000  0.0331359816  1.0733942580  0.2373423576  450           0.6264612436 
0.3900000000  0.3888888889  0.3920000000  0.3968253968  0.5256024096  0.5361445783  0.5451807229  0.4939759036  0.4650793651  32.000000000  0.0315530777  1.0704384303  0.2373423576  500           0.5867085361 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-06
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3840000000  0.3412698413  0.3680000000  0.4047619048  0.3569277108  0.3674698795  0.3298192771  0.3554216867  0.1047619048  0.0000000000  0.0340414047  1.1074935198  0.1887979507  0             0.8561379910 
0.3340000000  0.3333333333  0.3340000000  0.3253968254  0.3403614458  0.3373493976  0.3509036145  0.3433734940  0.3253968254  3.2000000000  0.0295009327  1.1032204366  0.2373423576  50            0.5679979229 
0.3640000000  0.3492063492  0.3400000000  0.3571428571  0.3524096386  0.3373493976  0.3795180723  0.3734939759  0.3396825397  6.4000000000  0.0223360777  1.0973108435  0.2373423576  100           0.5609935570 
0.5500000000  0.5158730159  0.5240000000  0.5317460317  0.3825301205  0.3614457831  0.4307228916  0.4337349398  0.5238095238  9.6000000000  0.0209639311  1.0923957324  0.2373423576  150           0.5964502811 
0.5340000000  0.4841269841  0.4960000000  0.5158730159  0.4382530120  0.4518072289  0.4668674699  0.4939759036  0.5412698413  12.800000000  0.0155746222  1.0889822340  0.2373423576  200           0.5656380463 
0.4900000000  0.4761904762  0.4640000000  0.5158730159  0.4849397590  0.4939759036  0.5180722892  0.4939759036  0.5317460317  16.000000000  0.0175514030  1.0855627465  0.2373423576  250           0.5554170990 
0.4700000000  0.4444444444  0.4420000000  0.5000000000  0.4924698795  0.5120481928  0.5421686747  0.5301204819  0.4793650794  19.200000000  0.0193190813  1.0836689568  0.2373423576  300           0.5862224913 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3680000000  0.3253968254  0.3440000000  0.3333333333  0.3433734940  0.3253012048  0.4201807229  0.4036144578  0.4015873016  0.0000000000  1.1108505726  1.1432409286  0.0563254356  0             0.4287283421 
0.3820000000  0.3412698413  0.4140000000  0.3253968254  0.4472891566  0.4277108434  0.4352409639  0.4156626506  0.4301587302  3.2000000000  0.6085187674  1.0950289321  0.0604138374  50            0.1487600231 
0.3640000000  0.3809523810  0.3840000000  0.3015873016  0.4774096386  0.4397590361  0.5587349398  0.5843373494  0.3920634921  6.4000000000  0.4197288513  1.0905078912  0.0604138374  100           0.1405999565 
0.3600000000  0.3412698413  0.3520000000  0.3015873016  0.5060240964  0.4578313253  0.2409638554  0.2530120482  0.4269841270  9.6000000000  0.4090192318  1.0881838131  0.0604138374  150           0.1462999344 
0.3300000000  0.2380952381  0.3200000000  0.2857142857  0.4457831325  0.4096385542  0.3102409639  0.3132530120  0.3396825397  12.800000000  0.2110455036  1.0921801805  0.0604138374  200           0.1438335466 
0.3420000000  0.3095238095  0.3660000000  0.3650793651  0.3268072289  0.3313253012  0.2409638554  0.2771084337  0.3174603175  16.000000000  0.1641968489  1.0929937077  0.0604138374  250           0.1439885235 
0.3480000000  0.3253968254  0.3460000000  0.3174603175  0.3539156627  0.3554216867  0.2876506024  0.3072289157  0.3015873016  19.200000000  0.1184798956  1.0942427826  0.0604138374  300           0.1441618347 
0.3500000000  0.3253968254  0.3540000000  0.3333333333  0.3614457831  0.3614457831  0.3343373494  0.3373493976  0.2952380952  22.400000000  0.0684956789  1.0972501111  0.0604138374  350           0.1436136580 
0.3260000000  0.3253968254  0.3300000000  0.3174603175  0.3509036145  0.3554216867  0.3222891566  0.3253012048  0.3126984127  25.600000000  0.0473692417  1.0980741334  0.0604138374  400           0.1480543661 
0.3300000000  0.3253968254  0.3380000000  0.3253968254  0.3478915663  0.3674698795  0.3373493976  0.3253012048  0.3095238095  28.800000000  0.0365223408  1.0980849433  0.0604138374  450           0.1454799604 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.2660000000  0.2380952381  0.3900000000  0.4444444444  0.2981927711  0.2650602410  0.3433734940  0.3734939759  0.0825396825  0.0000000000  0.0887453556  1.1074935198  0.1887979507  0             0.8967711926 
0.3500000000  0.3333333333  0.3620000000  0.3412698413  0.4457831325  0.3975903614  0.3840361446  0.3795180723  0.3460317460  3.2000000000  0.1970540524  1.0658268785  0.2373423576  50            0.5529484510 
0.6020000000  0.6507936508  0.6320000000  0.6031746032  0.5436746988  0.5240963855  0.5768072289  0.5481927711  0.7619047619  6.4000000000  0.2892693162  1.0309642446  0.2373423576  100           0.5590548754 
0.6120000000  0.6031746032  0.6620000000  0.6507936508  0.7243975904  0.6325301205  0.6837349398  0.6746987952  0.7238095238  9.6000000000  0.4278972387  0.9932802606  0.2373423576  150           0.5513922167 
0.6200000000  0.6904761905  0.6660000000  0.6111111111  0.7439759036  0.6746987952  0.7123493976  0.7048192771  0.7650793651  12.800000000  0.4681355238  0.9414580071  0.2373423576  200           0.5477141380 
0.7340000000  0.7380952381  0.7420000000  0.7857142857  0.7259036145  0.6987951807  0.7801204819  0.7831325301  0.4079365079  16.000000000  0.6756907821  0.8540729725  0.2373423576  250           0.5638967800 
0.7640000000  0.7619047619  0.6880000000  0.6904761905  0.8629518072  0.8373493976  0.8027108434  0.8132530120  0.7158730159  19.200000000  0.7924316382  0.7576253843  0.2373423576  300           0.5540608120 
0.8220000000  0.8015873016  0.7560000000  0.7301587302  0.8825301205  0.8433734940  0.8960843373  0.8614457831  0.5222222222  22.400000000  0.8975060582  0.6316408217  0.2373423576  350           0.5520413351 
0.9040000000  0.9285714286  0.8120000000  0.8253968254  0.7710843373  0.7469879518  0.8569277108  0.8493975904  0.5634920635  25.600000000  1.1064470708  0.5718579566  0.2373423576  400           0.5490063286 
0.9200000000  0.8333333333  0.8620000000  0.8650793651  0.8614457831  0.8795180723  0.8900602410  0.8855421687  0.5301587302  28.800000000  1.0403149176  0.5042025560  0.2373423576  450           0.5477145195 
0.8720000000  0.8809523810  0.8820000000  0.8492063492  0.8795180723  0.8795180723  0.8539156627  0.8493975904  0.7190476190  32.000000000  0.9411559713  0.4395754063  0.2373423576  500           0.5559639263 
0.8260000000  0.7777777778  0.8180000000  0.8015873016  0.9292168675  0.9457831325  0.9533132530  0.9337349398  0.5873015873  35.200000000  0.9966301906  0.3793672913  0.2373423576  550           0.5922925043 
0.8900000000  0.8571428571  0.8640000000  0.8095238095  0.9186746988  0.9156626506  0.8313253012  0.8433734940  0.6444444444  38.400000000  1.1474526572  0.3617591560  0.2373423576  600           0.5932489729 
0.9500000000  0.9285714286  0.9580000000  0.8968253968  0.9307228916  0.8313253012  0.8403614458  0.8313253012  0.5174603175  41.600000000  1.3077587098  0.3126152149  0.2373423576  650           0.5466526890 
0.9560000000  0.9126984127  0.9480000000  0.8730158730  0.9126506024  0.8795180723  0.8132530120  0.8192771084  0.5746031746  44.800000000  1.4049649137  0.2894954300  0.2373423576  700           0.5545228672 
0.9720000000  0.9365079365  0.9240000000  0.8412698413  0.9608433735  0.9277108434  0.9578313253  0.9397590361  0.3936507937  48.000000000  1.2167778420  0.2394270965  0.2373423576  750           0.5648180914 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [7]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_in_acc   env6_out_acc  env7_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4975024975  0.5258964143  0.4835164835  0.4422310757  0.3990963855  0.4156626506  0.4307228916  0.4096385542  0.4702380952  0.4920634921  0.4584323040  0.4644549763  0.2903885481  0.2357723577  0.4066666667  0.0000000000  0.1953136921  1.1038072109  0.3178915977  0             1.0924155712 
0.5204795205  0.5099601594  0.4575424575  0.4900398406  0.4819277108  0.4819277108  0.5918674699  0.5722891566  0.4186507937  0.3888888889  0.5605700713  0.5924170616  0.6155419223  0.5121951220  0.4733333333  3.2719836401  0.3804303408  1.0701947737  0.3646621704  50            0.7970039415 
0.5654345654  0.5537848606  0.5784215784  0.5617529880  0.6250000000  0.6084337349  0.5210843373  0.5060240964  0.5099206349  0.4761904762  0.4406175772  0.4644549763  0.3374233129  0.3333333333  0.5766666667  6.5439672802  0.3642230511  1.0573439646  0.3646621704  100           0.7690191650 
0.4285714286  0.4262948207  0.4075924076  0.4103585657  0.5075301205  0.4759036145  0.3750000000  0.4036144578  0.3829365079  0.3888888889  0.3634204276  0.3791469194  0.5889570552  0.5853658537  0.3200000000  9.8159509202  0.4995301366  1.0365139985  0.3646621704  150           0.7743295002 
0.6473526474  0.6294820717  0.5894105894  0.5816733068  0.5361445783  0.5903614458  0.6265060241  0.6385542169  0.5753968254  0.5952380952  0.6092636580  0.5687203791  0.6237218814  0.5853658537  0.4666666667  13.087934560  0.5983450651  1.0113995075  0.3646621704  200           0.7949105167 
0.5684315684  0.5976095618  0.6243756244  0.6254980080  0.4593373494  0.4397590361  0.4051204819  0.4156626506  0.6587301587  0.6746031746  0.4703087886  0.3838862559  0.5623721881  0.5284552846  0.4333333333  16.359918200  0.6512516737  1.0080192399  0.3646621704  250           0.7690454102 
0.5834165834  0.6374501992  0.6143856144  0.6015936255  0.6611445783  0.6084337349  0.6099397590  0.5843373494  0.7142857143  0.6984126984  0.5581947743  0.5545023697  0.6237218814  0.5772357724  0.4533333333  19.631901840  0.8172628999  0.9863358665  0.3646621704  300           0.7644027281 
0.6403596404  0.6374501992  0.6803196803  0.6454183267  0.6159638554  0.6084337349  0.5376506024  0.5963855422  0.5277777778  0.5317460317  0.5261282660  0.5213270142  0.7852760736  0.8048780488  0.2533333333  22.903885480  0.7912770391  0.9672373629  0.3646621704  350           0.8064963388 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [7]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_in_acc   env6_out_acc  env7_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.4835164835  0.4741035857  0.5094905095  0.4820717131  0.3448795181  0.3313253012  0.3328313253  0.3313253012  0.5019841270  0.5079365079  0.3337292162  0.3317535545  0.3333333333  0.3333333333  0.3733333333  0.0000000000  0.8540523052  1.1038072109  0.3178915977  0             1.1268141270 
0.6153846154  0.5976095618  0.5804195804  0.5458167331  0.3569277108  0.3554216867  0.5602409639  0.6506024096  0.4226190476  0.3809523810  0.3349168646  0.3175355450  0.3333333333  0.3333333333  0.4433333333  3.2719836401  1.0522970200  1.0585967779  0.3646621704  50            0.8172784090 
0.4105894106  0.3984063745  0.3156843157  0.3027888446  0.4367469880  0.4096385542  0.5406626506  0.5120481928  0.3571428571  0.3492063492  0.3764845606  0.3886255924  0.3190184049  0.3008130081  0.3266666667  6.5439672802  1.1768839836  1.0601998305  0.3646621704  100           0.8524661684 
0.5454545455  0.5418326693  0.6473526474  0.6175298805  0.3840361446  0.3554216867  0.3689759036  0.3433734940  0.7003968254  0.7698412698  0.3337292162  0.3317535545  0.2862985685  0.2520325203  0.3933333333  9.8159509202  0.9373497987  1.0642118979  0.3646621704  150           0.8115505171 
0.5784215784  0.5498007968  0.5804195804  0.5418326693  0.3569277108  0.3433734940  0.3509036145  0.3313253012  0.5892857143  0.5952380952  0.3384798100  0.3317535545  0.3353783231  0.3170731707  0.4033333333  13.087934560  1.4679052472  1.0382984114  0.3646621704  200           0.8538197994 
0.5914085914  0.5816733068  0.5394605395  0.4741035857  0.3493975904  0.3614457831  0.3463855422  0.3373493976  0.5476190476  0.5793650794  0.3361045131  0.3317535545  0.3456032720  0.3414634146  0.4266666667  16.359918200  1.2482846117  1.0609187901  0.3646621704  250           0.8716206551 
0.4855144855  0.5498007968  0.4285714286  0.4541832669  0.4653614458  0.4036144578  0.4126506024  0.4819277108  0.4305555556  0.4444444444  0.3610451306  0.3554502370  0.4703476483  0.4878048780  0.3033333333  19.631901840  1.3485545444  1.0351245189  0.3646621704  300           0.9107492208 
0.4275724276  0.4183266932  0.3746253746  0.3705179283  0.4186746988  0.3975903614  0.5075301205  0.4638554217  0.5753968254  0.5634920635  0.2505938242  0.2796208531  0.3558282209  0.3252032520  0.3366666667  22.903885480  1.5025284290  1.0384382141  0.3646621704  350           0.8368286228 
0.4065934066  0.4103585657  0.3306693307  0.3466135458  0.3704819277  0.3373493976  0.3102409639  0.3373493976  0.3531746032  0.3730158730  0.3301662708  0.3222748815  0.3558282209  0.3821138211  0.3333333333  26.175869120  1.5645769334  1.0409518850  0.3646621704  400           0.8333150291 
0.5254745255  0.5298804781  0.4665334665  0.4462151394  0.3870481928  0.3433734940  0.3734939759  0.3855421687  0.4126984127  0.3809523810  0.3551068884  0.3507109005  0.5419222904  0.5203252033  0.3166666667  29.447852760  1.8806396627  1.0394480944  0.3646621704  450           0.8862311363 
0.5994005994  0.5816733068  0.5414585415  0.5378486056  0.4096385542  0.3855421687  0.4156626506  0.4216867470  0.6130952381  0.6031746032  0.3396674584  0.3270142180  0.2249488753  0.2439024390  0.4466666667  32.719836400  1.2077001905  1.0329118145  0.3646621704  500           0.8772769785 
0.5334665335  0.5298804781  0.4765234765  0.5019920319  0.3825301205  0.3493975904  0.3704819277  0.3855421687  0.4523809524  0.4365079365  0.3456057007  0.3412322275  0.4948875256  0.4959349593  0.3266666667  35.991820040  1.0883872509  1.0375903952  0.3646621704  550           0.8481065369 
0.4255744256  0.4501992032  0.3436563437  0.3545816733  0.3674698795  0.3373493976  0.3343373494  0.3493975904  0.3650793651  0.3492063492  0.3242280285  0.3033175355  0.3169734151  0.3414634146  0.3333333333  39.263803681  1.5332539988  1.0432195568  0.3646621704  600           0.8752946091 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3720000000  0.3095238095  0.3720000000  0.2857142857  0.6400602410  0.6084337349  0.5873493976  0.5542168675  0.3714285714  0.0000000000  1.2362146378  1.1432409286  0.0539793968  0             0.4861056805 
0.3460000000  0.3571428571  0.3440000000  0.3333333333  0.3493975904  0.3253012048  0.3283132530  0.3253012048  0.3333333333  3.2000000000  0.6709443808  1.1027270365  0.0604138374  50            0.1514912319 
0.3860000000  0.3095238095  0.4300000000  0.3571428571  0.4367469880  0.3855421687  0.2635542169  0.2590361446  0.3063492063  6.4000000000  0.1900428534  1.0929228210  0.0604138374  100           0.1576936007 
0.3840000000  0.3809523810  0.4240000000  0.3968253968  0.3975903614  0.4337349398  0.4246987952  0.4096385542  0.3888888889  9.6000000000  0.0959896326  1.0943832612  0.0604138374  150           0.1521200037 
0.4660000000  0.4285714286  0.4920000000  0.4603174603  0.6204819277  0.6385542169  0.4427710843  0.4698795181  0.5079365079  12.800000000  0.0730077505  1.0962711000  0.0604138374  200           0.1530115461 
0.4800000000  0.5079365079  0.4700000000  0.3968253968  0.2454819277  0.2951807229  0.3960843373  0.3313253012  0.5714285714  16.000000000  0.0635704517  1.0950292158  0.0604138374  250           0.1531455135 
0.3580000000  0.3412698413  0.3580000000  0.3333333333  0.4668674699  0.4819277108  0.4382530120  0.4036144578  0.3158730159  19.200000000  0.0451051235  1.0961888051  0.0604138374  300           0.1530133104 
0.4240000000  0.4206349206  0.3780000000  0.3730158730  0.4246987952  0.4216867470  0.3493975904  0.3493975904  0.3555555556  22.400000000  0.0420818090  1.0952494955  0.0604138374  350           0.1531022072 
0.4080000000  0.3809523810  0.3740000000  0.3809523810  0.3810240964  0.3674698795  0.1837349398  0.2168674699  0.3126984127  25.600000000  0.0291363239  1.0949457693  0.0604138374  400           0.1551066589 
0.4760000000  0.4603174603  0.4740000000  0.5000000000  0.5873493976  0.5421686747  0.5436746988  0.5000000000  0.5238095238  28.800000000  0.0354351521  1.0963411570  0.0604138374  450           0.1524784279 
0.5720000000  0.5873015873  0.5940000000  0.5476190476  0.4126506024  0.3975903614  0.3644578313  0.3855421687  0.6253968254  32.000000000  0.0270129919  1.0957820797  0.0604138374  500           0.1551943493 
0.4040000000  0.4047619048  0.4060000000  0.4523809524  0.5225903614  0.4759036145  0.5376506024  0.5602409639  0.5507936508  35.200000000  0.0265048742  1.0954753685  0.0604138374  550           0.1581740475 
0.5540000000  0.5873015873  0.5160000000  0.5158730159  0.5993975904  0.5421686747  0.5978915663  0.5963855422  0.5809523810  38.400000000  0.0268124819  1.0950920272  0.0604138374  600           0.1540569973 
0.4540000000  0.4603174603  0.4320000000  0.4047619048  0.5376506024  0.4879518072  0.4894578313  0.5000000000  0.5253968254  41.600000000  0.0271989822  1.0964041615  0.0604138374  650           0.1604262733 
0.5040000000  0.5079365079  0.5660000000  0.5634920635  0.6972891566  0.6566265060  0.7831325301  0.8313253012  0.4587301587  44.800000000  0.0261582851  1.0952556419  0.0604138374  700           0.1518760443 
0.4540000000  0.5238095238  0.5260000000  0.5476190476  0.4683734940  0.4277108434  0.4563253012  0.4759036145  0.5968253968  48.000000000  0.0263733387  1.0945012164  0.0604138374  750           0.1534393024 
0.4140000000  0.4444444444  0.4800000000  0.4523809524  0.3358433735  0.3313253012  0.3373493976  0.3373493976  0.5317460317  51.200000000  0.0282263041  1.0961318660  0.0604138374  800           0.1511265707 
0.5020000000  0.5158730159  0.5300000000  0.5396825397  0.4638554217  0.4337349398  0.5030120482  0.4819277108  0.5650793651  54.400000000  0.0169623375  1.0964448857  0.0604138374  850           0.1514210224 
0.5960000000  0.5317460317  0.6000000000  0.6190476190  0.7078313253  0.7228915663  0.6701807229  0.6807228916  0.5603174603  57.600000000  0.0153640985  1.0969037294  0.0604138374  900           0.1603777313 
0.3940000000  0.3492063492  0.3840000000  0.3968253968  0.4743975904  0.4638554217  0.3840361446  0.3554216867  0.3460317460  60.800000000  0.0140312910  1.0967430377  0.0604138374  950           0.1617383575 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 10
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3358433735  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.2777528763  1.1000244617  0.0563969612  0             0.4927616119 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3433734940  0.3373493976  0.3333333333  3.2000000000  0.0541320086  1.0990655780  0.0604739189  50            0.1701432705 
0.4240000000  0.4365079365  0.4020000000  0.4206349206  0.3343373494  0.3373493976  0.3343373494  0.3373493976  0.3126984127  6.4000000000  0.0431797743  1.0972389984  0.0604739189  100           0.1856867266 
0.5080000000  0.4761904762  0.5280000000  0.5873015873  0.3448795181  0.3433734940  0.5120481928  0.5060240964  0.3253968254  9.6000000000  0.0432708025  1.0953649354  0.0604739189  150           0.1709536457 
0.4440000000  0.4761904762  0.3500000000  0.3015873016  0.3509036145  0.3554216867  0.3433734940  0.3373493976  0.3460317460  12.800000000  0.0568127155  1.0944605088  0.0604739189  200           0.1649258471 
0.4220000000  0.4523809524  0.3460000000  0.3333333333  0.3343373494  0.3373493976  0.3343373494  0.3373493976  0.3857142857  16.000000000  0.0731878042  1.0907535195  0.0604739189  250           0.1622949123 
0.4280000000  0.4206349206  0.3160000000  0.3174603175  0.3388554217  0.3554216867  0.3418674699  0.3433734940  0.4682539683  19.200000000  0.0842550993  1.0872529650  0.0604739189  300           0.1597852135 
0.4800000000  0.4523809524  0.4340000000  0.3650793651  0.3795180723  0.3855421687  0.3614457831  0.3493975904  0.6142857143  22.400000000  0.1505266666  1.0814446568  0.0604739189  350           0.1705179977 
0.4080000000  0.3888888889  0.3600000000  0.3412698413  0.5301204819  0.5060240964  0.5888554217  0.5722891566  0.4841269841  25.600000000  0.2169560671  1.0732404399  0.0604739189  400           0.1729110765 
0.5600000000  0.5952380952  0.5800000000  0.5079365079  0.4442771084  0.4518072289  0.4352409639  0.4638554217  0.6349206349  28.800000000  0.2644252062  1.0742169166  0.0604739189  450           0.1686279583 
0.5220000000  0.5714285714  0.5020000000  0.4444444444  0.3509036145  0.3554216867  0.3373493976  0.3373493976  0.6333333333  32.000000000  0.2366543531  1.0700781727  0.0604739189  500           0.1696872759 
0.3900000000  0.4365079365  0.3980000000  0.3968253968  0.5753012048  0.5421686747  0.6129518072  0.5963855422  0.4412698413  35.200000000  0.3662507057  1.0573717809  0.0604739189  550           0.1633716297 
0.6160000000  0.5793650794  0.5740000000  0.5476190476  0.3388554217  0.3433734940  0.3463855422  0.3493975904  0.6523809524  38.400000000  0.5279873729  1.0474493551  0.0604739189  600           0.1685168648 
0.4420000000  0.4206349206  0.4640000000  0.4761904762  0.3478915663  0.3554216867  0.3734939759  0.3614457831  0.5396825397  41.600000000  0.6168290257  1.0317336416  0.0604739189  650           0.1715393925 
0.4120000000  0.3968253968  0.3880000000  0.3809523810  0.5783132530  0.5421686747  0.6159638554  0.6325301205  0.5349206349  44.800000000  0.8661901736  1.0110172868  0.0604739189  700           0.1671235037 
0.5260000000  0.4365079365  0.4860000000  0.4761904762  0.6415662651  0.6385542169  0.6445783133  0.6506024096  0.5841269841  48.000000000  1.2143454194  1.0084449542  0.0604739189  750           0.1699985266 
0.4540000000  0.4285714286  0.4280000000  0.3968253968  0.6400602410  0.6445783133  0.5722891566  0.5903614458  0.5904761905  51.200000000  1.5038327861  1.0028849697  0.0604739189  800           0.1668342924 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0005
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3358433735  0.3313253012  0.3328313253  0.3313253012  0.3349206349  0.0000000000  0.0534377098  1.1000244617  0.0563969612  0             0.4579691887 
0.5660000000  0.5793650794  0.5960000000  0.6507936508  0.6521084337  0.5843373494  0.5361445783  0.5542168675  0.5285714286  3.2000000000  0.0124861097  1.0951081657  0.0604739189  50            0.1623129129 
0.6720000000  0.6825396825  0.6500000000  0.7142857143  0.9246987952  0.8915662651  0.7861445783  0.7831325301  0.6587301587  6.4000000000  0.1009018493  0.9614215708  0.0604739189  100           0.1703089952 
0.7840000000  0.7222222222  0.6820000000  0.6428571429  0.8493975904  0.8192771084  0.8478915663  0.8132530120  0.6777777778  9.6000000000  0.2033774543  0.6296557164  0.0604739189  150           0.1662015676 
0.7840000000  0.7857142857  0.6520000000  0.6746031746  0.8674698795  0.8433734940  0.9171686747  0.9096385542  0.6507936508  12.800000000  0.2525245571  0.5099485970  0.0604739189  200           0.1672435045 
0.7940000000  0.7777777778  0.7840000000  0.8095238095  0.7469879518  0.7108433735  0.7334337349  0.7168674699  0.5301587302  16.000000000  0.2868939149  0.4212952042  0.0604739189  250           0.1662363434 
0.9160000000  0.9126984127  0.9560000000  0.9365079365  0.9804216867  0.9698795181  0.9713855422  0.9578313253  0.4793650794  19.200000000  0.2908333784  0.3152579027  0.0604739189  300           0.1694962454 
0.9600000000  0.9761904762  0.9820000000  0.9365079365  0.9819277108  0.9638554217  0.9683734940  0.9578313253  0.4873015873  22.400000000  0.2088642547  0.1911050241  0.0604739189  350           0.1653525829 
0.9800000000  0.9365079365  0.9860000000  0.9206349206  0.9804216867  0.9457831325  0.9909638554  0.9759036145  0.5158730159  25.600000000  0.2018326062  0.1335949857  0.0604739189  400           0.1682246876 
0.9960000000  0.9841269841  0.9800000000  0.9365079365  0.9834337349  0.9819277108  0.9939759036  0.9759036145  0.5523809524  28.800000000  0.2180511035  0.1073442348  0.0604739189  450           0.1657558060 
0.9940000000  0.9682539683  0.9940000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5666666667  32.000000000  0.1555850520  0.0550399699  0.0604739189  500           0.1611260366 
1.0000000000  0.9841269841  0.9940000000  0.9523809524  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.4555555556  35.200000000  0.0919999340  0.0334426254  0.0604739189  550           0.1638099623 
1.0000000000  0.9920634921  0.9980000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4476190476  38.400000000  0.1225318556  0.0410690733  0.0604739189  600           0.1588850451 
0.9980000000  0.9920634921  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3698412698  41.600000000  0.0562905491  0.0153764661  0.0604739189  650           0.1638466740 
1.0000000000  0.9682539683  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4523809524  44.800000000  0.0545964636  0.0197637445  0.0604739189  700           0.1629956150 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3841269841  48.000000000  0.0318020276  0.0103232285  0.0604739189  750           0.1616936779 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3920634921  51.200000000  0.0203845543  0.0068718204  0.0604739189  800           0.1697050381 
1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4380952381  54.400000000  0.0650255405  0.0156808396  0.0604739189  850           0.1672098351 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2920634921  57.600000000  0.0605307589  0.0151812381  0.0604739189  900           0.1690440607 
1.0000000000  1.0000000000  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2904761905  60.800000000  0.0296005637  0.0077969342  0.0604739189  950           0.1719661379 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2571428571  64.000000000  0.0149047140  0.0028781351  0.0604739189  1000          0.1664332581 
1.0000000000  1.0000000000  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3142857143  67.200000000  0.0267649654  0.0034107362  0.0604739189  1050          0.1689756060 
1.0000000000  1.0000000000  1.0000000000  0.9841269841  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.2968253968  70.400000000  0.0331231656  0.0029581132  0.0604739189  1100          0.1698267794 
1.0000000000  1.0000000000  1.0000000000  0.9761904762  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3634920635  73.600000000  0.0228574897  0.0066669445  0.0604739189  1150          0.1684392405

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.0969817638  1.1000244617  0.0563969612  0             0.4625012875 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  3.2000000000  0.0601242590  1.1020090508  0.0604739189  50            0.1634826612 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  6.4000000000  0.0524925852  1.1020127463  0.0604739189  100           0.1654292107 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  9.6000000000  0.0367546654  1.0990783429  0.0604739189  150           0.1602494335 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  12.800000000  0.0325779343  1.0992681599  0.0604739189  200           0.1633126020 
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3313253012  0.3253012048  0.3253968254  16.000000000  0.0185097170  1.0987747049  0.0604739189  250           0.1633562040 
0.2560000000  0.2301587302  0.2940000000  0.2857142857  0.2123493976  0.2349397590  0.2334337349  0.2469879518  0.1063492063  19.200000000  0.0117825699  1.0986436939  0.0604739189  300           0.1656583691 
0.2680000000  0.1746031746  0.2980000000  0.2619047619  0.3117469880  0.3253012048  0.2831325301  0.2289156627  0.0793650794  22.400000000  0.0094679451  1.0981603956  0.0604739189  350           0.1608391523 
0.3440000000  0.2857142857  0.3600000000  0.3174603175  0.3373493976  0.3493975904  0.2816265060  0.2228915663  0.1396825397  25.600000000  0.0088819742  1.0973287082  0.0604739189  400           0.1609085894 
0.3680000000  0.3412698413  0.3560000000  0.3412698413  0.3840361446  0.3795180723  0.3509036145  0.3192771084  0.2476190476  28.800000000  0.0092964697  1.0964284277  0.0604739189  450           0.1633934259 
0.3680000000  0.3571428571  0.3780000000  0.3492063492  0.4186746988  0.4096385542  0.3569277108  0.2951807229  0.2873015873  32.000000000  0.0095833063  1.0958143401  0.0604739189  500           0.1633300257 
0.4580000000  0.3333333333  0.4400000000  0.3571428571  0.4834337349  0.4879518072  0.3750000000  0.3433734940  0.2349206349  35.200000000  0.0092246628  1.0955070758  0.0604739189  550           0.1639402437 
0.4340000000  0.3412698413  0.4180000000  0.4126984127  0.6129518072  0.6325301205  0.5617469880  0.4879518072  0.3015873016  38.400000000  0.0087670135  1.0943056631  0.0604739189  600           0.1627412415 
0.5060000000  0.4047619048  0.4900000000  0.4206349206  0.5978915663  0.6204819277  0.5045180723  0.4156626506  0.3126984127  41.600000000  0.0101737881  1.0936823845  0.0604739189  650           0.1605668974 
0.5620000000  0.4285714286  0.5220000000  0.4761904762  0.6385542169  0.6445783133  0.5662650602  0.5180722892  0.3158730159  44.800000000  0.0096941280  1.0935705566  0.0604739189  700           0.1673277092 
0.5740000000  0.4761904762  0.5360000000  0.4523809524  0.6686746988  0.6445783133  0.5858433735  0.5361445783  0.3634920635  48.000000000  0.0100670815  1.0925160623  0.0604739189  750           0.1620587635 
0.6080000000  0.5714285714  0.5660000000  0.4841269841  0.6174698795  0.6265060241  0.6099397590  0.5722891566  0.3841269841  51.200000000  0.0091761208  1.0920646024  0.0604739189  800           0.1638435364 
0.5920000000  0.5476190476  0.5540000000  0.4682539683  0.7424698795  0.7409638554  0.6716867470  0.6265060241  0.4301587302  54.400000000  0.0101306963  1.0909399390  0.0604739189  850           0.1661839819 
0.6160000000  0.5396825397  0.6060000000  0.5555555556  0.7936746988  0.8012048193  0.6867469880  0.6024096386  0.4396825397  57.600000000  0.0103194666  1.0896991944  0.0604739189  900           0.1669741535 
0.5820000000  0.5000000000  0.5460000000  0.5000000000  0.8599397590  0.8253012048  0.7831325301  0.7108433735  0.4158730159  60.800000000  0.0129900551  1.0882180810  0.0604739189  950           0.1672404289 
0.5920000000  0.5317460317  0.5040000000  0.4523809524  0.8358433735  0.8373493976  0.8147590361  0.7409638554  0.4412698413  64.000000000  0.0116040421  1.0866110039  0.0604739189  1000          0.1668383884 
0.6800000000  0.6111111111  0.6300000000  0.5000000000  0.8132530120  0.7951807229  0.7590361446  0.7108433735  0.5238095238  67.200000000  0.0137010717  1.0851839018  0.0604739189  1050          0.1634739637 
0.7060000000  0.6190476190  0.6820000000  0.5238095238  0.8524096386  0.8313253012  0.7213855422  0.6807228916  0.5126984127  70.400000000  0.0133244181  1.0839513922  0.0604739189  1100          0.1641927814 
0.7240000000  0.6349206349  0.6580000000  0.5793650794  0.8870481928  0.8734939759  0.7771084337  0.7469879518  0.5079365079  73.600000000  0.0141383934  1.0821303391  0.0604739189  1150          0.1614942074 
0.7940000000  0.6666666667  0.7660000000  0.6428571429  0.8102409639  0.7831325301  0.6521084337  0.6445783133  0.5365079365  76.800000000  0.0155328321  1.0795963860  0.0604739189  1200          0.1638257217 
0.7880000000  0.6984126984  0.7700000000  0.6190476190  0.8042168675  0.7951807229  0.6656626506  0.6385542169  0.5714285714  80.000000000  0.0173541641  1.0770877171  0.0604739189  1250          0.1629731894 
0.7160000000  0.6587301587  0.6800000000  0.6031746032  0.8840361446  0.8855421687  0.7575301205  0.7289156627  0.5269841270  83.200000000  0.0188089752  1.0740386176  0.0604739189  1300          0.1610875893 
0.8120000000  0.7142857143  0.7960000000  0.6587301587  0.8358433735  0.8253012048  0.6837349398  0.6686746988  0.5904761905  86.400000000  0.0183391619  1.0717815042  0.0604739189  1350          0.1609257984 
0.7240000000  0.6825396825  0.6660000000  0.5476190476  0.8448795181  0.8373493976  0.7846385542  0.7891566265  0.5206349206  89.600000000  0.0231954432  1.0675743318  0.0604739189  1400          0.1650171137 
0.7000000000  0.6111111111  0.6580000000  0.6190476190  0.8975903614  0.8795180723  0.8644578313  0.8313253012  0.5269841270  92.800000000  0.0218013430  1.0642178679  0.0604739189  1450          0.1689426422 
0.8060000000  0.7063492063  0.7920000000  0.6349206349  0.8674698795  0.8554216867  0.7138554217  0.6987951807  0.6333333333  96.000000000  0.0259743786  1.0611102390  0.0604739189  1500          0.1619057846 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.00018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3360000000  0.3333333333  0.3328313253  0.3313253012  0.3328313253  0.3313253012  0.3333333333  0.0000000000  0.0800554752  1.1000244617  0.0563969612  0             0.4686260223 
0.3860000000  0.3412698413  0.4120000000  0.3650793651  0.3237951807  0.3192771084  0.4141566265  0.3915662651  0.2079365079  3.2000000000  0.0206397820  1.0976824927  0.0604739189  50            0.1599390554 
0.5900000000  0.6111111111  0.5940000000  0.6031746032  0.3734939759  0.3614457831  0.3448795181  0.3433734940  0.4365079365  6.4000000000  0.0107858372  1.0925603843  0.0604739189  100           0.1616758823 
0.6700000000  0.6587301587  0.5960000000  0.6031746032  0.8539156627  0.8132530120  0.8719879518  0.8975903614  0.6825396825  9.6000000000  0.0393261981  1.0272508430  0.0604739189  150           0.1632339191 
0.7340000000  0.7380952381  0.6900000000  0.6507936508  0.7951807229  0.7831325301  0.8162650602  0.8554216867  0.7380952381  12.800000000  0.1951146984  0.7608050251  0.0604739189  200           0.1588987160 
0.8280000000  0.8571428571  0.7460000000  0.7063492063  0.9081325301  0.8614457831  0.8433734940  0.8554216867  0.5777777778  16.000000000  0.2242907882  0.5502321488  0.0604739189  250           0.1568290138 
0.8520000000  0.8015873016  0.8120000000  0.7698412698  0.8750000000  0.8734939759  0.8448795181  0.8614457831  0.3920634921  19.200000000  0.2238282979  0.4983949202  0.0604739189  300           0.1661271191 
0.9280000000  0.8968253968  0.9120000000  0.8809523810  0.9713855422  0.9337349398  0.9728915663  0.9759036145  0.4984126984  22.400000000  0.2462418008  0.4225845188  0.0604739189  350           0.1627464199 
0.9520000000  0.9206349206  0.9140000000  0.9126984127  0.9638554217  0.9036144578  0.9834337349  0.9578313253  0.6142857143  25.600000000  0.2105209267  0.3020991799  0.0604739189  400           0.1629315424 
0.9260000000  0.8968253968  0.8720000000  0.8333333333  0.9382530120  0.9216867470  0.9623493976  0.9337349398  0.5857142857  28.800000000  0.2173320708  0.2090129828  0.0604739189  450           0.1646390295 
0.9780000000  0.9682539683  0.9520000000  0.9047619048  0.9924698795  0.9819277108  0.9954819277  0.9939759036  0.5841269841  32.000000000  0.2478336209  0.1713249078  0.0604739189  500           0.1698415613 
0.9900000000  0.9761904762  0.9840000000  0.9444444444  0.9969879518  0.9759036145  0.9774096386  0.9457831325  0.5317460317  35.200000000  0.1750626998  0.1108128850  0.0604739189  550           0.1719381428 
0.9960000000  0.9761904762  0.9900000000  0.9523809524  0.9969879518  1.0000000000  0.9969879518  1.0000000000  0.4650793651  38.400000000  0.1521578288  0.0841642832  0.0604739189  600           0.1606741571 
0.9900000000  0.9761904762  0.9860000000  0.9126984127  0.9924698795  0.9698795181  0.9969879518  1.0000000000  0.3936507937  41.600000000  0.1269249018  0.0662394818  0.0604739189  650           0.1611062717 
0.9980000000  0.9761904762  0.9980000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4349206349  44.800000000  0.1085299073  0.0490108177  0.0604739189  700           0.1643941307 
0.9940000000  0.9841269841  0.9920000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5000000000  48.000000000  0.0775033052  0.0379106110  0.0604739189  750           0.1598172188 
0.9980000000  0.9841269841  0.9960000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4111111111  51.200000000  0.0742339435  0.0285621829  0.0604739189  800           0.1625790548 
1.0000000000  0.9761904762  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3365079365  54.400000000  0.0800576243  0.0256378745  0.0604739189  850           0.1656994247 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  1.0000000000  0.9879518072  1.0000000000  0.9879518072  0.4238095238  57.600000000  0.0683355979  0.0186332412  0.0604739189  900           0.1640441132 
1.0000000000  0.9920634921  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3619047619  60.800000000  0.0462820318  0.0133724222  0.0604739189  950           0.1852436066 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.2269841270  64.000000000  0.0317971922  0.0097924407  0.0604739189  1000          0.1673404074 
1.0000000000  0.9682539683  1.0000000000  0.9682539683  1.0000000000  0.9879518072  1.0000000000  1.0000000000  0.3952380952  67.200000000  0.0563345100  0.0118088948  0.0604739189  1050          0.1758956146 
1.0000000000  0.9682539683  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3349206349  70.400000000  0.0424425487  0.0098126189  0.0604739189  1100          0.1722597218 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3587301587  73.600000000  0.0341211967  0.0092304066  0.0604739189  1150          0.1694116116 
1.0000000000  0.9841269841  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3349206349  76.800000000  0.0196346854  0.0063198193  0.0604739189  1200          0.1710587978 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3365079365  80.000000000  0.0333758430  0.0047081504  0.0604739189  1250          0.1698311472 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4492063492  83.200000000  0.0191518394  0.0065053871  0.0604739189  1300          0.1710372734 
1.0000000000  0.9841269841  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3809523810  86.400000000  0.0209796242  0.0055778412  0.0604739189  1350          0.1691062069 
1.0000000000  0.9523809524  0.9960000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4714285714  89.600000000  0.0240309936  0.0051825481  0.0604739189  1400          0.1695138502 
1.0000000000  0.9841269841  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3190476190  92.800000000  0.0082124179  0.0026409305  0.0604739189  1450          0.1720920038 
1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.3349206349  96.000000000  0.0100061604  0.0021151241  0.0604739189  1500          0.1708564758 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.0018486359452623148
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3700000000  0.3412698413  0.3680000000  0.4047619048  0.3237951807  0.3192771084  0.4081325301  0.4036144578  0.3682539683  0.0000000000  0.0150177479  1.1000244617  0.0563969612  0             0.5460164547 
0.3620000000  0.3412698413  0.3620000000  0.3571428571  0.5240963855  0.5301204819  0.5963855422  0.5783132530  0.3333333333  3.2000000000  0.0560379434  1.0679326415  0.0604739189  50            0.1676854038 
0.6020000000  0.6111111111  0.6200000000  0.6111111111  0.7078313253  0.6867469880  0.8237951807  0.8012048193  0.6015873016  6.4000000000  0.2566286767  0.7905895340  0.0604739189  100           0.1687760496 
0.7520000000  0.7301587302  0.6600000000  0.6349206349  0.8885542169  0.8433734940  0.9367469880  0.9036144578  0.6380952381  9.6000000000  0.2802445507  0.5512574279  0.0604739189  150           0.1687159681 
0.7140000000  0.6587301587  0.7180000000  0.6746031746  0.9021084337  0.8975903614  0.9066265060  0.8915662651  0.5158730159  12.800000000  0.3536281729  0.5168531799  0.0604739189  200           0.1683186960 
0.7000000000  0.6269841270  0.6700000000  0.6904761905  0.8704819277  0.8192771084  0.7951807229  0.7951807229  0.2952380952  16.000000000  0.3390234071  0.4674598902  0.0604739189  250           0.1676079082 
0.7520000000  0.6746031746  0.7620000000  0.7539682540  0.8524096386  0.8433734940  0.7816265060  0.7891566265  0.4158730159  19.200000000  0.3678301513  0.4566326964  0.0604739189  300           0.1688429689 
0.7100000000  0.6904761905  0.7060000000  0.6666666667  0.8478915663  0.8373493976  0.8478915663  0.8373493976  0.3507936508  22.400000000  0.3614013839  0.4518522328  0.0604739189  350           0.1729081774 
0.6760000000  0.6666666667  0.6900000000  0.6746031746  0.8328313253  0.8012048193  0.7861445783  0.7710843373  0.3507936508  25.600000000  0.3682283717  0.3884187603  0.0604739189  400           0.1676822138 
0.8420000000  0.8412698413  0.8460000000  0.8333333333  0.9307228916  0.9397590361  0.8177710843  0.8253012048  0.3095238095  28.800000000  0.3660069138  0.3951612324  0.0604739189  450           0.1625629425 
0.8600000000  0.7936507937  0.8460000000  0.8253968254  0.8599397590  0.8373493976  0.7966867470  0.7771084337  0.2730158730  32.000000000  0.4212642670  0.3397975686  0.0604739189  500           0.1707217312 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.2620000000  0.2936507937  0.2920000000  0.2777777778  0.3102409639  0.3132530120  0.2801204819  0.2409638554  0.3174603175  0.0000000000  0.0432863235  1.1000244617  0.0563850403  0             0.5897037983 
0.6440000000  0.6587301587  0.6600000000  0.6666666667  0.6551204819  0.6566265060  0.4563253012  0.4759036145  0.6523809524  3.2000000000  0.0994176602  0.9691410804  0.0604739189  50            0.1699775696 
0.6840000000  0.6587301587  0.6560000000  0.6825396825  0.6912650602  0.6566265060  0.6626506024  0.6987951807  0.6269841270  6.4000000000  0.2455618179  0.6700106359  0.0604739189  100           0.1701580906 
0.7200000000  0.7142857143  0.6500000000  0.6666666667  0.8283132530  0.8132530120  0.7771084337  0.7710843373  0.3523809524  9.6000000000  0.1976618505  0.5401401013  0.0604739189  150           0.1668471479 
0.6740000000  0.6587301587  0.6680000000  0.6666666667  0.6897590361  0.6987951807  0.7274096386  0.7409638554  0.5936507937  12.800000000  0.2794322777  0.4777357382  0.0604739189  200           0.1790312004 
0.8380000000  0.8809523810  0.8380000000  0.8253968254  0.8780120482  0.8734939759  0.7831325301  0.7469879518  0.4333333333  16.000000000  0.2876765585  0.4506772000  0.0604739189  250           0.1625810242 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.2560000000  0.3253968254  0.2620000000  0.2777777778  0.2906626506  0.2831325301  0.2921686747  0.2771084337  0.3126984127  0.0000000000  0.0396261215  1.1010289192  0.0563850403  0             0.5197160244 
0.6800000000  0.6507936508  0.6460000000  0.6349206349  0.5512048193  0.5662650602  0.5512048193  0.5542168675  0.6603174603  3.2000000000  0.0255895090  1.0854006243  0.0604739189  50            0.1656234455 
0.6940000000  0.7460317460  0.6200000000  0.6507936508  0.8057228916  0.7650602410  0.5331325301  0.5542168675  0.6698412698  6.4000000000  0.1961049247  0.7627940869  0.0604739189  100           0.1596928263 
0.6820000000  0.6984126984  0.6660000000  0.6666666667  0.8418674699  0.8012048193  0.8027108434  0.8253012048  0.6015873016  9.6000000000  0.1666902101  0.5800361884  0.0604739189  150           0.1633769941 
0.7220000000  0.7380952381  0.6460000000  0.6507936508  0.9066265060  0.8433734940  0.7951807229  0.8313253012  0.6222222222  12.800000000  0.2741268611  0.5601853436  0.0604739189  200           0.1577675438 
0.7820000000  0.7936507937  0.6520000000  0.5714285714  0.9608433735  0.9397590361  0.9427710843  0.9397590361  0.6349206349  16.000000000  0.2960773993  0.4976209152  0.0604739189  250           0.1575469542 
0.6720000000  0.6984126984  0.6900000000  0.6904761905  0.6611445783  0.6325301205  0.7891566265  0.7831325301  0.5349206349  19.200000000  0.2272310197  0.4993092680  0.0604739189  300           0.1620654535 
0.6800000000  0.6269841270  0.7100000000  0.6984126984  0.8704819277  0.8313253012  0.7484939759  0.7530120482  0.5174603175  22.400000000  0.2680245054  0.4856311357  0.0604739189  350           0.1608107853 
0.7760000000  0.7460317460  0.7200000000  0.6984126984  0.8524096386  0.7951807229  0.8524096386  0.9036144578  0.5158730159  25.600000000  0.2426204109  0.4511017627  0.0604739189  400           0.1578072929 
0.8960000000  0.8650793651  0.8600000000  0.8015873016  0.8900602410  0.8734939759  0.8207831325  0.7951807229  0.4285714286  28.800000000  0.3035048211  0.4044757736  0.0604739189  450           0.1681309605 
0.9280000000  0.8650793651  0.9540000000  0.9603174603  0.9277108434  0.9277108434  0.9638554217  0.9759036145  0.3825396825  32.000000000  0.3193297255  0.2880754533  0.0604739189  500           0.1707341528 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3540000000  0.3174603175  0.5316265060  0.5361445783  0.5466867470  0.5240963855  0.3365079365  0.0000000000  0.5104279518  1.1402245760  0.0539793968  0             0.4819111824 
0.6680000000  0.6666666667  0.6360000000  0.6349206349  0.6536144578  0.6265060241  0.6189759036  0.6325301205  0.6285714286  3.2000000000  0.2076164460  0.8693717039  0.0604138374  50            0.1594464731 
0.6960000000  0.7380952381  0.6080000000  0.5714285714  0.7575301205  0.7168674699  0.8870481928  0.8734939759  0.8063492063  6.4000000000  0.2432170355  0.6177644175  0.0604138374  100           0.1501928091 
0.7400000000  0.7380952381  0.7100000000  0.6587301587  0.9457831325  0.9397590361  0.8990963855  0.9216867470  0.7777777778  9.6000000000  0.2637195837  0.5240718794  0.0604138374  150           0.1508714199 
0.7420000000  0.7619047619  0.7120000000  0.6666666667  0.6656626506  0.6626506024  0.7861445783  0.7831325301  0.7412698413  12.800000000  0.2095799923  0.4712464768  0.0604138374  200           0.1522014189 
0.8880000000  0.8809523810  0.9020000000  0.8968253968  0.9774096386  0.9578313253  0.9563253012  0.9337349398  0.6079365079  16.000000000  0.2331167853  0.4091199833  0.0604138374  250           0.1495867205 
0.9500000000  0.9206349206  0.9280000000  0.9047619048  0.9412650602  0.9216867470  0.9864457831  0.9698795181  0.4031746032  19.200000000  0.2114526153  0.3086546701  0.0604138374  300           0.1477407646 
0.9740000000  0.9285714286  0.9220000000  0.8968253968  0.9864457831  0.9578313253  0.9969879518  0.9879518072  0.6253968254  22.400000000  0.2391678149  0.2442075852  0.0604138374  350           0.1517891121 
0.9840000000  0.9444444444  0.9860000000  0.9841269841  0.9849397590  0.9518072289  0.9849397590  0.9879518072  0.2380952381  25.600000000  0.2024867463  0.1770180936  0.0604138374  400           0.1594973326 
0.9860000000  0.9603174603  0.9700000000  0.9047619048  0.9984939759  0.9939759036  0.9939759036  1.0000000000  0.4095238095  28.800000000  0.1680414277  0.1154674342  0.0604138374  450           0.1572975016 
0.9940000000  0.9603174603  0.9920000000  0.9682539683  0.9849397590  0.9638554217  0.9969879518  0.9759036145  0.1555555556  32.000000000  0.1334624621  0.0765555478  0.0604138374  500           0.1536583710 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3540000000  0.3174603175  0.5316265060  0.5361445783  0.5466867470  0.5240963855  0.3365079365  0.0000000000  0.5104279518  1.1402245760  0.0539793968  0             0.4652049541 
0.6680000000  0.6666666667  0.6360000000  0.6349206349  0.6536144578  0.6265060241  0.6189759036  0.6325301205  0.6285714286  3.2000000000  0.2076164460  0.8693717039  0.0604138374  50            0.1383913708 
0.6960000000  0.7380952381  0.6080000000  0.5714285714  0.7575301205  0.7168674699  0.8870481928  0.8734939759  0.8063492063  6.4000000000  0.2432170355  0.6177644175  0.0604138374  100           0.1423813200 
0.7400000000  0.7380952381  0.7100000000  0.6587301587  0.9457831325  0.9397590361  0.8990963855  0.9216867470  0.7777777778  9.6000000000  0.2637195837  0.5240718794  0.0604138374  150           0.1479567289 
0.7420000000  0.7619047619  0.7120000000  0.6666666667  0.6656626506  0.6626506024  0.7861445783  0.7831325301  0.7412698413  12.800000000  0.2095799923  0.4712464768  0.0604138374  200           0.1474119520 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3540000000  0.3174603175  0.5316265060  0.5361445783  0.5466867470  0.5240963855  0.3365079365  0.0000000000  0.5104279518  1.1402245760  0.0539793968  0             0.4302132130 
0.6500000000  0.6507936508  0.6080000000  0.5793650794  0.5933734940  0.5903614458  0.4563253012  0.5000000000  0.6666666667  1.6000000000  0.1482427359  0.9958185005  0.0604138374  25            0.1323550415 
0.6640000000  0.6666666667  0.6500000000  0.6587301587  0.6536144578  0.6144578313  0.5858433735  0.5843373494  0.6444444444  3.2000000000  0.2669648552  0.7394020295  0.0604138374  50            0.1403119850 
0.7020000000  0.7460317460  0.6840000000  0.6349206349  0.9036144578  0.8674698795  0.9367469880  0.9518072289  0.7238095238  4.8000000000  0.2441966653  0.6281824470  0.0604138374  75            0.1541340446 
0.7700000000  0.8015873016  0.6860000000  0.6825396825  0.8298192771  0.7650602410  0.7108433735  0.7349397590  0.6714285714  6.4000000000  0.2846725082  0.5546271694  0.0604138374  100           0.1391300774 
0.7540000000  0.7460317460  0.7280000000  0.6349206349  0.8659638554  0.8132530120  0.7801204819  0.7831325301  0.7047619048  8.0000000000  0.2706520557  0.5396898806  0.0604138374  125           0.1460766315 
0.7940000000  0.7222222222  0.6960000000  0.6349206349  0.8072289157  0.7590361446  0.8283132530  0.8313253012  0.7015873016  9.6000000000  0.2038818192  0.4818796647  0.0604138374  150           0.1404079437 
0.7640000000  0.7777777778  0.7300000000  0.6746031746  0.8975903614  0.9036144578  0.9096385542  0.9277108434  0.7063492063  11.200000000  0.2462684584  0.4803949583  0.0604138374  175           0.1416246510 
0.8980000000  0.7777777778  0.8000000000  0.7619047619  0.9743975904  0.9457831325  0.9969879518  1.0000000000  0.6619047619  12.800000000  0.1923328876  0.4355854082  0.0604138374  200           0.1361857033 
0.8060000000  0.7222222222  0.8260000000  0.7142857143  0.9834337349  0.9698795181  0.9864457831  0.9819277108  0.5761904762  14.400000000  0.1808121538  0.4139729416  0.0604138374  225           0.1397931957 
0.8820000000  0.8492063492  0.8100000000  0.7380952381  0.9849397590  0.9638554217  0.9894578313  0.9819277108  0.7190476190  16.000000000  0.1807844424  0.3503190911  0.0604138374  250           0.1405271053 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [4]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3360000000  0.3333333333  0.3540000000  0.3174603175  0.5316265060  0.5361445783  0.5466867470  0.5240963855  0.3365079365  0.0000000000  0.5104279518  1.1402245760  0.0539793968  0             0.4685058594 
0.6680000000  0.6666666667  0.6360000000  0.6349206349  0.6536144578  0.6265060241  0.6189759036  0.6325301205  0.6285714286  3.2000000000  0.2076164460  0.8693717039  0.0604581833  50            0.1647381115 
0.6960000000  0.7380952381  0.6080000000  0.5714285714  0.7575301205  0.7168674699  0.8870481928  0.8734939759  0.8063492063  6.4000000000  0.2432170355  0.6177644175  0.0604581833  100           0.1676606607 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 0.001
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3320000000  0.3333333333  0.3300000000  0.3333333333  0.3320000000  0.3333333333  0.3320000000  0.3333333333  0.3343373494  0.3373493976  0.3343373494  0.3373493976  0.3333333333  0.0000000000  0.5372090340  1.1565986872  0.0797834396  0             0.6038038731 
0.6640000000  0.7857142857  0.6100000000  0.5952380952  0.7220000000  0.7460317460  0.6640000000  0.6428571429  0.8780120482  0.8734939759  0.6430722892  0.6807228916  0.8507936508  3.2000000000  0.2691297722  0.8447713888  0.0853281021  50            0.2198990393 
0.5760000000  0.6111111111  0.6060000000  0.6349206349  0.6160000000  0.5873015873  0.6220000000  0.6349206349  0.8765060241  0.8192771084  0.9593373494  0.9578313253  0.5952380952  6.4000000000  0.2322409689  0.6194779086  0.0869860649  100           0.2216328812 
0.8040000000  0.8253968254  0.7300000000  0.7142857143  0.7800000000  0.7857142857  0.7660000000  0.6825396825  0.9231927711  0.9216867470  0.8810240964  0.8855421687  0.5984126984  9.6000000000  0.2456116343  0.5488112324  0.0869860649  150           0.2225274611 
0.7660000000  0.7539682540  0.7240000000  0.6587301587  0.7560000000  0.7539682540  0.7340000000  0.6269841270  0.9743975904  0.9939759036  0.9382530120  0.9337349398  0.5079365079  12.800000000  0.2035201395  0.4880273867  0.0869860649  200           0.2178070974 
0.7560000000  0.7619047619  0.7240000000  0.6904761905  0.7480000000  0.7698412698  0.7260000000  0.6984126984  0.7801204819  0.7590361446  0.8644578313  0.7951807229  0.4650793651  16.000000000  0.2323970592  0.4891025430  0.0869860649  250           0.2226324892 
0.8660000000  0.8650793651  0.8680000000  0.8571428571  0.8640000000  0.8174603175  0.8500000000  0.7936507937  0.9819277108  0.9879518072  0.9804216867  0.9698795181  0.6285714286  19.200000000  0.1940684330  0.4527049506  0.0869860649  300           0.2220196199 
0.9060000000  0.9285714286  0.8860000000  0.9206349206  0.9320000000  0.9206349206  0.8900000000  0.8015873016  0.9713855422  0.9337349398  0.9201807229  0.9096385542  0.6952380952  22.400000000  0.2109565127  0.3724147457  0.0869860649  350           0.2211005545 
0.8380000000  0.8809523810  0.8140000000  0.7936507937  0.8460000000  0.8333333333  0.8560000000  0.7698412698  0.9533132530  0.9096385542  0.9472891566  0.9337349398  0.5936507937  25.600000000  0.2436474359  0.3057471308  0.0869860649  400           0.2209750175 
0.8200000000  0.8333333333  0.8160000000  0.8333333333  0.8080000000  0.7936507937  0.8220000000  0.7857142857  0.8117469880  0.8012048193  0.8825301205  0.8313253012  0.5936507937  28.800000000  0.2818799743  0.2585724819  0.0869860649  450           0.2309437418 
0.9800000000  0.9682539683  0.9700000000  0.9603174603  0.9920000000  0.9841269841  0.9440000000  0.8412698413  0.9819277108  0.9759036145  0.9608433735  0.9156626506  0.4984126984  32.000000000  0.2664031357  0.2159881672  0.0869860649  500           0.2229127741 
0.9900000000  0.9682539683  0.9900000000  0.9761904762  0.9960000000  0.9682539683  0.9720000000  0.8492063492  0.9894578313  0.9819277108  1.0000000000  1.0000000000  0.2698412698  35.200000000  0.1856450897  0.1181040401  0.0869860649  550           0.2321680927 
0.9840000000  0.9603174603  0.9880000000  0.9682539683  0.9900000000  0.9603174603  0.9580000000  0.8492063492  1.0000000000  1.0000000000  0.9984939759  0.9939759036  0.3507936508  38.400000000  0.1751036536  0.0797405478  0.0869860649  600           0.2170093393 
0.9960000000  0.9841269841  0.9960000000  0.9841269841  1.0000000000  0.9841269841  0.9820000000  0.8968253968  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4222222222  41.600000000  0.1210436233  0.0477613582  0.0869860649  650           0.2443073177 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3253968254  0.3140000000  0.3095238095  0.3200000000  0.3095238095  0.3260000000  0.3174603175  0.3418674699  0.3313253012  0.3253012048  0.3253012048  0.3301587302  0.0000000000  0.2722291946  1.1565986872  0.0797834396  0             0.4635887146 
0.4740000000  0.3730158730  0.4220000000  0.3809523810  0.4500000000  0.4365079365  0.3840000000  0.3968253968  0.3448795181  0.4397590361  0.3433734940  0.3373493976  0.3380952381  3.2000000000  0.1544886827  1.1207703900  0.0852260590  50            0.1652401018 
0.5540000000  0.4603174603  0.4920000000  0.5238095238  0.5460000000  0.5396825397  0.4360000000  0.4444444444  0.4668674699  0.4698795181  0.5436746988  0.5602409639  0.4142857143  6.4000000000  0.1184755945  1.0891820765  0.0852260590  100           0.1644295788 
0.5660000000  0.5079365079  0.4720000000  0.5158730159  0.5700000000  0.5793650794  0.4620000000  0.4682539683  0.5316265060  0.5240963855  0.5873493976  0.5783132530  0.4730158730  9.6000000000  0.1194817019  1.0758772254  0.0852260590  150           0.1657776022 
0.5920000000  0.5555555556  0.5380000000  0.5317460317  0.6040000000  0.6428571429  0.4920000000  0.5158730159  0.6475903614  0.6626506024  0.6475903614  0.6385542169  0.4730158730  12.800000000  0.1158650064  1.0618484449  0.0852260590  200           0.1695486259 
0.5880000000  0.5238095238  0.5340000000  0.5714285714  0.5860000000  0.6269841270  0.5020000000  0.5634920635  0.7093373494  0.7409638554  0.6777108434  0.6987951807  0.4825396825  16.000000000  0.1059204841  1.0534774232  0.0852260590  250           0.1658240509 
0.6100000000  0.5555555556  0.5500000000  0.5476190476  0.6000000000  0.6269841270  0.5140000000  0.5634920635  0.6942771084  0.6686746988  0.7243975904  0.6927710843  0.5015873016  19.200000000  0.1014678621  1.0429224730  0.0852260590  300           0.1659727192 
0.6260000000  0.6031746032  0.5980000000  0.5396825397  0.6280000000  0.6507936508  0.5740000000  0.5873015873  0.7259036145  0.7228915663  0.6867469880  0.6987951807  0.5365079365  22.400000000  0.1064037299  1.0331210423  0.0852260590  350           0.1650372505 
0.6360000000  0.6428571429  0.6120000000  0.5396825397  0.6360000000  0.6507936508  0.6120000000  0.6031746032  0.6927710843  0.6746987952  0.6656626506  0.6746987952  0.5984126984  25.600000000  0.0974659157  1.0201967287  0.0852260590  400           0.1650453901 
0.6200000000  0.6507936508  0.5720000000  0.5317460317  0.6100000000  0.6111111111  0.5740000000  0.5634920635  0.7003012048  0.7048192771  0.6987951807  0.7108433735  0.5857142857  28.800000000  0.1065224934  1.0135683250  0.0852260590  450           0.1674646425 
0.6340000000  0.6428571429  0.6100000000  0.5396825397  0.6320000000  0.6111111111  0.6200000000  0.6269841270  0.6957831325  0.6867469880  0.6490963855  0.6566265060  0.6349206349  32.000000000  0.0984298348  1.0013400519  0.0852260590  500           0.1655094814 
0.6340000000  0.6587301587  0.6180000000  0.5793650794  0.6440000000  0.6587301587  0.6480000000  0.6269841270  0.6490963855  0.6325301205  0.6009036145  0.6084337349  0.6682539683  35.200000000  0.1118360949  0.9843401313  0.0852260590  550           0.1692189169 
0.6160000000  0.6269841270  0.6100000000  0.5396825397  0.6140000000  0.6031746032  0.6180000000  0.6031746032  0.7319277108  0.7469879518  0.7213855422  0.7289156627  0.6682539683  38.400000000  0.0984796524  0.9741658270  0.0852260590  600           0.1652108383 
0.6200000000  0.6190476190  0.6280000000  0.5793650794  0.6080000000  0.6031746032  0.6380000000  0.6111111111  0.7530120482  0.7710843373  0.6927710843  0.7228915663  0.6619047619  41.600000000  0.1213161063  0.9581727767  0.0852260590  650           0.1687188911 
0.6320000000  0.6269841270  0.6640000000  0.6428571429  0.6320000000  0.6349206349  0.6760000000  0.6269841270  0.7816265060  0.7650602410  0.6340361446  0.6445783133  0.6936507937  44.800000000  0.1128176427  0.9445607483  0.0852260590  700           0.1650005865 
0.6180000000  0.6190476190  0.6440000000  0.5952380952  0.6340000000  0.6190476190  0.6240000000  0.6190476190  0.8192771084  0.8192771084  0.7243975904  0.7530120482  0.6460317460  48.000000000  0.1269800997  0.9262285018  0.0852260590  750           0.1892209053 
0.6340000000  0.6349206349  0.6380000000  0.6190476190  0.6520000000  0.6428571429  0.6440000000  0.6349206349  0.7816265060  0.7530120482  0.5692771084  0.5903614458  0.6666666667  51.200000000  0.1327141619  0.9081164539  0.0852260590  800           0.1801123190 
0.6400000000  0.6507936508  0.6300000000  0.5873015873  0.6540000000  0.6507936508  0.6480000000  0.6349206349  0.8072289157  0.7951807229  0.6355421687  0.6385542169  0.6984126984  54.400000000  0.1432804561  0.8864027822  0.0852260590  850           0.1669283724 
0.6000000000  0.6190476190  0.6140000000  0.5952380952  0.6360000000  0.6031746032  0.6220000000  0.6031746032  0.8900602410  0.8734939759  0.7710843373  0.7831325301  0.6555555556  57.600000000  0.1591554260  0.8687282264  0.0852260590  900           0.1679271936 
0.6220000000  0.6587301587  0.6300000000  0.5634920635  0.6680000000  0.6269841270  0.6560000000  0.6190476190  0.8313253012  0.8313253012  0.7515060241  0.7530120482  0.7206349206  60.800000000  0.1593129826  0.8485453117  0.0852260590  950           0.1647543287 
0.6300000000  0.6190476190  0.6340000000  0.5476190476  0.6560000000  0.6428571429  0.6580000000  0.6031746032  0.8975903614  0.8915662651  0.8463855422  0.8433734940  0.7031746032  64.000000000  0.1675474715  0.8266539288  0.0852260590  1000          0.1683379745 
0.6140000000  0.6190476190  0.5800000000  0.5476190476  0.6220000000  0.6031746032  0.5820000000  0.5714285714  0.9277108434  0.9277108434  0.8719879518  0.8734939759  0.6126984127  67.200000000  0.1633302593  0.8065039968  0.0852260590  1050          0.1644049358 
0.6420000000  0.6746031746  0.6480000000  0.5634920635  0.6720000000  0.6587301587  0.6440000000  0.6428571429  0.8930722892  0.8734939759  0.7138554217  0.7349397590  0.7253968254  70.400000000  0.1855308127  0.7887789297  0.0852260590  1100          0.1643803549 
0.6740000000  0.7063492063  0.6860000000  0.5793650794  0.7120000000  0.6825396825  0.7100000000  0.6349206349  0.9713855422  0.9457831325  0.7801204819  0.7951807229  0.7682539683  73.600000000  0.1913229990  0.7687027574  0.0852260590  1150          0.1655732965 
0.6680000000  0.6666666667  0.6400000000  0.5952380952  0.6760000000  0.6428571429  0.6660000000  0.6507936508  0.9563253012  0.9337349398  0.8659638554  0.8855421687  0.7333333333  76.800000000  0.1828426933  0.7533786285  0.0852260590  1200          0.1681631994 
0.6920000000  0.7063492063  0.6560000000  0.5873015873  0.7180000000  0.6666666667  0.6740000000  0.6428571429  0.9593373494  0.9457831325  0.7665662651  0.7530120482  0.7761904762  80.000000000  0.1957743931  0.7423572898  0.0852260590  1250          0.1674437046 
0.7120000000  0.7619047619  0.6980000000  0.6190476190  0.7540000000  0.7142857143  0.7200000000  0.6587301587  0.9548192771  0.9277108434  0.8177710843  0.8132530120  0.7698412698  83.200000000  0.1890363955  0.7207564855  0.0852260590  1300          0.1645438147 
0.7020000000  0.7063492063  0.6900000000  0.6031746032  0.7320000000  0.7222222222  0.7080000000  0.6507936508  0.9548192771  0.9277108434  0.8885542169  0.8915662651  0.7634920635  86.400000000  0.1862720799  0.7070063281  0.0852260590  1350          0.1676726627 
0.6980000000  0.7380952381  0.6720000000  0.6031746032  0.7420000000  0.7142857143  0.6980000000  0.6349206349  0.9277108434  0.9036144578  0.7756024096  0.8012048193  0.7904761905  89.600000000  0.2132072806  0.6918192708  0.0852260590  1400          0.1692154455 
0.7580000000  0.7936507937  0.6980000000  0.6031746032  0.7720000000  0.7539682540  0.7100000000  0.6666666667  0.9442771084  0.8975903614  0.8132530120  0.8192771084  0.7555555556  92.800000000  0.1993752241  0.6843316019  0.0852260590  1450          0.1656434059 
0.7160000000  0.7698412698  0.6460000000  0.5714285714  0.7620000000  0.7460317460  0.6920000000  0.6428571429  0.9322289157  0.9337349398  0.7831325301  0.7831325301  0.8095238095  96.000000000  0.2073163629  0.6680391502  0.0852260590  1500          0.1666638851 
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3253968254  0.3140000000  0.3095238095  0.3200000000  0.3095238095  0.3260000000  0.3174603175  0.3418674699  0.3313253012  0.3253012048  0.3253012048  0.3301587302  0.0000000000  0.2722291946  1.1565986872  0.0797834396  0             0.5367941856 
0.4740000000  0.3730158730  0.4220000000  0.3809523810  0.4500000000  0.4365079365  0.3840000000  0.3968253968  0.3448795181  0.4397590361  0.3433734940  0.3373493976  0.3380952381  3.2000000000  0.1544886827  1.1207703900  0.0853466988  50            0.2064672041 
0.5540000000  0.4603174603  0.4920000000  0.5238095238  0.5460000000  0.5396825397  0.4360000000  0.4444444444  0.4668674699  0.4698795181  0.5436746988  0.5602409639  0.4142857143  6.4000000000  0.1184755945  1.0891820765  0.0854506493  100           0.2072489262 
0.5660000000  0.5079365079  0.4720000000  0.5158730159  0.5700000000  0.5793650794  0.4620000000  0.4682539683  0.5316265060  0.5240963855  0.5873493976  0.5783132530  0.4730158730  9.6000000000  0.1194817019  1.0758772254  0.0855102539  150           0.1874603748 
0.5920000000  0.5555555556  0.5380000000  0.5317460317  0.6040000000  0.6428571429  0.4920000000  0.5158730159  0.6475903614  0.6626506024  0.6475903614  0.6385542169  0.4730158730  12.800000000  0.1158650064  1.0618484449  0.0855102539  200           0.2092938089 
0.5880000000  0.5238095238  0.5340000000  0.5714285714  0.5860000000  0.6269841270  0.5020000000  0.5634920635  0.7093373494  0.7409638554  0.6777108434  0.6987951807  0.4825396825  16.000000000  0.1059204841  1.0534774232  0.0855102539  250           0.2090967655 
0.6100000000  0.5555555556  0.5500000000  0.5476190476  0.6000000000  0.6269841270  0.5140000000  0.5634920635  0.6942771084  0.6686746988  0.7243975904  0.6927710843  0.5015873016  19.200000000  0.1014678621  1.0429224730  0.0855102539  300           0.2075488901 
0.6260000000  0.6031746032  0.5980000000  0.5396825397  0.6280000000  0.6507936508  0.5740000000  0.5873015873  0.7259036145  0.7228915663  0.6867469880  0.6987951807  0.5365079365  22.400000000  0.1064037299  1.0331210423  0.0884170532  350           0.2070688057 
0.6360000000  0.6428571429  0.6120000000  0.5396825397  0.6360000000  0.6507936508  0.6120000000  0.6031746032  0.6927710843  0.6746987952  0.6656626506  0.6746987952  0.5984126984  25.600000000  0.0974659157  1.0201967287  0.0884170532  400           0.2158607769 
0.6200000000  0.6507936508  0.5720000000  0.5317460317  0.6100000000  0.6111111111  0.5740000000  0.5634920635  0.7003012048  0.7048192771  0.6987951807  0.7108433735  0.5857142857  28.800000000  0.1065224934  1.0135683250  0.0884170532  450           0.1964288902 
0.6340000000  0.6428571429  0.6100000000  0.5396825397  0.6320000000  0.6111111111  0.6200000000  0.6269841270  0.6957831325  0.6867469880  0.6490963855  0.6566265060  0.6349206349  32.000000000  0.0984298348  1.0013400519  0.0888710022  500           0.2053405190 
0.6340000000  0.6587301587  0.6180000000  0.5793650794  0.6440000000  0.6587301587  0.6480000000  0.6269841270  0.6490963855  0.6325301205  0.6009036145  0.6084337349  0.6682539683  35.200000000  0.1118360949  0.9843401313  0.0888710022  550           0.2059965944 
0.6160000000  0.6269841270  0.6100000000  0.5396825397  0.6140000000  0.6031746032  0.6180000000  0.6031746032  0.7319277108  0.7469879518  0.7213855422  0.7289156627  0.6682539683  38.400000000  0.0984796524  0.9741658270  0.0888710022  600           0.2056425476 
0.6200000000  0.6190476190  0.6280000000  0.5793650794  0.6080000000  0.6031746032  0.6380000000  0.6111111111  0.7530120482  0.7710843373  0.6927710843  0.7228915663  0.6619047619  41.600000000  0.1213161063  0.9581727767  0.0888710022  650           0.2131329536 
0.6320000000  0.6269841270  0.6640000000  0.6428571429  0.6320000000  0.6349206349  0.6760000000  0.6269841270  0.7816265060  0.7650602410  0.6340361446  0.6445783133  0.6936507937  44.800000000  0.1128176427  0.9445607483  0.0888710022  700           0.2072681141 
0.6180000000  0.6190476190  0.6440000000  0.5952380952  0.6340000000  0.6190476190  0.6240000000  0.6190476190  0.8192771084  0.8192771084  0.7243975904  0.7530120482  0.6460317460  48.000000000  0.1269800997  0.9262285018  0.0888710022  750           0.2100253487 
0.6340000000  0.6349206349  0.6380000000  0.6190476190  0.6520000000  0.6428571429  0.6440000000  0.6349206349  0.7816265060  0.7530120482  0.5692771084  0.5903614458  0.6666666667  51.200000000  0.1327141619  0.9081164539  0.0888710022  800           0.2032964134 
0.6400000000  0.6507936508  0.6300000000  0.5873015873  0.6540000000  0.6507936508  0.6480000000  0.6349206349  0.8072289157  0.7951807229  0.6355421687  0.6385542169  0.6984126984  54.400000000  0.1432804561  0.8864027822  0.0888710022  850           0.2110800314 
0.6000000000  0.6190476190  0.6140000000  0.5952380952  0.6360000000  0.6031746032  0.6220000000  0.6031746032  0.8900602410  0.8734939759  0.7710843373  0.7831325301  0.6555555556  57.600000000  0.1591554260  0.8687282264  0.0888710022  900           0.2241643333 
0.6220000000  0.6587301587  0.6300000000  0.5634920635  0.6680000000  0.6269841270  0.6560000000  0.6190476190  0.8313253012  0.8313253012  0.7515060241  0.7530120482  0.7206349206  60.800000000  0.1593129826  0.8485453117  0.0888710022  950           0.2180621052 
0.6300000000  0.6190476190  0.6340000000  0.5476190476  0.6560000000  0.6428571429  0.6580000000  0.6031746032  0.8975903614  0.8915662651  0.8463855422  0.8433734940  0.7031746032  64.000000000  0.1675474715  0.8266539288  0.0888710022  1000          0.2073580313 
0.6140000000  0.6190476190  0.5800000000  0.5476190476  0.6220000000  0.6031746032  0.5820000000  0.5714285714  0.9277108434  0.9277108434  0.8719879518  0.8734939759  0.6126984127  67.200000000  0.1633302593  0.8065039968  0.0888710022  1050          0.2069239473 
0.6420000000  0.6746031746  0.6480000000  0.5634920635  0.6720000000  0.6587301587  0.6440000000  0.6428571429  0.8930722892  0.8734939759  0.7138554217  0.7349397590  0.7253968254  70.400000000  0.1855308127  0.7887789297  0.0888710022  1100          0.2062312174 
0.6740000000  0.7063492063  0.6860000000  0.5793650794  0.7120000000  0.6825396825  0.7100000000  0.6349206349  0.9713855422  0.9457831325  0.7801204819  0.7951807229  0.7682539683  73.600000000  0.1913229990  0.7687027574  0.0888710022  1150          0.2068141985 
0.6680000000  0.6666666667  0.6400000000  0.5952380952  0.6760000000  0.6428571429  0.6660000000  0.6507936508  0.9563253012  0.9337349398  0.8659638554  0.8855421687  0.7333333333  76.800000000  0.1828426933  0.7533786285  0.0888710022  1200          0.2039817190 
0.6920000000  0.7063492063  0.6560000000  0.5873015873  0.7180000000  0.6666666667  0.6740000000  0.6428571429  0.9593373494  0.9457831325  0.7665662651  0.7530120482  0.7761904762  80.000000000  0.1957743931  0.7423572898  0.0888710022  1250          0.2047694921 
0.7120000000  0.7619047619  0.6980000000  0.6190476190  0.7540000000  0.7142857143  0.7200000000  0.6587301587  0.9548192771  0.9277108434  0.8177710843  0.8132530120  0.7698412698  83.200000000  0.1890363955  0.7207564855  0.0888710022  1300          0.2048284435 
0.7020000000  0.7063492063  0.6900000000  0.6031746032  0.7320000000  0.7222222222  0.7080000000  0.6507936508  0.9548192771  0.9277108434  0.8885542169  0.8915662651  0.7634920635  86.400000000  0.1862720799  0.7070063281  0.0888710022  1350          0.2036405754 
0.6980000000  0.7380952381  0.6720000000  0.6031746032  0.7420000000  0.7142857143  0.6980000000  0.6349206349  0.9277108434  0.9036144578  0.7756024096  0.8012048193  0.7904761905  89.600000000  0.2132072806  0.6918192708  0.0888710022  1400          0.2064042234 
0.7580000000  0.7936507937  0.6980000000  0.6031746032  0.7720000000  0.7539682540  0.7100000000  0.6666666667  0.9442771084  0.8975903614  0.8132530120  0.8192771084  0.7555555556  92.800000000  0.1993752241  0.6843316019  0.0888710022  1450          0.2141703844 
0.7160000000  0.7698412698  0.6460000000  0.5714285714  0.7620000000  0.7460317460  0.6920000000  0.6428571429  0.9322289157  0.9337349398  0.7831325301  0.7831325301  0.8095238095  96.000000000  0.2073163629  0.6680391502  0.0888710022  1500          0.2151520252 
0.7420000000  0.7619047619  0.6860000000  0.5714285714  0.7860000000  0.7698412698  0.7140000000  0.6666666667  0.9397590361  0.9277108434  0.8132530120  0.8192771084  0.7761904762  99.200000000  0.2011577916  0.6640601814  0.0888710022  1550          0.2149759531 
0.7180000000  0.7222222222  0.6500000000  0.5873015873  0.7380000000  0.7222222222  0.6860000000  0.6269841270  0.9608433735  0.9277108434  0.9427710843  0.9518072289  0.7047619048  102.40000000  0.2139844465  0.6560400271  0.0888710022  1600          0.2060251141 
0.7620000000  0.7857142857  0.7220000000  0.6190476190  0.7960000000  0.7698412698  0.7440000000  0.6746031746  0.9608433735  0.9397590361  0.9307228916  0.9277108434  0.7539682540  105.60000000  0.2107511282  0.6411354041  0.0888710022  1650          0.2268845177 
0.8240000000  0.8571428571  0.7520000000  0.6190476190  0.8380000000  0.8333333333  0.7760000000  0.6666666667  0.9653614458  0.9457831325  0.8207831325  0.8493975904  0.7857142857  108.80000000  0.2246325040  0.6276383746  0.0888710022  1700          0.2075274038 
0.7680000000  0.8492063492  0.6860000000  0.5793650794  0.7980000000  0.8095238095  0.7380000000  0.6587301587  0.9668674699  0.9638554217  0.8433734940  0.8554216867  0.8206349206  112.00000000  0.2224342728  0.6223346198  0.0888710022  1750          0.2163543367 
0.8200000000  0.8730158730  0.7320000000  0.6031746032  0.8440000000  0.8492063492  0.7640000000  0.6666666667  0.9743975904  0.9578313253  0.8403614458  0.8795180723  0.7857142857  115.20000000  0.2068574798  0.6095946646  0.0888710022  1800          0.2044342279 
0.8580000000  0.8730158730  0.7820000000  0.6349206349  0.8580000000  0.8968253968  0.8040000000  0.6825396825  0.9397590361  0.9156626506  0.7725903614  0.7891566265  0.7412698413  118.40000000  0.2204240203  0.6043451941  0.0888710022  1850          0.3142355251 
0.8120000000  0.8412698413  0.7420000000  0.6349206349  0.8280000000  0.8253968254  0.7680000000  0.6746031746  0.9698795181  0.9397590361  0.9262048193  0.9337349398  0.7492063492  121.60000000  0.2013894475  0.5905274820  0.0888710022  1900          0.2867955923 
0.8100000000  0.8492063492  0.7340000000  0.6428571429  0.8240000000  0.8412698413  0.7600000000  0.6825396825  0.9698795181  0.9397590361  0.9442771084  0.9578313253  0.7603174603  124.80000000  0.2033714306  0.5884153676  0.0888710022  1950          0.1959643412 
0.8380000000  0.8412698413  0.7400000000  0.6190476190  0.8340000000  0.8253968254  0.7700000000  0.6825396825  0.9759036145  0.9518072289  0.9262048193  0.9337349398  0.7412698413  128.00000000  0.2310346019  0.5806294858  0.0888710022  2000          0.1971624708 
0.8500000000  0.8650793651  0.7600000000  0.6507936508  0.8460000000  0.8412698413  0.7760000000  0.6746031746  0.9774096386  0.9457831325  0.8945783133  0.9036144578  0.7412698413  131.20000000  0.2050395501  0.5666530752  0.0888710022  2050          0.1984427452 
0.8560000000  0.8650793651  0.7480000000  0.6349206349  0.8380000000  0.8412698413  0.7680000000  0.6746031746  0.9819277108  0.9638554217  0.9096385542  0.9277108434  0.7555555556  134.40000000  0.2256916535  0.5658751869  0.0888710022  2100          0.1998646021 
0.8500000000  0.8809523810  0.7700000000  0.6507936508  0.8560000000  0.8412698413  0.7820000000  0.6666666667  0.9789156627  0.9518072289  0.8945783133  0.8915662651  0.7523809524  137.60000000  0.2078167737  0.5628793979  0.0888710022  2150          0.2053372812 
0.8520000000  0.8650793651  0.7560000000  0.6507936508  0.8420000000  0.8571428571  0.7700000000  0.6666666667  0.9759036145  0.9518072289  0.9141566265  0.9216867470  0.7571428571  140.80000000  0.1895221615  0.5647891045  0.0888710022  2200          0.2013569641 
0.8540000000  0.8650793651  0.7560000000  0.6507936508  0.8460000000  0.8571428571  0.7760000000  0.6666666667  0.9728915663  0.9397590361  0.9186746988  0.9277108434  0.7507936508  144.00000000  0.2179312277  0.5624397099  0.0888710022  2250          0.1996041346 
0.8680000000  0.8888888889  0.7800000000  0.6746031746  0.8660000000  0.8650793651  0.7940000000  0.6825396825  0.9713855422  0.9457831325  0.8810240964  0.8975903614  0.7539682540  147.20000000  0.2026646888  0.5598987985  0.0888710022  2300          0.2182677269 
0.8340000000  0.8492063492  0.7340000000  0.6190476190  0.8480000000  0.8174603175  0.7560000000  0.6666666667  0.9683734940  0.9457831325  0.9337349398  0.9518072289  0.7476190476  150.40000000  0.1871585107  0.5589229178  0.0888710022  2350          0.2040420675 
0.8360000000  0.8492063492  0.7380000000  0.6190476190  0.8460000000  0.8253968254  0.7560000000  0.6666666667  0.9683734940  0.9457831325  0.9367469880  0.9518072289  0.7460317460  153.60000000  0.2085763466  0.5621658003  0.0888710022  2400          0.2175087833 
0.8360000000  0.8492063492  0.7400000000  0.6111111111  0.8520000000  0.8333333333  0.7560000000  0.6666666667  0.9759036145  0.9518072289  0.9367469880  0.9518072289  0.7492063492  156.80000000  0.2303323913  0.5530853724  0.0888710022  2450          0.2117033052 
0.8720000000  0.8888888889  0.7860000000  0.6904761905  0.8680000000  0.8809523810  0.8020000000  0.6825396825  0.9698795181  0.9397590361  0.8885542169  0.9036144578  0.7428571429  160.00000000  0.1858905661  0.5575859928  0.0888710022  2500          0.2125447321 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [7]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_in_acc   env6_out_acc  env7_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3140000000  0.2619047619  0.3380000000  0.3095238095  0.3000000000  0.3412698413  0.3280000000  0.3095238095  0.3298192771  0.3313253012  0.3222891566  0.3253012048  0.3012048193  0.3253012048  0.3380952381  0.0000000000  0.1351609230  1.1249580383  0.0910148621  0             0.6327919960 
0.4040000000  0.3809523810  0.3940000000  0.4047619048  0.4000000000  0.4285714286  0.3980000000  0.3412698413  0.4518072289  0.5180722892  0.3629518072  0.3674698795  0.4171686747  0.3915662651  0.3682539683  3.2000000000  0.1862542677  1.1121840286  0.0971469879  50            0.2294187403 
0.4460000000  0.3888888889  0.4160000000  0.4365079365  0.4300000000  0.4920634921  0.4200000000  0.3650793651  0.4819277108  0.4457831325  0.5015060241  0.5000000000  0.3885542169  0.4096385542  0.4095238095  6.4000000000  0.1489149046  1.0924064112  0.0971469879  100           0.2263600969 
0.4560000000  0.3809523810  0.4520000000  0.4444444444  0.4460000000  0.4682539683  0.4640000000  0.3650793651  0.4939759036  0.4578313253  0.6039156627  0.5722891566  0.4066265060  0.4457831325  0.4428571429  9.6000000000  0.1509052181  1.0785429788  0.0992074013  150           0.2317038345 
0.5240000000  0.3968253968  0.5120000000  0.4761904762  0.4920000000  0.4920634921  0.5280000000  0.4761904762  0.4367469880  0.4578313253  0.5587349398  0.5481927711  0.5361445783  0.5301204819  0.4904761905  12.800000000  0.1331025720  1.0703495574  0.0992074013  200           0.2299615431 
0.5620000000  0.4682539683  0.5460000000  0.5079365079  0.5360000000  0.5476190476  0.5800000000  0.5158730159  0.4412650602  0.4277108434  0.5286144578  0.5481927711  0.5542168675  0.5301204819  0.5190476190  16.000000000  0.1190822935  1.0627261710  0.0992074013  250           0.2308711529 
0.5520000000  0.4444444444  0.5440000000  0.4920634921  0.5280000000  0.5079365079  0.5000000000  0.4761904762  0.4984939759  0.5120481928  0.6490963855  0.6325301205  0.6129518072  0.5963855422  0.5063492063  19.200000000  0.1109992218  1.0554923630  0.0992074013  300           0.2341402960 
0.5560000000  0.4920634921  0.5560000000  0.5158730159  0.5380000000  0.5317460317  0.5000000000  0.4761904762  0.5256024096  0.5120481928  0.7063253012  0.6927710843  0.6355421687  0.6265060241  0.5158730159  22.400000000  0.1122069168  1.0484794521  0.0992074013  350           0.2317879820 
0.6020000000  0.4841269841  0.5960000000  0.5952380952  0.5860000000  0.6111111111  0.5980000000  0.5714285714  0.5000000000  0.5301204819  0.6310240964  0.5722891566  0.5527108434  0.5120481928  0.5634920635  25.600000000  0.1124492002  1.0405554318  0.0992074013  400           0.2329407406 
0.5900000000  0.5317460317  0.5780000000  0.5873015873  0.5800000000  0.6111111111  0.5720000000  0.5793650794  0.5466867470  0.5722891566  0.7409638554  0.7228915663  0.6596385542  0.6506024096  0.5841269841  28.800000000  0.1115769029  1.0352879333  0.0992074013  450           0.2496618652 
0.6040000000  0.5396825397  0.6100000000  0.5952380952  0.5820000000  0.5793650794  0.6060000000  0.5873015873  0.6099397590  0.6084337349  0.7560240964  0.7228915663  0.6174698795  0.6144578313  0.6000000000  32.000000000  0.1069652343  1.0294722152  0.0992074013  500           0.2306539440 
0.6020000000  0.5158730159  0.5660000000  0.5714285714  0.5700000000  0.5714285714  0.5820000000  0.5555555556  0.6430722892  0.6204819277  0.7710843373  0.7108433735  0.6400602410  0.6325301205  0.6111111111  35.200000000  0.1144498396  1.0217731810  0.0992074013  550           0.2296379089 
0.5980000000  0.4920634921  0.5780000000  0.5793650794  0.5680000000  0.5873015873  0.6060000000  0.5952380952  0.6490963855  0.6204819277  0.7590361446  0.7228915663  0.6355421687  0.6506024096  0.6111111111  38.400000000  0.1027507019  1.0143549097  0.0992074013  600           0.2314209795 
0.5860000000  0.4920634921  0.6040000000  0.5793650794  0.5660000000  0.6190476190  0.6380000000  0.5634920635  0.6114457831  0.6144578313  0.7319277108  0.6987951807  0.5677710843  0.5963855422  0.6507936508  41.600000000  0.1058607578  1.0057372582  0.0992074013  650           0.2375163746 
0.5640000000  0.5079365079  0.5620000000  0.5634920635  0.5420000000  0.5793650794  0.5800000000  0.5555555556  0.7018072289  0.6746987952  0.8192771084  0.7590361446  0.7454819277  0.7289156627  0.6063492063  44.800000000  0.1222471452  0.9959306705  0.0992407799  700           0.2340738487 
0.5560000000  0.5000000000  0.5100000000  0.5158730159  0.5100000000  0.5238095238  0.5180000000  0.5238095238  0.7018072289  0.6746987952  0.8478915663  0.8012048193  0.7560240964  0.7590361446  0.5619047619  48.000000000  0.1185542083  0.9807949436  0.0992407799  750           0.2342115831 
0.5640000000  0.5238095238  0.5660000000  0.5634920635  0.5340000000  0.5714285714  0.5800000000  0.5634920635  0.7048192771  0.6987951807  0.8509036145  0.8012048193  0.7515060241  0.7530120482  0.6111111111  51.200000000  0.1206416774  0.9731580770  0.0992407799  800           0.2404256916 
0.5720000000  0.5396825397  0.5520000000  0.5476190476  0.5600000000  0.5714285714  0.5820000000  0.5873015873  0.7153614458  0.6927710843  0.8584337349  0.7951807229  0.8253012048  0.7831325301  0.6396825397  54.400000000  0.1182325792  0.9619393408  0.0992407799  850           0.2368908978 
0.5500000000  0.5238095238  0.5760000000  0.5476190476  0.5360000000  0.5793650794  0.5900000000  0.5873015873  0.7183734940  0.6566265060  0.8057228916  0.7771084337  0.7650602410  0.7590361446  0.6285714286  57.600000000  0.1211362934  0.9472557592  0.0994105339  900           0.2420282555 
0.5340000000  0.5396825397  0.5540000000  0.5555555556  0.5420000000  0.5714285714  0.5640000000  0.5714285714  0.7334337349  0.6807228916  0.8253012048  0.7831325301  0.7228915663  0.7349397590  0.6380952381  60.800000000  0.1326155567  0.9361664152  0.0994105339  950           0.2456937313 
0.5800000000  0.5555555556  0.5620000000  0.5952380952  0.5560000000  0.6190476190  0.6180000000  0.5952380952  0.7289156627  0.7108433735  0.8509036145  0.8012048193  0.7756024096  0.7650602410  0.6920634921  64.000000000  0.1336424685  0.9214043164  0.0994105339  1000          0.2335821056 
0.5760000000  0.5476190476  0.5580000000  0.5634920635  0.5500000000  0.6190476190  0.6200000000  0.5952380952  0.8117469880  0.7409638554  0.8569277108  0.8132530120  0.8644578313  0.8433734940  0.6984126984  67.200000000  0.1366707373  0.9092539501  0.0994105339  1050          0.2424594641 
0.5800000000  0.5634920635  0.5960000000  0.5714285714  0.5480000000  0.6428571429  0.6280000000  0.5714285714  0.7846385542  0.7168674699  0.8448795181  0.8012048193  0.8418674699  0.8132530120  0.7190476190  70.400000000  0.1260119820  0.8976218903  0.0994105339  1100          0.2382588148 
0.6080000000  0.5714285714  0.5900000000  0.5476190476  0.5800000000  0.6507936508  0.6460000000  0.5952380952  0.8373493976  0.7590361446  0.8268072289  0.7891566265  0.8388554217  0.8012048193  0.7650793651  73.600000000  0.1390969133  0.8802597654  0.0994105339  1150          0.2440419865 
0.5580000000  0.5396825397  0.5620000000  0.5396825397  0.5260000000  0.5952380952  0.6040000000  0.5793650794  0.8343373494  0.7590361446  0.8524096386  0.8192771084  0.8614457831  0.8313253012  0.6873015873  76.800000000  0.1420643687  0.8744918859  0.0994105339  1200          0.2403361034 
0.6060000000  0.5793650794  0.5940000000  0.5555555556  0.5660000000  0.6190476190  0.6400000000  0.6111111111  0.8478915663  0.7771084337  0.8072289157  0.7951807229  0.8765060241  0.8313253012  0.7111111111  80.000000000  0.1615306044  0.8572483969  0.0994372368  1250          0.2343486881 
0.5860000000  0.5555555556  0.5660000000  0.5238095238  0.5420000000  0.6190476190  0.6160000000  0.5952380952  0.8780120482  0.8493975904  0.8524096386  0.8192771084  0.8975903614  0.8915662651  0.7253968254  83.200000000  0.1533435774  0.8423812258  0.0994372368  1300          0.2447692871 
0.5760000000  0.5238095238  0.5600000000  0.5396825397  0.5540000000  0.6031746032  0.5820000000  0.5952380952  0.8644578313  0.8072289157  0.8659638554  0.8253012048  0.9051204819  0.8855421687  0.6952380952  86.400000000  0.1622938585  0.8280675352  0.0994372368  1350          0.2489391422 
0.6080000000  0.5634920635  0.5920000000  0.5396825397  0.5800000000  0.6190476190  0.6280000000  0.5873015873  0.8493975904  0.8313253012  0.8524096386  0.8192771084  0.8795180723  0.8674698795  0.7444444444  89.600000000  0.1815754867  0.8154979515  0.0994372368  1400          0.2419243860 
0.6200000000  0.5714285714  0.5860000000  0.5317460317  0.5960000000  0.6428571429  0.6320000000  0.6269841270  0.8780120482  0.8373493976  0.8674698795  0.8433734940  0.8885542169  0.8795180723  0.7349206349  92.800000000  0.1558082891  0.8035867357  0.0994372368  1450          0.2414026642 
0.6260000000  0.5873015873  0.6100000000  0.5476190476  0.6000000000  0.6666666667  0.6600000000  0.6269841270  0.8463855422  0.8072289157  0.8554216867  0.8313253012  0.8780120482  0.8493975904  0.7365079365  96.000000000  0.1754438496  0.7935247099  0.0994372368  1500          0.2445629930 
0.6340000000  0.5873015873  0.6120000000  0.5634920635  0.6260000000  0.6746031746  0.6640000000  0.6349206349  0.8885542169  0.8433734940  0.8493975904  0.8192771084  0.8990963855  0.8855421687  0.7380952381  99.200000000  0.1687100315  0.7764712822  0.0994372368  1550          0.2401597977 
0.6560000000  0.5873015873  0.6140000000  0.5714285714  0.6220000000  0.6746031746  0.6700000000  0.5873015873  0.8734939759  0.8313253012  0.8509036145  0.8253012048  0.8840361446  0.8734939759  0.7444444444  102.40000000  0.1763436627  0.7592512894  0.0994372368  1600          0.2552045059 
0.6800000000  0.6111111111  0.6220000000  0.6031746032  0.6580000000  0.7222222222  0.6700000000  0.6349206349  0.8810240964  0.8373493976  0.8493975904  0.8313253012  0.9156626506  0.9397590361  0.7428571429  105.60000000  0.1795464706  0.7455667508  0.0994405746  1650          0.2349739361 
0.7460000000  0.6825396825  0.6440000000  0.6190476190  0.7180000000  0.8015873016  0.6820000000  0.6507936508  0.8644578313  0.8433734940  0.8343373494  0.8072289157  0.8990963855  0.8975903614  0.7634920635  108.80000000  0.1740268946  0.7413811779  0.0994992256  1700          0.2354087639 
0.6940000000  0.6269841270  0.6320000000  0.5952380952  0.6720000000  0.7142857143  0.6700000000  0.6507936508  0.8900602410  0.8855421687  0.8825301205  0.8433734940  0.9397590361  0.9518072289  0.7619047619  112.00000000  0.1864410114  0.7194326007  0.0994992256  1750          0.2314267826 
0.6960000000  0.6428571429  0.6260000000  0.6111111111  0.6560000000  0.7301587302  0.6700000000  0.6666666667  0.8870481928  0.8855421687  0.8704819277  0.8313253012  0.9262048193  0.9457831325  0.7571428571  115.20000000  0.1987322330  0.7065239990  0.0994992256  1800          0.2347420263 
0.6500000000  0.6269841270  0.6160000000  0.6031746032  0.6440000000  0.6984126984  0.6340000000  0.6507936508  0.9427710843  0.9397590361  0.8433734940  0.8313253012  0.9503012048  0.9698795181  0.7285714286  118.40000000  0.1989060307  0.6896782720  0.0994992256  1850          0.2320761251 
0.6920000000  0.6507936508  0.6180000000  0.6031746032  0.6680000000  0.7380952381  0.6620000000  0.6666666667  0.9307228916  0.8795180723  0.8554216867  0.8192771084  0.9096385542  0.8915662651  0.7603174603  121.60000000  0.2008424044  0.6824477267  0.0994992256  1900          0.2322348404 
0.7260000000  0.6507936508  0.6500000000  0.6587301587  0.6880000000  0.7698412698  0.6800000000  0.6666666667  0.9442771084  0.8975903614  0.8343373494  0.7951807229  0.9322289157  0.9216867470  0.7555555556  124.80000000  0.2024154925  0.6697825694  0.0994992256  1950          0.2345411062 
0.7320000000  0.6904761905  0.6540000000  0.6587301587  0.7340000000  0.7698412698  0.6960000000  0.6587301587  0.9307228916  0.9277108434  0.8810240964  0.8614457831  0.9322289157  0.9337349398  0.7968253968  128.00000000  0.1945795417  0.6662469506  0.0994992256  2000          0.2340382338 
0.7260000000  0.6666666667  0.6280000000  0.6190476190  0.7320000000  0.7777777778  0.6720000000  0.6507936508  0.9578313253  0.9518072289  0.8629518072  0.8373493976  0.9593373494  0.9698795181  0.8000000000  131.20000000  0.1831067824  0.6553204226  0.0994992256  2050          0.2318470764 
0.7900000000  0.7539682540  0.6800000000  0.6746031746  0.7840000000  0.8650793651  0.7220000000  0.6904761905  0.9277108434  0.9036144578  0.8629518072  0.8253012048  0.9367469880  0.9397590361  0.7666666667  134.40000000  0.2171097136  0.6488016760  0.0994992256  2100          0.2330372190 
0.7420000000  0.6984126984  0.6300000000  0.6190476190  0.7180000000  0.8015873016  0.6880000000  0.6507936508  0.9533132530  0.9457831325  0.8463855422  0.8192771084  0.9578313253  0.9638554217  0.7714285714  137.60000000  0.1980210233  0.6490523028  0.0994992256  2150          0.2339376736 
0.7560000000  0.7222222222  0.6420000000  0.6190476190  0.7200000000  0.8174603175  0.6920000000  0.6746031746  0.9457831325  0.9036144578  0.8539156627  0.8253012048  0.9533132530  0.9578313253  0.7619047619  140.80000000  0.1971025991  0.6484947038  0.0994992256  2200          0.2333537006 
0.7740000000  0.7460317460  0.6740000000  0.6111111111  0.7460000000  0.8650793651  0.7020000000  0.6825396825  0.9322289157  0.9096385542  0.8524096386  0.8192771084  0.9427710843  0.9397590361  0.7682539683  144.00000000  0.1921756411  0.6512790978  0.1001296043  2250          0.2354727268 
0.7560000000  0.7380952381  0.6560000000  0.6507936508  0.7200000000  0.8412698413  0.6980000000  0.6746031746  0.9427710843  0.9036144578  0.8509036145  0.8253012048  0.9487951807  0.9397590361  0.7714285714  147.20000000  0.2026482964  0.6467734694  0.1001296043  2300          0.2356639338 
0.7340000000  0.6984126984  0.6400000000  0.6428571429  0.7080000000  0.8015873016  0.6840000000  0.6587301587  0.9472891566  0.9216867470  0.8524096386  0.8313253012  0.9533132530  0.9457831325  0.7682539683  150.40000000  0.1847152615  0.6502011371  0.1001296043  2350          0.2348846769 
0.7720000000  0.7460317460  0.6740000000  0.6190476190  0.7420000000  0.8571428571  0.7080000000  0.6825396825  0.9382530120  0.8975903614  0.8539156627  0.8253012048  0.9487951807  0.9397590361  0.7730158730  153.60000000  0.2093061280  0.6472279954  0.1001296043  2400          0.2351710701 
0.7520000000  0.7301587302  0.6560000000  0.6428571429  0.7120000000  0.8095238095  0.6940000000  0.6746031746  0.9503012048  0.9216867470  0.8524096386  0.8313253012  0.9518072289  0.9518072289  0.7714285714  156.80000000  0.2083157325  0.6474041831  0.1001296043  2450          0.2346038866 
0.7540000000  0.7301587302  0.6680000000  0.6269841270  0.7260000000  0.8095238095  0.6960000000  0.6825396825  0.9487951807  0.9036144578  0.8478915663  0.8253012048  0.9472891566  0.9457831325  0.7714285714  160.00000000  0.2081712556  0.6443991613  0.1011710167  2500          0.2337515020 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3253968254  0.3180000000  0.3095238095  0.3240000000  0.3253968254  0.3320000000  0.3174603175  0.3388554217  0.3313253012  0.4367469880  0.4337349398  0.3317460317  0.0000000000  0.3638734818  1.1401700974  0.0797834396  0             0.5194711685 
0.4500000000  0.3809523810  0.4200000000  0.3888888889  0.4460000000  0.4206349206  0.3940000000  0.3888888889  0.4006024096  0.4939759036  0.3343373494  0.3493975904  0.3523809524  3.2000000000  0.1580935431  1.1155875444  0.0853319168  50            0.2188893652 
0.5180000000  0.5079365079  0.4600000000  0.4603174603  0.5240000000  0.5238095238  0.4140000000  0.4523809524  0.5496987952  0.5722891566  0.4292168675  0.4156626506  0.4285714286  6.4000000000  0.1250150728  1.0895631886  0.0869722366  100           0.2160651684 
0.5460000000  0.5238095238  0.4960000000  0.4761904762  0.5380000000  0.5476190476  0.4560000000  0.4682539683  0.5150602410  0.5662650602  0.5542168675  0.5421686747  0.4444444444  9.6000000000  0.1273934841  1.0767691207  0.0869722366  150           0.2255431795 
0.6080000000  0.6031746032  0.5320000000  0.5555555556  0.6100000000  0.5714285714  0.5000000000  0.5000000000  0.5075301205  0.5361445783  0.5421686747  0.5542168675  0.5047619048  12.800000000  0.1209230042  1.0655985212  0.0869722366  200           0.2137385845 
0.6020000000  0.6190476190  0.5680000000  0.4920634921  0.6220000000  0.5952380952  0.5560000000  0.5634920635  0.6234939759  0.6385542169  0.5888554217  0.5361445783  0.5174603175  16.000000000  0.1093135738  1.0558388925  0.0869722366  250           0.2095808887 
0.5880000000  0.5634920635  0.5520000000  0.5000000000  0.6040000000  0.5714285714  0.5120000000  0.5238095238  0.6219879518  0.6084337349  0.6777108434  0.6385542169  0.5301587302  19.200000000  0.1020642400  1.0466545391  0.0869722366  300           0.2213399267 
0.5820000000  0.6190476190  0.5720000000  0.5000000000  0.6020000000  0.6031746032  0.5500000000  0.5634920635  0.6762048193  0.6686746988  0.7243975904  0.7168674699  0.5746031746  22.400000000  0.1190449357  1.0343870926  0.0869722366  350           0.2174189806 
0.6080000000  0.6349206349  0.6120000000  0.5238095238  0.6440000000  0.6269841270  0.6140000000  0.6428571429  0.6129518072  0.5843373494  0.6852409639  0.6204819277  0.6666666667  25.600000000  0.1063707185  1.0253300285  0.0869722366  400           0.2072551155 
0.6020000000  0.6031746032  0.5760000000  0.4682539683  0.6100000000  0.6269841270  0.5640000000  0.5793650794  0.5828313253  0.5843373494  0.6566265060  0.6867469880  0.6507936508  28.800000000  0.1063515019  1.0196600091  0.0869722366  450           0.2115553713 
0.5840000000  0.6349206349  0.6040000000  0.4920634921  0.6280000000  0.6269841270  0.6100000000  0.6111111111  0.6310240964  0.5843373494  0.7966867470  0.7650602410  0.7126984127  32.000000000  0.1055709386  1.0125812292  0.0869722366  500           0.2135689831 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3253968254  0.3180000000  0.3095238095  0.3240000000  0.3253968254  0.3320000000  0.3174603175  0.3388554217  0.3313253012  0.4367469880  0.4337349398  0.3317460317  0.0000000000  0.3638734818  1.1401700974  0.0797834396  0             0.7568962574 
0.4500000000  0.3809523810  0.4200000000  0.3888888889  0.4460000000  0.4206349206  0.3940000000  0.3888888889  0.4006024096  0.4939759036  0.3343373494  0.3493975904  0.3523809524  3.2000000000  0.1580935431  1.1155875444  0.0872716904  50            0.2283362198 
0.5180000000  0.5079365079  0.4600000000  0.4603174603  0.5240000000  0.5238095238  0.4140000000  0.4523809524  0.5496987952  0.5722891566  0.4292168675  0.4156626506  0.4285714286  6.4000000000  0.1250150728  1.0895631886  0.0872716904  100           0.2187272167 
0.5460000000  0.5238095238  0.4960000000  0.4761904762  0.5380000000  0.5476190476  0.4560000000  0.4682539683  0.5150602410  0.5662650602  0.5542168675  0.5421686747  0.4444444444  9.6000000000  0.1273934841  1.0767691207  0.0872716904  150           0.2183150959 
0.6080000000  0.6031746032  0.5320000000  0.5555555556  0.6100000000  0.5714285714  0.5000000000  0.5000000000  0.5075301205  0.5361445783  0.5421686747  0.5542168675  0.5047619048  12.800000000  0.1209230042  1.0655985212  0.0873303413  200           0.2207279205 
0.6020000000  0.6190476190  0.5680000000  0.4920634921  0.6220000000  0.5952380952  0.5560000000  0.5634920635  0.6234939759  0.6385542169  0.5888554217  0.5361445783  0.5174603175  16.000000000  0.1093135738  1.0558388925  0.0873303413  250           0.2175412512 
0.5880000000  0.5634920635  0.5520000000  0.5000000000  0.6040000000  0.5714285714  0.5120000000  0.5238095238  0.6219879518  0.6084337349  0.6777108434  0.6385542169  0.5301587302  19.200000000  0.1020642400  1.0466545391  0.0873303413  300           0.2204770851 
0.5820000000  0.6190476190  0.5720000000  0.5000000000  0.6020000000  0.6031746032  0.5500000000  0.5634920635  0.6762048193  0.6686746988  0.7243975904  0.7168674699  0.5746031746  22.400000000  0.1190449357  1.0343870926  0.0873303413  350           0.2160286093 
0.6080000000  0.6349206349  0.6120000000  0.5238095238  0.6440000000  0.6269841270  0.6140000000  0.6428571429  0.6129518072  0.5843373494  0.6852409639  0.6204819277  0.6666666667  25.600000000  0.1063707185  1.0253300285  0.0873303413  400           0.2222170544 
0.6020000000  0.6031746032  0.5760000000  0.4682539683  0.6100000000  0.6269841270  0.5640000000  0.5793650794  0.5828313253  0.5843373494  0.6566265060  0.6867469880  0.6507936508  28.800000000  0.1063515019  1.0196600091  0.0873303413  450           0.2203320026 
0.5840000000  0.6349206349  0.6040000000  0.4920634921  0.6280000000  0.6269841270  0.6100000000  0.6111111111  0.6310240964  0.5843373494  0.7966867470  0.7650602410  0.7126984127  32.000000000  0.1055709386  1.0125812292  0.0873303413  500           0.2181369019 
0.6280000000  0.6587301587  0.6400000000  0.5317460317  0.6580000000  0.6825396825  0.6600000000  0.6746031746  0.5933734940  0.5903614458  0.7078313253  0.6746987952  0.7460317460  35.200000000  0.1058873272  1.0013822675  0.0873303413  550           0.2238059473 
0.5940000000  0.6111111111  0.5940000000  0.5000000000  0.6220000000  0.6428571429  0.6120000000  0.6190476190  0.6490963855  0.6084337349  0.8388554217  0.8373493976  0.7126984127  38.400000000  0.1083031511  0.9909198987  0.0873303413  600           0.2264036560 
0.6000000000  0.6111111111  0.6040000000  0.5317460317  0.6220000000  0.6349206349  0.6180000000  0.6190476190  0.7379518072  0.7108433735  0.8313253012  0.7831325301  0.7365079365  41.600000000  0.1137418032  0.9738243639  0.0873303413  650           0.2261844921 
0.6360000000  0.6349206349  0.6360000000  0.5555555556  0.6440000000  0.6666666667  0.6760000000  0.6666666667  0.7123493976  0.6686746988  0.8283132530  0.7951807229  0.7698412698  44.800000000  0.1086969662  0.9623047245  0.0873303413  700           0.2293082094 
0.5900000000  0.5873015873  0.5920000000  0.5634920635  0.6000000000  0.6031746032  0.6220000000  0.6190476190  0.7710843373  0.7228915663  0.8298192771  0.8132530120  0.7380952381  48.000000000  0.1205460668  0.9453114796  0.0873303413  750           0.2344661522 
0.6000000000  0.6111111111  0.6020000000  0.5476190476  0.6160000000  0.6190476190  0.6320000000  0.6349206349  0.8057228916  0.7530120482  0.7921686747  0.7710843373  0.7317460317  51.200000000  0.1284925151  0.9267816651  0.0873303413  800           0.2215222931 
0.6060000000  0.6269841270  0.5740000000  0.5238095238  0.6360000000  0.6507936508  0.6120000000  0.5793650794  0.8177710843  0.7771084337  0.8674698795  0.8554216867  0.7444444444  54.400000000  0.1457773876  0.9076717520  0.0873303413  850           0.2251509523 
0.5960000000  0.6031746032  0.5600000000  0.5238095238  0.6200000000  0.6269841270  0.6060000000  0.5714285714  0.8177710843  0.8253012048  0.8539156627  0.8493975904  0.7317460317  57.600000000  0.1471268010  0.8925776231  0.0873303413  900           0.2209663677 
0.6260000000  0.6190476190  0.6120000000  0.5634920635  0.6560000000  0.6904761905  0.6580000000  0.6031746032  0.7635542169  0.7771084337  0.7846385542  0.7771084337  0.8079365079  60.800000000  0.1524510002  0.8746066892  0.0873303413  950           0.2237984800 
0.5860000000  0.5952380952  0.5980000000  0.5238095238  0.6220000000  0.6190476190  0.6120000000  0.5952380952  0.8253012048  0.8192771084  0.8237951807  0.8012048193  0.7698412698  64.000000000  0.1617017126  0.8546281290  0.0873303413  1000          0.2165808630 
0.5800000000  0.5952380952  0.5680000000  0.5396825397  0.5920000000  0.6031746032  0.5920000000  0.5793650794  0.8629518072  0.8493975904  0.8253012048  0.8072289157  0.7047619048  67.200000000  0.1527569890  0.8340957832  0.0873303413  1050          0.2168735218 
0.5760000000  0.5793650794  0.5680000000  0.5317460317  0.5940000000  0.5634920635  0.5920000000  0.5873015873  0.8237951807  0.8373493976  0.8885542169  0.8674698795  0.7111111111  70.400000000  0.1669726181  0.8242272532  0.0873303413  1100          0.2139699459 
0.6380000000  0.6825396825  0.6500000000  0.5714285714  0.6580000000  0.6507936508  0.6860000000  0.6031746032  0.8343373494  0.8313253012  0.8177710843  0.7891566265  0.7857142857  73.600000000  0.1747312188  0.8014092696  0.0873303413  1150          0.2139575815 
0.6500000000  0.6904761905  0.6540000000  0.5476190476  0.6780000000  0.6746031746  0.6800000000  0.6031746032  0.8750000000  0.8373493976  0.8162650602  0.8072289157  0.8047619048  76.800000000  0.1749128079  0.7839801669  0.0873303413  1200          0.2134429646 
0.6480000000  0.6666666667  0.6320000000  0.5396825397  0.6820000000  0.6428571429  0.6340000000  0.6111111111  0.8448795181  0.8373493976  0.8192771084  0.8072289157  0.8031746032  80.000000000  0.1934076786  0.7739879823  0.0873303413  1250          0.2161963129 
0.6820000000  0.7222222222  0.6660000000  0.5793650794  0.7160000000  0.6825396825  0.7080000000  0.6111111111  0.8283132530  0.8192771084  0.7695783133  0.7289156627  0.8111111111  83.200000000  0.1767304993  0.7572955477  0.0873303413  1300          0.2164245272 
0.6640000000  0.6904761905  0.6340000000  0.5634920635  0.6880000000  0.6666666667  0.6720000000  0.5873015873  0.8810240964  0.8493975904  0.8373493976  0.8192771084  0.7904761905  86.400000000  0.1830739641  0.7450059056  0.0873303413  1350          0.2158926058 
0.6920000000  0.7222222222  0.6400000000  0.5555555556  0.7020000000  0.7063492063  0.6960000000  0.6269841270  0.8373493976  0.8554216867  0.8328313253  0.8253012048  0.8047619048  89.600000000  0.1966630459  0.7265055466  0.0873303413  1400          0.2157931662 
0.6940000000  0.7142857143  0.6620000000  0.5555555556  0.7180000000  0.6666666667  0.6820000000  0.6269841270  0.8900602410  0.8493975904  0.8042168675  0.7831325301  0.7698412698  92.800000000  0.2017957330  0.7149436069  0.0873303413  1450          0.2165185022 
0.7120000000  0.7460317460  0.6560000000  0.5317460317  0.7100000000  0.7063492063  0.7160000000  0.6428571429  0.8313253012  0.8313253012  0.8569277108  0.8493975904  0.8428571429  96.000000000  0.2026235056  0.7006392097  0.0873303413  1500          0.2188620806 
0.7260000000  0.7619047619  0.7080000000  0.5396825397  0.7440000000  0.7460317460  0.7260000000  0.6428571429  0.8524096386  0.8313253012  0.8629518072  0.8734939759  0.8126984127  99.200000000  0.1986841559  0.6963919723  0.0873303413  1550          0.2296368074 
0.6620000000  0.6666666667  0.6460000000  0.5317460317  0.6980000000  0.6825396825  0.6560000000  0.5952380952  0.9503012048  0.9216867470  0.8268072289  0.8373493976  0.7492063492  102.40000000  0.2291113400  0.6859397590  0.0873303413  1600          0.2213345289 
0.7360000000  0.7777777778  0.6940000000  0.5952380952  0.7340000000  0.7539682540  0.7260000000  0.6746031746  0.8990963855  0.8855421687  0.8539156627  0.8493975904  0.8142857143  105.60000000  0.1975062346  0.6703446066  0.0873303413  1650          0.2401972055 
0.7920000000  0.8015873016  0.7520000000  0.6031746032  0.7660000000  0.7936507937  0.7480000000  0.6507936508  0.8478915663  0.8132530120  0.8629518072  0.8975903614  0.7857142857  108.80000000  0.2191330385  0.6609894335  0.0873303413  1700          0.2200713587 
0.7820000000  0.8253968254  0.7260000000  0.6031746032  0.7760000000  0.8095238095  0.7440000000  0.6587301587  0.8644578313  0.8433734940  0.8524096386  0.8674698795  0.8047619048  112.00000000  0.2178034353  0.6542518878  0.0873303413  1750          0.2449532890 
0.7760000000  0.7698412698  0.7060000000  0.6031746032  0.7600000000  0.8015873016  0.7340000000  0.6507936508  0.8704819277  0.8554216867  0.8253012048  0.8433734940  0.8063492063  115.20000000  0.2009363079  0.6402657843  0.0874738693  1800          0.2190541553 
0.8340000000  0.8095238095  0.7680000000  0.6190476190  0.8020000000  0.8333333333  0.8000000000  0.6825396825  0.8478915663  0.8373493976  0.7861445783  0.8072289157  0.7412698413  118.40000000  0.2117098951  0.6313356900  0.0874738693  1850          0.2226751804 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3120000000  0.3095238095  0.2980000000  0.2698412698  0.3180000000  0.3015873016  0.3000000000  0.3174603175  0.3283132530  0.3493975904  0.2771084337  0.2650602410  0.3269841270  0.0000000000  0.2134382725  1.1565986872  0.0797834396  0             0.5575032234 
0.5800000000  0.4603174603  0.5220000000  0.5079365079  0.5160000000  0.5396825397  0.5320000000  0.5158730159  0.6686746988  0.7108433735  0.6460843373  0.6807228916  0.5285714286  3.2000000000  0.1335914946  1.0730924916  0.0853452682  50            0.2251325798 
0.6280000000  0.5476190476  0.5980000000  0.5873015873  0.6180000000  0.6587301587  0.6160000000  0.6111111111  0.7906626506  0.7771084337  0.7996987952  0.7891566265  0.5888888889  6.4000000000  0.1174408293  1.0094651544  0.0853452682  100           0.2286309338 
0.6260000000  0.6190476190  0.6540000000  0.5873015873  0.6300000000  0.6190476190  0.6720000000  0.6031746032  0.6897590361  0.7469879518  0.6234939759  0.6385542169  0.6841269841  9.6000000000  0.1516894841  0.9309160280  0.0853452682  150           0.2226122713 
0.6300000000  0.6666666667  0.6040000000  0.5793650794  0.6460000000  0.6428571429  0.6220000000  0.6031746032  0.8674698795  0.9036144578  0.7334337349  0.7530120482  0.6666666667  12.800000000  0.1773992491  0.8546694148  0.0853452682  200           0.2250338459 
0.5960000000  0.6031746032  0.6100000000  0.5873015873  0.6000000000  0.6269841270  0.6080000000  0.6587301587  0.9608433735  0.9397590361  0.8358433735  0.8493975904  0.6666666667  16.000000000  0.2155786967  0.7835240924  0.0853452682  250           0.2223443508 
0.6600000000  0.6825396825  0.6020000000  0.5476190476  0.6500000000  0.7222222222  0.6020000000  0.5555555556  0.9262048193  0.8975903614  0.9231927711  0.9216867470  0.6380952381  19.200000000  0.2120917988  0.7291096306  0.0853452682  300           0.2196489477 
0.6980000000  0.7301587302  0.6600000000  0.6031746032  0.7180000000  0.7222222222  0.6800000000  0.7063492063  0.9849397590  0.9759036145  0.8042168675  0.8192771084  0.7142857143  22.400000000  0.1933690119  0.6590281415  0.0853452682  350           0.2260889101 
0.7860000000  0.8253968254  0.7120000000  0.6031746032  0.7880000000  0.8015873016  0.7400000000  0.6428571429  0.8222891566  0.8192771084  0.7921686747  0.7951807229  0.7936507937  25.600000000  0.2327243447  0.6246889758  0.0853452682  400           0.2223797655 
0.8340000000  0.8253968254  0.7660000000  0.6984126984  0.8220000000  0.8333333333  0.7960000000  0.6349206349  0.8975903614  0.8674698795  0.8584337349  0.9036144578  0.6936507937  28.800000000  0.2270346558  0.5880960989  0.0853452682  450           0.2177812672 
0.8740000000  0.8571428571  0.7800000000  0.6507936508  0.8680000000  0.8888888889  0.7900000000  0.7142857143  0.9201807229  0.8734939759  0.7530120482  0.7710843373  0.7111111111  32.000000000  0.2341584945  0.5589085543  0.0853452682  500           0.2243416119 
0.8100000000  0.7539682540  0.7840000000  0.7063492063  0.7800000000  0.7460317460  0.7720000000  0.6984126984  0.8493975904  0.8554216867  0.6762048193  0.7289156627  0.5031746032  35.200000000  0.2223257911  0.5321842790  0.0854840279  550           0.2330768204 
0.8840000000  0.8730158730  0.8140000000  0.6984126984  0.8700000000  0.9047619048  0.8180000000  0.6825396825  0.9759036145  0.9397590361  0.8960843373  0.9096385542  0.7666666667  38.400000000  0.1869934309  0.5127269578  0.0854926109  600           0.2234129429 
0.8780000000  0.8492063492  0.7920000000  0.6984126984  0.8820000000  0.8888888889  0.8180000000  0.6666666667  0.9819277108  0.9638554217  0.8704819277  0.8554216867  0.7809523810  41.600000000  0.2088948250  0.4894510144  0.0854992867  650           0.2281891155 
0.9380000000  0.8809523810  0.8680000000  0.8095238095  0.9300000000  0.9206349206  0.8760000000  0.7142857143  0.9608433735  0.9156626506  0.9367469880  0.9638554217  0.6174603175  44.800000000  0.1982915545  0.4809506434  0.0869727135  700           0.2161159897 
0.9320000000  0.9285714286  0.8820000000  0.8095238095  0.9540000000  0.9206349206  0.8660000000  0.7063492063  0.9743975904  0.9337349398  0.9503012048  0.9578313253  0.6380952381  48.000000000  0.2081229293  0.4611222178  0.0869727135  750           0.2309266996 
0.9100000000  0.8809523810  0.8860000000  0.8095238095  0.9280000000  0.9206349206  0.8520000000  0.7142857143  0.9909638554  0.9638554217  0.9909638554  0.9879518072  0.6825396825  51.200000000  0.2086595333  0.4392598069  0.0880651474  800           0.2336780071 
0.9380000000  0.9126984127  0.9180000000  0.8412698413  0.9600000000  0.9285714286  0.8920000000  0.7301587302  0.9638554217  0.9156626506  0.9578313253  0.9638554217  0.5000000000  54.400000000  0.2379268813  0.4132230145  0.0880651474  850           0.2375017071 
0.9460000000  0.9126984127  0.9040000000  0.8174603175  0.9680000000  0.9365079365  0.8800000000  0.7301587302  0.9698795181  0.9156626506  0.9954819277  0.9939759036  0.6460317460  57.600000000  0.1865978169  0.3969758207  0.0880651474  900           0.2271675491 
0.9460000000  0.9047619048  0.9140000000  0.8333333333  0.9340000000  0.8968253968  0.8860000000  0.7222222222  0.9804216867  0.9337349398  0.9698795181  0.9759036145  0.5920634921  60.800000000  0.2199723530  0.3819425708  0.0880651474  950           0.2262997007 
0.9260000000  0.9285714286  0.8960000000  0.8571428571  0.9540000000  0.9682539683  0.8980000000  0.7698412698  0.9397590361  0.9036144578  1.0000000000  1.0000000000  0.6492063492  64.000000000  0.2187565118  0.3682117265  0.0880651474  1000          0.2253652000 
0.9420000000  0.9206349206  0.9300000000  0.8888888889  0.9480000000  0.9444444444  0.9400000000  0.8253968254  0.9939759036  0.9879518072  0.9743975904  0.9698795181  0.6460317460  67.200000000  0.1997874200  0.3414718562  0.0880651474  1050          0.2208018255 
0.9580000000  0.9285714286  0.9180000000  0.8809523810  0.9860000000  0.9603174603  0.8960000000  0.7698412698  1.0000000000  1.0000000000  0.9759036145  0.9759036145  0.7365079365  70.400000000  0.2123393202  0.3163712221  0.0880651474  1100          0.2240971518 
0.9620000000  0.9047619048  0.9660000000  0.9444444444  0.9740000000  0.9365079365  0.9320000000  0.7857142857  0.9894578313  0.9819277108  0.9728915663  0.9638554217  0.4809523810  73.600000000  0.2109334809  0.2864644155  0.0880651474  1150          0.2267854214 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 2.5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3180000000  0.3174603175  0.3080000000  0.2936507937  0.3220000000  0.3015873016  0.3220000000  0.3015873016  0.3418674699  0.3313253012  0.3117469880  0.3072289157  0.3285714286  0.0000000000  0.2492818832  1.1565986872  0.0797834396  0             0.5761153698 
0.5780000000  0.5317460317  0.5320000000  0.5238095238  0.5320000000  0.5158730159  0.5040000000  0.5000000000  0.6310240964  0.6566265060  0.5180722892  0.5180722892  0.4365079365  3.2000000000  0.1295277357  1.0956204772  0.0852704048  50            0.2253821850 
0.6120000000  0.5793650794  0.5140000000  0.4920634921  0.6140000000  0.6190476190  0.5060000000  0.5158730159  0.6234939759  0.6385542169  0.6566265060  0.6867469880  0.5539682540  6.4000000000  0.1101856995  1.0540882993  0.0852704048  100           0.2144087076 
0.5920000000  0.5793650794  0.5520000000  0.4920634921  0.6080000000  0.5634920635  0.5200000000  0.5158730159  0.6219879518  0.6084337349  0.6716867470  0.6626506024  0.5523809524  9.6000000000  0.1141929674  1.0301414394  0.0852704048  150           0.2265069580 
0.5840000000  0.6031746032  0.5680000000  0.5396825397  0.5660000000  0.6031746032  0.5580000000  0.5952380952  0.8283132530  0.8433734940  0.7891566265  0.7831325301  0.5603174603  12.800000000  0.1165585089  1.0002085090  0.0852704048  200           0.2247739601 
0.5480000000  0.5952380952  0.5740000000  0.5317460317  0.5420000000  0.5317460317  0.5620000000  0.5793650794  0.8268072289  0.8132530120  0.8734939759  0.8433734940  0.5682539683  16.000000000  0.1333280349  0.9678820336  0.0852704048  250           0.2261042452 
0.5500000000  0.5634920635  0.5660000000  0.5396825397  0.5520000000  0.5396825397  0.5200000000  0.5158730159  0.8358433735  0.8132530120  0.8840361446  0.8493975904  0.4857142857  19.200000000  0.1369863558  0.9266157126  0.0852704048  300           0.2220376873 
0.5760000000  0.6269841270  0.5920000000  0.5634920635  0.6320000000  0.5952380952  0.6100000000  0.5873015873  0.9262048193  0.8975903614  0.7530120482  0.7710843373  0.6428571429  22.400000000  0.1547832775  0.8768273962  0.0852704048  350           0.2237408829 
0.6200000000  0.6507936508  0.6260000000  0.5476190476  0.6660000000  0.6031746032  0.6460000000  0.6190476190  0.7500000000  0.7349397590  0.7635542169  0.7530120482  0.7174603175  25.600000000  0.1707912922  0.8364335489  0.0853185654  400           0.2229489851 
0.6020000000  0.6825396825  0.6300000000  0.6031746032  0.6300000000  0.5873015873  0.6560000000  0.6031746032  0.9412650602  0.9096385542  0.8162650602  0.8192771084  0.6952380952  28.800000000  0.1766977453  0.8031736314  0.0853185654  450           0.2245129871 
0.6320000000  0.6587301587  0.6120000000  0.5714285714  0.6760000000  0.6111111111  0.6700000000  0.6587301587  0.8283132530  0.7951807229  0.7756024096  0.8012048193  0.7444444444  32.000000000  0.1790299940  0.7676414287  0.0853185654  500           0.2262695074 
0.7580000000  0.7698412698  0.7280000000  0.6349206349  0.7940000000  0.7698412698  0.7520000000  0.6825396825  0.8433734940  0.8072289157  0.6400602410  0.6807228916  0.7507936508  35.200000000  0.1880898571  0.7243472612  0.0874071121  550           0.2266695738 
0.6880000000  0.7063492063  0.6460000000  0.6111111111  0.7100000000  0.7142857143  0.6780000000  0.6507936508  0.9186746988  0.8915662651  0.8734939759  0.8795180723  0.7285714286  38.400000000  0.1924474740  0.6950207758  0.0874071121  600           0.2250299978 
0.7220000000  0.7777777778  0.6820000000  0.6111111111  0.7400000000  0.7380952381  0.7280000000  0.6349206349  0.9713855422  0.9578313253  0.8524096386  0.8795180723  0.7555555556  41.600000000  0.2069679379  0.6588293993  0.0874071121  650           0.2273603725 
0.7820000000  0.7857142857  0.7320000000  0.6984126984  0.7760000000  0.8412698413  0.7460000000  0.6825396825  0.9668674699  0.9397590361  0.8448795181  0.8614457831  0.6920634921  44.800000000  0.1948839569  0.6375621212  0.0874071121  700           0.2188950396 
0.7620000000  0.8015873016  0.6920000000  0.6190476190  0.7840000000  0.8095238095  0.7100000000  0.6587301587  0.9774096386  0.9698795181  0.8810240964  0.8734939759  0.6968253968  48.000000000  0.2126626074  0.6155484855  0.0874071121  750           0.2174868441 
0.7640000000  0.8333333333  0.7120000000  0.6507936508  0.7880000000  0.7936507937  0.7400000000  0.6507936508  0.9849397590  0.9638554217  0.8795180723  0.8915662651  0.7000000000  51.200000000  0.2068608081  0.5925316417  0.0874071121  800           0.2217860603 
0.8540000000  0.8888888889  0.7740000000  0.7142857143  0.8520000000  0.8968253968  0.8040000000  0.6825396825  0.9623493976  0.9457831325  0.8177710843  0.8493975904  0.6952380952  54.400000000  0.2514314795  0.5720560515  0.0874071121  850           0.2237320805 
0.8580000000  0.8571428571  0.7680000000  0.6587301587  0.8700000000  0.8730158730  0.7740000000  0.6984126984  0.9819277108  0.9638554217  0.9262048193  0.9457831325  0.7365079365  57.600000000  0.1859317648  0.5604927135  0.0874071121  900           0.2111444378 
0.8660000000  0.8809523810  0.8020000000  0.6507936508  0.8640000000  0.9126984127  0.8000000000  0.6746031746  0.9789156627  0.9638554217  0.9322289157  0.9457831325  0.7142857143  60.800000000  0.2184109497  0.5485873359  0.0874071121  950           0.2205948067 
0.8180000000  0.8333333333  0.7620000000  0.7222222222  0.8440000000  0.8650793651  0.7600000000  0.6904761905  0.9352409639  0.9096385542  1.0000000000  1.0000000000  0.6888888889  64.000000000  0.2157301724  0.5338762599  0.0874071121  1000          0.2251073742 
0.8660000000  0.8730158730  0.7940000000  0.7142857143  0.8680000000  0.8968253968  0.7820000000  0.6825396825  0.9683734940  0.9457831325  0.9743975904  0.9698795181  0.6984126984  67.200000000  0.2094054961  0.5110971528  0.0874071121  1050          0.2240072155 
0.8260000000  0.8095238095  0.7900000000  0.7301587302  0.8440000000  0.8412698413  0.7720000000  0.7142857143  0.9834337349  0.9578313253  0.9743975904  0.9819277108  0.6492063492  70.400000000  0.2312392795  0.5037702888  0.0874071121  1100          0.2302273893 
0.9100000000  0.8888888889  0.8400000000  0.7539682540  0.9080000000  0.9444444444  0.8260000000  0.6904761905  0.9804216867  0.9819277108  0.9743975904  0.9698795181  0.6777777778  73.600000000  0.2186479783  0.4754680270  0.0874071121  1150          0.2153967237 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 3.75e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3080000000  0.2936507937  0.3080000000  0.2857142857  0.3220000000  0.2936507937  0.3160000000  0.3174603175  0.3388554217  0.3313253012  0.2951807229  0.2771084337  0.3238095238  0.0000000000  0.2308082581  1.1565986872  0.0797834396  0             0.5136086941 
0.6420000000  0.5317460317  0.5880000000  0.5238095238  0.5840000000  0.6111111111  0.5740000000  0.5476190476  0.6581325301  0.6566265060  0.4879518072  0.5180722892  0.4984126984  3.2000000000  0.1304135251  1.0807814837  0.0852980614  50            0.2251511431 
0.6420000000  0.6031746032  0.5780000000  0.5396825397  0.6360000000  0.6269841270  0.6080000000  0.5793650794  0.7319277108  0.7349397590  0.6837349398  0.6626506024  0.6539682540  6.4000000000  0.1121708775  1.0350106215  0.0852980614  100           0.2240758038 
0.5900000000  0.5952380952  0.6040000000  0.5476190476  0.6040000000  0.5793650794  0.5980000000  0.6269841270  0.7409638554  0.7349397590  0.6174698795  0.6506024096  0.6698412698  9.6000000000  0.1158292079  0.9933179343  0.0853290558  150           0.2257715988 
0.6440000000  0.6746031746  0.6580000000  0.6031746032  0.6340000000  0.6111111111  0.6520000000  0.6031746032  0.8750000000  0.8734939759  0.6807228916  0.6746987952  0.6841269841  12.800000000  0.1453926444  0.9318203378  0.0853428841  200           0.2165979004 
0.5580000000  0.5952380952  0.6000000000  0.6111111111  0.5580000000  0.5873015873  0.5920000000  0.6031746032  0.9201807229  0.9216867470  0.7996987952  0.7891566265  0.6222222222  16.000000000  0.1760732937  0.8700490677  0.0853428841  250           0.2150635958 
0.5780000000  0.5952380952  0.5860000000  0.5317460317  0.5560000000  0.5873015873  0.5320000000  0.5634920635  0.8659638554  0.8855421687  0.8990963855  0.8975903614  0.5380952381  19.200000000  0.1906592345  0.8035132742  0.0853428841  300           0.2146865129 
0.6600000000  0.7142857143  0.6520000000  0.5793650794  0.7140000000  0.6904761905  0.6940000000  0.6507936508  0.9352409639  0.9216867470  0.7560240964  0.7590361446  0.7444444444  22.400000000  0.1882676315  0.7350840724  0.0853428841  350           0.2152851534 
0.7360000000  0.7777777778  0.6820000000  0.5158730159  0.7760000000  0.7539682540  0.7020000000  0.6666666667  0.8328313253  0.8253012048  0.7484939759  0.7650602410  0.8000000000  25.600000000  0.2074824214  0.6968257403  0.0853428841  400           0.2109033537 
0.7840000000  0.8174603175  0.7000000000  0.5952380952  0.7700000000  0.7936507937  0.7480000000  0.7142857143  0.9186746988  0.8795180723  0.7951807229  0.8072289157  0.7809523810  28.800000000  0.2121024108  0.6581720901  0.0912756920  450           0.2148801231 
0.8400000000  0.8333333333  0.7600000000  0.5952380952  0.8280000000  0.8492063492  0.7620000000  0.6904761905  0.9472891566  0.9216867470  0.7469879518  0.7831325301  0.7523809524  32.000000000  0.2209305573  0.6275552225  0.0912756920  500           0.2169291544 
0.8500000000  0.7936507937  0.7960000000  0.7301587302  0.8220000000  0.8174603175  0.7900000000  0.7142857143  0.8704819277  0.8674698795  0.6927710843  0.7108433735  0.6476190476  35.200000000  0.2026624274  0.5930623877  0.0912756920  550           0.2170612240 
0.8460000000  0.8492063492  0.7580000000  0.6428571429  0.8500000000  0.8650793651  0.7680000000  0.6904761905  0.9608433735  0.9156626506  0.8463855422  0.8433734940  0.7888888889  38.400000000  0.1941604424  0.5688170922  0.0912756920  600           0.2144115162 
0.8160000000  0.8095238095  0.7220000000  0.5952380952  0.8320000000  0.8174603175  0.7640000000  0.7142857143  0.9683734940  0.9337349398  0.8810240964  0.9096385542  0.7888888889  41.600000000  0.2106862783  0.5419345933  0.0912756920  650           0.2108295107 
0.8060000000  0.7539682540  0.8180000000  0.7460317460  0.7860000000  0.8095238095  0.8200000000  0.6904761905  0.9533132530  0.8975903614  0.9292168675  0.9457831325  0.6269841270  44.800000000  0.2081077027  0.5263480020  0.0912756920  700           0.2143288183 
0.8980000000  0.8968253968  0.8200000000  0.6507936508  0.8940000000  0.9047619048  0.8060000000  0.6825396825  0.9698795181  0.9397590361  0.9126506024  0.8915662651  0.6888888889  48.000000000  0.2206155705  0.5104971069  0.0912756920  750           0.2107531643 
0.8920000000  0.8730158730  0.8000000000  0.6587301587  0.9040000000  0.9126984127  0.8140000000  0.7222222222  0.9939759036  0.9879518072  0.8975903614  0.8795180723  0.7174603175  51.200000000  0.1998708689  0.4889795506  0.0912756920  800           0.2124193811 
0.9000000000  0.8650793651  0.8680000000  0.7777777778  0.9060000000  0.9206349206  0.8520000000  0.7063492063  0.9683734940  0.9457831325  0.9021084337  0.9216867470  0.5873015873  54.400000000  0.2516277552  0.4697307259  0.0912756920  850           0.2131053209 
0.9100000000  0.9126984127  0.8240000000  0.7301587302  0.9360000000  0.9285714286  0.8160000000  0.6984126984  0.9743975904  0.9216867470  0.9743975904  0.9698795181  0.6936507937  57.600000000  0.1842205024  0.4588001013  0.0912756920  900           0.2124891233 
0.9120000000  0.8968253968  0.9060000000  0.8333333333  0.9400000000  0.9285714286  0.8860000000  0.7301587302  0.9653614458  0.9578313253  0.9533132530  0.9698795181  0.6380952381  60.800000000  0.2083386302  0.4481080770  0.0912756920  950           0.2222138453 
Exception ignored in: <bound method _MultiProcessingDataLoaderIter.__del__ of <torch.utils.data.dataloader._MultiProcessingDataLoaderIter object at 0x7f3a002459b0>>

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 2.812885384798702e-06
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3120000000  0.3095238095  0.2980000000  0.2698412698  0.3180000000  0.3015873016  0.3000000000  0.3174603175  0.3283132530  0.3493975904  0.2771084337  0.2650602410  0.3269841270  0.0000000000  0.2134382725  1.1565986872  0.0797834396  0             0.5076317787 
0.5800000000  0.4603174603  0.5220000000  0.5079365079  0.5160000000  0.5396825397  0.5320000000  0.5158730159  0.6686746988  0.7108433735  0.6460843373  0.6807228916  0.5285714286  3.2000000000  0.1335914946  1.0730924916  0.0852704048  50            0.2086033583 
0.6280000000  0.5476190476  0.5980000000  0.5873015873  0.6180000000  0.6587301587  0.6160000000  0.6111111111  0.7906626506  0.7771084337  0.7996987952  0.7891566265  0.5888888889  6.4000000000  0.1174408293  1.0094651544  0.0852842331  100           0.2126242733 
0.6260000000  0.6190476190  0.6540000000  0.5873015873  0.6300000000  0.6190476190  0.6720000000  0.6031746032  0.6897590361  0.7469879518  0.6234939759  0.6385542169  0.6841269841  9.6000000000  0.1516894841  0.9309160280  0.0852842331  150           0.2112137318 
0.6300000000  0.6666666667  0.6040000000  0.5793650794  0.6460000000  0.6428571429  0.6220000000  0.6031746032  0.8674698795  0.9036144578  0.7334337349  0.7530120482  0.6666666667  12.800000000  0.1773992491  0.8546694148  0.0852842331  200           0.2098725796 
0.5960000000  0.6031746032  0.6100000000  0.5873015873  0.6000000000  0.6269841270  0.6080000000  0.6587301587  0.9608433735  0.9397590361  0.8358433735  0.8493975904  0.6666666667  16.000000000  0.2155786967  0.7835240924  0.0856280327  250           0.2086600018 
0.6600000000  0.6825396825  0.6020000000  0.5476190476  0.6500000000  0.7222222222  0.6020000000  0.5555555556  0.9262048193  0.8975903614  0.9231927711  0.9216867470  0.6380952381  19.200000000  0.2120917988  0.7291096306  0.0856280327  300           0.2118985462 
0.6980000000  0.7301587302  0.6600000000  0.6031746032  0.7180000000  0.7222222222  0.6800000000  0.7063492063  0.9849397590  0.9759036145  0.8042168675  0.8192771084  0.7142857143  22.400000000  0.1933690119  0.6590281415  0.0856280327  350           0.2079576349 
0.7860000000  0.8253968254  0.7120000000  0.6031746032  0.7880000000  0.8015873016  0.7400000000  0.6428571429  0.8222891566  0.8192771084  0.7921686747  0.7951807229  0.7936507937  25.600000000  0.2327243447  0.6246889758  0.0869860649  400           0.2123261833 
0.8340000000  0.8253968254  0.7660000000  0.6984126984  0.8220000000  0.8333333333  0.7960000000  0.6349206349  0.8975903614  0.8674698795  0.8584337349  0.9036144578  0.6936507937  28.800000000  0.2270346558  0.5880960989  0.0869860649  450           0.2089498425 
0.8740000000  0.8571428571  0.7800000000  0.6507936508  0.8680000000  0.8888888889  0.7900000000  0.7142857143  0.9201807229  0.8734939759  0.7530120482  0.7710843373  0.7111111111  32.000000000  0.2341584945  0.5589085543  0.0869860649  500           0.2112977886 
0.8100000000  0.7539682540  0.7840000000  0.7063492063  0.7800000000  0.7460317460  0.7720000000  0.6984126984  0.8493975904  0.8554216867  0.6762048193  0.7289156627  0.5031746032  35.200000000  0.2223257911  0.5321842790  0.0869860649  550           0.2088873339 
0.8840000000  0.8730158730  0.8140000000  0.6984126984  0.8700000000  0.9047619048  0.8180000000  0.6825396825  0.9759036145  0.9397590361  0.8960843373  0.9096385542  0.7666666667  38.400000000  0.1869934309  0.5127269578  0.0869860649  600           0.2136850739 
0.8780000000  0.8492063492  0.7920000000  0.6984126984  0.8820000000  0.8888888889  0.8180000000  0.6666666667  0.9819277108  0.9638554217  0.8704819277  0.8554216867  0.7809523810  41.600000000  0.2088948250  0.4894510144  0.0869860649  650           0.2251355934 
0.9380000000  0.8809523810  0.8680000000  0.8095238095  0.9300000000  0.9206349206  0.8760000000  0.7142857143  0.9608433735  0.9156626506  0.9367469880  0.9638554217  0.6174603175  44.800000000  0.1982915545  0.4809506434  0.0872530937  700           0.2149449301 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 2.812885384798702e-05
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3120000000  0.3095238095  0.2980000000  0.2698412698  0.3180000000  0.3015873016  0.3000000000  0.3174603175  0.3283132530  0.3493975904  0.2771084337  0.2650602410  0.3269841270  0.0000000000  0.2134382725  1.1565986872  0.0797834396  0             0.5057268143 
0.5800000000  0.4603174603  0.5220000000  0.5079365079  0.5160000000  0.5396825397  0.5320000000  0.5158730159  0.6686746988  0.7108433735  0.6460843373  0.6807228916  0.5285714286  3.2000000000  0.1335914946  1.0730924916  0.0884575844  50            0.2109881973 
0.6280000000  0.5476190476  0.5980000000  0.5873015873  0.6180000000  0.6587301587  0.6160000000  0.6111111111  0.7906626506  0.7771084337  0.7996987952  0.7891566265  0.5888888889  6.4000000000  0.1174408293  1.0094651544  0.0884575844  100           0.2193127203 
0.6260000000  0.6190476190  0.6540000000  0.5873015873  0.6300000000  0.6190476190  0.6720000000  0.6031746032  0.6897590361  0.7469879518  0.6234939759  0.6385542169  0.6841269841  9.6000000000  0.1516894841  0.9309160280  0.0884575844  150           0.2228213358 
0.6300000000  0.6666666667  0.6040000000  0.5793650794  0.6460000000  0.6428571429  0.6220000000  0.6031746032  0.8674698795  0.9036144578  0.7334337349  0.7530120482  0.6666666667  12.800000000  0.1773992491  0.8546694148  0.0884575844  200           0.2103127050 
0.5960000000  0.6031746032  0.6100000000  0.5873015873  0.6000000000  0.6269841270  0.6080000000  0.6587301587  0.9608433735  0.9397590361  0.8358433735  0.8493975904  0.6666666667  16.000000000  0.2155786967  0.7835240924  0.0884575844  250           0.2234876633 
0.6600000000  0.6825396825  0.6020000000  0.5476190476  0.6500000000  0.7222222222  0.6020000000  0.5555555556  0.9262048193  0.8975903614  0.9231927711  0.9216867470  0.6380952381  19.200000000  0.2120917988  0.7291096306  0.0897278786  300           0.2175288105 
0.6980000000  0.7301587302  0.6600000000  0.6031746032  0.7180000000  0.7222222222  0.6800000000  0.7063492063  0.9849397590  0.9759036145  0.8042168675  0.8192771084  0.7142857143  22.400000000  0.1933690119  0.6590281415  0.0897278786  350           0.2219096470 
0.7860000000  0.8253968254  0.7120000000  0.6031746032  0.7880000000  0.8015873016  0.7400000000  0.6428571429  0.8222891566  0.8192771084  0.7921686747  0.7951807229  0.7936507937  25.600000000  0.2327243447  0.6246889758  0.0897278786  400           0.2146251965 
0.8340000000  0.8253968254  0.7660000000  0.6984126984  0.8220000000  0.8333333333  0.7960000000  0.6349206349  0.8975903614  0.8674698795  0.8584337349  0.9036144578  0.6936507937  28.800000000  0.2270346558  0.5880960989  0.0897278786  450           0.2080831432 
0.8740000000  0.8571428571  0.7800000000  0.6507936508  0.8680000000  0.8888888889  0.7900000000  0.7142857143  0.9201807229  0.8734939759  0.7530120482  0.7710843373  0.7111111111  32.000000000  0.2341584945  0.5589085543  0.0897278786  500           0.2108697510 
0.8100000000  0.7539682540  0.7840000000  0.7063492063  0.7800000000  0.7460317460  0.7720000000  0.6984126984  0.8493975904  0.8554216867  0.6762048193  0.7289156627  0.5031746032  35.200000000  0.2223257911  0.5321842790  0.0897278786  550           0.2071399593 
0.8840000000  0.8730158730  0.8140000000  0.6984126984  0.8700000000  0.9047619048  0.8180000000  0.6825396825  0.9759036145  0.9397590361  0.8960843373  0.9096385542  0.7666666667  38.400000000  0.1869934309  0.5127269578  0.0897278786  600           0.2087435818 
0.8780000000  0.8492063492  0.7920000000  0.6984126984  0.8820000000  0.8888888889  0.8180000000  0.6666666667  0.9819277108  0.9638554217  0.8704819277  0.8554216867  0.7809523810  41.600000000  0.2088948250  0.4894510144  0.0897278786  650           0.2113915110 
0.9380000000  0.8809523810  0.8680000000  0.8095238095  0.9300000000  0.9206349206  0.8760000000  0.7142857143  0.9608433735  0.9156626506  0.9367469880  0.9638554217  0.6174603175  44.800000000  0.1982915545  0.4809506434  0.0897278786  700           0.2088647270 
0.9320000000  0.9285714286  0.8820000000  0.8095238095  0.9540000000  0.9206349206  0.8660000000  0.7063492063  0.9743975904  0.9337349398  0.9503012048  0.9578313253  0.6380952381  48.000000000  0.2081229293  0.4611222178  0.0897278786  750           0.2087321329 
0.9100000000  0.8809523810  0.8860000000  0.8095238095  0.9280000000  0.9206349206  0.8520000000  0.7142857143  0.9909638554  0.9638554217  0.9909638554  0.9879518072  0.6825396825  51.200000000  0.2086595333  0.4392598069  0.0897278786  800           0.2108657980 
0.9380000000  0.9126984127  0.9180000000  0.8412698413  0.9600000000  0.9285714286  0.8920000000  0.7301587302  0.9638554217  0.9156626506  0.9578313253  0.9638554217  0.5000000000  54.400000000  0.2379268813  0.4132230145  0.0897278786  850           0.2090796995 
0.9460000000  0.9126984127  0.9040000000  0.8174603175  0.9680000000  0.9365079365  0.8800000000  0.7301587302  0.9698795181  0.9156626506  0.9954819277  0.9939759036  0.6460317460  57.600000000  0.1865978169  0.3969758207  0.0897278786  900           0.2147564602 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.002812885384798702
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3120000000  0.3095238095  0.2980000000  0.2698412698  0.3180000000  0.3015873016  0.3000000000  0.3174603175  0.3283132530  0.3493975904  0.2771084337  0.2650602410  0.3269841270  0.0000000000  0.2134382725  1.1565986872  0.0797834396  0             0.6982917786 
0.5800000000  0.4603174603  0.5220000000  0.5079365079  0.5160000000  0.5396825397  0.5320000000  0.5158730159  0.6686746988  0.7108433735  0.6460843373  0.6807228916  0.5285714286  3.2000000000  0.1335914946  1.0730924916  0.0852704048  50            0.2118707514 
0.6280000000  0.5476190476  0.5980000000  0.5873015873  0.6180000000  0.6587301587  0.6160000000  0.6111111111  0.7906626506  0.7771084337  0.7996987952  0.7891566265  0.5888888889  6.4000000000  0.1174408293  1.0094651544  0.0868573189  100           0.2129306126 
0.6260000000  0.6190476190  0.6540000000  0.5873015873  0.6300000000  0.6190476190  0.6720000000  0.6031746032  0.6897590361  0.7469879518  0.6234939759  0.6385542169  0.6841269841  9.6000000000  0.1516894841  0.9309160280  0.0868573189  150           0.2144015646 
0.6300000000  0.6666666667  0.6040000000  0.5793650794  0.6460000000  0.6428571429  0.6220000000  0.6031746032  0.8674698795  0.9036144578  0.7334337349  0.7530120482  0.6666666667  12.800000000  0.1773992491  0.8546694148  0.0868573189  200           0.2271317625 
0.5960000000  0.6031746032  0.6100000000  0.5873015873  0.6000000000  0.6269841270  0.6080000000  0.6587301587  0.9608433735  0.9397590361  0.8358433735  0.8493975904  0.6666666667  16.000000000  0.2155786967  0.7835240924  0.0868573189  250           0.2165073681 
0.6600000000  0.6825396825  0.6020000000  0.5476190476  0.6500000000  0.7222222222  0.6020000000  0.5555555556  0.9262048193  0.8975903614  0.9231927711  0.9216867470  0.6380952381  19.200000000  0.2120917988  0.7291096306  0.0868573189  300           0.2099356365 
0.6980000000  0.7301587302  0.6600000000  0.6031746032  0.7180000000  0.7222222222  0.6800000000  0.7063492063  0.9849397590  0.9759036145  0.8042168675  0.8192771084  0.7142857143  22.400000000  0.1933690119  0.6590281415  0.0868573189  350           0.2253350735 
0.7860000000  0.8253968254  0.7120000000  0.6031746032  0.7880000000  0.8015873016  0.7400000000  0.6428571429  0.8222891566  0.8192771084  0.7921686747  0.7951807229  0.7936507937  25.600000000  0.2327243447  0.6246889758  0.0868573189  400           0.2160482216 
0.8340000000  0.8253968254  0.7660000000  0.6984126984  0.8220000000  0.8333333333  0.7960000000  0.6349206349  0.8975903614  0.8674698795  0.8584337349  0.9036144578  0.6936507937  28.800000000  0.2270346558  0.5880960989  0.0868573189  450           0.2122707891 
0.8740000000  0.8571428571  0.7800000000  0.6507936508  0.8680000000  0.8888888889  0.7900000000  0.7142857143  0.9201807229  0.8734939759  0.7530120482  0.7710843373  0.7111111111  32.000000000  0.2341584945  0.5589085543  0.0868573189  500           0.2252233124 
0.8100000000  0.7539682540  0.7840000000  0.7063492063  0.7800000000  0.7460317460  0.7720000000  0.6984126984  0.8493975904  0.8554216867  0.6762048193  0.7289156627  0.5031746032  35.200000000  0.2223257911  0.5321842790  0.0868573189  550           0.2149315739 
0.8840000000  0.8730158730  0.8140000000  0.6984126984  0.8700000000  0.9047619048  0.8180000000  0.6825396825  0.9759036145  0.9397590361  0.8960843373  0.9096385542  0.7666666667  38.400000000  0.1869934309  0.5127269578  0.0883688927  600           0.2043011093 
0.8780000000  0.8492063492  0.7920000000  0.6984126984  0.8820000000  0.8888888889  0.8180000000  0.6666666667  0.9819277108  0.9638554217  0.8704819277  0.8554216867  0.7809523810  41.600000000  0.2088948250  0.4894510144  0.0884466171  650           0.2123668242 
0.9380000000  0.8809523810  0.8680000000  0.8095238095  0.9300000000  0.9206349206  0.8760000000  0.7142857143  0.9608433735  0.9156626506  0.9367469880  0.9638554217  0.6174603175  44.800000000  0.1982915545  0.4809506434  0.0884466171  700           0.2159667492 
0.9320000000  0.9285714286  0.8820000000  0.8095238095  0.9540000000  0.9206349206  0.8660000000  0.7063492063  0.9743975904  0.9337349398  0.9503012048  0.9578313253  0.6380952381  48.000000000  0.2081229293  0.4611222178  0.0904769897  750           0.2202848053 

trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3120000000  0.3095238095  0.2980000000  0.2698412698  0.3180000000  0.3015873016  0.3000000000  0.3174603175  0.3283132530  0.3493975904  0.2771084337  0.2650602410  0.3269841270  0.0000000000  0.2134382725  1.1565986872  0.0797834396  0             0.5198569298 
0.5800000000  0.4603174603  0.5220000000  0.5079365079  0.5160000000  0.5396825397  0.5320000000  0.5158730159  0.6686746988  0.7108433735  0.6460843373  0.6807228916  0.5285714286  3.2000000000  0.1335914946  1.0730924916  0.0852704048  50            0.2198946381 
0.6280000000  0.5476190476  0.5980000000  0.5873015873  0.6180000000  0.6587301587  0.6160000000  0.6111111111  0.7906626506  0.7771084337  0.7996987952  0.7891566265  0.5888888889  6.4000000000  0.1174408293  1.0094651544  0.0852704048  100           0.2205950880 
0.6260000000  0.6190476190  0.6540000000  0.5873015873  0.6300000000  0.6190476190  0.6720000000  0.6031746032  0.6897590361  0.7469879518  0.6234939759  0.6385542169  0.6841269841  9.6000000000  0.1516894841  0.9309160280  0.0852704048  150           0.2180957603 
0.6300000000  0.6666666667  0.6040000000  0.5793650794  0.6460000000  0.6428571429  0.6220000000  0.6031746032  0.8674698795  0.9036144578  0.7334337349  0.7530120482  0.6666666667  12.800000000  0.1773992491  0.8546694148  0.0853290558  200           0.2150011635 
0.5960000000  0.6031746032  0.6100000000  0.5873015873  0.6000000000  0.6269841270  0.6080000000  0.6587301587  0.9608433735  0.9397590361  0.8358433735  0.8493975904  0.6666666667  16.000000000  0.2155786967  0.7835240924  0.0853290558  250           0.2147135305 
0.6600000000  0.6825396825  0.6020000000  0.5476190476  0.6500000000  0.7222222222  0.6020000000  0.5555555556  0.9262048193  0.8975903614  0.9231927711  0.9216867470  0.6380952381  19.200000000  0.2120917988  0.7291096306  0.0853290558  300           0.2263253307 
0.6980000000  0.7301587302  0.6600000000  0.6031746032  0.7180000000  0.7222222222  0.6800000000  0.7063492063  0.9849397590  0.9759036145  0.8042168675  0.8192771084  0.7142857143  22.400000000  0.1933690119  0.6590281415  0.0853905678  350           0.2020619726 
0.7860000000  0.8253968254  0.7120000000  0.6031746032  0.7880000000  0.8015873016  0.7400000000  0.6428571429  0.8222891566  0.8192771084  0.7921686747  0.7951807229  0.7936507937  25.600000000  0.2327243447  0.6246889758  0.0856866837  400           0.2001517487 
0.8340000000  0.8253968254  0.7660000000  0.6984126984  0.8220000000  0.8333333333  0.7960000000  0.6349206349  0.8975903614  0.8674698795  0.8584337349  0.9036144578  0.6936507937  28.800000000  0.2270346558  0.5880960989  0.0856866837  450           0.2163813353 
0.8740000000  0.8571428571  0.7800000000  0.6507936508  0.8680000000  0.8888888889  0.7900000000  0.7142857143  0.9201807229  0.8734939759  0.7530120482  0.7710843373  0.7111111111  32.000000000  0.2341584945  0.5589085543  0.0856866837  500           0.2126870728 
0.8100000000  0.7539682540  0.7840000000  0.7063492063  0.7800000000  0.7460317460  0.7720000000  0.6984126984  0.8493975904  0.8554216867  0.6762048193  0.7289156627  0.5031746032  35.200000000  0.2223257911  0.5321842790  0.0856866837  550           0.2296660852 
0.8840000000  0.8730158730  0.8140000000  0.6984126984  0.8700000000  0.9047619048  0.8180000000  0.6825396825  0.9759036145  0.9397590361  0.8960843373  0.9096385542  0.7666666667  38.400000000  0.1869934309  0.5127269578  0.0883302689  600           0.2075462246 
0.8780000000  0.8492063492  0.7920000000  0.6984126984  0.8820000000  0.8888888889  0.8180000000  0.6666666667  0.9819277108  0.9638554217  0.8704819277  0.8554216867  0.7809523810  41.600000000  0.2088948250  0.4894510144  0.0883302689  650           0.2158729887 
0.9380000000  0.8809523810  0.8680000000  0.8095238095  0.9300000000  0.9206349206  0.8760000000  0.7142857143  0.9608433735  0.9156626506  0.9367469880  0.9638554217  0.6174603175  44.800000000  0.1982915545  0.4809506434  0.0883302689  700           0.2119322968 
0.9320000000  0.9285714286  0.8820000000  0.8095238095  0.9540000000  0.9206349206  0.8660000000  0.7063492063  0.9743975904  0.9337349398  0.9503012048  0.9578313253  0.6380952381  48.000000000  0.2081229293  0.4611222178  0.0883302689  750           0.2125057936 
0.9100000000  0.8809523810  0.8860000000  0.8095238095  0.9280000000  0.9206349206  0.8520000000  0.7142857143  0.9909638554  0.9638554217  0.9909638554  0.9879518072  0.6825396825  51.200000000  0.2086595333  0.4392598069  0.0883302689  800           0.2163431978 
0.9380000000  0.9126984127  0.9180000000  0.8412698413  0.9600000000  0.9285714286  0.8920000000  0.7301587302  0.9638554217  0.9156626506  0.9578313253  0.9638554217  0.5000000000  54.400000000  0.2379268813  0.4132230145  0.0883302689  850           0.2246207142 
0.9460000000  0.9126984127  0.9040000000  0.8174603175  0.9680000000  0.9365079365  0.8800000000  0.7301587302  0.9698795181  0.9156626506  0.9954819277  0.9939759036  0.6460317460  57.600000000  0.1865978169  0.3969758207  0.0883302689  900           0.2270928478 
0.9460000000  0.9047619048  0.9140000000  0.8333333333  0.9340000000  0.8968253968  0.8860000000  0.7222222222  0.9804216867  0.9337349398  0.9698795181  0.9759036145  0.5920634921  60.800000000  0.2199723530  0.3819425708  0.0883302689  950           0.2395767403 
0.9260000000  0.9285714286  0.8960000000  0.8571428571  0.9540000000  0.9682539683  0.8980000000  0.7698412698  0.9397590361  0.9036144578  1.0000000000  1.0000000000  0.6492063492  64.000000000  0.2187565118  0.3682117265  0.0883302689  1000          0.2278803539 
0.9420000000  0.9206349206  0.9300000000  0.8888888889  0.9480000000  0.9444444444  0.9400000000  0.8253968254  0.9939759036  0.9879518072  0.9743975904  0.9698795181  0.6460317460  67.200000000  0.1997874200  0.3414718562  0.0883302689  1050          0.2330775261 
0.9580000000  0.9285714286  0.9180000000  0.8809523810  0.9860000000  0.9603174603  0.8960000000  0.7698412698  1.0000000000  1.0000000000  0.9759036145  0.9759036145  0.7365079365  70.400000000  0.2123393202  0.3163712221  0.0883302689  1100          0.2356567144 
0.9620000000  0.9047619048  0.9660000000  0.9444444444  0.9740000000  0.9365079365  0.9320000000  0.7857142857  0.9894578313  0.9819277108  0.9728915663  0.9638554217  0.4809523810  73.600000000  0.2109334809  0.2864644155  0.0883302689  1150          0.2257873249 
0.9620000000  0.9365079365  0.9660000000  0.9444444444  0.9780000000  0.9523809524  0.9320000000  0.7936507937  0.9924698795  0.9819277108  0.9382530120  0.9096385542  0.5714285714  76.800000000  0.2084295100  0.2703491804  0.0883302689  1200          0.2136536646 
0.9760000000  0.9761904762  0.9580000000  0.9285714286  0.9920000000  0.9682539683  0.9440000000  0.8174603175  0.9984939759  0.9939759036  0.9728915663  0.9638554217  0.6126984127  80.000000000  0.2079540288  0.2451908758  0.0883302689  1250          0.2327991819 
0.9920000000  0.9444444444  0.9660000000  0.9841269841  0.9920000000  0.9603174603  0.9420000000  0.7936507937  0.9984939759  0.9939759036  0.9954819277  0.9939759036  0.5587301587  83.200000000  0.2028969043  0.2275264865  0.0883302689  1300          0.2193371201 
0.9920000000  0.9761904762  0.9780000000  0.9523809524  0.9940000000  0.9761904762  0.9700000000  0.8888888889  0.9954819277  0.9939759036  1.0000000000  1.0000000000  0.5206349206  86.400000000  0.2063755921  0.2046182635  0.0883302689  1350          0.2275816202 
0.9940000000  0.9841269841  0.9740000000  0.9523809524  0.9940000000  0.9920634921  0.9860000000  0.9047619048  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6349206349  89.600000000  0.1872742629  0.1749446321  0.0883302689  1400          0.2501739311 
0.9960000000  0.9841269841  0.9900000000  1.0000000000  0.9920000000  0.9841269841  0.9900000000  0.8968253968  0.9984939759  0.9939759036  0.9909638554  0.9879518072  0.4222222222  92.800000000  0.2002081743  0.1634935543  0.0883302689  1450          0.2424247122 
0.9940000000  1.0000000000  0.9900000000  0.9523809524  0.9960000000  0.9920634921  0.9820000000  0.9047619048  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6031746032  96.000000000  0.1622404128  0.1476051526  0.0883302689  1500          0.2333370686 
0.9960000000  0.9920634921  0.9980000000  0.9761904762  1.0000000000  0.9920634921  0.9960000000  0.9126984127  1.0000000000  1.0000000000  0.9939759036  0.9879518072  0.4888888889  99.200000000  0.1584190834  0.1349459341  0.0883302689  1550          0.2330017710 
0.9960000000  0.9841269841  0.9960000000  0.9603174603  0.9960000000  0.9841269841  0.9960000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5730158730  102.40000000  0.1709386942  0.1171176851  0.0883302689  1600          0.2167998695 
0.9980000000  0.9920634921  0.9980000000  0.9920634921  1.0000000000  0.9920634921  0.9920000000  0.9047619048  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5015873016  105.60000000  0.1690623479  0.1081060450  0.0883302689  1650          0.2367221928 
1.0000000000  0.9841269841  0.9980000000  1.0000000000  1.0000000000  0.9761904762  1.0000000000  0.9126984127  0.9954819277  0.9578313253  1.0000000000  1.0000000000  0.4079365079  108.80000000  0.1500735480  0.1000665312  0.0883302689  1700          0.2331972933 
0.9980000000  0.9761904762  0.9980000000  1.0000000000  1.0000000000  0.9841269841  0.9920000000  0.8730158730  0.9969879518  0.9879518072  0.9969879518  1.0000000000  0.4222222222  112.00000000  0.1501341622  0.0900904852  0.0886650085  1750          0.2385902023 


trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3253968254  0.3140000000  0.3095238095  0.3200000000  0.3095238095  0.3260000000  0.3174603175  0.3418674699  0.3313253012  0.3253012048  0.3253012048  0.3301587302  0.0000000000  0.2722291946  1.1565986872  0.0797834396  0             0.6592812538 
0.4740000000  0.3730158730  0.4220000000  0.3809523810  0.4500000000  0.4365079365  0.3840000000  0.3968253968  0.3448795181  0.4397590361  0.3433734940  0.3373493976  0.3380952381  3.2000000000  0.1544886827  1.1207703900  0.0852704048  50            0.2103747606 
0.5540000000  0.4603174603  0.4920000000  0.5238095238  0.5460000000  0.5396825397  0.4360000000  0.4444444444  0.4668674699  0.4698795181  0.5436746988  0.5602409639  0.4142857143  6.4000000000  0.1184755945  1.0891820765  0.0852704048  100           0.2120293379 
0.5660000000  0.5079365079  0.4720000000  0.5158730159  0.5700000000  0.5793650794  0.4620000000  0.4682539683  0.5316265060  0.5240963855  0.5873493976  0.5783132530  0.4730158730  9.6000000000  0.1194817019  1.0758772254  0.0868711472  150           0.2093569136 
0.5920000000  0.5555555556  0.5380000000  0.5317460317  0.6040000000  0.6428571429  0.4920000000  0.5158730159  0.6475903614  0.6626506024  0.6475903614  0.6385542169  0.4730158730  12.800000000  0.1158650064  1.0618484449  0.0868711472  200           0.2102823591 
0.5880000000  0.5238095238  0.5340000000  0.5714285714  0.5860000000  0.6269841270  0.5020000000  0.5634920635  0.7093373494  0.7409638554  0.6777108434  0.6987951807  0.4825396825  16.000000000  0.1059204841  1.0534774232  0.0868711472  250           0.2081959629 
0.6100000000  0.5555555556  0.5500000000  0.5476190476  0.6000000000  0.6269841270  0.5140000000  0.5634920635  0.6942771084  0.6686746988  0.7243975904  0.6927710843  0.5015873016  19.200000000  0.1014678621  1.0429224730  0.0869307518  300           0.2119161510 
0.6260000000  0.6031746032  0.5980000000  0.5396825397  0.6280000000  0.6507936508  0.5740000000  0.5873015873  0.7259036145  0.7228915663  0.6867469880  0.6987951807  0.5365079365  22.400000000  0.1064037299  1.0331210423  0.0869307518  350           0.2174829483 
0.6360000000  0.6428571429  0.6120000000  0.5396825397  0.6360000000  0.6507936508  0.6120000000  0.6031746032  0.6927710843  0.6746987952  0.6656626506  0.6746987952  0.5984126984  25.600000000  0.0974659157  1.0201967287  0.0869307518  400           0.2219531298 
0.6200000000  0.6507936508  0.5720000000  0.5317460317  0.6100000000  0.6111111111  0.5740000000  0.5634920635  0.7003012048  0.7048192771  0.6987951807  0.7108433735  0.5857142857  28.800000000  0.1065224934  1.0135683250  0.0869307518  450           0.2228185368 
0.6340000000  0.6428571429  0.6100000000  0.5396825397  0.6320000000  0.6111111111  0.6200000000  0.6269841270  0.6957831325  0.6867469880  0.6490963855  0.6566265060  0.6349206349  32.000000000  0.0984298348  1.0013400519  0.0869307518  500           0.2036231613 
0.6340000000  0.6587301587  0.6180000000  0.5793650794  0.6440000000  0.6587301587  0.6480000000  0.6269841270  0.6490963855  0.6325301205  0.6009036145  0.6084337349  0.6682539683  35.200000000  0.1118360949  0.9843401313  0.0869307518  550           0.2051294947 
0.6160000000  0.6269841270  0.6100000000  0.5396825397  0.6140000000  0.6031746032  0.6180000000  0.6031746032  0.7319277108  0.7469879518  0.7213855422  0.7289156627  0.6682539683  38.400000000  0.0984796524  0.9741658270  0.0869307518  600           0.2092802286 
0.6200000000  0.6190476190  0.6280000000  0.5793650794  0.6080000000  0.6031746032  0.6380000000  0.6111111111  0.7530120482  0.7710843373  0.6927710843  0.7228915663  0.6619047619  41.600000000  0.1213161063  0.9581727767  0.0869307518  650           0.2077411509 
0.6320000000  0.6269841270  0.6640000000  0.6428571429  0.6320000000  0.6349206349  0.6760000000  0.6269841270  0.7816265060  0.7650602410  0.6340361446  0.6445783133  0.6936507937  44.800000000  0.1128176427  0.9445607483  0.0869307518  700           0.2085588884 
0.6180000000  0.6190476190  0.6440000000  0.5952380952  0.6340000000  0.6190476190  0.6240000000  0.6190476190  0.8192771084  0.8192771084  0.7243975904  0.7530120482  0.6460317460  48.000000000  0.1269800997  0.9262285018  0.0869307518  750           0.2086720514 
0.6340000000  0.6349206349  0.6380000000  0.6190476190  0.6520000000  0.6428571429  0.6440000000  0.6349206349  0.7816265060  0.7530120482  0.5692771084  0.5903614458  0.6666666667  51.200000000  0.1327141619  0.9081164539  0.0869307518  800           0.2107699823 
0.6400000000  0.6507936508  0.6300000000  0.5873015873  0.6540000000  0.6507936508  0.6480000000  0.6349206349  0.8072289157  0.7951807229  0.6355421687  0.6385542169  0.6984126984  54.400000000  0.1432804561  0.8864027822  0.0896677971  850           0.2092603159 
0.6000000000  0.6190476190  0.6140000000  0.5952380952  0.6360000000  0.6031746032  0.6220000000  0.6031746032  0.8900602410  0.8734939759  0.7710843373  0.7831325301  0.6555555556  57.600000000  0.1591554260  0.8687282264  0.0896677971  900           0.2082518148 
0.6220000000  0.6587301587  0.6300000000  0.5634920635  0.6680000000  0.6269841270  0.6560000000  0.6190476190  0.8313253012  0.8313253012  0.7515060241  0.7530120482  0.7206349206  60.800000000  0.1593129826  0.8485453117  0.0896677971  950           0.2110485315 
0.6300000000  0.6190476190  0.6340000000  0.5476190476  0.6560000000  0.6428571429  0.6580000000  0.6031746032  0.8975903614  0.8915662651  0.8463855422  0.8433734940  0.7031746032  64.000000000  0.1675474715  0.8266539288  0.0896677971  1000          0.2128720856 
0.6140000000  0.6190476190  0.5800000000  0.5476190476  0.6220000000  0.6031746032  0.5820000000  0.5714285714  0.9277108434  0.9277108434  0.8719879518  0.8734939759  0.6126984127  67.200000000  0.1633302593  0.8065039968  0.0896677971  1050          0.2148278999 
0.6420000000  0.6746031746  0.6480000000  0.5634920635  0.6720000000  0.6587301587  0.6440000000  0.6428571429  0.8930722892  0.8734939759  0.7138554217  0.7349397590  0.7253968254  70.400000000  0.1855308127  0.7887789297  0.0896677971  1100          0.2158743715 
0.6740000000  0.7063492063  0.6860000000  0.5793650794  0.7120000000  0.6825396825  0.7100000000  0.6349206349  0.9713855422  0.9457831325  0.7801204819  0.7951807229  0.7682539683  73.600000000  0.1913229990  0.7687027574  0.0896677971  1150          0.2172776079 
0.6680000000  0.6666666667  0.6400000000  0.5952380952  0.6760000000  0.6428571429  0.6660000000  0.6507936508  0.9563253012  0.9337349398  0.8659638554  0.8855421687  0.7333333333  76.800000000  0.1828426933  0.7533786285  0.0896677971  1200          0.2191747808 
0.6920000000  0.7063492063  0.6560000000  0.5873015873  0.7180000000  0.6666666667  0.6740000000  0.6428571429  0.9593373494  0.9457831325  0.7665662651  0.7530120482  0.7761904762  80.000000000  0.1957743931  0.7423572898  0.0896677971  1250          0.2201417828 
0.7120000000  0.7619047619  0.6980000000  0.6190476190  0.7540000000  0.7142857143  0.7200000000  0.6587301587  0.9548192771  0.9277108434  0.8177710843  0.8132530120  0.7698412698  83.200000000  0.1890363955  0.7207564855  0.0896677971  1300          0.2166468763 
0.7020000000  0.7063492063  0.6900000000  0.6031746032  0.7320000000  0.7222222222  0.7080000000  0.6507936508  0.9548192771  0.9277108434  0.8885542169  0.8915662651  0.7634920635  86.400000000  0.1862720799  0.7070063281  0.0896677971  1350          0.2170140839 
0.6980000000  0.7380952381  0.6720000000  0.6031746032  0.7420000000  0.7142857143  0.6980000000  0.6349206349  0.9277108434  0.9036144578  0.7756024096  0.8012048193  0.7904761905  89.600000000  0.2132072806  0.6918192708  0.0898270607  1400          0.2165362978 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 517, in __next__
    data = self._next_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1182, in _next_data
    idx, data = self._get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 1148, in _get_data
    success, data = self._try_get_data()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 986, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/connection.py", line 911, in wait
    ready = selector.select(timeout)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/selectors.py", line 376, in select
    fd_event_list = self._poll.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/util.py", line 319, in _exit_function
    p.join()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 122, in join
    assert self._parent_pid == os.getpid(), 'can only join a child process'
AssertionError: can only join a child process
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 1e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3220000000  0.3333333333  0.3140000000  0.3095238095  0.3200000000  0.3174603175  0.3300000000  0.3174603175  0.3418674699  0.3313253012  0.3253012048  0.3253012048  0.3301587302  0.0000000000  0.2728633881  1.1610440016  0.0797834396  0             0.5431683064 
0.4300000000  0.3730158730  0.3920000000  0.3492063492  0.4220000000  0.3730158730  0.3640000000  0.3809523810  0.3463855422  0.4216867470  0.3132530120  0.2891566265  0.2920634921  3.2000000000  0.1571430588  1.1217549801  0.0852704048  50            0.2152175808 
0.5480000000  0.4841269841  0.5040000000  0.4841269841  0.5520000000  0.5476190476  0.4300000000  0.4841269841  0.5225903614  0.5361445783  0.5256024096  0.5602409639  0.4206349206  6.4000000000  0.1186076403  1.0900907445  0.0852704048  100           0.2203224802 
0.5580000000  0.5555555556  0.5040000000  0.5317460317  0.5820000000  0.5634920635  0.4600000000  0.4761904762  0.5421686747  0.5903614458  0.6385542169  0.6265060241  0.4396825397  9.6000000000  0.1199036741  1.0754521585  0.0852704048  150           0.2137043476 
0.6080000000  0.5396825397  0.5500000000  0.5476190476  0.6060000000  0.5873015873  0.4980000000  0.5793650794  0.6084337349  0.6506024096  0.6506024096  0.6746987952  0.4857142857  12.800000000  0.1146870422  1.0602612472  0.0881853104  200           0.2305497742 
0.5740000000  0.5000000000  0.5340000000  0.5238095238  0.5560000000  0.5634920635  0.4860000000  0.5317460317  0.6792168675  0.6807228916  0.7153614458  0.7409638554  0.4761904762  16.000000000  0.1070834565  1.0527487183  0.0881853104  250           0.2341128969 
0.6180000000  0.5714285714  0.5660000000  0.5238095238  0.6100000000  0.6111111111  0.5180000000  0.5714285714  0.7048192771  0.7228915663  0.7123493976  0.7048192771  0.5285714286  19.200000000  0.1111314464  1.0418122411  0.0881853104  300           0.2211697531 
0.6200000000  0.5873015873  0.5560000000  0.5317460317  0.6240000000  0.6111111111  0.5560000000  0.6190476190  0.7093373494  0.7168674699  0.6867469880  0.7108433735  0.5396825397  22.400000000  0.1075256944  1.0312538433  0.0881853104  350           0.2267565203 
0.6400000000  0.5793650794  0.6100000000  0.5634920635  0.6280000000  0.6507936508  0.6080000000  0.6507936508  0.7289156627  0.7349397590  0.6867469880  0.7108433735  0.5682539683  25.600000000  0.1066364551  1.0179217744  0.0881853104  400           0.2176864147 
0.6220000000  0.5714285714  0.5720000000  0.5238095238  0.6140000000  0.6269841270  0.5700000000  0.6111111111  0.7289156627  0.7349397590  0.6777108434  0.7108433735  0.5746031746  28.800000000  0.1124832749  1.0148068106  0.0882368088  450           0.2225094843 
0.6140000000  0.6111111111  0.5680000000  0.5396825397  0.6080000000  0.6349206349  0.5880000000  0.6428571429  0.7123493976  0.7289156627  0.6927710843  0.7108433735  0.6000000000  32.000000000  0.1007369208  1.0040432703  0.0882368088  500           0.2277036238 
0.6500000000  0.6349206349  0.6140000000  0.5714285714  0.6520000000  0.6666666667  0.6240000000  0.6507936508  0.6340361446  0.5843373494  0.5933734940  0.5903614458  0.6492063492  35.200000000  0.1027246523  0.9916420186  0.0882368088  550           0.2275704718 
0.6300000000  0.5952380952  0.5700000000  0.5396825397  0.6300000000  0.6666666667  0.6080000000  0.6269841270  0.7665662651  0.7650602410  0.6762048193  0.6927710843  0.6380952381  38.400000000  0.1019088078  0.9804194856  0.0882368088  600           0.2237460804 
0.6060000000  0.5952380952  0.5720000000  0.5476190476  0.6140000000  0.6428571429  0.5980000000  0.6349206349  0.7981927711  0.8072289157  0.7063253012  0.7409638554  0.6396825397  41.600000000  0.1150648689  0.9650190902  0.0903482437  650           0.2146458292 
0.6500000000  0.6269841270  0.6260000000  0.6031746032  0.6380000000  0.6507936508  0.6560000000  0.6746031746  0.8192771084  0.8192771084  0.6897590361  0.7108433735  0.6857142857  44.800000000  0.1113414192  0.9505853236  0.0903482437  700           0.2214591694 
0.6380000000  0.5793650794  0.5940000000  0.5555555556  0.6340000000  0.6428571429  0.6280000000  0.6190476190  0.8373493976  0.8192771084  0.7590361446  0.7590361446  0.6571428571  48.000000000  0.1287270689  0.9337705863  0.0903482437  750           0.2294132853 
0.6640000000  0.6031746032  0.6240000000  0.5952380952  0.6500000000  0.6428571429  0.6440000000  0.6666666667  0.8268072289  0.8012048193  0.6099397590  0.6325301205  0.6904761905  51.200000000  0.1304987335  0.9159864616  0.0903482437  800           0.2175342321 
0.6420000000  0.5952380952  0.5920000000  0.5634920635  0.6480000000  0.6587301587  0.6200000000  0.6269841270  0.8313253012  0.8192771084  0.7409638554  0.7469879518  0.6349206349  54.400000000  0.1405358219  0.8941878259  0.0903482437  850           0.2325792074 
0.6340000000  0.5952380952  0.5860000000  0.5634920635  0.6320000000  0.6507936508  0.6180000000  0.5952380952  0.9051204819  0.8855421687  0.7409638554  0.7469879518  0.6634920635  57.600000000  0.1498816991  0.8791538501  0.0903482437  900           0.2192987299 
0.6520000000  0.6111111111  0.5940000000  0.5476190476  0.6660000000  0.6587301587  0.6300000000  0.6269841270  0.8659638554  0.8373493976  0.7439759036  0.7469879518  0.7285714286  60.800000000  0.1490163326  0.8621303570  0.0903482437  950           0.2267286158 
0.6420000000  0.5873015873  0.5820000000  0.5396825397  0.6440000000  0.6507936508  0.6160000000  0.6507936508  0.9171686747  0.9096385542  0.8734939759  0.8915662651  0.6873015873  64.000000000  0.1596850038  0.8438100159  0.0903482437  1000          0.2209337568 
0.6080000000  0.5476190476  0.5640000000  0.5317460317  0.5900000000  0.5873015873  0.5680000000  0.5476190476  0.9322289157  0.9096385542  0.9427710843  0.9638554217  0.5571428571  67.200000000  0.1578052235  0.8194366455  0.0903482437  1050          0.2158668900 
0.6740000000  0.6111111111  0.6400000000  0.6031746032  0.6600000000  0.6507936508  0.6600000000  0.6349206349  0.9367469880  0.9036144578  0.7560240964  0.7590361446  0.7126984127  70.400000000  0.1909740496  0.8033098781  0.0903482437  1100          0.2127751827 
0.6800000000  0.6031746032  0.6480000000  0.5793650794  0.6640000000  0.6428571429  0.6700000000  0.6269841270  0.9563253012  0.9216867470  0.8418674699  0.8614457831  0.7238095238  73.600000000  0.1854357886  0.7820125473  0.0903482437  1150          0.2226901054 
0.6720000000  0.6190476190  0.6280000000  0.5714285714  0.6620000000  0.6507936508  0.6480000000  0.6031746032  0.9442771084  0.9216867470  0.8478915663  0.8614457831  0.7301587302  76.800000000  0.1768844891  0.7647137177  0.0903482437  1200          0.2227307034 
0.6860000000  0.6349206349  0.6300000000  0.5793650794  0.6860000000  0.6825396825  0.6560000000  0.6269841270  0.9623493976  0.9216867470  0.7996987952  0.8012048193  0.7634920635  80.000000000  0.1869040418  0.7520780265  0.0903482437  1250          0.2213324738 
0.7400000000  0.6825396825  0.6700000000  0.5873015873  0.7400000000  0.7142857143  0.7020000000  0.6428571429  0.9487951807  0.9036144578  0.8102409639  0.8072289157  0.7523809524  83.200000000  0.1781300640  0.7337950718  0.0903482437  1300          0.2178861189 
0.7260000000  0.6428571429  0.6300000000  0.5634920635  0.7220000000  0.7301587302  0.6780000000  0.6190476190  0.9457831325  0.9277108434  0.8825301205  0.8915662651  0.7396825397  86.400000000  0.1812650323  0.7195364213  0.0903482437  1350          0.2131333590 
0.7220000000  0.6746031746  0.6200000000  0.5634920635  0.7280000000  0.7460317460  0.6700000000  0.6746031746  0.9307228916  0.9277108434  0.7500000000  0.7590361446  0.8079365079  89.600000000  0.1951971722  0.7028170836  0.0903482437  1400          0.2243302774 
0.7920000000  0.7539682540  0.6600000000  0.5952380952  0.7660000000  0.7380952381  0.7100000000  0.6507936508  0.9533132530  0.9096385542  0.7891566265  0.8072289157  0.7492063492  92.800000000  0.1973120594  0.6942526817  0.0903482437  1450          0.2282000589 
0.7360000000  0.6825396825  0.6400000000  0.5873015873  0.7380000000  0.7380952381  0.6720000000  0.6666666667  0.9397590361  0.9156626506  0.7515060241  0.8012048193  0.7873015873  96.000000000  0.1909357190  0.6775645626  0.0903482437  1500          0.2191684628 
0.7640000000  0.6904761905  0.6800000000  0.6111111111  0.7500000000  0.7380952381  0.7000000000  0.6904761905  0.9623493976  0.9216867470  0.8358433735  0.8614457831  0.7380952381  99.200000000  0.2005399489  0.6701200056  0.0903482437  1550          0.2161442137 
0.7160000000  0.6190476190  0.6240000000  0.6031746032  0.7160000000  0.7222222222  0.6600000000  0.6111111111  0.9638554217  0.9397590361  0.9337349398  0.9397590361  0.6746031746  102.40000000  0.2135217714  0.6620264983  0.0903482437  1600          0.2132767200 
0.8000000000  0.7142857143  0.7220000000  0.6190476190  0.7940000000  0.8015873016  0.7440000000  0.6587301587  0.9713855422  0.9457831325  0.8945783133  0.9156626506  0.7492063492  105.60000000  0.2032439733  0.6500293744  0.0903482437  1650          0.2104174328 
0.8360000000  0.8015873016  0.7240000000  0.6111111111  0.8380000000  0.8412698413  0.7600000000  0.6746031746  0.9653614458  0.9578313253  0.8539156627  0.8855421687  0.7587301587  108.80000000  0.2066831875  0.6358598936  0.0903482437  1700          0.2134013748 
0.7980000000  0.7777777778  0.6980000000  0.5952380952  0.8080000000  0.8174603175  0.7480000000  0.6349206349  0.9668674699  0.9518072289  0.7936746988  0.8132530120  0.7888888889  112.00000000  0.2237338316  0.6267526710  0.0903482437  1750          0.2107001543 
0.8400000000  0.8095238095  0.7340000000  0.6269841270  0.8340000000  0.8492063492  0.7620000000  0.6666666667  0.9728915663  0.9638554217  0.8554216867  0.8795180723  0.7428571429  115.20000000  0.2041144812  0.6158815742  0.0903482437  1800          0.2155581665 
0.8580000000  0.7857142857  0.7600000000  0.6190476190  0.8380000000  0.8809523810  0.7880000000  0.6666666667  0.9653614458  0.9457831325  0.8102409639  0.8554216867  0.7126984127  118.40000000  0.2202962601  0.6098105395  0.0903482437  1850          0.2134054995 
0.8180000000  0.7222222222  0.7280000000  0.6269841270  0.8000000000  0.8095238095  0.7680000000  0.6507936508  0.9849397590  0.9638554217  0.8930722892  0.9096385542  0.7269841270  121.60000000  0.1907955062  0.5974283600  0.0903482437  1900          0.2210225964 
0.8320000000  0.7301587302  0.7320000000  0.6111111111  0.8140000000  0.8253968254  0.7560000000  0.6746031746  0.9759036145  0.9397590361  0.9277108434  0.9397590361  0.7333333333  124.80000000  0.1945772707  0.6006652319  0.0903482437  1950          0.2367193794 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 327, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/lib/misc.py", line 171, in accuracy
    for x, y in loader:
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 355, in __iter__
    return self._get_iterator()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 301, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 914, in __init__
    w.start()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/process.py", line 105, in start
    self._popen = self._Popen(self)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/multiprocessing/popen_fork.py", line 66, in _launch
    self.pid = os.fork()
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3080000000  0.2619047619  0.3100000000  0.2698412698  0.3160000000  0.3015873016  0.2960000000  0.3095238095  0.3268072289  0.3313253012  0.2786144578  0.2590361446  0.3238095238  0.0000000000  0.2149960995  1.1610440016  0.0797834396  0             0.5513224602 
0.6140000000  0.5873015873  0.5700000000  0.5238095238  0.6300000000  0.6428571429  0.5640000000  0.5793650794  0.6566265060  0.7108433735  0.5888554217  0.6204819277  0.5444444444  3.2000000000  0.1302665544  1.0685660768  0.0852842331  50            0.2118348169 
0.6120000000  0.5952380952  0.5780000000  0.4920634921  0.6220000000  0.6349206349  0.5600000000  0.5793650794  0.7289156627  0.7831325301  0.8147590361  0.7891566265  0.5777777778  6.4000000000  0.1155549216  1.0180117607  0.0852842331  100           0.2152921915 
0.5660000000  0.5793650794  0.6000000000  0.5317460317  0.5680000000  0.6111111111  0.5940000000  0.6190476190  0.8147590361  0.8012048193  0.7635542169  0.7650602410  0.6428571429  9.6000000000  0.1317012119  0.9532996476  0.0852842331  150           0.2115959215 
0.7180000000  0.6825396825  0.6620000000  0.5714285714  0.6980000000  0.7142857143  0.6580000000  0.6507936508  0.8584337349  0.8554216867  0.6686746988  0.6746987952  0.7619047619  12.800000000  0.1650131369  0.8685117316  0.0852842331  200           0.2128355646 
0.5880000000  0.6031746032  0.5900000000  0.6031746032  0.5840000000  0.5714285714  0.5940000000  0.5952380952  0.9036144578  0.8915662651  0.8780120482  0.8975903614  0.5888888889  16.000000000  0.2109158349  0.7892457819  0.0879411697  250           0.2155308008 
0.6200000000  0.5793650794  0.5460000000  0.5317460317  0.5980000000  0.5873015873  0.5400000000  0.5158730159  0.7695783133  0.7289156627  0.9924698795  0.9939759036  0.5825396825  19.200000000  0.2054898190  0.7205307782  0.0879411697  300           0.2131452417 
0.7180000000  0.7142857143  0.6500000000  0.5634920635  0.7120000000  0.7619047619  0.7000000000  0.6428571429  0.9728915663  0.9638554217  0.8328313253  0.8614457831  0.7873015873  22.400000000  0.2209067440  0.6566299033  0.0879411697  350           0.2165764618 
0.7680000000  0.7857142857  0.6600000000  0.5873015873  0.8080000000  0.7380952381  0.7040000000  0.6746031746  0.9442771084  0.9216867470  0.8885542169  0.8674698795  0.7222222222  25.600000000  0.2194222152  0.6231161737  0.0879411697  400           0.2202714920 
0.8320000000  0.8174603175  0.7180000000  0.6111111111  0.8080000000  0.8333333333  0.7380000000  0.6587301587  0.9352409639  0.9096385542  0.9563253012  0.9698795181  0.7396825397  28.800000000  0.2425246644  0.5881279254  0.0879411697  450           0.2270961571 
0.8580000000  0.8492063492  0.7320000000  0.5873015873  0.8620000000  0.8730158730  0.7400000000  0.6507936508  0.9653614458  0.9216867470  0.8810240964  0.8855421687  0.7507936508  32.000000000  0.2522314739  0.5554601216  0.0879411697  500           0.2116908646 
0.8480000000  0.8253968254  0.8100000000  0.7301587302  0.8080000000  0.8095238095  0.7720000000  0.7142857143  0.8403614458  0.8313253012  0.7771084337  0.8072289157  0.4746031746  35.200000000  0.1995931256  0.5288289154  0.0879411697  550           0.2156424809 
0.8800000000  0.8174603175  0.7720000000  0.6746031746  0.8800000000  0.9047619048  0.8060000000  0.6746031746  0.9819277108  0.9759036145  0.9231927711  0.9457831325  0.7619047619  38.400000000  0.2090151656  0.5147991914  0.0879411697  600           0.2180642796 
0.8680000000  0.8253968254  0.7420000000  0.6587301587  0.8700000000  0.8730158730  0.7780000000  0.6746031746  0.9894578313  0.9939759036  0.8990963855  0.9216867470  0.7730158730  41.600000000  0.1978903615  0.4940769732  0.0879411697  650           0.2273509693 
0.8760000000  0.8571428571  0.8480000000  0.7777777778  0.8600000000  0.8492063492  0.8460000000  0.7142857143  0.9563253012  0.8975903614  0.9457831325  0.9518072289  0.5873015873  44.800000000  0.1981887186  0.4827140564  0.0884079933  700           0.2199315596 
0.9140000000  0.8571428571  0.8400000000  0.7619047619  0.9080000000  0.9047619048  0.8380000000  0.7460317460  0.9623493976  0.9216867470  0.9864457831  0.9698795181  0.6317460317  48.000000000  0.2174240816  0.4596862495  0.0884079933  750           0.2228731441 
0.9120000000  0.8968253968  0.8480000000  0.7539682540  0.9240000000  0.9126984127  0.8440000000  0.6825396825  0.9864457831  0.9819277108  0.9834337349  0.9698795181  0.7063492063  51.200000000  0.1964919901  0.4354053146  0.0884079933  800           0.2143958044 
0.8980000000  0.8888888889  0.8780000000  0.8015873016  0.9220000000  0.9047619048  0.8680000000  0.7698412698  0.9759036145  0.9518072289  0.9774096386  0.9578313253  0.5301587302  54.400000000  0.2396447635  0.4187230265  0.0894317627  850           0.2188565016 
0.9300000000  0.9206349206  0.8440000000  0.7777777778  0.9600000000  0.9365079365  0.8440000000  0.7460317460  0.9653614458  0.9337349398  1.0000000000  1.0000000000  0.6777777778  57.600000000  0.2069409168  0.4071901768  0.0894317627  900           0.2281149054 
0.9420000000  0.9603174603  0.9120000000  0.8412698413  0.9580000000  0.9365079365  0.8900000000  0.7380952381  0.9728915663  0.9518072289  0.9653614458  0.9578313253  0.5555555556  60.800000000  0.2106703603  0.3861290151  0.0894317627  950           0.2115538311 
0.9580000000  0.9365079365  0.9180000000  0.8809523810  0.9760000000  0.9523809524  0.9000000000  0.7936507937  0.9563253012  0.9096385542  1.0000000000  1.0000000000  0.6269841270  64.000000000  0.2099384212  0.3649196547  0.0894317627  1000          0.2097598362 
0.9080000000  0.8888888889  0.8840000000  0.8253968254  0.9120000000  0.9365079365  0.8840000000  0.8015873016  0.9894578313  0.9698795181  0.9969879518  1.0000000000  0.6492063492  67.200000000  0.2114314061  0.3347222304  0.0894317627  1050          0.2075744915 
0.9680000000  0.9523809524  0.9120000000  0.8571428571  0.9860000000  0.9761904762  0.9100000000  0.8333333333  0.9864457831  0.9578313253  1.0000000000  1.0000000000  0.6539682540  70.400000000  0.2123542339  0.3164880407  0.0894317627  1100          0.2232627344 
0.9420000000  0.9365079365  0.9140000000  0.8968253968  0.9500000000  0.8968253968  0.9000000000  0.7777777778  0.9804216867  0.9578313253  0.9698795181  0.9638554217  0.4396825397  73.600000000  0.2082132953  0.2814611208  0.0894317627  1150          0.2168602514 
0.9700000000  0.9444444444  0.9760000000  0.9365079365  0.9800000000  0.9682539683  0.9640000000  0.8730158730  0.9834337349  0.9819277108  0.9984939759  0.9939759036  0.6063492063  76.800000000  0.2112861121  0.2729358158  0.0894317627  1200          0.2069723368 
0.9740000000  0.9761904762  0.9380000000  0.8809523810  0.9920000000  0.9682539683  0.9340000000  0.8650793651  0.9984939759  0.9939759036  0.9909638554  0.9759036145  0.5841269841  80.000000000  0.1945505893  0.2469799000  0.0894317627  1250          0.2180724001 
0.9940000000  0.9841269841  0.9820000000  0.9603174603  0.9980000000  0.9841269841  0.9740000000  0.8730158730  0.9849397590  0.9759036145  0.9924698795  0.9939759036  0.4460317460  83.200000000  0.2046110606  0.2208224341  0.0894317627  1300          0.2120436478 
0.9700000000  0.9603174603  0.9680000000  0.9285714286  0.9880000000  0.9841269841  0.9760000000  0.9206349206  0.9864457831  0.9819277108  1.0000000000  1.0000000000  0.4968253968  86.400000000  0.1879981598  0.2039176536  0.0894317627  1350          0.2134797668 
0.9800000000  0.9841269841  0.9620000000  0.9365079365  0.9980000000  0.9761904762  0.9780000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.6412698413  89.600000000  0.1843016055  0.1805403665  0.0894317627  1400          0.2114720631 
0.9860000000  0.9841269841  0.9820000000  0.9841269841  0.9920000000  0.9761904762  0.9780000000  0.8571428571  0.9984939759  0.9939759036  0.9894578313  0.9819277108  0.4619047619  92.800000000  0.2086013141  0.1686011225  0.0894317627  1450          0.2127574492 
0.9960000000  0.9841269841  0.9960000000  0.9444444444  1.0000000000  0.9841269841  0.9860000000  0.8730158730  1.0000000000  1.0000000000  1.0000000000  0.9879518072  0.6190476190  96.000000000  0.1709760046  0.1440206330  0.0894317627  1500          0.2101706505 
0.9920000000  0.9841269841  0.9940000000  0.9682539683  1.0000000000  0.9761904762  0.9760000000  0.8650793651  1.0000000000  1.0000000000  0.9939759036  0.9879518072  0.5587301587  99.200000000  0.1612877625  0.1325283276  0.0894317627  1550          0.2128758335 
0.9920000000  0.9841269841  0.9840000000  0.9523809524  0.9980000000  0.9920634921  0.9880000000  0.8968253968  0.9969879518  0.9759036145  1.0000000000  1.0000000000  0.6349206349  102.40000000  0.1562801561  0.1165184139  0.0894317627  1600          0.2142380667 
0.9980000000  0.9920634921  0.9940000000  0.9761904762  1.0000000000  0.9841269841  0.9900000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5079365079  105.60000000  0.1431393735  0.1018606165  0.0894317627  1650          0.2135860252 
1.0000000000  0.9920634921  0.9960000000  0.9761904762  1.0000000000  0.9761904762  0.9900000000  0.8730158730  0.9984939759  0.9939759036  1.0000000000  1.0000000000  0.4253968254  108.80000000  0.1537563695  0.0960800135  0.0894317627  1700          0.2130475426 
0.9960000000  0.9761904762  0.9980000000  0.9761904762  1.0000000000  0.9682539683  0.9900000000  0.8968253968  0.9984939759  0.9939759036  0.9909638554  0.9759036145  0.5190476190  112.00000000  0.1319696313  0.0896099967  0.0894317627  1750          0.2094567776 
0.9980000000  0.9841269841  0.9920000000  0.9682539683  0.9980000000  0.9761904762  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5031746032  115.20000000  0.1237620404  0.0782868128  0.0894317627  1800          0.2116744518 
1.0000000000  0.9920634921  1.0000000000  1.0000000000  1.0000000000  0.9920634921  0.9980000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4142857143  118.40000000  0.1085173847  0.0694192481  0.0894317627  1850          0.2130616283 
1.0000000000  0.9841269841  0.9960000000  0.9841269841  1.0000000000  0.9841269841  0.9980000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5793650794  121.60000000  0.0965794483  0.0624681577  0.0894317627  1900          0.2117744112 
1.0000000000  0.9920634921  0.9960000000  0.9841269841  1.0000000000  0.9841269841  1.0000000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5222222222  124.80000000  0.1033068305  0.0552205628  0.0894317627  1950          0.2134945583 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5063492063  128.00000000  0.0917592984  0.0500837063  0.0894317627  2000          0.2108109903 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4682539683  131.20000000  0.0882841326  0.0441248448  0.0894317627  2050          0.2125106812 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  0.9682539683  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4920634921  134.40000000  0.0774797128  0.0431451846  0.0894317627  2100          0.2125581169 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9206349206  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4920634921  137.60000000  0.0956206980  0.0434425871  0.0894317627  2150          0.2138490534 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5174603175  140.80000000  0.0752633359  0.0403590462  0.0894317627  2200          0.2129657364 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5380952381  144.00000000  0.0908327060  0.0391042152  0.0894317627  2250          0.2143640184 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4730158730  147.20000000  0.0857473350  0.0395968800  0.0898513794  2300          0.2139202881 
1.0000000000  0.9920634921  1.0000000000  0.9761904762  1.0000000000  0.9920634921  1.0000000000  0.9603174603  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5460317460  150.40000000  0.0754650949  0.0371250244  0.0898513794  2350          0.2139295864 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9444444444  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5269841270  153.60000000  0.0808406029  0.0357969270  0.0898513794  2400          0.2120178509 
1.0000000000  0.9920634921  1.0000000000  0.9841269841  1.0000000000  0.9920634921  1.0000000000  0.9523809524  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.5190476190  156.80000000  0.0736133833  0.0358410998  0.0898513794  2450          0.2129345894 
1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9920634921  1.0000000000  0.9285714286  1.0000000000  1.0000000000  1.0000000000  1.0000000000  0.4888888889  160.00000000  0.0755903468  0.0349849892  0.0898513794  2500          0.2150593853 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 355, in <module>
    save_checkpoint('model.pkl')
KeyboardInterrupt
trails: 0
Args:
	algorithm: Transfer
	checkpoint_freq: None
	data_dir: /home/yfy/Desktop/Dataset/
	dataset: Bearing
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	normlizetype: 0-1
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [6]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	d_steps_per_g: 10
	data_augmentation: True
	delta: 2
	gda: False
	lr: 2.5e-05
	lr_d: 1e-05
	lr_iter: 2001
	nonlinear_classifier: True
	resnet18: False
	resnet_dropout: 0.0
	t_lambda: 2
	weight_decay: 2.812885384798702e-06
	weight_decay_d: 0.0008
Load Data.
data 4
Start Training.
env0_in_acc   env0_out_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  env4_in_acc   env4_out_acc  env5_in_acc   env5_out_acc  env6_test_ac  epoch         gap           loss          mem_gb        step          step_time    
0.3160000000  0.3174603175  0.3040000000  0.2936507937  0.3240000000  0.2936507937  0.3180000000  0.3015873016  0.3418674699  0.3313253012  0.3057228916  0.3072289157  0.3285714286  0.0000000000  0.2507612705  1.1610440016  0.0797834396  0             0.6405937672 
0.5480000000  0.4285714286  0.5200000000  0.5079365079  0.5240000000  0.5396825397  0.4920000000  0.4761904762  0.5240963855  0.5301204819  0.4638554217  0.4578313253  0.3825396825  3.2000000000  0.1370820236  1.0935661101  0.0852842331  50            0.2162343836 
0.5960000000  0.5714285714  0.5480000000  0.5238095238  0.6280000000  0.5952380952  0.5420000000  0.6349206349  0.6099397590  0.6084337349  0.6475903614  0.6144578313  0.5523809524  6.4000000000  0.1070810318  1.0555831146  0.0852842331  100           0.2150531626 
0.5960000000  0.6111111111  0.5500000000  0.4920634921  0.6080000000  0.6349206349  0.5460000000  0.5634920635  0.6686746988  0.6867469880  0.6656626506  0.6385542169  0.5666666667  9.6000000000  0.1142275119  1.0336251688  0.0853910446  150           0.2248401499 
0.6280000000  0.5873015873  0.5740000000  0.5158730159  0.6100000000  0.6031746032  0.5580000000  0.6031746032  0.6731927711  0.6686746988  0.6340361446  0.5963855422  0.6222222222  12.800000000  0.1154706311  0.9990199459  0.0869331360  200           0.2191882277 
0.5960000000  0.5714285714  0.6080000000  0.5476190476  0.5700000000  0.6269841270  0.6120000000  0.6666666667  0.8192771084  0.8433734940  0.7515060241  0.7530120482  0.6396825397  16.000000000  0.1283813262  0.9692734206  0.0869331360  250           0.2135186958 
0.5600000000  0.5555555556  0.5480000000  0.5238095238  0.5560000000  0.5634920635  0.5160000000  0.5079365079  0.7560240964  0.7349397590  0.8674698795  0.8433734940  0.4746031746  19.200000000  0.1329520297  0.9258631420  0.0869331360  300           0.2167206144 
0.6480000000  0.5873015873  0.6120000000  0.5714285714  0.6380000000  0.6190476190  0.6320000000  0.6349206349  0.7921686747  0.7590361446  0.7289156627  0.7590361446  0.6857142857  22.400000000  0.1543172169  0.8808861315  0.0869331360  350           0.2182362556 
0.6480000000  0.5793650794  0.6060000000  0.6111111111  0.6300000000  0.6031746032  0.6380000000  0.6349206349  0.8885542169  0.8795180723  0.7891566265  0.7951807229  0.6825396825  25.600000000  0.1735314369  0.8343302023  0.0880093575  400           0.2231967354 
0.6920000000  0.6111111111  0.6800000000  0.6031746032  0.6860000000  0.6825396825  0.7000000000  0.6190476190  0.9322289157  0.8975903614  0.7756024096  0.7771084337  0.7492063492  28.800000000  0.1903237629  0.7997107649  0.0880093575  450           0.2162447357 
0.6860000000  0.6428571429  0.6340000000  0.5793650794  0.6760000000  0.6904761905  0.6680000000  0.6428571429  0.8750000000  0.8373493976  0.7786144578  0.7771084337  0.7761904762  32.000000000  0.1881099367  0.7676286471  0.0880093575  500           0.2151320505 
0.7940000000  0.7460317460  0.7580000000  0.6190476190  0.7520000000  0.7936507937  0.7660000000  0.6984126984  0.8539156627  0.8253012048  0.7063253012  0.7289156627  0.7476190476  35.200000000  0.1783273149  0.7231184804  0.0880093575  550           0.2245328426 
0.6900000000  0.6666666667  0.6140000000  0.5476190476  0.6960000000  0.6984126984  0.6660000000  0.6111111111  0.9563253012  0.9216867470  0.9171686747  0.9457831325  0.7793650794  38.400000000  0.1954352689  0.6903481591  0.0880093575  600           0.2237048244 
0.7240000000  0.7142857143  0.6660000000  0.5793650794  0.7420000000  0.7380952381  0.7080000000  0.6587301587  0.9668674699  0.9397590361  0.8569277108  0.8493975904  0.8142857143  41.600000000  0.1928136516  0.6564421403  0.0880093575  650           0.2175015116 
0.8240000000  0.7857142857  0.7600000000  0.6587301587  0.7720000000  0.8253968254  0.7840000000  0.6666666667  0.9503012048  0.9216867470  0.9006024096  0.9277108434  0.7158730159  44.800000000  0.1943015218  0.6387013817  0.0880093575  700           0.2192816544 
0.8020000000  0.7301587302  0.7300000000  0.6349206349  0.7700000000  0.7539682540  0.7400000000  0.6666666667  0.9668674699  0.9397590361  0.9292168675  0.9578313253  0.7111111111  48.000000000  0.2108429718  0.6171474349  0.0880093575  750           0.2305958462 
0.7700000000  0.7142857143  0.6920000000  0.6507936508  0.7740000000  0.7777777778  0.7200000000  0.6746031746  0.9593373494  0.9337349398  0.8569277108  0.8373493976  0.6952380952  51.200000000  0.2115780580  0.5952184415  0.0880093575  800           0.2184716749 
0.8660000000  0.8253968254  0.7580000000  0.6746031746  0.8580000000  0.8730158730  0.7960000000  0.7142857143  0.9668674699  0.9397590361  0.9051204819  0.9216867470  0.7253968254  54.400000000  0.2466865349  0.5722650671  0.0880093575  850           0.2129493618 
0.8260000000  0.8333333333  0.7380000000  0.5634920635  0.8300000000  0.8095238095  0.7380000000  0.6587301587  0.9759036145  0.9518072289  0.9322289157  0.9578313253  0.7650793651  57.600000000  0.1862057900  0.5571761763  0.0880093575  900           0.2000751686 
0.8820000000  0.8650793651  0.8080000000  0.6587301587  0.8820000000  0.8730158730  0.8080000000  0.7142857143  0.9698795181  0.9518072289  0.9216867470  0.9397590361  0.6761904762  60.800000000  0.2078609753  0.5445383048  0.0880093575  950           0.1991905069 
0.8440000000  0.7777777778  0.7600000000  0.6746031746  0.8440000000  0.8333333333  0.7640000000  0.6507936508  0.9698795181  0.9397590361  0.9939759036  0.9879518072  0.6952380952  64.000000000  0.2228977346  0.5282926917  0.0880093575  1000          0.2093933964 
0.8420000000  0.7936507937  0.8000000000  0.7142857143  0.8420000000  0.8174603175  0.7880000000  0.6984126984  0.9713855422  0.9216867470  0.9954819277  0.9939759036  0.6761904762  67.200000000  0.2039505279  0.5121978432  0.0880093575  1050          0.2093345833 
0.8280000000  0.7936507937  0.7940000000  0.7460317460  0.8520000000  0.8253968254  0.7820000000  0.6825396825  0.9713855422  0.9337349398  0.9774096386  0.9819277108  0.6984126984  70.400000000  0.2231878436  0.5011031812  0.0880093575  1100          0.2017659426 
0.9060000000  0.8809523810  0.8260000000  0.7460317460  0.9140000000  0.9523809524  0.8560000000  0.7301587302  0.9683734940  0.9337349398  0.9472891566  0.9698795181  0.6857142857  73.600000000  0.2164249551  0.4767255747  0.0880093575  1150          0.2065393829 
0.9020000000  0.8888888889  0.8560000000  0.7698412698  0.9220000000  0.9285714286  0.8440000000  0.7063492063  0.9849397590  0.9759036145  0.9156626506  0.9277108434  0.7015873016  76.800000000  0.1944400072  0.4730748594  0.0880093575  1200          0.2148848772 
0.9100000000  0.8809523810  0.7940000000  0.6984126984  0.9260000000  0.9126984127  0.8160000000  0.7142857143  0.9909638554  0.9879518072  0.9623493976  0.9578313253  0.7285714286  80.000000000  0.2076577532  0.4702071440  0.0880093575  1250          0.2239982843 
0.9340000000  0.8571428571  0.9000000000  0.7936507937  0.9460000000  0.9206349206  0.8820000000  0.7142857143  0.9442771084  0.8855421687  0.9262048193  0.9457831325  0.5190476190  83.200000000  0.1743410635  0.4567832303  0.0880093575  1300          0.2136151457 
0.9240000000  0.8412698413  0.8420000000  0.7460317460  0.9240000000  0.9206349206  0.8540000000  0.7222222222  0.9774096386  0.9216867470  0.9924698795  0.9819277108  0.7206349206  86.400000000  0.2010035980  0.4480437106  0.0880093575  1350          0.2116747141 
0.9200000000  0.8809523810  0.8780000000  0.8095238095  0.9140000000  0.9126984127  0.8800000000  0.7222222222  0.9924698795  0.9698795181  0.9864457831  0.9698795181  0.6968253968  89.600000000  0.2181374919  0.4334660393  0.0880093575  1400          0.2179225111 
0.9260000000  0.8968253968  0.9100000000  0.8333333333  0.9360000000  0.9206349206  0.9100000000  0.7460317460  0.9834337349  0.9698795181  0.9713855422  0.9819277108  0.6000000000  92.800000000  0.2342326021  0.4214251083  0.0880093575  1450          0.2129907465 
0.9260000000  0.9047619048  0.8900000000  0.7619047619  0.9380000000  0.9126984127  0.8920000000  0.7222222222  0.9894578313  0.9819277108  0.9653614458  0.9819277108  0.6952380952  96.000000000  0.1900216806  0.4134186620  0.0880093575  1500          0.2155847740 
0.9420000000  0.9047619048  0.9080000000  0.8333333333  0.9480000000  0.9206349206  0.9080000000  0.7380952381  0.9954819277  0.9939759036  0.9533132530  0.9457831325  0.6666666667  99.200000000  0.1995832193  0.4156820637  0.0880093575  1550          0.2258836508 
Traceback (most recent call last):
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/scripts/train.py", line 305, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)   # loss 
  File "/home/yfy/Desktop/my_project/DomainBed-IFD/domainbed/algorithms.py", line 1983, in update
    gap.backward()
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/tensor.py", line 245, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/yfy/anaconda3/envs/pytorch/lib/python3.6/site-packages/torch/autograd/__init__.py", line 147, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
